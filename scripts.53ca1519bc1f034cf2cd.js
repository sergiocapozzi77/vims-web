/*! For license information please see scripts.53ca1519bc1f034cf2cd.js.LICENSE.txt */
"undefined"!=typeof window&&function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Hls=t():e.Hls=t()}(this,(function(){return function(e){var t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,(function(t){return e[t]}).bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/dist/",i(i.s=13)}([function(e,t,i){"use strict";i.d(t,"a",(function(){return c})),i.d(t,"b",(function(){return d}));var r=i(5);function n(){}var a={trace:n,debug:n,log:n,warn:n,info:n,error:n},s=a;function o(e,t){return"["+e+"] > "+t}var u=Object(r.a)();function l(e){var t=u.console[e];return t?function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];r[0]&&(r[0]=o(e,r[0])),t.apply(u.console,r)}:n}var c=function(e){if(u.console&&!0===e||"object"==typeof e){!function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];i.forEach((function(t){s[t]=e[t]?e[t].bind(e):l(t)}))}(e,"debug","log","info","warn","error");try{s.log()}catch(e){s=a}}else s=a},d=s},function(e,t,i){"use strict";t.a={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",LEVELS_UPDATED:"hlsLevelsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",CUES_PARSED:"hlsCuesParsed",NON_NATIVE_TEXT_TRACKS_FOUND:"hlsNonNativeTextTracksFound",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition",LIVE_BACK_BUFFER_REACHED:"hlsLiveBackBufferReached"}},function(e,t,i){"use strict";var r,n;i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return n})),function(e){e.NETWORK_ERROR="networkError",e.MEDIA_ERROR="mediaError",e.KEY_SYSTEM_ERROR="keySystemError",e.MUX_ERROR="muxError",e.OTHER_ERROR="otherError"}(r||(r={})),function(e){e.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",e.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",e.KEY_SYSTEM_NO_SESSION="keySystemNoSession",e.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",e.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",e.LEVEL_EMPTY_ERROR="levelEmptyError",e.LEVEL_LOAD_ERROR="levelLoadError",e.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",e.LEVEL_SWITCH_ERROR="levelSwitchError",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",e.FRAG_LOAD_ERROR="fragLoadError",e.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",e.FRAG_DECRYPT_ERROR="fragDecryptError",e.FRAG_PARSING_ERROR="fragParsingError",e.REMUX_ALLOC_ERROR="remuxAllocError",e.KEY_LOAD_ERROR="keyLoadError",e.KEY_LOAD_TIMEOUT="keyLoadTimeOut",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.BUFFER_APPEND_ERROR="bufferAppendError",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.BUFFER_STALLED_ERROR="bufferStalledError",e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.INTERNAL_EXCEPTION="internalException"}(n||(n={}))},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)}},function(e,t,i){"use strict";i.d(t,"b",(function(){return o}));var r,n=i(5),a=function(){function e(){}return e.isHeader=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.isFooter=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.getID3Data=function(t,i){for(var r=i,n=0;e.isHeader(t,i);)n+=10,n+=e._readSize(t,i+6),e.isFooter(t,i+10)&&(n+=10),i+=n;if(n>0)return t.subarray(r,r+n)},e._readSize=function(e,t){var i=0;return i=(127&e[t])<<21,i|=(127&e[t+1])<<14,(i|=(127&e[t+2])<<7)|127&e[t+3]},e.getTimeStamp=function(t){for(var i=e.getID3Frames(t),r=0;r<i.length;r++){var n=i[r];if(e.isTimeStampFrame(n))return e._readTimeStamp(n)}},e.isTimeStampFrame=function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info},e._getFrameData=function(t){var i=String.fromCharCode(t[0],t[1],t[2],t[3]),r=e._readSize(t,4);return{type:i,size:r,data:t.subarray(10,10+r)}},e.getID3Frames=function(t){for(var i=0,r=[];e.isHeader(t,i);){for(var n=e._readSize(t,i+6),a=(i+=10)+n;i+8<a;){var s=e._getFrameData(t.subarray(i)),o=e._decodeFrame(s);o&&r.push(o),i+=s.size+10}e.isFooter(t,i)&&(i+=10)}return r},e._decodeFrame=function(t){return"PRIV"===t.type?e._decodePrivFrame(t):"W"===t.type[0]?e._decodeURLFrame(t):e._decodeTextFrame(t)},e._readTimeStamp=function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),i=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return i/=45,1&t[3]&&(i+=47721858.84),Math.round(i)}},e._decodePrivFrame=function(t){if(!(t.size<2)){var i=e._utf8ArrayToStr(t.data,!0),r=new Uint8Array(t.data.subarray(i.length+1));return{key:t.type,info:i,data:r.buffer}}},e._decodeTextFrame=function(t){if(!(t.size<2)){if("TXXX"===t.type){var i=1,r=e._utf8ArrayToStr(t.data.subarray(i),!0),n=e._utf8ArrayToStr(t.data.subarray(i+=r.length+1));return{key:t.type,info:r,data:n}}var a=e._utf8ArrayToStr(t.data.subarray(1));return{key:t.type,data:a}}},e._decodeURLFrame=function(t){if("WXXX"===t.type){if(t.size<2)return;var i=1,r=e._utf8ArrayToStr(t.data.subarray(i),!0),n=e._utf8ArrayToStr(t.data.subarray(i+=r.length+1));return{key:t.type,info:r,data:n}}var a=e._utf8ArrayToStr(t.data);return{key:t.type,data:a}},e._utf8ArrayToStr=function(e,t){void 0===t&&(t=!1);var i=s();if(i){var r=i.decode(e);if(t){var n=r.indexOf("\0");return-1!==n?r.substring(0,n):r}return r.replace(/\0/g,"")}for(var a,o,u,l=e.length,c="",d=0;d<l;){if(0===(a=e[d++])&&t)return c;if(0!==a&&3!==a)switch(a>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:c+=String.fromCharCode(a);break;case 12:case 13:o=e[d++],c+=String.fromCharCode((31&a)<<6|63&o);break;case 14:o=e[d++],u=e[d++],c+=String.fromCharCode((15&a)<<12|(63&o)<<6|(63&u)<<0)}}return c},e}();function s(){var e=Object(n.a)();return r||void 0===e.TextDecoder||(r=new e.TextDecoder("utf-8")),r}var o=a._utf8ArrayToStr;t.a=a},function(e,t,i){"use strict";function r(){return"undefined"==typeof window?self:window}i.d(t,"a",(function(){return r}))},function(e,t,i){var r,n,a,s,o;r=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#.*)?$/,n=/^([^\/?#]*)(.*)$/,a=/(?:\/|^)\.(?=\/)/g,s=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,o={buildAbsoluteURL:function(e,t,i){if(i=i||{},e=e.trim(),!(t=t.trim())){if(!i.alwaysNormalize)return e;var r=o.parseURL(e);if(!r)throw new Error("Error trying to parse base URL.");return r.path=o.normalizePath(r.path),o.buildURLFromParts(r)}var a=o.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return i.alwaysNormalize?(a.path=o.normalizePath(a.path),o.buildURLFromParts(a)):t;var s=o.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var u=n.exec(s.path);s.netLoc=u[1],s.path=u[2]}s.netLoc&&!s.path&&(s.path="/");var l={scheme:s.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(l.netLoc=s.netLoc,"/"!==a.path[0]))if(a.path){var c=s.path,d=c.substring(0,c.lastIndexOf("/")+1)+a.path;l.path=o.normalizePath(d)}else l.path=s.path,a.params||(l.params=s.params,a.query||(l.query=s.query));return null===l.path&&(l.path=i.alwaysNormalize?o.normalizePath(a.path):a.path),o.buildURLFromParts(l)},parseURL:function(e){var t=r.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(a,"");e.length!==(e=e.replace(s,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=o},function(e,t,i){"use strict";var r=function(){function e(e,t){this.subtle=e,this.aesIV=t}return e.prototype.decrypt=function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)},e}(),n=function(){function e(e,t){this.subtle=e,this.key=t}return e.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},e}(),a=function(){function e(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}var t=e.prototype;return t.uint8ArrayToUint32Array_=function(e){for(var t=new DataView(e),i=new Uint32Array(4),r=0;r<4;r++)i[r]=t.getUint32(4*r);return i},t.initTable=function(){var e=this.sBox,t=this.invSBox,i=this.subMix,r=i[0],n=i[1],a=i[2],s=i[3],o=this.invSubMix,u=o[0],l=o[1],c=o[2],d=o[3],h=new Uint32Array(256),f=0,p=0,g=0;for(g=0;g<256;g++)h[g]=g<128?g<<1:g<<1^283;for(g=0;g<256;g++){var m=p^p<<1^p<<2^p<<3^p<<4;e[f]=m=m>>>8^255&m^99,t[m]=f;var v=h[f],y=h[v],_=h[y],b=257*h[m]^16843008*m;r[f]=b<<24|b>>>8,n[f]=b<<16|b>>>16,a[f]=b<<8|b>>>24,s[f]=b,u[m]=(b=16843009*_^65537*y^257*v^16843008*f)<<24|b>>>8,l[m]=b<<16|b>>>16,c[m]=b<<8|b>>>24,d[m]=b,f?(f=v^h[h[h[_^v]]],p^=h[h[p]]):f=p=1}},t.expandKey=function(e){for(var t=this.uint8ArrayToUint32Array_(e),i=!0,r=0;r<t.length&&i;)i=t[r]===this.key[r],r++;if(!i){this.key=t;var n=this.keySize=t.length;if(4!==n&&6!==n&&8!==n)throw new Error("Invalid aes key size="+n);var a,s,o,u,l=this.ksRows=4*(n+6+1),c=this.keySchedule=new Uint32Array(l),d=this.invKeySchedule=new Uint32Array(l),h=this.sBox,f=this.rcon,p=this.invSubMix,g=p[0],m=p[1],v=p[2],y=p[3];for(a=0;a<l;a++)a<n?o=c[a]=t[a]:(u=o,a%n==0?(u=h[(u=u<<8|u>>>24)>>>24]<<24|h[u>>>16&255]<<16|h[u>>>8&255]<<8|h[255&u],u^=f[a/n|0]<<24):n>6&&a%n==4&&(u=h[u>>>24]<<24|h[u>>>16&255]<<16|h[u>>>8&255]<<8|h[255&u]),c[a]=o=(c[a-n]^u)>>>0);for(s=0;s<l;s++)a=l-s,u=3&s?c[a]:c[a-4],d[s]=s<4||a<=4?u:g[h[u>>>24]]^m[h[u>>>16&255]]^v[h[u>>>8&255]]^y[h[255&u]],d[s]=d[s]>>>0}},t.networkToHostOrderSwap=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},t.decrypt=function(e,t,i,r){for(var n,a,s,o,u,l,c,d,h,f,p,g,m,v,y,_,b,T=this.keySize+6,S=this.invKeySchedule,E=this.invSBox,k=this.invSubMix,w=k[0],C=k[1],A=k[2],L=k[3],I=this.uint8ArrayToUint32Array_(i),R=I[0],D=I[1],O=I[2],x=I[3],P=new Int32Array(e),M=new Int32Array(P.length),N=this.networkToHostOrderSwap;t<P.length;){for(h=N(P[t]),f=N(P[t+1]),p=N(P[t+2]),g=N(P[t+3]),u=h^S[0],l=g^S[1],c=p^S[2],d=f^S[3],m=4,v=1;v<T;v++)a=w[l>>>24]^C[c>>16&255]^A[d>>8&255]^L[255&u]^S[m+1],s=w[c>>>24]^C[d>>16&255]^A[u>>8&255]^L[255&l]^S[m+2],o=w[d>>>24]^C[u>>16&255]^A[l>>8&255]^L[255&c]^S[m+3],u=n=w[u>>>24]^C[l>>16&255]^A[c>>8&255]^L[255&d]^S[m],l=a,c=s,d=o,m+=4;n=E[u>>>24]<<24^E[l>>16&255]<<16^E[c>>8&255]<<8^E[255&d]^S[m],a=E[l>>>24]<<24^E[c>>16&255]<<16^E[d>>8&255]<<8^E[255&u]^S[m+1],s=E[c>>>24]<<24^E[d>>16&255]<<16^E[u>>8&255]<<8^E[255&l]^S[m+2],o=E[d>>>24]<<24^E[u>>16&255]<<16^E[l>>8&255]<<8^E[255&c]^S[m+3],m+=3,M[t]=N(n^R),M[t+1]=N(o^D),M[t+2]=N(s^O),M[t+3]=N(a^x),R=h,D=f,O=p,x=g,t+=4}return r?(b=(_=(y=M.buffer).byteLength)&&new DataView(y).getUint8(_-1))?y.slice(0,_-b):y:M.buffer},t.destroy=function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0},e}(),s=i(2),o=i(0),u=i(1),l=i(5),c=Object(l.a)(),d=function(){function e(e,t,i){var r=(void 0===i?{}:i).removePKCS7Padding,n=void 0===r||r;if(this.logEnabled=!0,this.observer=e,this.config=t,this.removePKCS7Padding=n,n)try{var a=c.crypto;a&&(this.subtle=a.subtle||a.webkitSubtle)}catch(e){}this.disableWebCrypto=!this.subtle}var t=e.prototype;return t.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},t.decrypt=function(e,t,i,s){var u=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(o.b.log("JS AES decrypt"),this.logEnabled=!1);var l=this.decryptor;l||(this.decryptor=l=new a),l.expandKey(t),s(l.decrypt(e,0,i,this.removePKCS7Padding))}else{this.logEnabled&&(o.b.log("WebCrypto AES decrypt"),this.logEnabled=!1);var c=this.subtle;this.key!==t&&(this.key=t,this.fastAesKey=new n(c,t)),this.fastAesKey.expandKey().then((function(n){new r(c,i).decrypt(e,n).catch((function(r){u.onWebCryptoError(r,e,t,i,s)})).then((function(e){s(e)}))})).catch((function(r){u.onWebCryptoError(r,e,t,i,s)}))}},t.onWebCryptoError=function(e,t,i,r,n){this.config.enableSoftwareAES?(o.b.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(t,i,r,n)):(o.b.error("decrypting error : "+e.message),this.observer.trigger(u.a.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))},t.destroy=function(){var e=this.decryptor;e&&(e.destroy(),this.decryptor=void 0)},e}();t.a=d},function(e,t,i){"use strict";var r=Object.prototype.hasOwnProperty,n="~";function a(){}function s(e,t,i){this.fn=e,this.context=t,this.once=i||!1}function o(e,t,i,r,a){if("function"!=typeof i)throw new TypeError("The listener must be a function");var o=new s(i,r||e,a),u=n?n+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],o]:e._events[u].push(o):(e._events[u]=o,e._eventsCount++),e}function u(e,t){0==--e._eventsCount?e._events=new a:delete e._events[t]}function l(){this._events=new a,this._eventsCount=0}Object.create&&(a.prototype=Object.create(null),(new a).__proto__||(n=!1)),l.prototype.eventNames=function(){var e,t,i=[];if(0===this._eventsCount)return i;for(t in e=this._events)r.call(e,t)&&i.push(n?t.slice(1):t);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},l.prototype.listeners=function(e){var t=this._events[n?n+e:e];if(!t)return[];if(t.fn)return[t.fn];for(var i=0,r=t.length,a=new Array(r);i<r;i++)a[i]=t[i].fn;return a},l.prototype.listenerCount=function(e){var t=this._events[n?n+e:e];return t?t.fn?1:t.length:0},l.prototype.emit=function(e,t,i,r,a,s){var o=n?n+e:e;if(!this._events[o])return!1;var u,l,c=this._events[o],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,i),!0;case 4:return c.fn.call(c.context,t,i,r),!0;case 5:return c.fn.call(c.context,t,i,r,a),!0;case 6:return c.fn.call(c.context,t,i,r,a,s),!0}for(l=1,u=new Array(d-1);l<d;l++)u[l-1]=arguments[l];c.fn.apply(c.context,u)}else{var h,f=c.length;for(l=0;l<f;l++)switch(c[l].once&&this.removeListener(e,c[l].fn,void 0,!0),d){case 1:c[l].fn.call(c[l].context);break;case 2:c[l].fn.call(c[l].context,t);break;case 3:c[l].fn.call(c[l].context,t,i);break;case 4:c[l].fn.call(c[l].context,t,i,r);break;default:if(!u)for(h=1,u=new Array(d-1);h<d;h++)u[h-1]=arguments[h];c[l].fn.apply(c[l].context,u)}}return!0},l.prototype.on=function(e,t,i){return o(this,e,t,i,!1)},l.prototype.once=function(e,t,i){return o(this,e,t,i,!0)},l.prototype.removeListener=function(e,t,i,r){var a=n?n+e:e;if(!this._events[a])return this;if(!t)return u(this,a),this;var s=this._events[a];if(s.fn)s.fn!==t||r&&!s.once||i&&s.context!==i||u(this,a);else{for(var o=0,l=[],c=s.length;o<c;o++)(s[o].fn!==t||r&&!s[o].once||i&&s[o].context!==i)&&l.push(s[o]);l.length?this._events[a]=1===l.length?l[0]:l:u(this,a)}return this},l.prototype.removeAllListeners=function(e){var t;return e?this._events[t=n?n+e:e]&&u(this,t):(this._events=new a,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=n,l.EventEmitter=l,e.exports=l},function(e,t,i){"use strict";var r=i(1),n=i(2),a=i(7),s=i(3),o=i(0),u=i(5);function l(e,t){return 255===e[t]&&240==(246&e[t+1])}function c(e,t){return 1&e[t+1]?7:9}function d(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function h(e,t){return!!(t+1<e.length&&l(e,t))}function f(e,t){if(h(e,t)){var i=c(e,t);if(t+i>=e.length)return!1;var r=d(e,t);if(r<=i)return!1;var n=t+r;if(n===e.length||n+1<e.length&&l(e,n))return!0}return!1}function p(e,t,i,a,s){if(!e.samplerate){var u=function(e,t,i,a){var s,u,l,c,d,h=navigator.userAgent.toLowerCase(),f=a,p=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];if(s=1+((192&t[i+2])>>>6),!((u=(60&t[i+2])>>>2)>p.length-1))return c=(1&t[i+2])<<2,o.b.log("manifest codec:"+a+",ADTS data:type:"+s+",sampleingIndex:"+u+"["+p[u]+"Hz],channelConfig:"+(c|=(192&t[i+3])>>>6)),/firefox/i.test(h)?u>=6?(s=5,d=new Array(4),l=u-3):(s=2,d=new Array(2),l=u):-1!==h.indexOf("android")?(s=2,d=new Array(2),l=u):(s=5,d=new Array(4),a&&(-1!==a.indexOf("mp4a.40.29")||-1!==a.indexOf("mp4a.40.5"))||!a&&u>=6?l=u-3:((a&&-1!==a.indexOf("mp4a.40.2")&&(u>=6&&1===c||/vivaldi/i.test(h))||!a&&1===c)&&(s=2,d=new Array(2)),l=u)),d[0]=s<<3,d[0]|=(14&u)>>1,d[1]|=(1&u)<<7,d[1]|=c<<3,5===s&&(d[1]|=(14&l)>>1,d[2]=(1&l)<<7,d[2]|=8,d[3]=0),{config:d,samplerate:p[u],channelCount:c,codec:"mp4a.40."+s,manifestCodec:f};e.trigger(r.a.ERROR,{type:n.b.MEDIA_ERROR,details:n.a.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+u})}(t,i,a,s);e.config=u.config,e.samplerate=u.samplerate,e.channelCount=u.channelCount,e.codec=u.codec,e.manifestCodec=u.manifestCodec,o.b.log("parsed codec:"+e.codec+",rate:"+u.samplerate+",nb channel:"+u.channelCount)}}function g(e){return 9216e4/e}function m(e,t,i,r,n){var a=function(e,t,i,r,n){var a,s,o=e.length;if(a=c(e,t),s=d(e,t),(s-=a)>0&&t+a+s<=o)return{headerLength:a,frameLength:s,stamp:i+r*n}}(t,i,r,n,g(e.samplerate));if(a){var s=a.stamp,o=a.headerLength,u=a.frameLength,l={unit:t.subarray(i+o,i+o+u),pts:s,dts:s};return e.samples.push(l),{sample:l,length:u+o}}}var v=i(4),y=function(){function e(e,t,i){this.observer=e,this.config=i,this.remuxer=t}var t=e.prototype;return t.resetInitSegment=function(e,t,i,r){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:t,duration:r,inputTimeScale:9e4}},t.resetTimeStamp=function(){},e.probe=function(e){if(!e)return!1;for(var t=(v.a.getID3Data(e,0)||[]).length,i=e.length;t<i;t++)if(f(e,t))return o.b.log("ADTS sync word found !"),!0;return!1},t.append=function(e,t,i,r){for(var n=this._audioTrack,a=v.a.getID3Data(e,0)||[],u=v.a.getTimeStamp(a),l=Object(s.a)(u)?90*u:9e4*t,c=0,d=l,f=e.length,g=a.length,y=[{pts:d,dts:d,data:a}];g<f-1;)if(h(e,g)&&g+5<f){p(n,this.observer,e,g,n.manifestCodec);var _=m(n,e,g,l,c);if(!_){o.b.log("Unable to parse AAC frame");break}g+=_.length,d=_.sample.pts,c++}else v.a.isHeader(e,g)?(a=v.a.getID3Data(e,g),y.push({pts:d,dts:d,data:a}),g+=a.length):g++;this.remuxer.remux(n,{samples:[]},{samples:y,inputTimeScale:9e4},{samples:[]},t,i,r)},t.destroy=function(){},e}(),_=i(10),b={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(e,t,i,r,n){if(!(i+24>t.length)){var a=this.parseHeader(t,i);if(a&&i+a.frameLength<=t.length){var s=r+n*(9e4*a.samplesPerFrame/a.sampleRate),o={unit:t.subarray(i,i+a.frameLength),pts:s,dts:s};return e.config=[],e.channelCount=a.channelCount,e.samplerate=a.sampleRate,e.samples.push(o),{sample:o,length:a.frameLength}}}},parseHeader:function(e,t){var i=e[t+1]>>3&3,r=e[t+1]>>1&3,n=e[t+2]>>4&15,a=e[t+2]>>2&3;if(1!==i&&0!==n&&15!==n&&3!==a){var s=b.SamplingRateMap[3*(3===i?0:2===i?1:2)+a],o=b.SamplesCoefficients[i][r],u=b.BytesInSlot[r],l=8*o*u;return{sampleRate:s,channelCount:e[t+3]>>6==3?1:2,frameLength:parseInt(o*(1e3*b.BitratesMap[14*(3===i?3-r:3===r?3:4)+n-1])/s+(e[t+2]>>1&1),10)*u,samplesPerFrame:l}}},isHeaderPattern:function(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var i=this.parseHeader(e,t),r=4;i&&i.frameLength&&(r=i.frameLength);var n=t+r;if(n===e.length||n+1<e.length&&this.isHeaderPattern(e,n))return!0}return!1}},T=b,S=function(){function e(e){this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}var t=e.prototype;return t.loadWord=function(){var e=this.data,t=this.bytesAvailable,i=e.byteLength-t,r=new Uint8Array(4),n=Math.min(4,t);if(0===n)throw new Error("no bytes available");r.set(e.subarray(i,i+n)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=8*n,this.bytesAvailable-=n},t.skipBits=function(e){var t;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,e-=(t=e>>3)>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)},t.readBits=function(e){var t=Math.min(this.bitsAvailable,e),i=this.word>>>32-t;return e>32&&o.b.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),(t=e-t)>0&&this.bitsAvailable?i<<t|this.readBits(t):i},t.skipLZ=function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},t.skipUEG=function(){this.skipBits(1+this.skipLZ())},t.skipEG=function(){this.skipBits(1+this.skipLZ())},t.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},t.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},t.readBoolean=function(){return 1===this.readBits(1)},t.readUByte=function(){return this.readBits(8)},t.readUShort=function(){return this.readBits(16)},t.readUInt=function(){return this.readBits(32)},t.skipScalingList=function(e){var t,i=8,r=8;for(t=0;t<e;t++)0!==r&&(r=(i+this.readEG()+256)%256),i=0===r?i:r},t.readSPS=function(){var e,t,i,r,n,a,s,o=0,u=0,l=0,c=0,d=this.readUByte.bind(this),h=this.readBits.bind(this),f=this.readUEG.bind(this),p=this.readBoolean.bind(this),g=this.skipBits.bind(this),m=this.skipEG.bind(this),v=this.skipUEG.bind(this),y=this.skipScalingList.bind(this);if(d(),e=d(),h(5),g(3),d(),v(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var _=f();if(3===_&&g(1),v(),v(),g(1),p())for(a=3!==_?8:12,s=0;s<a;s++)p()&&y(s<6?16:64)}v();var b=f();if(0===b)f();else if(1===b)for(g(1),m(),m(),t=f(),s=0;s<t;s++)m();v(),g(1),i=f(),r=f(),0===(n=h(1))&&g(1),g(1),p()&&(o=f(),u=f(),l=f(),c=f());var T=[1,1];if(p()&&p())switch(d()){case 1:T=[1,1];break;case 2:T=[12,11];break;case 3:T=[10,11];break;case 4:T=[16,11];break;case 5:T=[40,33];break;case 6:T=[24,11];break;case 7:T=[20,11];break;case 8:T=[32,11];break;case 9:T=[80,33];break;case 10:T=[18,11];break;case 11:T=[15,11];break;case 12:T=[64,33];break;case 13:T=[160,99];break;case 14:T=[4,3];break;case 15:T=[3,2];break;case 16:T=[2,1];break;case 255:T=[d()<<8|d(),d()<<8|d()]}return{width:Math.ceil(16*(i+1)-2*o-2*u),height:(2-n)*(r+1)*16-(n?2:4)*(l+c),pixelRatio:T}},t.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},e}(),E=function(){function e(e,t,i,r){this.decryptdata=i,this.discardEPB=r,this.decrypter=new a.a(e,t,{removePKCS7Padding:!1})}var t=e.prototype;return t.decryptBuffer=function(e,t){this.decrypter.decrypt(e,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,t)},t.decryptAacSample=function(e,t,i,r){var n=e[t].unit,a=n.subarray(16,n.length-n.length%16),s=a.buffer.slice(a.byteOffset,a.byteOffset+a.length),o=this;this.decryptBuffer(s,(function(a){a=new Uint8Array(a),n.set(a,16),r||o.decryptAacSamples(e,t+1,i)}))},t.decryptAacSamples=function(e,t,i){for(;;t++){if(t>=e.length)return void i();if(!(e[t].unit.length<32)){var r=this.decrypter.isSync();if(this.decryptAacSample(e,t,i,r),!r)return}}},t.getAvcEncryptedData=function(e){for(var t=16*Math.floor((e.length-48)/160)+16,i=new Int8Array(t),r=0,n=32;n<=e.length-16;n+=160,r+=16)i.set(e.subarray(n,n+16),r);return i},t.getAvcDecryptedUnit=function(e,t){t=new Uint8Array(t);for(var i=0,r=32;r<=e.length-16;r+=160,i+=16)e.set(t.subarray(i,i+16),r);return e},t.decryptAvcSample=function(e,t,i,r,n,a){var s=this.discardEPB(n.data),o=this.getAvcEncryptedData(s),u=this;this.decryptBuffer(o.buffer,(function(o){n.data=u.getAvcDecryptedUnit(s,o),a||u.decryptAvcSamples(e,t,i+1,r)}))},t.decryptAvcSamples=function(e,t,i,r){for(;;t++,i=0){if(t>=e.length)return void r();for(var n=e[t].units;!(i>=n.length);i++){var a=n[i];if(!(a.data.length<=48||1!==a.type&&5!==a.type)){var s=this.decrypter.isSync();if(this.decryptAvcSample(e,t,i,r,a,s),!s)return}}}},e}(),k={video:1,audio:2,id3:3,text:4},w=function(){function e(e,t,i,r){this.observer=e,this.config=i,this.typeSupported=r,this.remuxer=t,this.sampleAes=null,this.pmtUnknownTypes={}}var t=e.prototype;return t.setDecryptData=function(e){this.sampleAes=null!=e&&null!=e.key&&"SAMPLE-AES"===e.method?new E(this.observer,this.config,e,this.discardEPB):null},e.probe=function(t){var i=e._syncOffset(t);return!(i<0||(i&&o.b.warn("MPEG2-TS detected but first sync word found @ offset "+i+", junk ahead ?"),0))},e._syncOffset=function(e){for(var t=Math.min(1e3,e.length-564),i=0;i<t;){if(71===e[i]&&71===e[i+188]&&71===e[i+376])return i;i++}return-1},e.createTrack=function(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:k[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:"video"===e?0:void 0,isAAC:"audio"===e||void 0,duration:"audio"===e?t:void 0}},t.resetInitSegment=function(t,i,r,n){this.pmtParsed=!1,this._pmtId=-1,this.pmtUnknownTypes={},this._avcTrack=e.createTrack("video",n),this._audioTrack=e.createTrack("audio",n),this._id3Track=e.createTrack("id3",n),this._txtTrack=e.createTrack("text",n),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=i,this.videoCodec=r,this._duration=n},t.resetTimeStamp=function(){},t.append=function(t,i,a,s){var u,l,c,d,h,f=t.length,p=!1;this.pmtUnknownTypes={},this.contiguous=a;var g=this.pmtParsed,m=this._avcTrack,v=this._audioTrack,y=this._id3Track,_=m.pid,b=v.pid,T=y.pid,S=this._pmtId,E=m.pesData,k=v.pesData,w=y.pesData,C=this._parsePAT,A=this._parsePMT.bind(this),L=this._parsePES,I=this._parseAVCPES.bind(this),R=this._parseAACPES.bind(this),D=this._parseMPEGPES.bind(this),O=this._parseID3PES.bind(this),x=e._syncOffset(t);for(f-=(f+x)%188,u=x;u<f;u+=188)if(71===t[u]){if(l=!!(64&t[u+1]),c=((31&t[u+1])<<8)+t[u+2],(48&t[u+3])>>4>1){if((d=u+5+t[u+4])===u+188)continue}else d=u+4;switch(c){case _:l&&(E&&(h=L(E))&&I(h,!1),E={data:[],size:0}),E&&(E.data.push(t.subarray(d,u+188)),E.size+=u+188-d);break;case b:l&&(k&&(h=L(k))&&(v.isAAC?R(h):D(h)),k={data:[],size:0}),k&&(k.data.push(t.subarray(d,u+188)),k.size+=u+188-d);break;case T:l&&(w&&(h=L(w))&&O(h),w={data:[],size:0}),w&&(w.data.push(t.subarray(d,u+188)),w.size+=u+188-d);break;case 0:l&&(d+=t[d]+1),S=this._pmtId=C(t,d);break;case S:l&&(d+=t[d]+1);var P=A(t,d,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);(_=P.avc)>0&&(m.pid=_),(b=P.audio)>0&&(v.pid=b,v.isAAC=P.isAAC),(T=P.id3)>0&&(y.pid=T),p&&!g&&(o.b.log("reparse from beginning"),p=!1,u=x-188),g=this.pmtParsed=!0;break;case 17:case 8191:break;default:p=!0}}else this.observer.trigger(r.a.ERROR,{type:n.b.MEDIA_ERROR,details:n.a.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});E&&(h=L(E))?(I(h,!0),m.pesData=null):m.pesData=E,k&&(h=L(k))?(v.isAAC?R(h):D(h),v.pesData=null):(k&&k.size&&o.b.log("last AAC PES packet truncated,might overlap between fragments"),v.pesData=k),w&&(h=L(w))?(O(h),y.pesData=null):y.pesData=w,null==this.sampleAes?this.remuxer.remux(v,m,y,this._txtTrack,i,a,s):this.decryptAndRemux(v,m,y,this._txtTrack,i,a,s)},t.decryptAndRemux=function(e,t,i,r,n,a,s){if(e.samples&&e.isAAC){var o=this;this.sampleAes.decryptAacSamples(e.samples,0,(function(){o.decryptAndRemuxAvc(e,t,i,r,n,a,s)}))}else this.decryptAndRemuxAvc(e,t,i,r,n,a,s)},t.decryptAndRemuxAvc=function(e,t,i,r,n,a,s){if(t.samples){var o=this;this.sampleAes.decryptAvcSamples(t.samples,0,0,(function(){o.remuxer.remux(e,t,i,r,n,a,s)}))}else this.remuxer.remux(e,t,i,r,n,a,s)},t.destroy=function(){this._initPTS=this._initDTS=void 0,this._duration=0},t._parsePAT=function(e,t){return(31&e[t+10])<<8|e[t+11]},t._trackUnknownPmt=function(e,t,i){var r=this.pmtUnknownTypes[e]||0;return 0===r&&(this.pmtUnknownTypes[e]=0,t.call(o.b,i)),this.pmtUnknownTypes[e]++,r},t._parsePMT=function(e,t,i,r){var n,a,s={audio:-1,avc:-1,id3:-1,isAAC:!0};for(n=t+3+((15&e[t+1])<<8|e[t+2])-4,t+=12+((15&e[t+10])<<8|e[t+11]);t<n;){switch(a=(31&e[t+1])<<8|e[t+2],e[t]){case 207:if(!r){this._trackUnknownPmt(e[t],o.b.warn,"ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:-1===s.audio&&(s.audio=a);break;case 21:-1===s.id3&&(s.id3=a);break;case 219:if(!r){this._trackUnknownPmt(e[t],o.b.warn,"H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:-1===s.avc&&(s.avc=a);break;case 3:case 4:i?-1===s.audio&&(s.audio=a,s.isAAC=!1):this._trackUnknownPmt(e[t],o.b.warn,"MPEG audio found, not supported in this browser");break;case 36:this._trackUnknownPmt(e[t],o.b.warn,"Unsupported HEVC stream type found");break;default:this._trackUnknownPmt(e[t],o.b.log,"Unknown stream type:"+e[t])}t+=5+((15&e[t+3])<<8|e[t+4])}return s},t._parsePES=function(e){var t,i,r,n,a,s,u,l,c=0,d=e.data;if(!e||0===e.size)return null;for(;d[0].length<19&&d.length>1;){var h=new Uint8Array(d[0].length+d[1].length);h.set(d[0]),h.set(d[1],d[0].length),d[0]=h,d.splice(1,1)}if(1===((t=d[0])[0]<<16)+(t[1]<<8)+t[2]){if((r=(t[4]<<8)+t[5])&&r>e.size-6)return null;if(192&(i=t[7])&&(s=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,64&i?s-(u=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)>54e5&&(o.b.warn(Math.round((s-u)/9e4)+"s delta between PTS and DTS, align them"),s=u):u=s),l=(n=t[8])+9,e.size<=l)return null;e.size-=l,a=new Uint8Array(e.size);for(var f=0,p=d.length;f<p;f++){var g=(t=d[f]).byteLength;if(l){if(l>g){l-=g;continue}t=t.subarray(l),g-=l,l=0}a.set(t,c),c+=g}return r&&(r-=n+3),{data:a,pts:s,dts:u,len:r}}return null},t.pushAccesUnit=function(e,t){if(e.units.length&&e.frame){var i=t.samples,r=i.length;if(isNaN(e.pts)){if(!r)return void t.dropped++;var n=i[r-1];e.pts=n.pts,e.dts=n.dts}!this.config.forceKeyFrameOnDiscontinuity||!0===e.key||t.sps&&(r||this.contiguous)?(e.id=r,i.push(e)):t.dropped++}e.debug.length&&o.b.log(e.pts+"/"+e.dts+":"+e.debug)},t._parseAVCPES=function(e,t){var i,r,n,a=this,s=this._avcTrack,o=this._parseAVCNALu(e.data),u=this.avcSample,l=!1,c=this.pushAccesUnit.bind(this),d=function(e,t,i,r){return{key:e,pts:t,dts:i,units:[],debug:r}};e.data=null,u&&o.length&&!s.audFound&&(c(u,s),u=this.avcSample=d(!1,e.pts,e.dts,"")),o.forEach((function(t){switch(t.type){case 1:r=!0,u||(u=a.avcSample=d(!0,e.pts,e.dts,"")),u.frame=!0;var o=t.data;if(l&&o.length>4){var h=new S(o).readSliceType();2!==h&&4!==h&&7!==h&&9!==h||(u.key=!0)}break;case 5:r=!0,u||(u=a.avcSample=d(!0,e.pts,e.dts,"")),u.key=!0,u.frame=!0;break;case 6:r=!0,(i=new S(a.discardEPB(t.data))).readUByte();for(var f=0,p=0,g=!1,m=0;!g&&i.bytesAvailable>1;){f=0;do{f+=m=i.readUByte()}while(255===m);p=0;do{p+=m=i.readUByte()}while(255===m);if(4===f&&0!==i.bytesAvailable){if(g=!0,181===i.readUByte()&&49===i.readUShort()&&1195456820===i.readUInt()&&3===i.readUByte()){var y=i.readUByte(),_=31&y,b=[y,i.readUByte()];for(n=0;n<_;n++)b.push(i.readUByte()),b.push(i.readUByte()),b.push(i.readUByte());a._insertSampleInOrder(a._txtTrack.samples,{type:3,pts:e.pts,bytes:b})}}else if(5===f&&0!==i.bytesAvailable){if(g=!0,p>16){var T=[];for(n=0;n<16;n++)T.push(i.readUByte().toString(16)),3!==n&&5!==n&&7!==n&&9!==n||T.push("-");var E=p-16,k=new Uint8Array(E);for(n=0;n<E;n++)k[n]=i.readUByte();a._insertSampleInOrder(a._txtTrack.samples,{pts:e.pts,payloadType:f,uuid:T.join(""),userDataBytes:k,userData:Object(v.b)(k.buffer)})}}else if(p<i.bytesAvailable)for(n=0;n<p;n++)i.readUByte()}break;case 7:if(r=!0,l=!0,!s.sps){var w=(i=new S(t.data)).readSPS();s.width=w.width,s.height=w.height,s.pixelRatio=w.pixelRatio,s.sps=[t.data],s.duration=a._duration;var C=t.data.subarray(1,4),A="avc1.";for(n=0;n<3;n++){var L=C[n].toString(16);L.length<2&&(L="0"+L),A+=L}s.codec=A}break;case 8:r=!0,s.pps||(s.pps=[t.data]);break;case 9:r=!1,s.audFound=!0,u&&c(u,s),u=a.avcSample=d(!1,e.pts,e.dts,"");break;case 12:r=!1;break;default:r=!1,u&&(u.debug+="unknown NAL "+t.type+" ")}u&&r&&u.units.push(t)})),t&&u&&(c(u,s),this.avcSample=null)},t._insertSampleInOrder=function(e,t){var i=e.length;if(i>0){if(t.pts>=e[i-1].pts)e.push(t);else for(var r=i-1;r>=0;r--)if(t.pts<e[r].pts){e.splice(r,0,t);break}}else e.push(t)},t._getLastNalUnit=function(){var e,t=this.avcSample;if(!t||0===t.units.length){var i=this._avcTrack.samples;t=i[i.length-1]}if(t){var r=t.units;e=r[r.length-1]}return e},t._parseAVCNALu=function(e){var t,i,r,n,a=0,s=e.byteLength,o=this._avcTrack,u=o.naluState||0,l=u,c=[],d=-1;for(-1===u&&(d=0,n=31&e[0],u=0,a=1);a<s;)if(t=e[a++],u)if(1!==u)if(t)if(1===t){if(d>=0)r={data:e.subarray(d,a-u-1),type:n},c.push(r);else{var h=this._getLastNalUnit();if(h&&(l&&a<=4-l&&h.state&&(h.data=h.data.subarray(0,h.data.byteLength-l)),(i=a-u-1)>0)){var f=new Uint8Array(h.data.byteLength+i);f.set(h.data,0),f.set(e.subarray(0,i),h.data.byteLength),h.data=f}}a<s?(d=a,n=31&e[a],u=0):u=-1}else u=0;else u=3;else u=t?0:2;else u=t?0:1;if(d>=0&&u>=0&&(r={data:e.subarray(d,s),type:n,state:u},c.push(r)),0===c.length){var p=this._getLastNalUnit();if(p){var g=new Uint8Array(p.data.byteLength+e.byteLength);g.set(p.data,0),g.set(e,p.data.byteLength),p.data=g}}return o.naluState=u,c},t.discardEPB=function(e){for(var t,i,r=e.byteLength,n=[],a=1;a<r-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(n.push(a+2),a+=2):a++;if(0===n.length)return e;t=r-n.length,i=new Uint8Array(t);var s=0;for(a=0;a<t;s++,a++)s===n[0]&&(s++,n.shift()),i[a]=e[s];return i},t._parseAACPES=function(e){var t,i,a,s,u,l,c,d=this._audioTrack,f=e.data,v=e.pts,y=this.aacOverFlow,_=this.aacLastPTS;if(y){var b=new Uint8Array(y.byteLength+f.byteLength);b.set(y,0),b.set(f,y.byteLength),f=b}for(a=0,u=f.length;a<u-1&&!h(f,a);a++);if(!a||(a<u-1?(l="AAC PES did not start with ADTS header,offset:"+a,c=!1):(l="no ADTS header found in AAC PES",c=!0),o.b.warn("parsing error:"+l),this.observer.trigger(r.a.ERROR,{type:n.b.MEDIA_ERROR,details:n.a.FRAG_PARSING_ERROR,fatal:c,reason:l}),!c)){if(p(d,this.observer,f,a,this.audioCodec),i=0,t=g(d.samplerate),y&&_){var T=_+t;Math.abs(T-v)>1&&(o.b.log("AAC: align PTS for overlapping frames by "+Math.round((T-v)/90)),v=T)}for(;a<u;){if(h(f,a)){if(a+5<u){var S=m(d,f,a,v,i);if(S){a+=S.length,s=S.sample.pts,i++;continue}}break}a++}y=a<u?f.subarray(a,u):null,this.aacOverFlow=y,this.aacLastPTS=s}},t._parseMPEGPES=function(e){for(var t=e.data,i=t.length,r=0,n=0,a=e.pts;n<i;)if(T.isHeader(t,n)){var s=T.appendFrame(this._audioTrack,t,n,a,r);if(!s)break;n+=s.length,r++}else n++},t._parseID3PES=function(e){this._id3Track.samples.push(e)},e}(),C=function(){function e(e,t,i){this.observer=e,this.config=i,this.remuxer=t}var t=e.prototype;return t.resetInitSegment=function(e,t,i,r){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:t,duration:r,inputTimeScale:9e4}},t.resetTimeStamp=function(){},e.probe=function(e){var t,i,r=v.a.getID3Data(e,0);if(r&&void 0!==v.a.getTimeStamp(r))for(t=r.length,i=Math.min(e.length-1,t+100);t<i;t++)if(T.probe(e,t))return o.b.log("MPEG Audio sync word found !"),!0;return!1},t.append=function(e,t,i,r){for(var n=v.a.getID3Data(e,0)||[],a=v.a.getTimeStamp(n),s=void 0!==a?90*a:9e4*t,o=n.length,u=e.length,l=0,c=0,d=this._audioTrack,h=[{pts:s,dts:s,data:n}];o<u;)if(T.isHeader(e,o)){var f=T.appendFrame(d,e,o,s,l);if(!f)break;o+=f.length,c=f.sample.pts,l++}else v.a.isHeader(e,o)?(n=v.a.getID3Data(e,o),h.push({pts:c,dts:c,data:n}),o+=n.length):o++;this.remuxer.remux(d,{samples:[]},{samples:h,inputTimeScale:9e4},{samples:[]},t,i,r)},t.destroy=function(){},e}(),A=function(){function e(){}return e.getSilentFrame=function(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},e}(),L=Math.pow(2,32)-1,I=function(){function e(){}return e.init=function(){var t;for(t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]})e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var i=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:i,audio:r};var n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=a,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var s=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),u=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,s,u,s,o),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,n))},e.box=function(e){for(var t,i=Array.prototype.slice.call(arguments,1),r=8,n=i.length,a=n;n--;)r+=i[n].byteLength;for((t=new Uint8Array(r))[0]=r>>24&255,t[1]=r>>16&255,t[2]=r>>8&255,t[3]=255&r,t.set(e,4),n=0,r=8;n<a;n++)t.set(i[n],r),r+=i[n].byteLength;return t},e.hdlr=function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])},e.mdat=function(t){return e.box(e.types.mdat,t)},e.mdhd=function(t,i){i*=t;var r=Math.floor(i/(L+1)),n=Math.floor(i%(L+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r,n>>24,n>>16&255,n>>8&255,255&n,85,196,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))},e.mfhd=function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))},e.minf=function(t){return e.box(e.types.minf,"audio"===t.type?e.box(e.types.smhd,e.SMHD):e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))},e.moof=function(t,i,r){return e.box(e.types.moof,e.mfhd(t),e.traf(r,i))},e.moov=function(t){for(var i=t.length,r=[];i--;)r[i]=e.trak(t[i]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(r).concat(e.mvex(t)))},e.mvex=function(t){for(var i=t.length,r=[];i--;)r[i]=e.trex(t[i]);return e.box.apply(null,[e.types.mvex].concat(r))},e.mvhd=function(t,i){i*=t;var r=Math.floor(i/(L+1)),n=Math.floor(i%(L+1)),a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r,n>>24,n>>16&255,n>>8&255,255&n,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,a)},e.sdtp=function(t){var i,r,n=t.samples||[],a=new Uint8Array(4+n.length);for(r=0;r<n.length;r++)a[r+4]=(i=n[r].flags).dependsOn<<4|i.isDependedOn<<2|i.hasRedundancy;return e.box(e.types.sdtp,a)},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))},e.avc1=function(t){var i,r,n,a=[],s=[];for(i=0;i<t.sps.length;i++)n=(r=t.sps[i]).byteLength,a.push(n>>>8&255),a.push(255&n),a=a.concat(Array.prototype.slice.call(r));for(i=0;i<t.pps.length;i++)n=(r=t.pps[i]).byteLength,s.push(n>>>8&255),s.push(255&n),s=s.concat(Array.prototype.slice.call(r));var o=e.box(e.types.avcC,new Uint8Array([1,a[3],a[4],a[5],255,224|t.sps.length].concat(a).concat([t.pps.length]).concat(s))),u=t.width,l=t.height,c=t.pixelRatio[0],d=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,u>>8&255,255&u,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,255&c,d>>24,d>>16&255,d>>8&255,255&d])))},e.esds=function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))},e.mp4a=function(t){var i=t.samplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,i>>8&255,255&i,0,0]),e.box(e.types.esds,e.esds(t)))},e.mp3=function(t){var i=t.samplerate;return e.box(e.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,i>>8&255,255&i,0,0]))},e.stsd=function(t){return e.box(e.types.stsd,e.STSD,"audio"===t.type?t.isAAC||"mp3"!==t.codec?e.mp4a(t):e.mp3(t):e.avc1(t))},e.tkhd=function(t){var i=t.id,r=t.duration*t.timescale,n=t.width,a=t.height,s=Math.floor(r/(L+1)),o=Math.floor(r%(L+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,i>>24&255,i>>16&255,i>>8&255,255&i,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,o>>24,o>>16&255,o>>8&255,255&o,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,255&n,0,0,a>>8&255,255&a,0,0]))},e.traf=function(t,i){var r=e.sdtp(t),n=t.id,a=Math.floor(i/(L+1)),s=Math.floor(i%(L+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,s>>24,s>>16&255,s>>8&255,255&s])),e.trun(t,r.length+16+20+8+16+8+8),r)},e.trak=function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.trex=function(t){var i=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},e.trun=function(t,i){var r,n,a,s,o,u,l=t.samples||[],c=l.length,d=12+16*c,h=new Uint8Array(d);for(h.set([0,0,15,1,c>>>24&255,c>>>16&255,c>>>8&255,255&c,(i+=8+d)>>>24&255,i>>>16&255,i>>>8&255,255&i],0),r=0;r<c;r++)a=(n=l[r]).duration,h.set([a>>>24&255,a>>>16&255,a>>>8&255,255&a,(s=n.size)>>>24&255,s>>>16&255,s>>>8&255,255&s,(o=n.flags).isLeading<<2|o.dependsOn,o.isDependedOn<<6|o.hasRedundancy<<4|o.paddingValue<<1|o.isNonSync,61440&o.degradPrio,15&o.degradPrio,(u=n.cts)>>>24&255,u>>>16&255,u>>>8&255,255&u],12+16*r);return e.box(e.types.trun,h)},e.initSegment=function(t){e.types||e.init();var i,r=e.moov(t);return(i=new Uint8Array(e.FTYP.byteLength+r.byteLength)).set(e.FTYP),i.set(r,e.FTYP.byteLength),i},e}();function R(e,t,i,r){void 0===i&&(i=1),void 0===r&&(r=!1);var n=e*t*i;return r?Math.round(n):n}function D(e,t){return void 0===t&&(t=!1),R(e,1e3,1/9e4,t)}function O(e,t){return void 0===t&&(t=1),R(e,9e4,1/t)}var x=O(10),P=O(.2),M=null;function N(e,t){var i;if(void 0===t)return e;for(i=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=i;return e}var U,F=function(){function e(e,t,i,r){if(this.observer=e,this.config=t,this.typeSupported=i,this.ISGenerated=!1,null===M){var n=navigator.userAgent.match(/Chrome\/(\d+)/i);M=n?parseInt(n[1]):0}}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(e){this._initPTS=this._initDTS=e},t.resetInitSegment=function(){this.ISGenerated=!1},t.getVideoStartPts=function(e){var t=!1,i=e.reduce((function(e,i){var r=i.pts-e;return r<-4294967296?(t=!0,N(e,i.pts)):r>0?e:i.pts}),e[0].pts);return t&&o.b.debug("PTS rollover detected"),i},t.remux=function(e,t,i,n,a,s,u){if(this.ISGenerated||this.generateIS(e,t,a),this.ISGenerated){var l=e.samples.length,c=t.samples.length,d=a,h=a;if(l&&c){var f=this.getVideoStartPts(t.samples),p=(N(e.samples[0].pts,f)-f)/t.inputTimeScale;d+=Math.max(0,p),h+=Math.max(0,-p)}if(l){e.timescale||(o.b.warn("regenerate InitSegment as audio detected"),this.generateIS(e,t,a));var g,m=this.remuxAudio(e,d,s,u);c&&(m&&(g=m.endPTS-m.startPTS),t.timescale||(o.b.warn("regenerate InitSegment as video detected"),this.generateIS(e,t,a)),this.remuxVideo(t,h,s,g))}else if(c){var v=this.remuxVideo(t,h,s,0,u);v&&e.codec&&this.remuxEmptyAudio(e,d,s,v)}}i.samples.length&&this.remuxID3(i,a),n.samples.length&&this.remuxText(n,a),this.observer.trigger(r.a.FRAG_PARSED)},t.generateIS=function(e,t,i){var a,s,u=this.observer,l=e.samples,c=t.samples,d=this.typeSupported,h="audio/mp4",f={},p={tracks:f},g=void 0===this._initPTS;if(g&&(a=s=1/0),e.config&&l.length&&(e.timescale=e.samplerate,o.b.log("audio sampling rate : "+e.samplerate),e.isAAC||(d.mpeg?(h="audio/mpeg",e.codec=""):d.mp3&&(e.codec="mp3")),f.audio={container:h,codec:e.codec,initSegment:!e.isAAC&&d.mpeg?new Uint8Array:I.initSegment([e]),metadata:{channelCount:e.channelCount}},g&&(a=s=l[0].pts-Math.round(e.inputTimeScale*i))),t.sps&&t.pps&&c.length){var m=t.inputTimeScale;if(t.timescale=m,f.video={container:"video/mp4",codec:t.codec,initSegment:I.initSegment([t]),metadata:{width:t.width,height:t.height}},g){var v=this.getVideoStartPts(c),y=Math.round(m*i);s=Math.min(s,N(c[0].dts,v)-y),a=Math.min(a,v-y),this.observer.trigger(r.a.INIT_PTS_FOUND,{initPTS:a})}}else g&&f.audio&&this.observer.trigger(r.a.INIT_PTS_FOUND,{initPTS:a});Object.keys(f).length?(u.trigger(r.a.FRAG_PARSING_INIT_SEGMENT,p),this.ISGenerated=!0,g&&(this._initPTS=a,this._initDTS=s)):u.trigger(r.a.ERROR,{type:n.b.MEDIA_ERROR,details:n.a.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},t.remuxVideo=function(e,t,i,a){var s,u,l,c,d,h=e.timescale,f=e.samples,p=[],g=f.length,m=this._initPTS,v=8,y=Number.POSITIVE_INFINITY,_=Number.NEGATIVE_INFINITY,b=0,T=!1,S=this.nextAvcDts;if(0!==g){i||(S=t*h-(f[0].pts-N(f[0].dts,f[0].pts)));for(var E=0;E<g;E++){var k=f[E];k.pts=N(k.pts-m,S),k.dts=N(k.dts-m,S),k.dts>k.pts&&(b=Math.max(Math.min(b,k.pts-k.dts),-1*P)),k.dts<f[E>0?E-1:E].dts&&(T=!0)}T&&f.sort((function(e,t){return e.dts-t.dts||e.pts-t.pts||e.id-t.id})),c=f[0].dts,d=f[g-1].dts;var w=Math.round((d-c)/(g-1));if(b<0){if(b<-2*w){o.b.warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+D(-w,!0)+" ms");for(var C=b,A=0;A<g;A++)f[A].dts=C=Math.max(C,f[A].pts-w),f[A].pts=Math.max(C,f[A].pts)}else{o.b.warn("PTS < DTS detected in video samples, shifting DTS by "+D(b,!0)+" ms to overcome this issue");for(var L=0;L<g;L++)f[L].dts=f[L].dts+b}c=f[0].dts,d=f[g-1].dts}if(i){var R=c-S,O=R>w;if(O||R<-1){o.b.warn(O?"AVC: "+D(R,!0)+" ms ("+R+"dts) hole between fragments detected, filling it":"AVC: "+D(-R,!0)+" ms ("+R+"dts) overlapping between fragments detected");var x=f[0].pts-R;f[0].dts=c=S,f[0].pts=x,o.b.log("Video: First PTS/DTS adjusted: "+D(x,!0)+"/"+D(c,!0)+", delta: "+D(R,!0)+" ms")}}M&&M<75&&(c=Math.max(0,c));for(var U=0,F=0,B=0;B<g;B++){for(var j=f[B],V=j.units,H=V.length,G=0,q=0;q<H;q++)G+=V[q].data.length;F+=G,U+=H,j.length=G,j.dts=Math.max(j.dts,c),j.pts=Math.max(j.pts,j.dts,0),y=Math.min(j.pts,y),_=Math.max(j.pts,_)}d=f[g-1].dts;var K=F+4*U+8;try{u=new Uint8Array(K)}catch(e){return void this.observer.trigger(r.a.ERROR,{type:n.b.MUX_ERROR,details:n.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:K,reason:"fail allocating video mdat "+K})}var W=new DataView(u.buffer);W.setUint32(0,K),u.set(I.types.mdat,4);for(var z=0;z<g;z++){for(var Y,X=f[z],Q=X.units,$=0,J=0,Z=Q.length;J<Z;J++){var ee=Q[J],te=ee.data,ie=ee.data.byteLength;W.setUint32(v,ie),u.set(te,v+=4),v+=ie,$+=4+ie}if(z<g-1)s=f[z+1].dts-X.dts;else{var re=this.config,ne=X.dts-f[z>0?z-1:z].dts;if(re.stretchShortVideoTrack){var ae=Math.floor(re.maxBufferHole*h),se=(a?y+a*h:this.nextAudioPts)-X.pts;se>ae?((s=se-ne)<0&&(s=ne),o.b.log("It is approximately "+D(se,!1)+" ms to the next segment; using duration "+D(s,!1)+" ms for the last video frame.")):s=ne}else s=ne}Y=Math.round(X.pts-X.dts),p.push({size:$,duration:s,cts:Y,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:X.key?2:1,isNonSync:X.key?0:1}})}this.nextAvcDts=d+s;var oe=e.dropped;if(e.nbNalu=0,e.dropped=0,p.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var ue=p[0].flags;ue.dependsOn=2,ue.isNonSync=0}e.samples=p,l=I.moof(e.sequenceNumber++,c,e),e.samples=[];var le={data1:l,data2:u,startPTS:y/h,endPTS:(_+s)/h,startDTS:c/h,endDTS:this.nextAvcDts/h,type:"video",hasAudio:!1,hasVideo:!0,nb:p.length,dropped:oe};return this.observer.trigger(r.a.FRAG_PARSING_DATA,le),le}},t.remuxAudio=function(e,t,i,a){var s,u,l,c,d,h,f=e.inputTimeScale,p=f/e.timescale,g=(e.isAAC?1024:1152)*p,m=this._initPTS,v=!e.isAAC&&this.typeSupported.mpeg,y=v?0:8,_=e.samples,b=[],T=this.nextAudioPts;if(i|=_.length&&T&&(a&&Math.abs(t-T/f)<.1||Math.abs(_[0].pts-T-m)<20*g),_.forEach((function(e){e.pts=e.dts=N(e.pts-m,t*f)})),0!==(_=_.filter((function(e){return e.pts>=0}))).length){if(i||(T=a?Math.max(0,t*f):_[0].pts),e.isAAC)for(var S=this.config.maxAudioFramesDrift,E=0,k=T;E<_.length;){var w=_[E],C=w.pts,L=C-k;if(L<=-S*g)i||E>0?(o.b.warn("Dropping 1 audio frame @ "+D(k,!0)/1e3+"s due to "+D(L,!0)+" ms overlap."),_.splice(E,1)):(o.b.warn("Audio frame @ "+D(C,!0)/1e3+"s overlaps nextAudioPts by "+D(L,!0)+" ms."),k=C+g,E++);else if(L>=S*g&&L<x&&k){var R=Math.round(L/g);o.b.warn("Injecting "+R+" audio frames @ "+D(k,!0)/1e3+"s due to "+D(L,!0)+" ms gap.");for(var O=0;O<R;O++){var P=Math.max(k,0);(u=A.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(o.b.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),u=w.unit.subarray()),_.splice(E,0,{unit:u,pts:P,dts:P}),k+=g,E++}w.pts=w.dts=k,k+=g,E++}else Math.abs(L),w.pts=w.dts=k,k+=g,E++}for(var M=_.length,U=0;M--;)U+=_[M].unit.byteLength;for(var F=0,B=_.length;F<B;F++){var j=_[F],V=j.unit,H=j.pts;if(void 0!==h&&s)s.duration=Math.round((H-h)/p);else{var G=H-T,q=0;if(i&&e.isAAC&&G){if(G>0&&G<x)q=Math.round((H-T)/g),o.b.log(D(G,!0)+" ms hole between AAC samples detected,filling it"),q>0&&((u=A.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(u=V.subarray()),U+=q*u.length);else if(G<-12){o.b.log("drop overlapping AAC sample, expected/parsed/delta: "+D(T,!0)+" ms / "+D(H,!0)+" ms / "+D(-G,!0)+" ms"),U-=V.byteLength;continue}H=T}if(d=H,!(U>0))return;U+=y;try{l=new Uint8Array(U)}catch(e){return void this.observer.trigger(r.a.ERROR,{type:n.b.MUX_ERROR,details:n.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:U,reason:"fail allocating audio mdat "+U})}v||(new DataView(l.buffer).setUint32(0,U),l.set(I.types.mdat,4));for(var K=0;K<q;K++)(u=A.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(o.b.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),u=V.subarray()),l.set(u,y),y+=u.byteLength,b.push(s={size:u.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}})}l.set(V,y);var W=V.byteLength;y+=W,b.push(s={size:W,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}}),h=H}var z=0;if((M=b.length)>=2&&(s.duration=z=b[M-2].duration),M){this.nextAudioPts=T=h+p*z,e.samples=b,c=v?new Uint8Array:I.moof(e.sequenceNumber++,d/p,e),e.samples=[];var Y=d/f,X=T/f,Q={data1:c,data2:l,startPTS:Y,endPTS:X,startDTS:Y,endDTS:X,type:"audio",hasAudio:!0,hasVideo:!1,nb:M};return this.observer.trigger(r.a.FRAG_PARSING_DATA,Q),Q}return null}},t.remuxEmptyAudio=function(e,t,i,r){var n=e.inputTimeScale,a=this.nextAudioPts,s=(void 0!==a?a:r.startDTS*n)+this._initDTS,u=n/(e.samplerate?e.samplerate:n)*1024,l=Math.ceil((r.endDTS*n+this._initDTS-s)/u),c=A.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(o.b.warn("remux empty Audio"),c){for(var d=[],h=0;h<l;h++){var f=s+h*u;d.push({unit:c,pts:f,dts:f})}e.samples=d,this.remuxAudio(e,t,i)}else o.b.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")},t.remuxID3=function(e,t){var i=e.samples.length;if(i){for(var n=e.inputTimeScale,a=this._initPTS,s=this._initDTS,o=0;o<i;o++){var u=e.samples[o];u.pts=N(u.pts-a,t*n)/n,u.dts=N(u.dts-s,t*n)/n}this.observer.trigger(r.a.FRAG_PARSING_METADATA,{samples:e.samples}),e.samples=[]}},t.remuxText=function(e,t){var i=e.samples.length,n=e.inputTimeScale,a=this._initPTS;if(i){for(var s=0;s<i;s++){var o=e.samples[s];o.pts=N(o.pts-a,t*n)/n}e.samples.sort((function(e,t){return e.pts-t.pts})),this.observer.trigger(r.a.FRAG_PARSING_USERDATA,{samples:e.samples})}e.samples=[]},e}(),B=function(){function e(e){this.observer=e}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(){},t.resetInitSegment=function(){},t.remux=function(e,t,i,n,a,s,o,u){var l=this.observer,c="";e&&(c+="audio"),t&&(c+="video"),l.trigger(r.a.FRAG_PARSING_DATA,{data1:u,startPTS:a,startDTS:a,type:c,hasAudio:!!e,hasVideo:!!t,nb:1,dropped:0}),l.trigger(r.a.FRAG_PARSED)},e}(),j=Object(u.a)();try{U=j.performance.now.bind(j.performance)}catch(e){o.b.debug("Unable to use Performance API on this environment"),U=j.Date.now}var V=function(){function e(e,t,i,r){this.observer=e,this.typeSupported=t,this.config=i,this.vendor=r}var t=e.prototype;return t.destroy=function(){var e=this.demuxer;e&&e.destroy()},t.push=function(e,t,i,n,s,o,u,l,c,d,h,f){var p=this;if(e.byteLength>0&&null!=t&&null!=t.key&&"AES-128"===t.method){var g=this.decrypter;null==g&&(g=this.decrypter=new a.a(this.observer,this.config));var m=U();g.decrypt(e,t.key.buffer,t.iv.buffer,(function(e){var a=U();p.observer.trigger(r.a.FRAG_DECRYPTED,{stats:{tstart:m,tdecrypt:a}}),p.pushDecrypted(new Uint8Array(e),t,new Uint8Array(i),n,s,o,u,l,c,d,h,f)}))}else this.pushDecrypted(new Uint8Array(e),t,new Uint8Array(i),n,s,o,u,l,c,d,h,f)},t.pushDecrypted=function(e,t,i,a,s,o,u,l,c,d,h,f){var p=this.demuxer,g=this.remuxer;if(!p||u||l){for(var m,v=this.observer,b=this.typeSupported,T=this.config,S=[{demux:w,remux:F},{demux:_.a,remux:B},{demux:y,remux:F},{demux:C,remux:F}],E=0,k=S.length;E<k&&!(m=S[E]).demux.probe(e);E++);if(!m)return void v.trigger(r.a.ERROR,{type:n.b.MEDIA_ERROR,details:n.a.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});g&&g instanceof m.remux||(g=new m.remux(v,T,b,this.vendor)),p&&p instanceof m.demux||(p=new m.demux(v,g,T,b),this.probe=m.demux.probe),this.demuxer=p,this.remuxer=g}(u||l)&&(p.resetInitSegment(i,a,s,d),g.resetInitSegment()),u&&(p.resetTimeStamp(f),g.resetTimeStamp(f)),"function"==typeof p.setDecryptData&&p.setDecryptData(t),p.append(e,o,c,h)},e}();t.a=V},function(e,t,i){"use strict";var r=i(0),n=i(1),a=Math.pow(2,32)-1,s=function(){function e(e,t){this.observer=e,this.remuxer=t}var t=e.prototype;return t.resetTimeStamp=function(e){this.initPTS=e},t.resetInitSegment=function(t,i,r,a){if(t&&t.byteLength){var s=this.initData=e.parseInitSegment(t);null==i&&(i="mp4a.40.5"),null==r&&(r="avc1.42e01e");var o={};s.audio&&s.video?o.audiovideo={container:"video/mp4",codec:i+","+r,initSegment:a?t:null}:(s.audio&&(o.audio={container:"audio/mp4",codec:i,initSegment:a?t:null}),s.video&&(o.video={container:"video/mp4",codec:r,initSegment:a?t:null})),this.observer.trigger(n.a.FRAG_PARSING_INIT_SEGMENT,{tracks:o})}else i&&(this.audioCodec=i),r&&(this.videoCodec=r)},e.probe=function(t){return e.findBox({data:t,start:0,end:Math.min(t.length,16384)},["moof"]).length>0},e.bin2str=function(e){return String.fromCharCode.apply(null,e)},e.readUint16=function(e,t){e.data&&(t+=e.start,e=e.data);var i=e[t]<<8|e[t+1];return i<0?65536+i:i},e.readUint32=function(e,t){e.data&&(t+=e.start,e=e.data);var i=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];return i<0?4294967296+i:i},e.writeUint32=function(e,t,i){e.data&&(t+=e.start,e=e.data),e[t]=i>>24,e[t+1]=i>>16&255,e[t+2]=i>>8&255,e[t+3]=255&i},e.findBox=function(t,i){var r,n,a,s,o,u,l=[];if(t.data?(o=t.start,a=t.end,t=t.data):(o=0,a=t.byteLength),!i.length)return null;for(r=o;r<a;)u=(n=e.readUint32(t,r))>1?r+n:a,e.bin2str(t.subarray(r+4,r+8))===i[0]&&(1===i.length?l.push({data:t,start:r+8,end:u}):(s=e.findBox({data:t,start:r+8,end:u},i.slice(1))).length&&(l=l.concat(s))),r=u;return l},e.parseSegmentIndex=function(t){var i,r=e.findBox(t,["moov"])[0],n=r?r.end:null,a=0,s=e.findBox(t,["sidx"]);if(!s||!s[0])return null;i=[];var o=(s=s[0]).data[0],u=e.readUint32(s,a=0===o?8:16);a+=4,a+=0===o?8:16;var l=s.end+0,c=e.readUint16(s,a+=2);a+=2;for(var d=0;d<c;d++){var h=a,f=e.readUint32(s,h);h+=4;var p=2147483647&f;if(1==(2147483648&f)>>>31)return void console.warn("SIDX has hierarchical references (not supported)");var g=e.readUint32(s,h);h+=4,i.push({referenceSize:p,subsegmentDuration:g,info:{duration:g/u,start:l,end:l+p-1}}),l+=p,a=h+=4}return{earliestPresentationTime:0,timescale:u,version:o,referencesCount:c,references:i,moovEndOffset:n}},e.parseInitSegment=function(t){var i=[];return e.findBox(t,["moov","trak"]).forEach((function(t){var n=e.findBox(t,["tkhd"])[0];if(n){var a=n.data[n.start],s=0===a?12:20,o=e.readUint32(n,s),u=e.findBox(t,["mdia","mdhd"])[0];if(u){s=0===(a=u.data[u.start])?12:20;var l=e.readUint32(u,s),c=e.findBox(t,["mdia","hdlr"])[0];if(c){var d={soun:"audio",vide:"video"}[e.bin2str(c.data.subarray(c.start+8,c.start+12))];if(d){var h=e.findBox(t,["mdia","minf","stbl","stsd"]);if(h.length){var f=e.bin2str((h=h[0]).data.subarray(h.start+12,h.start+16));r.b.log("MP4Demuxer:"+d+":"+f+" found")}i[o]={timescale:l,type:d},i[d]={timescale:l,id:o}}}}}})),i},e.getStartDTS=function(t,i){var r,n,a;return r=e.findBox(i,["moof","traf"]),n=[].concat.apply([],r.map((function(i){return e.findBox(i,["tfhd"]).map((function(r){var n,a;return n=e.readUint32(r,4),a=t[n].timescale||9e4,e.findBox(i,["tfdt"]).map((function(t){var i,r;return i=t.data[t.start],r=e.readUint32(t,4),1===i&&(r*=Math.pow(2,32),r+=e.readUint32(t,8)),r}))[0]/a}))}))),a=Math.min.apply(null,n),isFinite(a)?a:0},e.offsetStartDTS=function(t,i,r){e.findBox(i,["moof","traf"]).map((function(i){return e.findBox(i,["tfhd"]).map((function(n){var s=e.readUint32(n,4),o=t[s].timescale||9e4;e.findBox(i,["tfdt"]).map((function(t){var i=t.data[t.start],n=e.readUint32(t,4);if(0===i)e.writeUint32(t,4,n-r*o);else{n*=Math.pow(2,32),n+=e.readUint32(t,8),n-=r*o,n=Math.max(n,0);var s=Math.floor(n/(a+1)),u=Math.floor(n%(a+1));e.writeUint32(t,4,s),e.writeUint32(t,8,u)}}))}))}))},t.append=function(t,i,r,a){var s=this.initData;s||(this.resetInitSegment(t,this.audioCodec,this.videoCodec,!1),s=this.initData);var o,u=this.initPTS;if(void 0===u){var l=e.getStartDTS(s,t);this.initPTS=u=l-i,this.observer.trigger(n.a.INIT_PTS_FOUND,{initPTS:u})}e.offsetStartDTS(s,t,u),o=e.getStartDTS(s,t),this.remuxer.remux(s.audio,s.video,null,null,o,r,a,t)},t.destroy=function(){},e}();t.a=s},function(e,t,i){function r(e){var t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.i=function(e){return e},i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/",i.oe=function(e){throw console.error(e),e};var r=i(i.s=ENTRY_MODULE);return r.default||r}function n(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function a(e,t,r){var a={};a[r]=[];var s=t.toString(),o=s.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!o)return a;for(var u,l=o[1],c=new RegExp("(\\\\n|\\W)"+n(l)+"\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)","g");u=c.exec(s);)"dll-reference"!==u[3]&&a[r].push(u[3]);for(c=new RegExp("\\("+n(l)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)',"g");u=c.exec(s);)e[u[2]]||(a[r].push(u[1]),e[u[2]]=i(u[1]).m),a[u[2]]=a[u[2]]||[],a[u[2]].push(u[4]);for(var d=Object.keys(a),h=0;h<d.length;h++)for(var f=0;f<a[d[h]].length;f++)isNaN(1*a[d[h]][f])||(a[d[h]][f]=1*a[d[h]][f]);return a}function s(e){return Object.keys(e).reduce((function(t,i){return t||e[i].length>0}),!1)}e.exports=function(e,t){var n={main:i.m},o=(t=t||{}).all?{main:Object.keys(n.main)}:function(e,t){for(var i={main:[t]},r={main:[]},n={main:{}};s(i);)for(var o=Object.keys(i),u=0;u<o.length;u++){var l=o[u],c=i[l].pop();if(n[l]=n[l]||{},!n[l][c]&&e[l][c]){n[l][c]=!0,r[l]=r[l]||[],r[l].push(c);for(var d=a(e,e[l][c],l),h=Object.keys(d),f=0;f<h.length;f++)i[h[f]]=i[h[f]]||[],i[h[f]]=i[h[f]].concat(d[h[f]])}}return r}(n,e),u="";Object.keys(o).filter((function(e){return"main"!==e})).forEach((function(e){for(var t=0;o[e][t];)t++;o[e].push(t),n[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",u=u+"var "+e+" = ("+r.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+o[e].map((function(t){return JSON.stringify(t)+": "+n[e][t].toString()})).join(",")+"});\n"})),u=u+"new (("+r.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+o.main.map((function(e){return JSON.stringify(e)+": "+n.main[e].toString()})).join(",")+"}))(self);";var l=new window.Blob([u],{type:"text/javascript"});if(t.bare)return l;var c=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(l),d=new window.Worker(c);return d.objectURL=c,d}},function(e,t,i){"use strict";i.r(t);var r=i(9),n=i(1),a=i(0),s=i(8);t.default=function(e){var t=new s.EventEmitter;t.trigger=function(e){for(var i=arguments.length,r=new Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];t.emit.apply(t,[e,e].concat(r))},t.off=function(e){for(var i=arguments.length,r=new Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];t.removeListener.apply(t,[e].concat(r))};var i=function(t,i){e.postMessage({event:t,data:i})};e.addEventListener("message",(function(n){var s=n.data;switch(s.cmd){case"init":var o=JSON.parse(s.config);e.demuxer=new r.a(t,s.typeSupported,o,s.vendor),Object(a.a)(o.debug),i("init",null);break;case"demux":e.demuxer.push(s.data,s.decryptdata,s.initSegment,s.audioCodec,s.videoCodec,s.timeOffset,s.discontinuity,s.trackSwitch,s.contiguous,s.duration,s.accurateTimeOffset,s.defaultInitPTS)}})),t.on(n.a.FRAG_DECRYPTED,i),t.on(n.a.FRAG_PARSING_INIT_SEGMENT,i),t.on(n.a.FRAG_PARSED,i),t.on(n.a.ERROR,i),t.on(n.a.FRAG_PARSING_METADATA,i),t.on(n.a.FRAG_PARSING_USERDATA,i),t.on(n.a.INIT_PTS_FOUND,i),t.on(n.a.FRAG_PARSING_DATA,(function(t,i){var r=[],n={event:t,data:i};i.data1&&(n.data1=i.data1.buffer,r.push(i.data1.buffer),delete i.data1),i.data2&&(n.data2=i.data2.buffer,r.push(i.data2.buffer),delete i.data2),e.postMessage(n,r)}))}},function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return zt}));var r={};i.r(r),i.d(r,"newCue",(function(){return nt}));var n,a,s=i(6),o=i(2),u=i(3),l=i(1),c=i(0),d={hlsEventGeneric:!0,hlsHandlerDestroying:!0,hlsHandlerDestroyed:!0},h=function(){function e(e){this.hls=void 0,this.handledEvents=void 0,this.useGenericHandler=void 0,this.hls=e,this.onEvent=this.onEvent.bind(this);for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];this.handledEvents=i,this.useGenericHandler=!0,this.registerListeners()}var t=e.prototype;return t.destroy=function(){this.onHandlerDestroying(),this.unregisterListeners(),this.onHandlerDestroyed()},t.onHandlerDestroying=function(){},t.onHandlerDestroyed=function(){},t.isEventHandler=function(){return"object"==typeof this.handledEvents&&this.handledEvents.length&&"function"==typeof this.onEvent},t.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach((function(e){if(d[e])throw new Error("Forbidden event-name: "+e);this.hls.on(e,this.onEvent)}),this)},t.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach((function(e){this.hls.off(e,this.onEvent)}),this)},t.onEvent=function(e,t){this.onEventGeneric(e,t)},t.onEventGeneric=function(e,t){try{(function(e,t){var i="on"+e.replace("hls","");if("function"!=typeof this[i])throw new Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+i+")");return this[i].bind(this,t)}).call(this,e,t).call()}catch(t){c.b.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),this.hls.trigger(l.a.ERROR,{type:o.b.OTHER_ERROR,details:o.a.INTERNAL_EXCEPTION,fatal:!1,event:e,err:t})}},e}();!function(e){e.MANIFEST="manifest",e.LEVEL="level",e.AUDIO_TRACK="audioTrack",e.SUBTITLE_TRACK="subtitleTrack"}(n||(n={})),function(e){e.MAIN="main",e.AUDIO="audio",e.SUBTITLE="subtitle"}(a||(a={}));var f,p=i(10),g=function(){function e(e,t){this._uri=null,this.baseuri=void 0,this.reluri=void 0,this.method=null,this.key=null,this.iv=null,this.baseuri=e,this.reluri=t}var t;return(t=[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=Object(s.buildAbsoluteURL)(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}])&&function(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}();!function(e){e.AUDIO="audio",e.VIDEO="video"}(f||(f={}));var m=function(){function e(){var e;this._url=null,this._byteRange=null,this._decryptdata=null,this._elementaryStreams=((e={})[f.AUDIO]=!1,e[f.VIDEO]=!1,e),this.deltaPTS=0,this.rawProgramDateTime=null,this.programDateTime=null,this.title=null,this.tagList=[],this.cc=void 0,this.type=void 0,this.relurl=void 0,this.baseurl=void 0,this.duration=void 0,this.start=void 0,this.sn=0,this.urlId=0,this.level=0,this.levelkey=void 0,this.loader=void 0}var t,i=e.prototype;return i.setByteRange=function(e,t){var i=e.split("@",2),r=[];r[0]=1===i.length?t?t.byteRangeEndOffset:0:parseInt(i[1]),r[1]=parseInt(i[0])+r[0],this._byteRange=r},i.addElementaryStream=function(e){this._elementaryStreams[e]=!0},i.hasElementaryStream=function(e){return!0===this._elementaryStreams[e]},i.createInitializationVector=function(e){for(var t=new Uint8Array(16),i=12;i<16;i++)t[i]=e>>8*(15-i)&255;return t},i.setDecryptDataFromLevelKey=function(e,t){var i=e;return(null==e?void 0:e.method)&&e.uri&&!e.iv&&((i=new g(e.baseuri,e.reluri)).method=e.method,i.iv=this.createInitializationVector(t)),i},(t=[{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=Object(s.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(e){this._url=e}},{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var e=this.sn;"number"!=typeof e&&(this.levelkey&&"AES-128"===this.levelkey.method&&!this.levelkey.iv&&c.b.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),e=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,e)}return this._decryptdata}},{key:"endProgramDateTime",get:function(){if(null===this.programDateTime)return null;if(!Object(u.a)(this.programDateTime))return null;var e=Object(u.a)(this.duration)?this.duration:0;return this.programDateTime+1e3*e}},{key:"encrypted",get:function(){return!(!this.decryptdata||null===this.decryptdata.uri||null!==this.decryptdata.key)}}])&&function(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}(),v=function(){function e(e){this.endCC=0,this.endSN=0,this.fragments=[],this.initSegment=null,this.live=!0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=e,this.version=null}var t;return(t=[{key:"hasProgramDateTime",get:function(){return!(!this.fragments[0]||!Object(u.a)(this.fragments[0].programDateTime))}}])&&function(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}(),y=/^(\d+)x(\d+)$/,_=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,b=function(){function e(t){for(var i in"string"==typeof t&&(t=e.parseAttrList(t)),t)t.hasOwnProperty(i)&&(this[i]=t[i])}var t=e.prototype;return t.decimalInteger=function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.hexadecimalInteger=function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var i=new Uint8Array(t.length/2),r=0;r<t.length/2;r++)i[r]=parseInt(t.slice(2*r,2*r+2),16);return i}return null},t.hexadecimalIntegerAsNumber=function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.decimalFloatingPoint=function(e){return parseFloat(this[e])},t.enumeratedString=function(e){return this[e]},t.decimalResolution=function(e){var t=y.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},e.parseAttrList=function(e){var t,i={};for(_.lastIndex=0;null!==(t=_.exec(e));){var r=t[2];0===r.indexOf('"')&&r.lastIndexOf('"')===r.length-1&&(r=r.slice(1,-1)),i[t[1]]=r}return i},e}(),T={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}};function S(e,t){return MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+e+'"')}var E=/(?:#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)|#EXT-X-SESSION-DATA:([^\n\r]*)[\r\n]+)/g,k=/#EXT-X-MEDIA:(.*)/g,w=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)([\S+ ?]+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),C=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,A=/\.(mp4|m4s|m4v|m4a)$/i,L=function(){function e(){}return e.findGroup=function(e,t){for(var i=0;i<e.length;i++){var r=e[i];if(r.id===t)return r}},e.convertAVC1ToAVCOTI=function(e){var t,i=e.split(".");return i.length>2?(t=i.shift()+".",t+=parseInt(i.shift()).toString(16),t+=("000"+parseInt(i.shift()).toString(16)).substr(-4)):t=e,t},e.resolve=function(e,t){return s.buildAbsoluteURL(t,e,{alwaysNormalize:!0})},e.parseMasterPlaylist=function(t,i){var r,n=[],a={},s=!1;function o(e,t){["video","audio"].forEach((function(i){var r=e.filter((function(e){return function(e,t){var i=T[t];return!!i&&!0===i[e.slice(0,4)]}(e,i)}));if(r.length){var n=r.filter((function(e){return 0===e.lastIndexOf("avc1",0)||0===e.lastIndexOf("mp4a",0)}));t[i+"Codec"]=n.length>0?n[0]:r[0],e=e.filter((function(e){return-1===r.indexOf(e)}))}})),t.unknownCodecs=e}for(E.lastIndex=0;null!=(r=E.exec(t));)if(r[1]){var u={},l=u.attrs=new b(r[1]);u.url=e.resolve(r[2],i);var c=l.decimalResolution("RESOLUTION");c&&(u.width=c.width,u.height=c.height),u.bitrate=l.decimalInteger("AVERAGE-BANDWIDTH")||l.decimalInteger("BANDWIDTH"),u.name=l.NAME,o([].concat((l.CODECS||"").split(/[ ,]+/)),u),u.videoCodec&&-1!==u.videoCodec.indexOf("avc1")&&(u.videoCodec=e.convertAVC1ToAVCOTI(u.videoCodec)),n.push(u)}else if(r[3]){var d=new b(r[3]);d["DATA-ID"]&&(s=!0,a[d["DATA-ID"]]=d)}return{levels:n,sessionData:s?a:null}},e.parseMasterPlaylistMedia=function(t,i,r,n){var a;void 0===n&&(n=[]);var s=[],o=0;for(k.lastIndex=0;null!==(a=k.exec(t));){var u=new b(a[1]);if(u.TYPE===r){var l={attrs:u,id:o++,groupId:u["GROUP-ID"],instreamId:u["INSTREAM-ID"],name:u.NAME||u.LANGUAGE,type:r,default:"YES"===u.DEFAULT,autoselect:"YES"===u.AUTOSELECT,forced:"YES"===u.FORCED,lang:u.LANGUAGE};if(u.URI&&(l.url=e.resolve(u.URI,i)),n.length){var c=e.findGroup(n,l.groupId);l.audioCodec=c?c.codec:n[0].codec}s.push(l)}}return s},e.parseLevelPlaylist=function(e,t,i,r,n){var a,s,o,l=0,d=0,h=new v(t),f=0,p=null,y=new m,_=null;for(w.lastIndex=0;null!==(a=w.exec(e));){var T=a[1];if(T){y.duration=parseFloat(T);var S=(" "+a[2]).slice(1);y.title=S||null,y.tagList.push(S?["INF",T,S]:["INF",T])}else if(a[3]){if(Object(u.a)(y.duration)){var E=l++;y.type=r,y.start=d,o&&(y.levelkey=o),y.sn=E,y.level=i,y.cc=f,y.urlId=n,y.baseurl=t,y.relurl=(" "+a[3]).slice(1),I(y,p),h.fragments.push(y),p=y,d+=y.duration,y=new m}}else if(a[4]){var k=(" "+a[4]).slice(1);p?y.setByteRange(k,p):y.setByteRange(k)}else if(a[5])y.rawProgramDateTime=(" "+a[5]).slice(1),y.tagList.push(["PROGRAM-DATE-TIME",y.rawProgramDateTime]),null===_&&(_=h.fragments.length);else{if(!(a=a[0].match(C))){c.b.warn("No matches on slow regex match for level playlist!");continue}for(s=1;s<a.length&&void 0===a[s];s++);var L=(" "+a[s+1]).slice(1),R=(" "+a[s+2]).slice(1);switch(a[s]){case"#":y.tagList.push(R?[L,R]:[L]);break;case"PLAYLIST-TYPE":h.type=L.toUpperCase();break;case"MEDIA-SEQUENCE":l=h.startSN=parseInt(L);break;case"TARGETDURATION":h.targetduration=parseFloat(L);break;case"VERSION":h.version=parseInt(L);break;case"EXTM3U":break;case"ENDLIST":h.live=!1;break;case"DIS":f++,y.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":f=parseInt(L);break;case"KEY":var D=new b(L),O=D.enumeratedString("METHOD"),x=D.URI,P=D.hexadecimalInteger("IV");if("com.apple.streamingkeydelivery"===(D.KEYFORMAT||"identity")){c.b.warn("Keyformat com.apple.streamingkeydelivery is not supported");continue}O&&(o=new g(t,x),x&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(O)>=0&&(o.method=O,o.key=null,o.iv=P));break;case"START":var M=new b(L).decimalFloatingPoint("TIME-OFFSET");Object(u.a)(M)&&(h.startTimeOffset=M);break;case"MAP":var N=new b(L);y.relurl=N.URI,N.BYTERANGE&&y.setByteRange(N.BYTERANGE),y.baseurl=t,y.level=i,y.type=r,y.sn="initSegment",h.initSegment=y,(y=new m).rawProgramDateTime=h.initSegment.rawProgramDateTime;break;default:c.b.warn("line parsed but not handled: "+a)}}}return(y=p)&&!y.relurl&&(h.fragments.pop(),d-=y.duration),h.totalduration=d,h.averagetargetduration=d/h.fragments.length,h.endSN=l-1,h.startCC=h.fragments[0]?h.fragments[0].cc:0,h.endCC=f,!h.initSegment&&h.fragments.length&&h.fragments.every((function(e){return A.test(e.relurl)}))&&(c.b.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(y=new m).relurl=h.fragments[0].relurl,y.baseurl=t,y.level=i,y.type=r,y.sn="initSegment",h.initSegment=y,h.needSidxRanges=!0),_&&function(e,t){for(var i=e[t],r=t-1;r>=0;r--){var n=e[r];n.programDateTime=i.programDateTime-1e3*n.duration,i=n}}(h.fragments,_),h},e}();function I(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):(null==t?void 0:t.programDateTime)&&(e.programDateTime=t.endProgramDateTime),Object(u.a)(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}var R=window.performance,D=function(e){var t,i;function r(t){var i;return(i=e.call(this,t,l.a.MANIFEST_LOADING,l.a.LEVEL_LOADING,l.a.AUDIO_TRACK_LOADING,l.a.SUBTITLE_TRACK_LOADING)||this).loaders={},i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i,r.canHaveQualityLevels=function(e){return e!==n.AUDIO_TRACK&&e!==n.SUBTITLE_TRACK},r.mapContextToLevelType=function(e){switch(e.type){case n.AUDIO_TRACK:return a.AUDIO;case n.SUBTITLE_TRACK:return a.SUBTITLE;default:return a.MAIN}},r.getResponseUrl=function(e,t){var i=e.url;return void 0!==i&&0!==i.indexOf("data:")||(i=t.url),i};var s=r.prototype;return s.createInternalLoader=function(e){var t=this.hls.config,i=new(t.pLoader||t.loader)(t);return e.loader=i,this.loaders[e.type]=i,i},s.getInternalLoader=function(e){return this.loaders[e.type]},s.resetInternalLoader=function(e){this.loaders[e]&&delete this.loaders[e]},s.destroyInternalLoaders=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}},s.destroy=function(){this.destroyInternalLoaders(),e.prototype.destroy.call(this)},s.onManifestLoading=function(e){this.load({url:e.url,type:n.MANIFEST,level:0,id:null,responseType:"text"})},s.onLevelLoading=function(e){this.load({url:e.url,type:n.LEVEL,level:e.level,id:e.id,responseType:"text"})},s.onAudioTrackLoading=function(e){this.load({url:e.url,type:n.AUDIO_TRACK,level:null,id:e.id,responseType:"text"})},s.onSubtitleTrackLoading=function(e){this.load({url:e.url,type:n.SUBTITLE_TRACK,level:null,id:e.id,responseType:"text"})},s.load=function(e){var t=this.hls.config;c.b.debug("Loading playlist of type "+e.type+", level: "+e.level+", id: "+e.id);var i,r,a,s,o=this.getInternalLoader(e);if(o){var u=o.context;if(u&&u.url===e.url)return c.b.trace("playlist request ongoing"),!1;c.b.warn("aborting previous loader for type: "+e.type),o.abort()}switch(e.type){case n.MANIFEST:i=t.manifestLoadingMaxRetry,r=t.manifestLoadingTimeOut,a=t.manifestLoadingRetryDelay,s=t.manifestLoadingMaxRetryTimeout;break;case n.LEVEL:i=0,s=0,a=0,r=t.levelLoadingTimeOut;break;default:i=t.levelLoadingMaxRetry,r=t.levelLoadingTimeOut,a=t.levelLoadingRetryDelay,s=t.levelLoadingMaxRetryTimeout}o=this.createInternalLoader(e);var l={timeout:r,maxRetry:i,retryDelay:a,maxRetryDelay:s},d={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};return c.b.debug("Calling internal loader delegate for URL: "+e.url),o.load(e,l,d),!0},s.loadsuccess=function(e,t,i,r){if(void 0===r&&(r=null),i.isSidxRequest)return this._handleSidxRequest(e,i),void this._handlePlaylistLoaded(e,t,i,r);if(this.resetInternalLoader(i.type),"string"!=typeof e.data)throw new Error('expected responseType of "text" for PlaylistLoader');var n=e.data;t.tload=R.now(),0===n.indexOf("#EXTM3U")?n.indexOf("#EXTINF:")>0||n.indexOf("#EXT-X-TARGETDURATION:")>0?this._handleTrackOrLevelPlaylist(e,t,i,r):this._handleMasterPlaylist(e,t,i,r):this._handleManifestParsingError(e,i,"no EXTM3U delimiter",r)},s.loaderror=function(e,t,i){void 0===i&&(i=null),this._handleNetworkError(t,i,!1,e)},s.loadtimeout=function(e,t,i){void 0===i&&(i=null),this._handleNetworkError(t,i,!0)},s._handleMasterPlaylist=function(e,t,i,n){var a=this.hls,s=e.data,o=r.getResponseUrl(e,i),u=L.parseMasterPlaylist(s,o),d=u.levels,h=u.sessionData;if(d.length){var f=d.map((function(e){return{id:e.attrs.AUDIO,codec:e.audioCodec}})),p=L.parseMasterPlaylistMedia(s,o,"AUDIO",f),g=L.parseMasterPlaylistMedia(s,o,"SUBTITLES"),m=L.parseMasterPlaylistMedia(s,o,"CLOSED-CAPTIONS");if(p.length){var v=!1;p.forEach((function(e){e.url||(v=!0)})),!1===v&&d[0].audioCodec&&!d[0].attrs.AUDIO&&(c.b.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),p.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:{},url:""}))}a.trigger(l.a.MANIFEST_LOADED,{levels:d,audioTracks:p,subtitles:g,captions:m,url:o,stats:t,networkDetails:n,sessionData:h})}else this._handleManifestParsingError(e,i,"no level found in manifest",n)},s._handleTrackOrLevelPlaylist=function(e,t,i,a){var s=this.hls,c=i.id,d=i.level,h=i.type,f=r.getResponseUrl(e,i),p=Object(u.a)(c)?c:0,g=Object(u.a)(d)?d:p,m=r.mapContextToLevelType(i),v=L.parseLevelPlaylist(e.data,f,g,m,p);v.tload=t.tload,v.fragments.length?(h===n.MANIFEST&&s.trigger(l.a.MANIFEST_LOADED,{levels:[{url:f,details:v}],audioTracks:[],url:f,stats:t,networkDetails:a,sessionData:null}),t.tparsed=R.now(),v.needSidxRanges?this.load({url:v.initSegment.url,isSidxRequest:!0,type:h,level:d,levelDetails:v,id:c,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"}):(i.levelDetails=v,this._handlePlaylistLoaded(e,t,i,a))):s.trigger(l.a.ERROR,{type:o.b.NETWORK_ERROR,details:o.a.LEVEL_EMPTY_ERROR,fatal:!1,url:f,reason:"no fragments found in level",level:"number"==typeof i.level?i.level:void 0})},s._handleSidxRequest=function(e,t){if("string"==typeof e.data)throw new Error("sidx request must be made with responseType of array buffer");var i=p.a.parseSegmentIndex(new Uint8Array(e.data));if(i){var r=t.levelDetails;i.references.forEach((function(e,t){var i=e.info;if(r){var n=r.fragments[t];0===n.byteRange.length&&n.setByteRange(String(1+i.end-i.start)+"@"+String(i.start))}})),r&&r.initSegment.setByteRange(String(i.moovEndOffset)+"@0")}},s._handleManifestParsingError=function(e,t,i,r){this.hls.trigger(l.a.ERROR,{type:o.b.NETWORK_ERROR,details:o.a.MANIFEST_PARSING_ERROR,fatal:!0,url:e.url,reason:i,networkDetails:r})},s._handleNetworkError=function(e,t,i,r){var a,s;void 0===i&&(i=!1),void 0===r&&(r=null),c.b.info("A network error occured while loading a "+e.type+"-type playlist");var u=this.getInternalLoader(e);switch(e.type){case n.MANIFEST:a=i?o.a.MANIFEST_LOAD_TIMEOUT:o.a.MANIFEST_LOAD_ERROR,s=!0;break;case n.LEVEL:a=i?o.a.LEVEL_LOAD_TIMEOUT:o.a.LEVEL_LOAD_ERROR,s=!1;break;case n.AUDIO_TRACK:a=i?o.a.AUDIO_TRACK_LOAD_TIMEOUT:o.a.AUDIO_TRACK_LOAD_ERROR,s=!1;break;default:s=!1}u&&(u.abort(),this.resetInternalLoader(e.type));var d={type:o.b.NETWORK_ERROR,details:a,fatal:s,url:e.url,loader:u,context:e,networkDetails:t};r&&(d.response=r),this.hls.trigger(l.a.ERROR,d)},s._handlePlaylistLoaded=function(e,t,i,a){var s=i.type,o=i.level,u=i.id,c=i.levelDetails;if(c&&c.targetduration)if(r.canHaveQualityLevels(i.type))this.hls.trigger(l.a.LEVEL_LOADED,{details:c,level:o||0,id:u||0,stats:t,networkDetails:a});else switch(s){case n.AUDIO_TRACK:this.hls.trigger(l.a.AUDIO_TRACK_LOADED,{details:c,id:u,stats:t,networkDetails:a});break;case n.SUBTITLE_TRACK:this.hls.trigger(l.a.SUBTITLE_TRACK_LOADED,{details:c,id:u,stats:t,networkDetails:a})}else this._handleManifestParsingError(e,i,"invalid target duration",a)},r}(h),O=function(e){var t,i;function r(t){var i;return(i=e.call(this,t,l.a.FRAG_LOADING)||this).loaders={},i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n=r.prototype;return n.destroy=function(){var t=this.loaders;for(var i in t){var r=t[i];r&&r.destroy()}this.loaders={},e.prototype.destroy.call(this)},n.onFragLoading=function(e){var t=e.frag,i=t.type,r=this.loaders,n=this.hls.config,a=n.fLoader,s=n.loader;t.loaded=0;var o,l,d,h=r[i];h&&(c.b.warn("abort previous fragment loader for type: "+i),h.abort()),h=r[i]=t.loader=n.fLoader?new a(n):new s(n),o={url:t.url,frag:t,responseType:"arraybuffer",progressData:!1};var f=t.byteRangeStartOffset,p=t.byteRangeEndOffset;Object(u.a)(f)&&Object(u.a)(p)&&(o.rangeStart=f,o.rangeEnd=p),l={timeout:n.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:n.fragLoadingMaxRetryTimeout},d={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},h.load(o,l,d)},n.loadsuccess=function(e,t,i,r){void 0===r&&(r=null);var n=e.data,a=i.frag;a.loader=void 0,this.loaders[a.type]=void 0,this.hls.trigger(l.a.FRAG_LOADED,{payload:n,frag:a,stats:t,networkDetails:r})},n.loaderror=function(e,t,i){void 0===i&&(i=null);var r=t.frag,n=r.loader;n&&n.abort(),this.loaders[r.type]=void 0,this.hls.trigger(l.a.ERROR,{type:o.b.NETWORK_ERROR,details:o.a.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e,networkDetails:i})},n.loadtimeout=function(e,t,i){void 0===i&&(i=null);var r=t.frag,n=r.loader;n&&n.abort(),this.loaders[r.type]=void 0,this.hls.trigger(l.a.ERROR,{type:o.b.NETWORK_ERROR,details:o.a.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag,networkDetails:i})},n.loadprogress=function(e,t,i,r){void 0===r&&(r=null);var n=t.frag;n.loaded=e.loaded,this.hls.trigger(l.a.FRAG_LOAD_PROGRESS,{frag:n,stats:e,networkDetails:r})},r}(h),x=function(e){var t,i;function r(t){var i;return(i=e.call(this,t,l.a.KEY_LOADING)||this).loaders={},i.decryptkey=null,i.decrypturl=null,i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n=r.prototype;return n.destroy=function(){for(var t in this.loaders){var i=this.loaders[t];i&&i.destroy()}this.loaders={},e.prototype.destroy.call(this)},n.onKeyLoading=function(e){var t=e.frag,i=t.type,r=this.loaders[i];if(t.decryptdata){var n=t.decryptdata.uri;if(n!==this.decrypturl||null===this.decryptkey){var a=this.hls.config;if(r&&(c.b.warn("abort previous key loader for type:"+i),r.abort()),!n)return void c.b.warn("key uri is falsy");t.loader=this.loaders[i]=new a.loader(a),this.decrypturl=n,this.decryptkey=null;var s={url:n,frag:t,responseType:"arraybuffer"},o={timeout:a.fragLoadingTimeOut,maxRetry:0,retryDelay:a.fragLoadingRetryDelay,maxRetryDelay:a.fragLoadingMaxRetryTimeout},u={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};t.loader.load(s,o,u)}else this.decryptkey&&(t.decryptdata.key=this.decryptkey,this.hls.trigger(l.a.KEY_LOADED,{frag:t}))}else c.b.warn("Missing decryption data on fragment in onKeyLoading")},n.loadsuccess=function(e,t,i){var r=i.frag;r.decryptdata?(this.decryptkey=r.decryptdata.key=new Uint8Array(e.data),r.loader=void 0,delete this.loaders[r.type],this.hls.trigger(l.a.KEY_LOADED,{frag:r})):c.b.error("after key load, decryptdata unset")},n.loaderror=function(e,t){var i=t.frag,r=i.loader;r&&r.abort(),delete this.loaders[i.type],this.hls.trigger(l.a.ERROR,{type:o.b.NETWORK_ERROR,details:o.a.KEY_LOAD_ERROR,fatal:!1,frag:i,response:e})},n.loadtimeout=function(e,t){var i=t.frag,r=i.loader;r&&r.abort(),delete this.loaders[i.type],this.hls.trigger(l.a.ERROR,{type:o.b.NETWORK_ERROR,details:o.a.KEY_LOAD_TIMEOUT,fatal:!1,frag:i})},r}(h),P="NOT_LOADED",M="APPENDING",N="PARTIAL",U="OK",F=function(e){var t,i;function r(t){var i;return(i=e.call(this,t,l.a.BUFFER_APPENDED,l.a.FRAG_BUFFERED,l.a.FRAG_LOADED)||this).bufferPadding=.2,i.fragments=Object.create(null),i.timeRanges=Object.create(null),i.config=t.config,i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n=r.prototype;return n.destroy=function(){this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.config=null,h.prototype.destroy.call(this),e.prototype.destroy.call(this)},n.getBufferedFrag=function(e,t){var i=this.fragments,r=Object.keys(i).filter((function(r){var n=i[r];if(n.body.type!==t)return!1;if(!n.buffered)return!1;var a=n.body;return a.startPTS<=e&&e<=a.endPTS}));if(0===r.length)return null;var n=r.pop();return i[n].body},n.detectEvictedFragments=function(e,t){var i=this;Object.keys(this.fragments).forEach((function(r){var n=i.fragments[r];if(n&&n.buffered){var a=n.range[e];if(a)for(var s=a.time,o=0;o<s.length;o++){var u=s[o];if(!i.isTimeBuffered(u.startPTS,u.endPTS,t)){i.removeFragment(n.body);break}}}}))},n.detectPartialFragments=function(e){var t=this,i=this.getFragmentKey(e),r=this.fragments[i];r&&(r.buffered=!0,Object.keys(this.timeRanges).forEach((function(i){e.hasElementaryStream(i)&&(r.range[i]=t.getBufferedTimes(e.startPTS,e.endPTS,t.timeRanges[i]))})))},n.getBufferedTimes=function(e,t,i){for(var r,n,a=[],s=!1,o=0;o<i.length;o++){if(r=i.start(o)-this.bufferPadding,n=i.end(o)+this.bufferPadding,e>=r&&t<=n){a.push({startPTS:Math.max(e,i.start(o)),endPTS:Math.min(t,i.end(o))});break}if(e<n&&t>r)a.push({startPTS:Math.max(e,i.start(o)),endPTS:Math.min(t,i.end(o))}),s=!0;else if(t<=r)break}return{time:a,partial:s}},n.getFragmentKey=function(e){return e.type+"_"+e.level+"_"+e.urlId+"_"+e.sn},n.getPartialFragment=function(e){var t,i,r,n=this,a=null,s=0;return Object.keys(this.fragments).forEach((function(o){var u=n.fragments[o];n.isPartial(u)&&(r=u.body.endPTS+n.bufferPadding,e>=(i=u.body.startPTS-n.bufferPadding)&&e<=r&&(t=Math.min(e-i,r-e),s<=t&&(a=u.body,s=t)))})),a},n.getState=function(e){var t=this.getFragmentKey(e),i=this.fragments[t],r=P;return void 0!==i&&(r=i.buffered?!0===this.isPartial(i)?N:U:M),r},n.isPartial=function(e){return!0===e.buffered&&(void 0!==e.range.video&&!0===e.range.video.partial||void 0!==e.range.audio&&!0===e.range.audio.partial)},n.isTimeBuffered=function(e,t,i){for(var r,n,a=0;a<i.length;a++){if(r=i.start(a)-this.bufferPadding,n=i.end(a)+this.bufferPadding,e>=r&&t<=n)return!0;if(t<=r)return!1}return!1},n.onFragLoaded=function(e){var t=e.frag;Object(u.a)(t.sn)&&!t.bitrateTest&&(this.fragments[this.getFragmentKey(t)]={body:t,range:Object.create(null),buffered:!1})},n.onBufferAppended=function(e){var t=this;this.timeRanges=e.timeRanges,Object.keys(this.timeRanges).forEach((function(e){t.detectEvictedFragments(e,t.timeRanges[e])}))},n.onFragBuffered=function(e){this.detectPartialFragments(e.frag)},n.hasFragment=function(e){var t=this.getFragmentKey(e);return void 0!==this.fragments[t]},n.removeFragment=function(e){var t=this.getFragmentKey(e);delete this.fragments[t]},n.removeAllFragments=function(){this.fragments=Object.create(null)},r}(h),B=function(e,t){for(var i=0,r=e.length-1,n=null,a=null;i<=r;){var s=t(a=e[n=(i+r)/2|0]);if(s>0)i=n+1;else{if(!(s<0))return a;r=n-1}}return null},j=function(){function e(){}return e.isBuffered=function(e,t){try{if(e)for(var i=e.buffered,r=0;r<i.length;r++)if(t>=i.start(r)&&t<=i.end(r))return!0}catch(e){}return!1},e.bufferInfo=function(e,t,i){try{if(e){var r,n=e.buffered,a=[];for(r=0;r<n.length;r++)a.push({start:n.start(r),end:n.end(r)});return this.bufferedInfo(a,t,i)}}catch(e){}return{len:0,start:t,end:t,nextStart:void 0}},e.bufferedInfo=function(e,t,i){e.sort((function(e,t){return e.start-t.start||t.end-e.end}));var r=[];if(i)for(var n=0;n<e.length;n++){var a=r.length;if(a){var s=r[a-1].end;e[n].start-s<i?e[n].end>s&&(r[a-1].end=e[n].end):r.push(e[n])}else r.push(e[n])}else r=e;for(var o,u=0,l=t,c=t,d=0;d<r.length;d++){var h=r[d].start,f=r[d].end;if(t+i>=h&&t<f)l=h,u=(c=f)-t;else if(t+i<h){o=h;break}}return{len:u,start:l,end:c,nextStart:o}},e}(),V=i(8),H=i(11),G=i(9);function q(){return window.MediaSource||window.WebKitMediaSource}var K=i(5),W=function(e){var t,i;function r(){return e.apply(this,arguments)||this}return i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i,r.prototype.trigger=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];this.emit.apply(this,[e,e].concat(i))},r}(V.EventEmitter),z=Object(K.a)(),Y=q()||{isTypeSupported:function(){return!1}},X=function(){function e(e,t){var i=this;this.hls=e,this.id=t;var r=this.observer=new W,n=e.config,a=function(t,r){(r=r||{}).frag=i.frag,r.id=i.id,e.trigger(t,r)};r.on(l.a.FRAG_DECRYPTED,a),r.on(l.a.FRAG_PARSING_INIT_SEGMENT,a),r.on(l.a.FRAG_PARSING_DATA,a),r.on(l.a.FRAG_PARSED,a),r.on(l.a.ERROR,a),r.on(l.a.FRAG_PARSING_METADATA,a),r.on(l.a.FRAG_PARSING_USERDATA,a),r.on(l.a.INIT_PTS_FOUND,a);var s={mp4:Y.isTypeSupported("video/mp4"),mpeg:Y.isTypeSupported("audio/mpeg"),mp3:Y.isTypeSupported('audio/mp4; codecs="mp3"')},u=navigator.vendor;if(n.enableWorker&&"undefined"!=typeof Worker){var d;c.b.log("demuxing in webworker");try{d=this.w=H(12),this.onwmsg=this.onWorkerMessage.bind(this),d.addEventListener("message",this.onwmsg),d.onerror=function(t){e.trigger(l.a.ERROR,{type:o.b.OTHER_ERROR,details:o.a.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:t.message+" ("+t.filename+":"+t.lineno+")"}})},d.postMessage({cmd:"init",typeSupported:s,vendor:u,id:t,config:JSON.stringify(n)})}catch(e){c.b.warn("Error in worker:",e),c.b.error("Error while initializing DemuxerWorker, fallback on DemuxerInline"),d&&z.URL.revokeObjectURL(d.objectURL),this.demuxer=new G.a(r,s,n,u),this.w=void 0}}else this.demuxer=new G.a(r,s,n,u)}var t=e.prototype;return t.destroy=function(){var e=this.w;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}var i=this.observer;i&&(i.removeAllListeners(),this.observer=null)},t.push=function(e,t,i,r,n,a,s,o){var l=this.w,d=Object(u.a)(n.startPTS)?n.startPTS:n.start,h=n.decryptdata,f=this.frag,p=!(f&&n.cc===f.cc),g=!(f&&n.level===f.level),m=!g&&f&&n.sn===f.sn+1;if(p&&c.b.log(this.id+":discontinuity detected"),g&&c.b.log(this.id+":switch detected"),this.frag=n,l)l.postMessage({cmd:"demux",data:e,decryptdata:h,initSegment:t,audioCodec:i,videoCodec:r,timeOffset:d,discontinuity:p,trackSwitch:g,contiguous:m,duration:a,accurateTimeOffset:s,defaultInitPTS:o},e instanceof ArrayBuffer?[e]:[]);else{var v=this.demuxer;v&&v.push(e,h,t,i,r,d,p,g,m,a,s,o)}},t.onWorkerMessage=function(e){var t=e.data,i=this.hls;switch(t.event){case"init":z.URL.revokeObjectURL(this.w.objectURL);break;case l.a.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,i.trigger(t.event,t.data)}},e}();function Q(e,t,i){switch(t){case"audio":e.audioGroupIds||(e.audioGroupIds=[]),e.audioGroupIds.push(i);break;case"text":e.textGroupIds||(e.textGroupIds=[]),e.textGroupIds.push(i)}}function $(e,t,i){var r=e[t],n=e[i],a=n.startPTS;Object(u.a)(a)?i>t?(r.duration=a-r.start,r.duration<0&&c.b.warn("negative duration computed for frag "+r.sn+",level "+r.level+", there should be some duration drift between playlist and fragment!")):(n.duration=r.start-a,n.duration<0&&c.b.warn("negative duration computed for frag "+n.sn+",level "+n.level+", there should be some duration drift between playlist and fragment!")):n.start=i>t?r.start+(r.cc===n.cc&&r.minEndPTS?r.minEndPTS-r.start:r.duration):Math.max(r.start-n.duration,0)}function J(e,t,i,r,n,a){var s=i,o=r;if(Object(u.a)(t.startPTS)){var l=Math.abs(t.startPTS-i);t.deltaPTS=Object(u.a)(t.deltaPTS)?Math.max(l,t.deltaPTS):l,s=Math.max(i,t.startPTS),i=Math.min(i,t.startPTS),o=Math.min(r,t.endPTS),r=Math.max(r,t.endPTS),n=Math.min(n,t.startDTS),a=Math.max(a,t.endDTS)}var c=i-t.start;t.start=t.startPTS=i,t.maxStartPTS=s,t.endPTS=r,t.minEndPTS=o,t.startDTS=n,t.endDTS=a,t.duration=r-i;var d,h,f,p=t.sn;if(!e||p<e.startSN||p>e.endSN)return 0;for((h=e.fragments)[d=p-e.startSN]=t,f=d;f>0;f--)$(h,f,f-1);for(f=d;f<h.length-1;f++)$(h,f,f+1);return e.PTSKnown=!0,c}function Z(e,t){t.initSegment&&e.initSegment&&(t.initSegment=e.initSegment);var i,r=0;if(ee(e,t,(function(e,n){r=e.cc-n.cc,Object(u.a)(e.startPTS)&&(n.start=n.startPTS=e.startPTS,n.endPTS=e.endPTS,n.duration=e.duration,n.backtracked=e.backtracked,n.dropped=e.dropped,i=n),t.PTSKnown=!0})),t.PTSKnown){if(r){c.b.log("discontinuity sliding from playlist, take drift into account");for(var n=t.fragments,a=0;a<n.length;a++)n[a].cc+=r}i?J(t,i,i.startPTS,i.endPTS,i.startDTS,i.endDTS):function(e,t){var i=t.startSN-e.startSN,r=e.fragments,n=t.fragments;if(!(i<0||i>r.length))for(var a=0;a<n.length;a++)n[a].start+=r[i].start}(e,t),t.PTSKnown=e.PTSKnown}}function ee(e,t,i){if(e&&t)for(var r=Math.max(e.startSN,t.startSN)-t.startSN,n=Math.min(e.endSN,t.endSN)-t.startSN,a=t.startSN-e.startSN,s=r;s<=n;s++){var o=e.fragments[a+s],u=t.fragments[s];if(!o||!u)break;i(o,u,s)}}function te(e,t,i){var r=1e3*(t.averagetargetduration?t.averagetargetduration:t.targetduration),n=r/2;return e&&t.endSN===e.endSN&&(r=n),i&&(r=Math.max(n,r-(window.performance.now()-i))),Math.round(r)}var ie=function(e){for(var t="",i=e.length,r=0;r<i;r++)t+="["+e.start(r).toFixed(3)+","+e.end(r).toFixed(3)+"]";return t};function re(e,t){t.fragments.forEach((function(t){if(t){var i=t.start+e;t.start=t.startPTS=i,t.endPTS=i+t.duration}})),t.PTSKnown=!0}function ne(e,t,i){!function(e,t,i){if(function(e,t,i){var r=!1;return t&&t.details&&i&&(i.endCC>i.startCC||e&&e.cc<i.startCC)&&(r=!0),r}(e,i,t)){var r=function(e,t){var i=e.fragments,r=t.fragments;if(r.length&&i.length){var n=function(e,t){for(var i=null,r=0;r<e.length;r+=1){var n=e[r];if(n&&n.cc===t){i=n;break}}return i}(i,r[0].cc);if(n&&(!n||n.startPTS))return n;c.b.log("No frag in previous level to align on")}else c.b.log("No fragments to align")}(i.details,t);r&&(c.b.log("Adjusting PTS using last level due to CC increase within current level"),re(r.start,t))}}(e,i,t),!i.PTSKnown&&t&&function(e,t){if(t&&t.fragments.length){if(!e.hasProgramDateTime||!t.hasProgramDateTime)return;var i=(e.fragments[0].programDateTime-t.fragments[0].programDateTime)/1e3+t.fragments[0].start;Object(u.a)(i)&&(c.b.log("adjusting PTS using programDateTime delta, sliding:"+i.toFixed(3)),re(i,e))}}(i,t.details)}function ae(e,t,i){if(null===t||!Array.isArray(e)||!e.length||!Object(u.a)(t))return null;if(t<(e[0].programDateTime||0))return null;if(t>=(e[e.length-1].endProgramDateTime||0))return null;i=i||0;for(var r=0;r<e.length;++r){var n=e[r];if(ue(t,i,n))return n}return null}function se(e,t,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=null;return e?n=t[e.sn-t[0].sn+1]:0===i&&0===t[0].start&&(n=t[0]),n&&0===oe(i,r,n)?n:B(t,oe.bind(null,i,r))||n}function oe(e,t,i){void 0===e&&(e=0),void 0===t&&(t=0);var r=Math.min(t,i.duration+(i.deltaPTS?i.deltaPTS:0));return i.start+i.duration-r<=e?1:i.start-r>e&&i.start?-1:0}function ue(e,t,i){var r=1e3*Math.min(t,i.duration+(i.deltaPTS?i.deltaPTS:0));return(i.endProgramDateTime||0)-r>e}var le=function(){function e(e,t,i,r){this.config=e,this.media=t,this.fragmentTracker=i,this.hls=r,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1}var t=e.prototype;return t.poll=function(e){var t=this.config,i=this.media,r=this.stalled,n=i.currentTime,a=i.seeking,s=this.seeking&&!a,o=!this.seeking&&a;if(this.seeking=a,n===e){if((o||s)&&(this.stalled=null),!i.paused&&!i.ended&&0!==i.playbackRate&&i.buffered.length){var u=j.bufferInfo(i,n,0),l=u.nextStart||0;if(u.len>0||l){if(a){var d=u.len>2,h=!l||l-n>2&&!this.fragmentTracker.getPartialFragment(n);if(d||h)return;this.moved=!1}if(!this.moved&&this.stalled){var f=Math.max(l,u.start||0)-n;if(f>0&&f<=2)return void this._trySkipBufferHole(null)}var p=self.performance.now();if(null!==r){var g=p-r;!a&&g>=250&&this._reportStall(u.len);var m=j.bufferInfo(i,n,t.maxBufferHole);this._tryFixBufferStall(m,g)}else this.stalled=p}}}else if(this.moved=!0,null!==r){if(this.stallReported){var v=self.performance.now()-r;c.b.warn("playback not stuck anymore @"+n+", after "+Math.round(v)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}},t._tryFixBufferStall=function(e,t){var i=this.config,r=this.fragmentTracker.getPartialFragment(this.media.currentTime);r&&this._trySkipBufferHole(r)||e.len>i.maxBufferHole&&t>1e3*i.highBufferWatchdogPeriod&&(c.b.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},t._reportStall=function(e){var t=this.hls,i=this.media;this.stallReported||(this.stallReported=!0,c.b.warn("Playback stalling at @"+i.currentTime+" due to low buffer (buffer="+e+")"),t.trigger(l.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_STALLED_ERROR,fatal:!1,buffer:e}))},t._trySkipBufferHole=function(e){for(var t=this.config,i=this.hls,r=this.media,n=r.currentTime,a=0,s=0;s<r.buffered.length;s++){var u=r.buffered.start(s);if(n+t.maxBufferHole>=a&&n<u){var d=Math.max(u+.05,r.currentTime+.1);return c.b.warn("skipping hole, adjusting currentTime from "+n+" to "+d),this.moved=!0,this.stalled=null,r.currentTime=d,e&&i.trigger(l.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+n+" to "+d,frag:e}),d}a=r.buffered.end(s)}return 0},t._tryNudgeBuffer=function(){var e=this.config,t=this.hls,i=this.media,r=i.currentTime,n=(this.nudgeRetry||0)+1;if(this.nudgeRetry=n,n<e.nudgeMaxRetry){var a=r+n*e.nudgeOffset;c.b.warn("Nudging 'currentTime' from "+r+" to "+a),i.currentTime=a,t.trigger(l.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_NUDGE_ON_STALL,fatal:!1})}else c.b.error("Playhead still not moving while enough data buffered @"+r+" after "+e.nudgeMaxRetry+" nudges"),t.trigger(l.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_STALLED_ERROR,fatal:!0})},e}();function ce(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var de,he=function(e){var t,i;function r(t){for(var i,r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return(i=e.call.apply(e,[this,t].concat(n))||this)._boundTick=void 0,i._tickTimer=null,i._tickInterval=null,i._tickCallCount=0,i._boundTick=i.tick.bind(ce(i)),i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n=r.prototype;return n.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},n.hasInterval=function(){return!!this._tickInterval},n.hasNextTick=function(){return!!this._tickTimer},n.setInterval=function(e){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,e),!0)},n.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},n.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},n.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&(this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)),this._tickCallCount=0)},n.doTick=function(){},r}(h),fe="STOPPED",pe="STARTING",ge="IDLE",me="KEY_LOADING",ve="FRAG_LOADING",ye="FRAG_LOADING_WAITING_RETRY",_e="WAITING_TRACK",be="PARSING",Te="PARSED",Se="BUFFER_FLUSHING",Ee="ENDED",ke="ERROR",we="WAITING_INIT_PTS",Ce="WAITING_LEVEL",Ae=function(e){var t,i;function r(){return e.apply(this,arguments)||this}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n=r.prototype;return n.doTick=function(){},n.startLoad=function(){},n.stopLoad=function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragmentTracker.removeFragment(e)),this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=fe},n._streamEnded=function(e,t){var i=this.fragCurrent;if(!t.live&&i&&!i.backtracked&&i.sn===t.endSN&&!e.nextStart){var r=this.fragmentTracker.getState(i);return r===N||r===U}return!1},n.onMediaSeeking=function(){var e=this.config,t=this.media,i=this.state,r=t?t.currentTime:null,n=j.bufferInfo(this.mediaBuffer||t,r,this.config.maxBufferHole);if(c.b.log("media seeking to "+(Object(u.a)(r)?r.toFixed(3):r)),i===ve){var a=this.fragCurrent;if(0===n.len&&a){var s=e.maxFragLookUpTolerance;r<a.start-s||r>a.start+a.duration+s?(a.loader&&(c.b.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),a.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=ge):c.b.log("seeking outside of buffer but within currently loaded fragment range")}}else i===Ee&&(0===n.len&&(this.fragPrevious=null,this.fragCurrent=null),this.state=ge);t&&(this.lastCurrentTime=r),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=r),this.tick()},n.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},n.onHandlerDestroying=function(){this.stopLoad(),e.prototype.onHandlerDestroying.call(this)},n.onHandlerDestroyed=function(){this.state=fe,this.fragmentTracker=null},n.computeLivePosition=function(e,t){return e+Math.max(0,t.totalduration-(void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration))},r}(he),Le=function(e){var t,i;function r(t,i){var r;return(r=e.call(this,t,l.a.MEDIA_ATTACHED,l.a.MEDIA_DETACHING,l.a.MANIFEST_LOADING,l.a.MANIFEST_PARSED,l.a.LEVEL_LOADED,l.a.LEVELS_UPDATED,l.a.KEY_LOADED,l.a.FRAG_LOADED,l.a.FRAG_LOAD_EMERGENCY_ABORTED,l.a.FRAG_PARSING_INIT_SEGMENT,l.a.FRAG_PARSING_DATA,l.a.FRAG_PARSED,l.a.ERROR,l.a.AUDIO_TRACK_SWITCHING,l.a.AUDIO_TRACK_SWITCHED,l.a.BUFFER_CREATED,l.a.BUFFER_APPENDED,l.a.BUFFER_FLUSHED)||this).fragmentTracker=i,r.config=t.config,r.audioCodecSwap=!1,r._state=fe,r.stallReported=!1,r.gapController=null,r.altAudio=!1,r.audioOnly=!1,r.bitrateTest=!1,r}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n,s=r.prototype;return s.startLoad=function(e){if(this.levels){var t=this.lastCurrentTime,i=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var r=i.startLevel;-1===r&&(i.config.testBandwidth?(r=0,this.bitrateTest=!0):r=i.nextAutoLevel),this.level=i.nextLoadLevel=r,this.loadedmetadata=!1}t>0&&-1===e&&(c.b.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=ge,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this.forceStartLoad=!0,this.state=fe},s.stopLoad=function(){this.forceStartLoad=!1,e.prototype.stopLoad.call(this)},s.doTick=function(){switch(this.state){case Se:this.fragLoadError=0;break;case ge:this._doTickIdle();break;case Ce:var e=this.levels[this.level];e&&e.details&&(this.state=ge);break;case ye:var t=window.performance.now(),i=this.retryDate;(!i||t>=i||this.media&&this.media.seeking)&&(c.b.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=ge)}this._checkBuffer(),this._checkFragmentChanged()},s._doTickIdle=function(){var e=this.hls,t=e.config,i=this.media;if(void 0!==this.levelLastLoaded&&(i||!this.startFragRequested&&t.startFragPrefetch))if(this.altAudio&&this.audioOnly)this.demuxer.frag=null;else{var r;r=this.loadedmetadata?i.currentTime:this.nextLoadPosition;var n=e.nextLoadLevel,a=this.levels[n];if(a){var s,o=a.bitrate;s=o?Math.max(8*t.maxBufferSize/o,t.maxBufferLength):t.maxBufferLength,s=Math.min(s,t.maxMaxBufferLength);var u=r<t.maxBufferHole?Math.max(2,t.maxBufferHole):t.maxBufferHole,d=j.bufferInfo(this.mediaBuffer?this.mediaBuffer:i,r,u),h=d.len;if(!(h>=s)){c.b.trace("buffer length of "+h.toFixed(3)+" is below max of "+s.toFixed(3)+". checking for more payload ..."),this.level=e.nextLoadLevel=n;var f=a.details;if(!f||f.live&&this.levelLastLoaded!==n)this.state=Ce;else{if(this._streamEnded(d,f)){var p={};return this.altAudio&&(p.type="video"),this.hls.trigger(l.a.BUFFER_EOS,p),void(this.state=Ee)}this._fetchPayloadOrEos(r,d,f)}}}}},s._fetchPayloadOrEos=function(e,t,i){var r=this.fragPrevious,n=i.fragments,a=n.length;if(0!==a){var s,o=n[0].start,u=n[a-1].start+n[a-1].duration,l=t.end;if(i.initSegment&&!i.initSegment.data)s=i.initSegment;else if(i.live){var d=this.config.initialLiveManifestSize;if(a<d)return void c.b.warn("Can not start playback of a level, reason: not enough fragments "+a+" < "+d);if(null===(s=this._ensureFragmentAtLivePoint(i,l,o,u,r,n)))return}else l<o&&(s=n[0]);s||(s=this._findFragment(o,r,a,n,l,u,i)),s&&(s.encrypted?this._loadKey(s,i):this._loadFragment(s,i,e,l))}},s._ensureFragmentAtLivePoint=function(e,t,i,r,n,a){var s,o=this.hls.config,l=this.media,d=1/0;if(void 0!==o.liveMaxLatencyDuration?d=o.liveMaxLatencyDuration:Object(u.a)(o.liveMaxLatencyDurationCount)&&(d=o.liveMaxLatencyDurationCount*e.targetduration),t<Math.max(i-o.maxFragLookUpTolerance,r-d)){var h=this.liveSyncPosition=this.computeLivePosition(i,e);t=h,l&&!l.paused&&l.readyState&&l.duration>h&&h>l.currentTime&&(c.b.log("buffer end: "+t.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+h.toFixed(3)),l.currentTime=h),this.nextLoadPosition=h}if(e.PTSKnown&&t>r&&l&&l.readyState)return null;if(this.startFragRequested&&!e.PTSKnown&&n)if(e.hasProgramDateTime)c.b.log("live playlist, switching playlist, load frag with same PDT: "+n.programDateTime),s=ae(a,n.endProgramDateTime,o.maxFragLookUpTolerance);else{var f=n.sn+1;if(f>=e.startSN&&f<=e.endSN){var p=a[f-e.startSN];n.cc===p.cc&&c.b.log("live playlist, switching playlist, load frag with next SN: "+(s=p).sn)}s||(s=B(a,(function(e){return n.cc-e.cc})))&&c.b.log("live playlist, switching playlist, load frag with same CC: "+s.sn)}return s},s._findFragment=function(e,t,i,r,n,a,s){var o,u=this.hls.config;if(o=n<a?se(t,r,n,n>a-u.maxFragLookUpTolerance?0:u.maxFragLookUpTolerance):r[i-1]){var l=o.sn-s.startSN,d=r[l-1],h=r[l+1];if(t&&o.sn===t.sn)if(t&&o.level===t.level&&!o.backtracked)if(o.sn<s.endSN){var f=t.deltaPTS;f&&f>u.maxBufferHole&&t.dropped&&l?(o=d,c.b.warn("Previous fragment was dropped with large PTS gap between audio and video. Maybe fragment is not starting with a keyframe? Loading previous one to try to overcome this")):this.fragmentTracker.getState(o=h)!==U&&c.b.log("Re-loading fragment with SN: "+o.sn)}else o=null;else o.backtracked&&(h&&h.backtracked?(c.b.warn("Already backtracked from fragment "+h.sn+", will not backtrack to fragment "+o.sn+". Loading fragment "+h.sn),o=h):(c.b.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),o.dropped=0,d?(o=d).backtracked=!0:l&&(o=null)))}return o},s._loadKey=function(e,t){c.b.log("Loading key for "+e.sn+" of ["+t.startSN+"-"+t.endSN+"], level "+this.level),this.state=me,this.hls.trigger(l.a.KEY_LOADING,{frag:e})},s._loadFragment=function(e,t,i,r){var n=this.fragmentTracker.getState(e);this.fragCurrent=e,"initSegment"!==e.sn&&(this.startFragRequested=!0),Object(u.a)(e.sn)&&!e.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),e.backtracked||n===P||n===N?(e.autoLevel=this.hls.autoLevelEnabled,e.bitrateTest=this.bitrateTest,c.b.log("Loading "+e.sn+" of ["+t.startSN+"-"+t.endSN+"], level "+this.level+", "+(this.loadedmetadata?"currentTime":"nextLoadPosition")+": "+parseFloat(i.toFixed(3))+", bufferEnd: "+parseFloat(r.toFixed(3))),this.hls.trigger(l.a.FRAG_LOADING,{frag:e}),this.demuxer||(this.demuxer=new X(this.hls,"main")),this.state=ve):n===M&&this._reduceMaxBufferLength(e.duration)&&this.fragmentTracker.removeFragment(e)},s.getBufferedFrag=function(e){return this.fragmentTracker.getBufferedFrag(e,a.MAIN)},s.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.endPTS+.5):null},s._checkFragmentChanged=function(){var e,t,i=this.media;if(i&&i.readyState&&!1===i.seeking&&((t=i.currentTime)>this.lastCurrentTime&&(this.lastCurrentTime=t),j.isBuffered(i,t)?e=this.getBufferedFrag(t):j.isBuffered(i,t+.1)&&(e=this.getBufferedFrag(t+.1)),e)){var r=e;if(r!==this.fragPlaying){this.hls.trigger(l.a.FRAG_CHANGED,{frag:r});var n=r.level;this.fragPlaying&&this.fragPlaying.level===n||this.hls.trigger(l.a.LEVEL_SWITCHED,{level:n}),this.fragPlaying=r}}},s.immediateLevelSwitch=function(){if(c.b.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var e,t=this.media;t?(e=t.paused)||t.pause():e=!0,this.previouslyPaused=e}var i=this.fragCurrent;i&&i.loader&&i.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},s.immediateLevelSwitchEnd=function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,e.currentTime>0&&j.isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())},s.nextLevelSwitch=function(){var e=this.media;if(e&&e.readyState){var t,i=this.getBufferedFrag(e.currentTime);if(i&&i.startPTS>1&&this.flushMainBuffer(0,i.startPTS-1),e.paused)t=0;else{var r=this.fragLastKbps;t=r&&this.fragCurrent?this.fragCurrent.duration*this.levels[this.hls.nextLoadLevel].bitrate/(1e3*r)+1:0}var n=this.getBufferedFrag(e.currentTime+t);if(n){var a=this.followingBufferedFrag(n);if(a){var s=this.fragCurrent;s&&s.loader&&s.loader.abort(),this.fragCurrent=null;var o=Math.max(n.endPTS,a.maxStartPTS+Math.min(this.config.maxFragLookUpTolerance,a.duration));this.flushMainBuffer(o,Number.POSITIVE_INFINITY)}}}},s.flushMainBuffer=function(e,t){this.state=Se;var i={startOffset:e,endOffset:t};this.altAudio&&(i.type="video"),this.hls.trigger(l.a.BUFFER_FLUSHING,i)},s.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended);var i=this.config;this.levels&&i.autoStartLoad&&this.hls.startLoad(i.startPosition),this.gapController=new le(i,t,this.fragmentTracker,this.hls)},s.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(c.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach((function(e){e.details&&e.details.fragments.forEach((function(e){e.backtracked=void 0}))})),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.fragmentTracker.removeAllFragments(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},s.onMediaSeeked=function(){var e=this.media,t=e?e.currentTime:void 0;Object(u.a)(t)&&c.b.log("media seeked to "+t.toFixed(3)),this.tick()},s.onManifestLoading=function(){c.b.log("trigger BUFFER_RESET"),this.hls.trigger(l.a.BUFFER_RESET),this.fragmentTracker.removeAllFragments(),this.stalled=!1,this.startPosition=this.lastCurrentTime=0},s.onManifestParsed=function(e){var t,i=!1,r=!1;e.levels.forEach((function(e){(t=e.audioCodec)&&(-1!==t.indexOf("mp4a.40.2")&&(i=!0),-1!==t.indexOf("mp4a.40.5")&&(r=!0))})),this.audioCodecSwitch=i&&r,this.audioCodecSwitch&&c.b.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.altAudio=e.altAudio,this.levels=e.levels,this.startFragRequested=!1;var n=this.config;(n.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(n.startPosition)},s.onLevelLoaded=function(e){var t=e.details,i=e.level,r=this.levels[this.levelLastLoaded],n=this.levels[i],a=t.totalduration,s=0;if(c.b.log("level "+i+" loaded ["+t.startSN+","+t.endSN+"],duration:"+a),t.live||n.details&&n.details.live){var o=n.details;o&&t.fragments.length>0?(Z(o,t),this.liveSyncPosition=this.computeLivePosition(s=t.fragments[0].start,o),t.PTSKnown&&Object(u.a)(s)?c.b.log("live playlist sliding:"+s.toFixed(3)):(c.b.log("live playlist - outdated PTS, unknown sliding"),ne(this.fragPrevious,r,t))):(c.b.log("live playlist - first load, unknown sliding"),t.PTSKnown=!1,ne(this.fragPrevious,r,t))}else t.PTSKnown=!1;if(n.details=t,this.levelLastLoaded=i,this.hls.trigger(l.a.LEVEL_UPDATED,{details:t,level:i}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var d=t.startTimeOffset;Object(u.a)(d)?(d<0&&(c.b.log("negative start time offset "+d+", count from end of last fragment"),d=s+a+d),c.b.log("start time offset found in playlist, adjust startPosition to "+d),this.startPosition=d):t.live?(this.startPosition=this.computeLivePosition(s,t),c.b.log("configure startPosition to "+this.startPosition)):this.startPosition=0,this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===Ce&&(this.state=ge),this.tick()},s.onKeyLoaded=function(){this.state===me&&(this.state=ge,this.tick())},s.onFragLoaded=function(e){var t=this.fragCurrent,i=this.hls,r=this.media,n=e.frag;if(this.state===ve&&t&&"main"===n.type&&n.level===t.level&&n.sn===t.sn){var a=e.stats,s=this.levels[t.level],o=s.details;if(this.bitrateTest=!1,this.stats=a,c.b.log("Loaded "+t.sn+" of ["+o.startSN+" ,"+o.endSN+"],level "+t.level),n.bitrateTest&&i.nextLoadLevel)this.state=ge,this.startFragRequested=!1,a.tparsed=a.tbuffered=window.performance.now(),i.trigger(l.a.FRAG_BUFFERED,{stats:a,frag:t,id:"main"}),this.tick();else if("initSegment"===n.sn)this.state=ge,a.tparsed=a.tbuffered=window.performance.now(),o.initSegment.data=e.payload,i.trigger(l.a.FRAG_BUFFERED,{stats:a,frag:t,id:"main"}),this.tick();else{c.b.log("Parsing "+t.sn+" of ["+o.startSN+" ,"+o.endSN+"],level "+t.level+", cc "+t.cc),this.state=be,this.pendingBuffering=!0,this.appended=!1,n.bitrateTest&&(n.bitrateTest=!1,this.fragmentTracker.onFragLoaded({frag:n}));var u=!(r&&r.seeking)&&(o.PTSKnown||!o.live),d=o.initSegment?o.initSegment.data:[],h=this._getAudioCodec(s);(this.demuxer=this.demuxer||new X(this.hls,"main")).push(e.payload,d,h,s.videoCodec,t,o.totalduration,u)}}this.fragLoadError=0},s.onFragParsingInitSegment=function(e){var t=this.fragCurrent,i=e.frag;if(t&&"main"===e.id&&i.sn===t.sn&&i.level===t.level&&this.state===be){var r,n,a=e.tracks;if(this.audioOnly=a.audio&&!a.video,this.altAudio&&!this.audioOnly&&delete a.audio,n=a.audio){var s=this.levels[this.level].audioCodec,o=navigator.userAgent.toLowerCase();s&&this.audioCodecSwap&&(c.b.log("swapping playlist audio codec"),s=-1!==s.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==n.metadata.channelCount&&-1===o.indexOf("firefox")&&(s="mp4a.40.5"),-1!==o.indexOf("android")&&"audio/mpeg"!==n.container&&c.b.log("Android: force audio codec to "+(s="mp4a.40.2")),n.levelCodec=s,n.id=e.id}for(r in(n=a.video)&&(n.levelCodec=this.levels[this.level].videoCodec,n.id=e.id),this.hls.trigger(l.a.BUFFER_CODECS,a),a){c.b.log("main track:"+r+",container:"+(n=a[r]).container+",codecs[level/parsed]=["+n.levelCodec+"/"+n.codec+"]");var u=n.initSegment;u&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(l.a.BUFFER_APPENDING,{type:r,data:u,parent:"main",content:"initSegment"}))}this.tick()}},s.onFragParsingData=function(e){var t=this,i=this.fragCurrent,r=e.frag;if(i&&"main"===e.id&&r.sn===i.sn&&r.level===i.level&&("audio"!==e.type||!this.altAudio)&&this.state===be){var n=this.levels[this.level],a=i;if(Object(u.a)(e.endPTS)||(e.endPTS=e.startPTS+i.duration,e.endDTS=e.startDTS+i.duration),!0===e.hasAudio&&a.addElementaryStream(f.AUDIO),!0===e.hasVideo&&a.addElementaryStream(f.VIDEO),c.b.log("Parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb+",dropped:"+(e.dropped||0)),"video"===e.type)if(a.dropped=e.dropped,a.dropped)if(a.backtracked)c.b.warn("Already backtracked on this fragment, appending with the gap",a.sn);else{var s=n.details;if(!s||a.sn!==s.startSN)return c.b.warn("missing video frame(s), backtracking fragment",a.sn),this.fragmentTracker.removeFragment(a),a.backtracked=!0,this.nextLoadPosition=e.startPTS,this.state=ge,this.fragPrevious=a,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),void this.tick();c.b.warn("missing video frame(s) on first frag, appending with gap",a.sn)}else a.backtracked=!1;var o=J(n.details,a,e.startPTS,e.endPTS,e.startDTS,e.endDTS),d=this.hls;d.trigger(l.a.LEVEL_PTS_UPDATED,{details:n.details,level:this.level,drift:o,type:e.type,start:e.startPTS,end:e.endPTS}),[e.data1,e.data2].forEach((function(i){i&&i.length&&t.state===be&&(t.appended=!0,t.pendingBuffering=!0,d.trigger(l.a.BUFFER_APPENDING,{type:e.type,data:i,parent:"main",content:"data"}))})),this.tick()}},s.onFragParsed=function(e){var t=this.fragCurrent,i=e.frag;t&&"main"===e.id&&i.sn===t.sn&&i.level===t.level&&this.state===be&&(this.stats.tparsed=window.performance.now(),this.state=Te,this._checkAppendedParsed())},s.onAudioTrackSwitching=function(e){var t=this.altAudio,i=e.id;if(!e.url){if(this.mediaBuffer!==this.media){c.b.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var r=this.fragCurrent;r.loader&&(c.b.log("switching to main audio track, cancel main fragment load"),r.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=ge}var n=this.hls;t&&n.trigger(l.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),n.trigger(l.a.AUDIO_TRACK_SWITCHED,{id:i})}},s.onAudioTrackSwitched=function(e){var t=!!this.hls.audioTracks[e.id].url;if(t){var i=this.videoBuffer;i&&this.mediaBuffer!==i&&(c.b.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=i)}this.altAudio=t,this.tick()},s.onBufferCreated=function(e){var t,i,r=e.tracks,n=!1;for(var a in r){var s=r[a];"main"===s.id?(i=a,t=s,"video"===a&&(this.videoBuffer=r[a].buffer)):n=!0}n&&t?(c.b.log("alternate track found, use "+i+".buffered to schedule main fragment loading"),this.mediaBuffer=t.buffer):this.mediaBuffer=this.media},s.onBufferAppended=function(e){if("main"===e.parent){var t=this.state;t!==be&&t!==Te||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}},s._checkAppendedParsed=function(){if(!(this.state!==Te||this.appended&&this.pendingBuffering)){var e=this.fragCurrent;if(e){c.b.log("main buffered : "+ie((this.mediaBuffer?this.mediaBuffer:this.media).buffered)),this.fragPrevious=e;var t=this.stats;t.tbuffered=window.performance.now(),this.fragLastKbps=Math.round(8*t.total/(t.tbuffered-t.tfirst)),this.hls.trigger(l.a.FRAG_BUFFERED,{stats:t,frag:e,id:"main"}),this.state=ge}(this.loadedmetadata||this.startPosition<=0)&&this.tick()}},s.onError=function(e){var t=e.frag||this.fragCurrent;if(!t||"main"===t.type){var i=!!this.media&&j.isBuffered(this.media,this.media.currentTime)&&j.isBuffered(this.media,this.media.currentTime+.5);switch(e.details){case o.a.FRAG_LOAD_ERROR:case o.a.FRAG_LOAD_TIMEOUT:case o.a.KEY_LOAD_ERROR:case o.a.KEY_LOAD_TIMEOUT:if(!e.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var r=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);c.b.warn("mediaController: frag loading failed, retry in "+r+" ms"),this.retryDate=window.performance.now()+r,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=ye}else c.b.error("mediaController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=ke;break;case o.a.LEVEL_LOAD_ERROR:case o.a.LEVEL_LOAD_TIMEOUT:this.state!==ke&&(e.fatal?(this.state=ke,c.b.warn("streamController: "+e.details+",switch to "+this.state+" state ...")):e.levelRetry||this.state!==Ce||(this.state=ge));break;case o.a.BUFFER_FULL_ERROR:"main"!==e.parent||this.state!==be&&this.state!==Te||(i?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=ge):(c.b.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}},s._reduceMaxBufferLength=function(e){var t=this.config;return t.maxMaxBufferLength>=e&&(t.maxMaxBufferLength/=2,c.b.warn("main:reduce max buffer length to "+t.maxMaxBufferLength+"s"),!0)},s._checkBuffer=function(){var e=this.media;if(e&&0!==e.readyState){var t=(this.mediaBuffer?this.mediaBuffer:e).buffered;!this.loadedmetadata&&t.length?(this.loadedmetadata=!0,this._seekToStartPos()):this.immediateSwitch?this.immediateLevelSwitchEnd():this.gapController.poll(this.lastCurrentTime,t)}},s.onFragLoadEmergencyAborted=function(){this.state=ge,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},s.onBufferFlushed=function(){var e=this.mediaBuffer?this.mediaBuffer:this.media;e&&this.fragmentTracker.detectEvictedFragments(this.audioOnly?f.AUDIO:f.VIDEO,e.buffered),this.state=ge,this.fragPrevious=null},s.onLevelsUpdated=function(e){this.levels=e.levels},s.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},s._seekToStartPos=function(){var e=this.media,t=e.currentTime,i=this.startPosition;if(t!==i&&i>=0){if(e.seeking)return void c.b.log("could not seek to "+i+", already seeking at "+t);var r=(e.buffered.length?e.buffered.start(0):0)-i;r>0&&r<this.config.maxBufferHole&&(c.b.log("adjusting start position by "+r+" to match buffer start"),this.startPosition=i+=r),c.b.log("seek to target start position "+i+" from current time "+t+". ready state "+e.readyState),e.currentTime=i}},s._getAudioCodec=function(e){var t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&(c.b.log("swapping playlist audio codec"),t&&(t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),t},(n=[{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,c.b.log("main stream-controller: "+t+"->"+e),this.hls.trigger(l.a.STREAM_STATE_TRANSITION,{previousState:t,nextState:e})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var e=this.media;if(e){var t=this.getBufferedFrag(e.currentTime);if(t)return t.level}return-1}},{key:"nextBufferedFrag",get:function(){var e=this.media;return e?this.followingBufferedFrag(this.getBufferedFrag(e.currentTime)):null}},{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e}}])&&function(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(r.prototype,n),r}(Ae),Ie=function(e){var t,i;function r(t){var i;return(i=e.call(this,t,l.a.MANIFEST_LOADED,l.a.LEVEL_LOADED,l.a.AUDIO_TRACK_SWITCHED,l.a.FRAG_LOADED,l.a.ERROR)||this).canload=!1,i.currentLevelIndex=null,i.manualLevelIndex=-1,i.timer=null,de=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n,a=r.prototype;return a.onHandlerDestroying=function(){this.clearTimer(),this.manualLevelIndex=-1},a.clearTimer=function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},a.startLoad=function(){var e=this._levels;this.canload=!0,this.levelRetryCount=0,e&&e.forEach((function(e){e.loadError=0;var t=e.details;t&&t.live&&(e.details=void 0)})),null!==this.timer&&this.loadLevel()},a.stopLoad=function(){this.canload=!1},a.onManifestLoaded=function(e){var t,i=[],r=[],n={},a=null,s=!1,u=!1;if(e.levels.forEach((function(e){var t=e.attrs;e.loadError=0,e.fragmentError=!1,s=s||!!e.videoCodec,u=u||!!e.audioCodec,de&&e.audioCodec&&-1!==e.audioCodec.indexOf("mp4a.40.34")&&(e.audioCodec=void 0),(a=n[e.bitrate])?a.url.push(e.url):(e.url=[e.url],e.urlId=0,n[e.bitrate]=e,i.push(e)),t&&(t.AUDIO&&Q(a||e,"audio",t.AUDIO),t.SUBTITLES&&Q(a||e,"text",t.SUBTITLES))})),s&&u&&(i=i.filter((function(e){return!!e.videoCodec}))),i=i.filter((function(e){var t=e.audioCodec,i=e.videoCodec;return(!t||S(t,"audio"))&&(!i||S(i,"video"))})),e.audioTracks&&(r=e.audioTracks.filter((function(e){return!e.audioCodec||S(e.audioCodec,"audio")}))).forEach((function(e,t){e.id=t})),i.length>0){t=i[0].bitrate,i.sort((function(e,t){return e.bitrate-t.bitrate})),this._levels=i;for(var d=0;d<i.length;d++)if(i[d].bitrate===t){this._firstLevel=d,c.b.log("manifest loaded,"+i.length+" level(s) found, first bitrate:"+t);break}this.hls.trigger(l.a.MANIFEST_PARSED,{levels:i,audioTracks:r,firstLevel:this._firstLevel,stats:e.stats,audio:u,video:s,altAudio:!(u&&!s)&&r.some((function(e){return!!e.url}))})}else this.hls.trigger(l.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},a.setLevelInternal=function(e){var t=this._levels,i=this.hls;if(e>=0&&e<t.length){if(this.clearTimer(),this.currentLevelIndex!==e){c.b.log("switching to level "+e),this.currentLevelIndex=e;var r=t[e];r.level=e,i.trigger(l.a.LEVEL_SWITCHING,r)}var n=t[e],a=n.details;if(!a||a.live){var s=n.urlId;i.trigger(l.a.LEVEL_LOADING,{url:n.url[s],level:e,id:s})}}else i.trigger(l.a.ERROR,{type:o.b.OTHER_ERROR,details:o.a.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})},a.onError=function(e){if(e.fatal)e.type===o.b.NETWORK_ERROR&&this.clearTimer();else{var t,i=!1,r=!1;switch(e.details){case o.a.FRAG_LOAD_ERROR:case o.a.FRAG_LOAD_TIMEOUT:case o.a.KEY_LOAD_ERROR:case o.a.KEY_LOAD_TIMEOUT:t=e.frag.level,r=!0;break;case o.a.LEVEL_LOAD_ERROR:case o.a.LEVEL_LOAD_TIMEOUT:t=e.context.level,i=!0;break;case o.a.REMUX_ALLOC_ERROR:t=e.level,i=!0}void 0!==t&&this.recoverLevel(e,t,i,r)}},a.recoverLevel=function(e,t,i,r){var n,a,s,o=this,u=this.hls.config,l=e.details,d=this._levels[t];if(d.loadError++,d.fragmentError=r,i){if(!(this.levelRetryCount+1<=u.levelLoadingMaxRetry))return c.b.error("level controller, cannot recover from "+l+" error"),this.currentLevelIndex=null,this.clearTimer(),void(e.fatal=!0);a=Math.min(Math.pow(2,this.levelRetryCount)*u.levelLoadingRetryDelay,u.levelLoadingMaxRetryTimeout),this.timer=setTimeout((function(){return o.loadLevel()}),a),e.levelRetry=!0,this.levelRetryCount++,c.b.warn("level controller, "+l+", retry in "+a+" ms, current retry count is "+this.levelRetryCount)}(i||r)&&((n=d.url.length)>1&&d.loadError<n?(d.urlId=(d.urlId+1)%n,d.details=void 0,c.b.warn("level controller, "+l+" for level "+t+": switching to redundant URL-id "+d.urlId)):-1===this.manualLevelIndex?(c.b.warn("level controller, "+l+": switch to "+(s=0===t?this._levels.length-1:t-1)),this.hls.nextAutoLevel=this.currentLevelIndex=s):r&&(c.b.warn("level controller, "+l+": reload a fragment"),this.currentLevelIndex=null))},a.onFragLoaded=function(e){var t=e.frag;if(void 0!==t&&"main"===t.type){var i=this._levels[t.level];void 0!==i&&(i.fragmentError=!1,i.loadError=0,this.levelRetryCount=0)}},a.onLevelLoaded=function(e){var t=this,i=e.level,r=e.details;if(i===this.currentLevelIndex){var n=this._levels[i];if(n.fragmentError||(n.loadError=0,this.levelRetryCount=0),r.live){var a=te(n.details,r,e.stats.trequest);c.b.log("live playlist, reload in "+Math.round(a)+" ms"),this.timer=setTimeout((function(){return t.loadLevel()}),a)}else this.clearTimer()}},a.onAudioTrackSwitched=function(e){var t=this.hls.audioTracks[e.id].groupId,i=this.hls.levels[this.currentLevelIndex];if(i&&i.audioGroupIds){for(var r=-1,n=0;n<i.audioGroupIds.length;n++)if(i.audioGroupIds[n]===t){r=n;break}r!==i.urlId&&(i.urlId=r,this.startLoad())}},a.loadLevel=function(){if(c.b.debug("call to loadLevel"),null!==this.currentLevelIndex&&this.canload){var e=this._levels[this.currentLevelIndex];if("object"==typeof e&&e.url.length>0){var t=this.currentLevelIndex,i=e.urlId,r=e.url[i];c.b.log("Attempt loading level index "+t+" with URL-id "+i),this.hls.trigger(l.a.LEVEL_LOADING,{url:r,level:t,id:i})}}},a.removeLevel=function(e,t){var i=this.levels.filter((function(i,r){return r!==e||i.url.length>1&&void 0!==t&&(i.url=i.url.filter((function(e,i){return i!==t})),i.urlId=0,!0)})).map((function(e,t){var i=e.details;return i&&i.fragments&&i.fragments.forEach((function(e){e.level=t})),e}));this._levels=i,this.hls.trigger(l.a.LEVELS_UPDATED,{levels:i})},(n=[{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(e){var t=this._levels;t&&(e=Math.min(e,t.length-1),this.currentLevelIndex===e&&t[e].details||this.setLevelInternal(e))}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel},set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}}])&&function(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(r.prototype,n),r}(h),Re=i(4);function De(e,t){var i;try{i=new Event("addtrack")}catch(e){(i=document.createEvent("Event")).initEvent("addtrack",!1,!1)}i.track=e,t.dispatchEvent(i)}function Oe(e){if(null==e?void 0:e.cues)for(;e.cues.length>0;)e.removeCue(e.cues[0])}var xe=function(e){var t,i;function r(t){var i;return(i=e.call(this,t,l.a.MEDIA_ATTACHED,l.a.MEDIA_DETACHING,l.a.FRAG_PARSING_METADATA,l.a.LIVE_BACK_BUFFER_REACHED)||this).id3Track=void 0,i.media=void 0,i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n=r.prototype;return n.destroy=function(){h.prototype.destroy.call(this)},n.onMediaAttached=function(e){this.media=e.media},n.onMediaDetaching=function(){Oe(this.id3Track),this.id3Track=void 0,this.media=void 0},n.getID3Track=function(e){for(var t=0;t<e.length;t++){var i=e[t];if("metadata"===i.kind&&"id3"===i.label)return De(i,this.media),i}return this.media.addTextTrack("metadata","id3")},n.onFragParsingMetadata=function(e){var t=e.frag,i=e.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var r=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,n=0;n<i.length;n++){var a=Re.a.getID3Frames(i[n].data);if(a){var s=Math.max(i[n].pts,0),o=n<i.length-1?i[n+1].pts:t.endPTS;o||(o=t.start+t.duration),o-s<=0&&(o=s+.25);for(var u=0;u<a.length;u++){var l=a[u];if(!Re.a.isTimeStampFrame(l)){var c=new r(s,o,"");c.value=l,this.id3Track.addCue(c)}}}}},n.onLiveBackBufferReached=function(e){var t=this.id3Track;if(t&&t.cues&&t.cues.length){var i=function(e,t){if(t<e[0].endTime)return e[0];if(t>e[e.length-1].endTime)return e[e.length-1];for(var i=0,r=e.length-1;i<=r;){var n=Math.floor((r+i)/2);if(t<e[n].endTime)r=n-1;else{if(!(t>e[n].endTime))return e[n];i=n+1}}return e[i].endTime-t<t-e[r].endTime?e[i]:e[r]}(t.cues,e.bufferEnd);if(i)for(;t.cues[0]!==i;)t.removeCue(t.cues[0])}},r}(h),Pe=function(){function e(e){this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=0,this.totalWeight_=0}var t=e.prototype;return t.sample=function(e,t){var i=Math.pow(this.alpha_,e);this.estimate_=t*(1-i)+i*this.estimate_,this.totalWeight_+=e},t.getTotalWeight=function(){return this.totalWeight_},t.getEstimate=function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_},e}(),Me=function(){function e(e,t,i,r){this.hls=void 0,this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.hls=e,this.defaultEstimate_=r,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Pe(t),this.fast_=new Pe(i)}var t=e.prototype;return t.sample=function(e,t){var i=(e=Math.max(e,this.minDelayMs_))/1e3,r=8*t/i;this.fast_.sample(i,r),this.slow_.sample(i,r)},t.canEstimate=function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_},t.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},t.destroy=function(){},e}(),Ne=window.performance,Ue=function(e){var t,i;function r(t){var i;return(i=e.call(this,t,l.a.FRAG_LOADING,l.a.FRAG_LOADED,l.a.FRAG_BUFFERED,l.a.ERROR)||this).lastLoadedFragLevel=0,i._nextAutoLevel=-1,i.hls=t,i.timer=null,i._bwEstimator=null,i.onCheck=i._abandonRulesCheck.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(i)),i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n,a=r.prototype;return a.destroy=function(){this.clearTimer(),h.prototype.destroy.call(this)},a.onFragLoading=function(e){var t=e.frag;if("main"===t.type&&(this.timer||(this.fragCurrent=t,this.timer=setInterval(this.onCheck,100)),!this._bwEstimator)){var i,r,n=this.hls,a=n.config;n.levels[t.level].details.live?(i=a.abrEwmaFastLive,r=a.abrEwmaSlowLive):(i=a.abrEwmaFastVoD,r=a.abrEwmaSlowVoD),this._bwEstimator=new Me(n,r,i,a.abrEwmaDefaultEstimate)}},a._abandonRulesCheck=function(){var e=this.hls,t=e.media,i=this.fragCurrent;if(i){var r=i.loader;if(!r||r.stats&&r.stats.aborted)return c.b.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);var n=r.stats;if(t&&n&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&i.autoLevel&&i.level){var a=Ne.now()-n.trequest,s=Math.abs(t.playbackRate);if(a>500*i.duration/s){var o=e.levels,u=Math.max(1,n.bw?n.bw/8:1e3*n.loaded/a),d=o[i.level];if(!d)return;var h=d.realBitrate?Math.max(d.realBitrate,d.bitrate):d.bitrate,f=n.total?n.total:Math.max(n.loaded,Math.round(i.duration*h/8)),p=t.currentTime,g=(f-n.loaded)/u,m=(j.bufferInfo(t,p,e.config.maxBufferHole).end-p)/s;if(m<2*i.duration/s&&g>m){var v,y=e.minAutoLevel;for(v=i.level-1;v>y;v--){var _=o[v].realBitrate?Math.max(o[v].realBitrate,o[v].bitrate):o[v].bitrate;if(i.duration*_/(6.4*u)<m)break}void 0<g&&(c.b.warn("loading too slow, abort fragment loading and switch to level "+v+":fragLoadedDelay["+v+"]<fragLoadedDelay["+(i.level-1)+"];bufferStarvationDelay:"+(void 0).toFixed(1)+"<"+g.toFixed(1)+":"+m.toFixed(1)),e.nextLoadLevel=v,this._bwEstimator.sample(a,n.loaded),r.abort(),this.clearTimer(),e.trigger(l.a.FRAG_LOAD_EMERGENCY_ABORTED,{frag:i,stats:n}))}}}}},a.onFragLoaded=function(e){var t=e.frag;if("main"===t.type&&Object(u.a)(t.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var i=this.hls.levels[t.level],r=(i.loaded?i.loaded.bytes:0)+e.stats.loaded,n=(i.loaded?i.loaded.duration:0)+e.frag.duration;i.loaded={bytes:r,duration:n},i.realBitrate=Math.round(8*r/n)}if(e.frag.bitrateTest){var a=e.stats;a.tparsed=a.tbuffered=a.tload,this.onFragBuffered(e)}}},a.onFragBuffered=function(e){var t=e.stats,i=e.frag;if(!0!==t.aborted&&"main"===i.type&&Object(u.a)(i.sn)&&(!i.bitrateTest||t.tload===t.tbuffered)){var r=t.tparsed-t.trequest;c.b.log("latency/loading/parsing/append/kbps:"+Math.round(t.tfirst-t.trequest)+"/"+Math.round(t.tload-t.tfirst)+"/"+Math.round(t.tparsed-t.tload)+"/"+Math.round(t.tbuffered-t.tparsed)+"/"+Math.round(8*t.loaded/(t.tbuffered-t.trequest))),this._bwEstimator.sample(r,t.loaded),t.bwEstimate=this._bwEstimator.getEstimate(),this.bitrateTestDelay=i.bitrateTest?r/1e3:0}},a.onError=function(e){switch(e.details){case o.a.FRAG_LOAD_ERROR:case o.a.FRAG_LOAD_TIMEOUT:this.clearTimer()}},a.clearTimer=function(){clearInterval(this.timer),this.timer=null},a._findBestLevel=function(e,t,i,r,n,a,s,o,u){for(var l=n;l>=r;l--){var d=u[l];if(d){var h,f=d.details,p=f?f.totalduration/f.fragments.length:t,g=!!f&&f.live;h=l<=e?s*i:o*i;var m=u[l].realBitrate?Math.max(u[l].realBitrate,u[l].bitrate):u[l].bitrate,v=m*p/h;if(c.b.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+l+"/"+Math.round(h)+"/"+m+"/"+p+"/"+a+"/"+v),h>m&&(!v||g&&!this.bitrateTestDelay||v<a))return l}}return-1},(n=[{key:"nextAutoLevel",get:function(){var e=this._nextAutoLevel,t=this._bwEstimator;if(!(-1===e||t&&t.canEstimate()))return e;var i=this._nextABRAutoLevel;return-1!==e&&(i=Math.min(e,i)),i},set:function(e){this._nextAutoLevel=e}},{key:"_nextABRAutoLevel",get:function(){var e=this.hls,t=e.maxAutoLevel,i=e.levels,r=e.config,n=e.minAutoLevel,a=e.media,s=this.lastLoadedFragLevel,o=this.fragCurrent?this.fragCurrent.duration:0,u=a?a.currentTime:0,l=a&&0!==a.playbackRate?Math.abs(a.playbackRate):1,d=this._bwEstimator?this._bwEstimator.getEstimate():r.abrEwmaDefaultEstimate,h=(j.bufferInfo(a,u,r.maxBufferHole).end-u)/l,f=this._findBestLevel(s,o,d,n,t,h,r.abrBandWidthFactor,r.abrBandWidthUpFactor,i);if(f>=0)return f;c.b.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var p=o?Math.min(o,r.maxStarvationDelay):r.maxStarvationDelay,g=r.abrBandWidthFactor,m=r.abrBandWidthUpFactor;if(0===h){var v=this.bitrateTestDelay;v&&(p=(o?Math.min(o,r.maxLoadingDelay):r.maxLoadingDelay)-v,c.b.trace("bitrate test took "+Math.round(1e3*v)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*p)+" ms"),g=m=1)}return f=this._findBestLevel(s,o,d,n,t,h+p,g,m,i),Math.max(f,0)}}])&&function(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(r.prototype,n),r}(h),Fe=q(),Be=function(e){var t,i;function r(t){var i;return(i=e.call(this,t,l.a.MEDIA_ATTACHING,l.a.MEDIA_DETACHING,l.a.MANIFEST_PARSED,l.a.BUFFER_RESET,l.a.BUFFER_APPENDING,l.a.BUFFER_CODECS,l.a.BUFFER_EOS,l.a.BUFFER_FLUSHING,l.a.LEVEL_PTS_UPDATED,l.a.LEVEL_UPDATED)||this)._msDuration=null,i._levelDuration=null,i._levelTargetDuration=10,i._live=null,i._objectUrl=null,i._needsFlush=!1,i._needsEos=!1,i.config=void 0,i.audioTimestampOffset=void 0,i.bufferCodecEventsExpected=0,i._bufferCodecEventsTotal=0,i.media=null,i.mediaSource=null,i.segments=[],i.parent=void 0,i.appending=!1,i.appended=0,i.appendError=0,i.flushBufferCounter=0,i.tracks={},i.pendingTracks={},i.sourceBuffer={},i.flushRange=[],i._onMediaSourceOpen=function(){c.b.log("media source opened"),i.hls.trigger(l.a.MEDIA_ATTACHED,{media:i.media});var e=i.mediaSource;e&&e.removeEventListener("sourceopen",i._onMediaSourceOpen),i.checkPendingTracks()},i._onMediaSourceClose=function(){c.b.log("media source closed")},i._onMediaSourceEnded=function(){c.b.log("media source ended")},i._onSBUpdateEnd=function(){if(i.audioTimestampOffset&&i.sourceBuffer.audio){var e=i.sourceBuffer.audio;c.b.warn("change mpeg audio timestamp offset from "+e.timestampOffset+" to "+i.audioTimestampOffset),e.timestampOffset=i.audioTimestampOffset,delete i.audioTimestampOffset}i._needsFlush&&i.doFlush(),i._needsEos&&i.checkEos(),i.appending=!1;var t=i.parent,r=i.segments.reduce((function(e,i){return i.parent===t?e+1:e}),0),n={},a=i.sourceBuffer;for(var s in a){var o=a[s];if(!o)throw Error("handling source buffer update end error: source buffer for "+s+" uninitilized and unable to update buffered TimeRanges.");n[s]=o.buffered}i.hls.trigger(l.a.BUFFER_APPENDED,{parent:t,pending:r,timeRanges:n}),i._needsFlush||i.doAppending(),i.updateMediaElementDuration(),0===r&&i.flushLiveBackBuffer()},i._onSBUpdateError=function(e){c.b.error("sourceBuffer error:",e),i.hls.trigger(l.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_APPENDING_ERROR,fatal:!1})},i.config=t.config,i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n=r.prototype;return n.destroy=function(){h.prototype.destroy.call(this)},n.onLevelPtsUpdated=function(e){var t=this.tracks.audio;if("audio"===e.type&&t&&"audio/mpeg"===t.container){var i=this.sourceBuffer.audio;if(!i)throw Error("Level PTS Updated and source buffer for audio uninitalized");if(Math.abs(i.timestampOffset-e.start)>.1){var r=i.updating;try{i.abort()}catch(e){c.b.warn("can not abort audio buffer: "+e)}r?this.audioTimestampOffset=e.start:(c.b.warn("change mpeg audio timestamp offset from "+i.timestampOffset+" to "+e.start),i.timestampOffset=e.start)}}},n.onManifestParsed=function(e){var t=2;(e.audio&&!e.video||!e.altAudio)&&(t=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=t,c.b.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},n.onMediaAttaching=function(e){var t=this.media=e.media;if(t&&Fe){var i=this.mediaSource=new Fe;i.addEventListener("sourceopen",this._onMediaSourceOpen),i.addEventListener("sourceended",this._onMediaSourceEnded),i.addEventListener("sourceclose",this._onMediaSourceClose),t.src=window.URL.createObjectURL(i),this._objectUrl=t.src}},n.onMediaDetaching=function(){c.b.log("media source detaching");var e=this.mediaSource;if(e){if("open"===e.readyState)try{e.endOfStream()}catch(e){c.b.warn("onMediaDetaching:"+e.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this._onMediaSourceOpen),e.removeEventListener("sourceended",this._onMediaSourceEnded),e.removeEventListener("sourceclose",this._onMediaSourceClose),this.media&&(this._objectUrl&&window.URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):c.b.warn("media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.hls.trigger(l.a.MEDIA_DETACHED)},n.checkPendingTracks=function(){var e=this.bufferCodecEventsExpected,t=this.pendingTracks,i=Object.keys(t).length;(i&&!e||2===i)&&(this.createSourceBuffers(t),this.pendingTracks={},this.doAppending())},n.onBufferReset=function(){var e=this.sourceBuffer;for(var t in e){var i=e[t];try{i&&(this.mediaSource&&this.mediaSource.removeSourceBuffer(i),i.removeEventListener("updateend",this._onSBUpdateEnd),i.removeEventListener("error",this._onSBUpdateError))}catch(e){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},n.onBufferCodecs=function(e){var t=this;Object.keys(this.sourceBuffer).length||(Object.keys(e).forEach((function(i){t.pendingTracks[i]=e[i]})),this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())},n.createSourceBuffers=function(e){var t=this.sourceBuffer,i=this.mediaSource;if(!i)throw Error("createSourceBuffers called when mediaSource was null");for(var r in e)if(!t[r]){var n=e[r];if(!n)throw Error("source buffer exists for track "+r+", however track does not");var a=n.levelCodec||n.codec,s=n.container+";codecs="+a;c.b.log("creating sourceBuffer("+s+")");try{var u=t[r]=i.addSourceBuffer(s);u.addEventListener("updateend",this._onSBUpdateEnd),u.addEventListener("error",this._onSBUpdateError),this.tracks[r]={buffer:u,codec:a,id:n.id,container:n.container,levelCodec:n.levelCodec}}catch(e){c.b.error("error while trying to add sourceBuffer:"+e.message),this.hls.trigger(l.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:e,mimeType:s})}}this.hls.trigger(l.a.BUFFER_CREATED,{tracks:this.tracks})},n.onBufferAppending=function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())},n.onBufferEos=function(e){for(var t in this.sourceBuffer)if(!e.type||e.type===t){var i=this.sourceBuffer[t];i&&!i.ended&&(i.ended=!0,c.b.log(t+" sourceBuffer now EOS"))}this.checkEos()},n.checkEos=function(){var e=this.sourceBuffer,t=this.mediaSource;if(t&&"open"===t.readyState){for(var i in e){var r=e[i];if(r){if(!r.ended)return;if(r.updating)return void(this._needsEos=!0)}}c.b.log("all media data are available, signal endOfStream() to MediaSource and stop loading fragment");try{t.endOfStream()}catch(e){c.b.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1},n.onBufferFlushing=function(e){e.type?this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}):(this.flushRange.push({start:e.startOffset,end:e.endOffset,type:"video"}),this.flushRange.push({start:e.startOffset,end:e.endOffset,type:"audio"})),this.flushBufferCounter=0,this.doFlush()},n.flushLiveBackBuffer=function(){if(this._live){var e=this.config.liveBackBufferLength;if(isFinite(e)&&!(e<0))if(this.media)for(var t=this.media.currentTime,i=this.sourceBuffer,r=Object.keys(i),n=t-Math.max(e,this._levelTargetDuration),a=r.length-1;a>=0;a--){var s=r[a],o=i[s];if(o){var u=o.buffered;u.length>0&&n>u.start(0)&&this.removeBufferRange(s,o,0,n)&&this.hls.trigger(l.a.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n})}}else c.b.error("flushLiveBackBuffer called without attaching media")}},n.onLevelUpdated=function(e){var t=e.details;t.fragments.length>0&&(this._levelDuration=t.totalduration+t.fragments[0].start,this._levelTargetDuration=t.averagetargetduration||t.targetduration||10,this._live=t.live,this.updateMediaElementDuration())},n.updateMediaElementDuration=function(){var e,t=this.config;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(var i in this.sourceBuffer){var r=this.sourceBuffer[i];if(r&&!0===r.updating)return}e=this.media.duration,null===this._msDuration&&(this._msDuration=this.mediaSource.duration),!0===this._live&&!0===t.liveDurationInfinity?(c.b.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>e||!Object(u.a)(e))&&(c.b.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},n.doFlush=function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,i=this.sourceBuffer;try{for(var r in i){var n=i[r];n&&(t+=n.buffered.length)}}catch(e){c.b.error("error while accessing sourceBuffer.buffered")}this.appended=t,this.hls.trigger(l.a.BUFFER_FLUSHED)}},n.doAppending=function(){var e=this.config,t=this.hls,i=this.segments,r=this.sourceBuffer;if(Object.keys(r).length){if(!this.media||this.media.error)return this.segments=[],void c.b.error("trying to append although a media error occured, flush segment and abort");if(!this.appending){var n=i.shift();if(n)try{var a=r[n.type];if(!a)return void this._onSBUpdateEnd();if(a.updating)return void i.unshift(n);a.ended=!1,this.parent=n.parent,a.appendBuffer(n.data),this.appendError=0,this.appended++,this.appending=!0}catch(r){c.b.error("error while trying to append buffer:"+r.message),i.unshift(n);var s={type:o.b.MEDIA_ERROR,parent:n.parent,details:"",fatal:!1};22===r.code?(this.segments=[],s.details=o.a.BUFFER_FULL_ERROR):(this.appendError++,s.details=o.a.BUFFER_APPEND_ERROR,this.appendError>e.appendErrorMaxRetry&&(c.b.log("fail "+e.appendErrorMaxRetry+" times to append segment in sourceBuffer"),this.segments=[],s.fatal=!0)),t.trigger(l.a.ERROR,s)}}}},n.flushBuffer=function(e,t,i){var r=this.sourceBuffer;if(!Object.keys(r).length)return!0;var n="null";if(this.media&&(n=this.media.currentTime.toFixed(3)),c.b.log("flushBuffer,pos/start/end: "+n+"/"+e+"/"+t),this.flushBufferCounter>=this.appended)return c.b.warn("abort flushing too many retries"),!0;var a=r[i];if(a){if(a.ended=!1,a.updating)return c.b.warn("cannot flush, sb updating in progress"),!1;if(this.removeBufferRange(i,a,e,t))return this.flushBufferCounter++,!1}return c.b.log("buffer flushed"),!0},n.removeBufferRange=function(e,t,i,r){try{for(var n=0;n<t.buffered.length;n++){var a=t.buffered.start(n),s=t.buffered.end(n),o=Math.max(a,i),u=Math.min(s,r);if(Math.min(u,s)-o>.5){var l="null";return this.media&&(l=this.media.currentTime.toString()),c.b.log("sb remove "+e+" ["+o+","+u+"], of ["+a+","+s+"], pos:"+l),t.remove(o,u),!0}}}catch(e){c.b.warn("removeBufferRange failed",e)}return!1},r}(h);function je(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ve=function(e){var t,i;function r(t){var i;return(i=e.call(this,t,l.a.FPS_DROP_LEVEL_CAPPING,l.a.MEDIA_ATTACHING,l.a.MANIFEST_PARSED,l.a.LEVELS_UPDATED,l.a.BUFFER_CODECS,l.a.MEDIA_DETACHING)||this).autoLevelCapping=Number.POSITIVE_INFINITY,i.firstLevel=null,i.levels=[],i.media=null,i.restrictedLevels=[],i.timer=null,i.clientRect=null,i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n,a,s,o=r.prototype;return o.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this.clientRect=null,this.stopCapping())},o.onFpsDropLevelCapping=function(e){r.isLevelAllowed(e.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(e.droppedLevel)},o.onMediaAttaching=function(e){this.media=e.media instanceof window.HTMLVideoElement?e.media:null},o.onManifestParsed=function(e){var t=this.hls;this.restrictedLevels=[],this.levels=e.levels,this.firstLevel=e.firstLevel,t.config.capLevelToPlayerSize&&e.video&&this.startCapping()},o.onBufferCodecs=function(e){this.hls.config.capLevelToPlayerSize&&e.video&&this.startCapping()},o.onLevelsUpdated=function(e){this.levels=e.levels},o.onMediaDetaching=function(){this.stopCapping()},o.detectPlayerSize=function(){if(this.media){var e=this.levels?this.levels.length:0;if(e){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e-1),t.autoLevelCapping>this.autoLevelCapping&&t.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}},o.getMaxLevel=function(e){var t=this;if(!this.levels)return-1;var i=this.levels.filter((function(i,n){return r.isLevelAllowed(n,t.restrictedLevels)&&n<=e}));return this.clientRect=null,r.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)},o.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},o.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer),this.timer=null)},o.getDimensions=function(){if(this.clientRect)return this.clientRect;var e=this.media,t={width:0,height:0};if(e){var i=e.getBoundingClientRect();t.width=i.width,t.height=i.height,t.width||t.height||(t.width=i.right-i.left||e.width||0,t.height=i.bottom-i.top||e.height||0)}return this.clientRect=t,t},r.isLevelAllowed=function(e,t){return void 0===t&&(t=[]),-1===t.indexOf(e)},r.getMaxLevelByMediaSize=function(e,t,i){if(!e||e&&!e.length)return-1;for(var r,n,a=e.length-1,s=0;s<e.length;s+=1){var o=e[s];if((o.width>=t||o.height>=i)&&(r=o,!(n=e[s+1])||r.width!==n.width||r.height!==n.height)){a=s;break}}return a},n=r,s=[{key:"contentScaleFactor",get:function(){var e=1;try{e=window.devicePixelRatio}catch(e){}return e}}],(a=[{key:"mediaWidth",get:function(){return this.getDimensions().width*r.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*r.contentScaleFactor}}])&&je(n.prototype,a),s&&je(n,s),r}(h),He=window.performance,Ge=function(e){var t,i;function r(t){return e.call(this,t,l.a.MEDIA_ATTACHING)||this}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n=r.prototype;return n.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},n.onMediaAttaching=function(e){var t=this.hls.config;t.capLevelOnFPSDrop&&("function"==typeof(this.video=e.media instanceof window.HTMLVideoElement?e.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod))},n.checkFPS=function(e,t,i){var r=He.now();if(t){if(this.lastTime){var n=i-this.lastDroppedFrames,a=t-this.lastDecodedFrames,s=1e3*n/(r-this.lastTime),o=this.hls;if(o.trigger(l.a.FPS_DROP,{currentDropped:n,currentDecoded:a,totalDroppedFrames:i}),s>0&&n>o.config.fpsDroppedMonitoringThreshold*a){var u=o.currentLevel;c.b.warn("drop FPS ratio greater than max allowed value for currentLevel: "+u),u>0&&(-1===o.autoLevelCapping||o.autoLevelCapping>=u)&&(o.trigger(l.a.FPS_DROP_LEVEL_CAPPING,{level:u-=1,droppedLevel:o.currentLevel}),o.autoLevelCapping=u,o.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=i,this.lastDecodedFrames=t}},n.checkFPSInterval=function(){var e=this.video;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)},r}(h),qe=function(){function e(e){e&&e.xhrSetup&&(this.xhrSetup=e.xhrSetup)}var t=e.prototype;return t.destroy=function(){this.abort(),this.loader=null},t.abort=function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},t.load=function(e,t,i){this.context=e,this.config=t,this.callbacks=i,this.stats={trequest:window.performance.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()},t.loadInternal=function(){var e,t=this.context;e=this.loader=new window.XMLHttpRequest;var i=this.stats;i.tfirst=0,i.loaded=0;var r=this.xhrSetup;try{if(r)try{r(e,t.url)}catch(i){e.open("GET",t.url,!0),r(e,t.url)}e.readyState||e.open("GET",t.url,!0)}catch(i){return void this.callbacks.onError({code:e.status,text:i.message},t,e)}t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),e.send()},t.readystatechange=function(e){var t=e.currentTarget,i=t.readyState,r=this.stats,n=this.context,a=this.config;if(!r.aborted&&i>=2)if(window.clearTimeout(this.requestTimeout),0===r.tfirst&&(r.tfirst=Math.max(window.performance.now(),r.trequest)),4===i){var s,o,u=t.status;u>=200&&u<300?(r.tload=Math.max(r.tfirst,window.performance.now()),o="arraybuffer"===n.responseType?(s=t.response).byteLength:(s=t.responseText).length,r.loaded=r.total=o,this.callbacks.onSuccess({url:t.responseURL,data:s},r,n,t)):r.retry>=a.maxRetry||u>=400&&u<499?(c.b.error(u+" while loading "+n.url),this.callbacks.onError({code:u,text:t.statusText},n,t)):(c.b.warn(u+" while loading "+n.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,a.maxRetryDelay),r.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),a.timeout)},t.loadtimeout=function(){c.b.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},t.loadprogress=function(e){var t=e.currentTarget,i=this.stats;i.loaded=e.loaded,e.lengthComputable&&(i.total=e.total);var r=this.callbacks.onProgress;r&&r(i,this.context,null,t)},e}(),Ke=function(e){var t,i;function r(t){var i;return(i=e.call(this,t,l.a.MANIFEST_LOADING,l.a.MANIFEST_PARSED,l.a.AUDIO_TRACK_LOADED,l.a.AUDIO_TRACK_SWITCHED,l.a.LEVEL_LOADED,l.a.ERROR)||this)._trackId=-1,i._selectDefaultTrack=!0,i.tracks=[],i.trackIdBlacklist=Object.create(null),i.audioGroupId=null,i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n,a=r.prototype;return a.onManifestLoading=function(){this.tracks=[],this._trackId=-1,this._selectDefaultTrack=!0},a.onManifestParsed=function(e){var t=this.tracks=e.audioTracks||[];this.hls.trigger(l.a.AUDIO_TRACKS_UPDATED,{audioTracks:t}),this._selectAudioGroup(this.hls.nextLoadLevel)},a.onAudioTrackLoaded=function(e){e.id>=this.tracks.length?c.b.warn("Invalid audio track id:",e.id):(c.b.log("audioTrack "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.hasInterval()&&this.setInterval(1e3*e.details.targetduration),!e.details.live&&this.hasInterval()&&this.clearInterval())},a.onAudioTrackSwitched=function(e){var t=this.tracks[e.id].groupId;t&&this.audioGroupId!==t&&(this.audioGroupId=t)},a.onLevelLoaded=function(e){this._selectAudioGroup(e.level)},a.onError=function(e){e.type===o.b.NETWORK_ERROR&&(e.fatal&&this.clearInterval(),e.details===o.a.AUDIO_TRACK_LOAD_ERROR&&(c.b.warn("Network failure on audio-track id:",e.context.id),this._handleLoadError()))},a._setAudioTrack=function(e){if(this._trackId===e&&this.tracks[this._trackId].details)c.b.debug("Same id as current audio-track passed, and track details available -> no-op");else if(e<0||e>=this.tracks.length)c.b.warn("Invalid id passed to audio-track controller");else{var t=this.tracks[e];c.b.log("Now switching to audio-track index "+e),this.clearInterval(),this._trackId=e,this.hls.trigger(l.a.AUDIO_TRACK_SWITCHING,{id:t.id,type:t.type,url:t.url}),this._loadTrackDetailsIfNeeded(t)}},a.doTick=function(){this._updateTrack(this._trackId)},a._selectAudioGroup=function(e){var t=this.hls.levels[e];if(t&&t.audioGroupIds){var i=t.audioGroupIds[t.urlId];this.audioGroupId!==i&&(this.audioGroupId=i,this._selectInitialAudioTrack())}},a._selectInitialAudioTrack=function(){var e=this,t=this.tracks;if(t.length){var i=this.tracks[this._trackId],r=null;if(i&&(r=i.name),this._selectDefaultTrack){var n=t.filter((function(e){return e.default}));n.length?t=n:c.b.warn("No default audio tracks defined")}var a=!1,s=function(){t.forEach((function(t){a||e.audioGroupId&&t.groupId!==e.audioGroupId||r&&r!==t.name||(e._setAudioTrack(t.id),a=!0)}))};s(),a||(r=null,s()),a||(c.b.error("No track found for running audio group-ID: "+this.audioGroupId),this.hls.trigger(l.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))}},a._needsTrackLoading=function(e){var t=e.details;return!(t&&!t.live||!e.url)},a._loadTrackDetailsIfNeeded=function(e){if(this._needsTrackLoading(e)){var t=e.url,i=e.id;c.b.log("loading audio-track playlist for id: "+i),this.hls.trigger(l.a.AUDIO_TRACK_LOADING,{url:t,id:i})}},a._updateTrack=function(e){e<0||e>=this.tracks.length||(this.clearInterval(),this._trackId=e,c.b.log("trying to update audio-track "+e),this._loadTrackDetailsIfNeeded(this.tracks[e]))},a._handleLoadError=function(){this.trackIdBlacklist[this._trackId]=!0;var e=this._trackId,t=this.tracks[e],i=t.name,r=t.language;c.b.warn("Loading failed on audio track id: "+e+", group-id: "+t.groupId+', name/language: "'+i+'" / "'+r+'"');for(var n=e,a=0;a<this.tracks.length;a++)if(!this.trackIdBlacklist[a]&&this.tracks[a].name===i){n=a;break}n!==e?(c.b.log("Attempting audio-track fallback id:",n,"group-id:",this.tracks[n].groupId),this._setAudioTrack(n)):c.b.warn('No fallback audio-track found for name/language: "'+i+'" / "'+r+'"')},(n=[{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this._trackId},set:function(e){this._setAudioTrack(e),this._selectDefaultTrack=!1}}])&&function(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(r.prototype,n),r}(he),We=window.performance,ze=function(e){var t,i;function r(t,i){var r;return(r=e.call(this,t,l.a.MEDIA_ATTACHED,l.a.MEDIA_DETACHING,l.a.AUDIO_TRACKS_UPDATED,l.a.AUDIO_TRACK_SWITCHING,l.a.AUDIO_TRACK_LOADED,l.a.KEY_LOADED,l.a.FRAG_LOADED,l.a.FRAG_PARSING_INIT_SEGMENT,l.a.FRAG_PARSING_DATA,l.a.FRAG_PARSED,l.a.ERROR,l.a.BUFFER_RESET,l.a.BUFFER_CREATED,l.a.BUFFER_APPENDED,l.a.BUFFER_FLUSHED,l.a.INIT_PTS_FOUND)||this).fragmentTracker=i,r.config=t.config,r.audioCodecSwap=!1,r._state=fe,r.initPTS=[],r.waitingFragment=null,r.videoTrackCC=null,r.waitingVideoCC=null,r}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n,a=r.prototype;return a.onInitPtsFound=function(e){var t=e.frag.cc,i=e.initPTS;"main"===e.id&&(this.initPTS[t]=i,this.videoTrackCC=t,c.b.log("InitPTS for cc: "+t+" found from main: "+i),this.state===we&&this.tick())},a.startLoad=function(e){if(this.tracks){var t=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,t>0&&-1===e?(c.b.log("audio:override startPosition with lastCurrentTime @"+t.toFixed(3)),this.state=ge):(this.lastCurrentTime=this.startPosition?this.startPosition:e,this.state=pe),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=e,this.state=fe},a.doTick=function(){var e,t,i,r=this.hls,n=r.config;switch(this.state){case ke:case"PAUSED":case Se:break;case pe:this.state=_e,this.loadedmetadata=!1;break;case ge:var a=this.tracks;if(!a)break;if(!this.media&&(this.startFragRequested||!n.startFragPrefetch))break;if(this.loadedmetadata)e=this.media.currentTime;else if(void 0===(e=this.nextLoadPosition))break;var s=this.mediaBuffer?this.mediaBuffer:this.media,o=this.videoBuffer?this.videoBuffer:this.media,d=e<n.maxBufferHole?Math.max(2,n.maxBufferHole):n.maxBufferHole,h=j.bufferInfo(s,e,d),f=j.bufferInfo(o,e,d),p=h.len,g=h.end,m=this.fragPrevious,v=Math.min(n.maxBufferLength,n.maxMaxBufferLength),y=Math.max(v,f.len),_=this.audioSwitch,b=this.trackId;if((p<y||_)&&b<a.length){if(void 0===(i=a[b].details)){this.state=_e;break}if(!_&&this._streamEnded(h,i))return this.hls.trigger(l.a.BUFFER_EOS,{type:"audio"}),void(this.state=Ee);var T,S=i.fragments,E=S.length,k=S[0].start,w=S[E-1].start+S[E-1].duration;if(_)if(i.live&&!i.PTSKnown)c.b.log("switching audiotrack, live stream, unknown PTS,load first fragment"),g=0;else if(g=e,i.PTSKnown&&e<k){if(!(h.end>k||h.nextStart))return;c.b.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=k+.05}if(i.initSegment&&!i.initSegment.data)T=i.initSegment;else if(g<=k){if(T=S[0],null!==this.videoTrackCC&&T.cc!==this.videoTrackCC&&(T=function(e,t){return B(e,(function(e){return e.cc<t?1:e.cc>t?-1:0}))}(S,this.videoTrackCC)),i.live&&T.loadIdx&&T.loadIdx===this.fragLoadIdx){var C=h.nextStart?h.nextStart:k;return c.b.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(C+.05)),void(this.media.currentTime=C+.05)}}else{var A,L=n.maxFragLookUpTolerance,I=m?S[m.sn-S[0].sn+1]:void 0;g<w?(g>w-L&&(L=0),A=I&&!oe(g,L,I)?I:B(S,(function(e){return oe(g,L,e)}))):A=S[E-1],A&&(T=A,k=A.start,m&&T.level===m.level&&T.sn===m.sn&&(T.sn<i.endSN?this.fragmentTracker.getState(T=S[T.sn+1-i.startSN])!==U&&c.b.log("SN just loaded, load next one: "+T.sn):T=null))}T&&(T.encrypted?(c.b.log("Loading key for "+T.sn+" of ["+i.startSN+" ,"+i.endSN+"],track "+b),this.state=me,r.trigger(l.a.KEY_LOADING,{frag:T})):(this.fragCurrent=T,(_||this.fragmentTracker.getState(T)===P)&&(c.b.log("Loading "+T.sn+", cc: "+T.cc+" of ["+i.startSN+" ,"+i.endSN+"],track "+b+", "+(this.loadedmetadata?"currentTime":"nextLoadPosition")+": "+e+", bufferEnd: "+g.toFixed(3)),"initSegment"!==T.sn&&(this.startFragRequested=!0),Object(u.a)(T.sn)&&(this.nextLoadPosition=T.start+T.duration),r.trigger(l.a.FRAG_LOADING,{frag:T}),this.state=ve)))}break;case _e:(t=this.tracks[this.trackId])&&t.details&&(this.state=ge);break;case ye:var R=We.now(),D=this.retryDate,O=(s=this.media)&&s.seeking;(!D||R>=D||O)&&(c.b.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=ge);break;case we:var x=this.waitingFragment;if(x){var M=x.frag.cc;if(void 0!==this.initPTS[M])this.waitingFragment=null,this.state=ve,this.onFragLoaded(x);else if(this.videoTrackCC!==this.waitingVideoCC)c.b.log("Waiting fragment cc ("+M+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var N=j.bufferInfo(this.mediaBuffer,this.media.currentTime,n.maxBufferHole);oe(N.end,n.maxFragLookUpTolerance,x.frag)<0&&(c.b.log("Waiting fragment cc ("+M+") @ "+x.frag.start+" cancelled because another fragment at "+N.end+" is needed"),this.clearWaitingFragment())}}else this.state=ge}},a.clearWaitingFragment=function(){var e=this.waitingFragment;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingFragment=null,this.waitingVideoCC=null,this.state=ge)},a.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("ended",this.onvended);var i=this.config;this.tracks&&i.autoStartLoad&&this.startLoad(i.startPosition)},a.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(c.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},a.onAudioTracksUpdated=function(e){c.b.log("audio tracks updated"),this.tracks=e.audioTracks},a.onAudioTrackSwitching=function(e){var t=!!e.url;this.trackId=e.id,this.fragCurrent=null,this.clearWaitingFragment(),this.state="PAUSED",t?this.setInterval(100):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),t&&(this.audioSwitch=!0,this.state=ge),this.tick()},a.onAudioTrackLoaded=function(e){var t=e.details,i=e.id,r=this.tracks[i],n=r.details,a=0;if(c.b.log("track "+i+" loaded ["+t.startSN+","+t.endSN+"],duration:"+t.totalduration),t.live||n&&n.live?n&&t.fragments.length>0?(Z(n,t),a=t.fragments[0].start,c.b.log(t.PTSKnown?"live audio playlist sliding:"+a.toFixed(3):"live audio playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,c.b.log("live audio playlist - first load, unknown sliding")):t.PTSKnown=!1,r.details=t,!this.startFragRequested){if(-1===this.startPosition){var s=t.startTimeOffset;Object(u.a)(s)?(c.b.log("start time offset found in playlist, adjust startPosition to "+s),this.startPosition=s):t.live?(this.startPosition=this.computeLivePosition(a,t),c.b.log("compute startPosition for audio-track to "+this.startPosition)):this.startPosition=0}this.nextLoadPosition=this.startPosition}this.state===_e&&(this.state=ge),this.tick()},a.onKeyLoaded=function(){this.state===me&&(this.state=ge,this.tick())},a.onFragLoaded=function(e){var t=this.fragCurrent,i=e.frag;if(this.state===ve&&t&&"audio"===i.type&&i.level===t.level&&i.sn===t.sn){var r=this.tracks[this.trackId],n=r.details,a=n.totalduration,s=t.level,o=t.sn,u=t.cc,d=this.config.defaultAudioCodec||r.audioCodec||"mp4a.40.2",h=this.stats=e.stats;if("initSegment"===o)this.state=ge,h.tparsed=h.tbuffered=We.now(),n.initSegment.data=e.payload,this.hls.trigger(l.a.FRAG_BUFFERED,{stats:h,frag:t,id:"audio"}),this.tick();else{this.state=be,this.appended=!1,this.demuxer||(this.demuxer=new X(this.hls,"audio"));var f=this.initPTS[u],p=n.initSegment?n.initSegment.data:[];void 0!==f?(this.pendingBuffering=!0,c.b.log("Demuxing "+o+" of ["+n.startSN+" ,"+n.endSN+"],track "+s),this.demuxer.push(e.payload,p,d,null,t,a,!1,f)):(c.b.log("Unknown video PTS for cc "+u+", waiting for video PTS before demuxing audio frag "+o+" of ["+n.startSN+" ,"+n.endSN+"],track "+s),this.waitingFragment=e,this.waitingVideoCC=this.videoTrackCC,this.state=we)}}this.fragLoadError=0},a.onFragParsingInitSegment=function(e){var t=this.fragCurrent,i=e.frag;if(t&&"audio"===e.id&&i.sn===t.sn&&i.level===t.level&&this.state===be){var r,n=e.tracks;if(n.video&&delete n.video,r=n.audio){r.levelCodec=r.codec,r.id=e.id,this.hls.trigger(l.a.BUFFER_CODECS,n),c.b.log("audio track:audio,container:"+r.container+",codecs[level/parsed]=["+r.levelCodec+"/"+r.codec+"]");var a=r.initSegment;if(a){var s={type:"audio",data:a,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[s]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(l.a.BUFFER_APPENDING,s))}this.tick()}}},a.onFragParsingData=function(e){var t=this,i=this.fragCurrent,r=e.frag;if(i&&"audio"===e.id&&"audio"===e.type&&r.sn===i.sn&&r.level===i.level&&this.state===be){var n=this.trackId,a=this.tracks[n],s=this.hls;Object(u.a)(e.endPTS)||(e.endPTS=e.startPTS+i.duration,e.endDTS=e.startDTS+i.duration),i.addElementaryStream(f.AUDIO),c.b.log("parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb),J(a.details,i,e.startPTS,e.endPTS);var d=this.media,h=!1;if(this.audioSwitch)if(d&&d.readyState){var p=d.currentTime;c.b.log("switching audio track : currentTime:"+p),p>=e.startPTS&&(c.b.log("switching audio track : flushing all audio"),this.state=Se,s.trigger(l.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),h=!0,this.audioSwitch=!1,s.trigger(l.a.AUDIO_TRACK_SWITCHED,{id:n}))}else this.audioSwitch=!1,s.trigger(l.a.AUDIO_TRACK_SWITCHED,{id:n});var g=this.pendingData;if(!g)return c.b.warn("Apparently attempt to enqueue media payload without codec initialization data upfront"),void s.trigger(l.a.ERROR,{type:o.b.MEDIA_ERROR,details:null,fatal:!0});this.audioSwitch||([e.data1,e.data2].forEach((function(t){t&&t.length&&g.push({type:e.type,data:t,parent:"audio",content:"data"})})),!h&&g.length&&(g.forEach((function(e){t.state===be&&(t.pendingBuffering=!0,t.hls.trigger(l.a.BUFFER_APPENDING,e))})),this.pendingData=[],this.appended=!0)),this.tick()}},a.onFragParsed=function(e){var t=this.fragCurrent,i=e.frag;t&&"audio"===e.id&&i.sn===t.sn&&i.level===t.level&&this.state===be&&(this.stats.tparsed=We.now(),this.state=Te,this._checkAppendedParsed())},a.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},a.onBufferCreated=function(e){var t=e.tracks.audio;t&&(this.mediaBuffer=t.buffer,this.loadedmetadata=!0),e.tracks.video&&(this.videoBuffer=e.tracks.video.buffer)},a.onBufferAppended=function(e){if("audio"===e.parent){var t=this.state;t!==be&&t!==Te||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}},a._checkAppendedParsed=function(){if(!(this.state!==Te||this.appended&&this.pendingBuffering)){var e=this.fragCurrent,t=this.stats,i=this.hls;if(e){this.fragPrevious=e,t.tbuffered=We.now(),i.trigger(l.a.FRAG_BUFFERED,{stats:t,frag:e,id:"audio"});var r=this.mediaBuffer?this.mediaBuffer:this.media;r&&c.b.log("audio buffered : "+ie(r.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,i.trigger(l.a.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=ge}this.tick()}},a.onError=function(e){var t=e.frag;if(!t||"audio"===t.type)switch(e.details){case o.a.FRAG_LOAD_ERROR:case o.a.FRAG_LOAD_TIMEOUT:var i=e.frag;if(i&&"audio"!==i.type)break;if(!e.fatal){var r=this.fragLoadError;r?r++:r=1;var n=this.config;if(r<=n.fragLoadingMaxRetry){this.fragLoadError=r;var a=Math.min(Math.pow(2,r-1)*n.fragLoadingRetryDelay,n.fragLoadingMaxRetryTimeout);c.b.warn("AudioStreamController: frag loading failed, retry in "+a+" ms"),this.retryDate=We.now()+a,this.state=ye}else c.b.error("AudioStreamController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=ke}break;case o.a.AUDIO_TRACK_LOAD_ERROR:case o.a.AUDIO_TRACK_LOAD_TIMEOUT:case o.a.KEY_LOAD_ERROR:case o.a.KEY_LOAD_TIMEOUT:this.state!==ke&&(this.state=e.fatal?ke:ge,c.b.warn("AudioStreamController: "+e.details+" while loading frag, now switching to "+this.state+" state ..."));break;case o.a.BUFFER_FULL_ERROR:if("audio"===e.parent&&(this.state===be||this.state===Te)){var s=this.mediaBuffer,u=this.media.currentTime;if(s&&j.isBuffered(s,u)&&j.isBuffered(s,u+.5)){var d=this.config;d.maxMaxBufferLength>=d.maxBufferLength&&(d.maxMaxBufferLength/=2,c.b.warn("AudioStreamController: reduce max buffer length to "+d.maxMaxBufferLength+"s")),this.state=ge}else c.b.warn("AudioStreamController: buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=Se,this.hls.trigger(l.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}}},a.onBufferFlushed=function(){var e=this,t=this.pendingData;t&&t.length?(c.b.log("AudioStreamController: appending pending audio data after buffer flushed"),t.forEach((function(t){e.hls.trigger(l.a.BUFFER_APPENDING,t)})),this.appended=!0,this.pendingData=[],this.state=Te):(this.state=ge,this.fragPrevious=null,this.tick())},(n=[{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,c.b.log("audio stream:"+t+"->"+e)}},get:function(){return this._state}}])&&function(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(r.prototype,n),r}(Ae),Ye=function(){if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var e={"":!0,lr:!0,rl:!0},t={start:!0,middle:!0,end:!0,left:!0,right:!0};function i(e){return"string"==typeof e&&!!t[e.toLowerCase()]&&e.toLowerCase()}function r(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)e[r]=i[r]}return e}function n(t,n,a){var s=this,o={enumerable:!0};s.hasBeenReset=!1;var u="",l=!1,c=t,d=n,h=a,f=null,p="",g=!0,m="auto",v="start",y=50,_="middle",b=50,T="middle";Object.defineProperty(s,"id",r({},o,{get:function(){return u},set:function(e){u=""+e}})),Object.defineProperty(s,"pauseOnExit",r({},o,{get:function(){return l},set:function(e){l=!!e}})),Object.defineProperty(s,"startTime",r({},o,{get:function(){return c},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");c=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"endTime",r({},o,{get:function(){return d},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");d=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"text",r({},o,{get:function(){return h},set:function(e){h=""+e,this.hasBeenReset=!0}})),Object.defineProperty(s,"region",r({},o,{get:function(){return f},set:function(e){f=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"vertical",r({},o,{get:function(){return p},set:function(t){var i=function(t){return"string"==typeof t&&!!e[t.toLowerCase()]&&t.toLowerCase()}(t);if(!1===i)throw new SyntaxError("An invalid or illegal string was specified.");p=i,this.hasBeenReset=!0}})),Object.defineProperty(s,"snapToLines",r({},o,{get:function(){return g},set:function(e){g=!!e,this.hasBeenReset=!0}})),Object.defineProperty(s,"line",r({},o,{get:function(){return m},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");m=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"lineAlign",r({},o,{get:function(){return v},set:function(e){var t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"position",r({},o,{get:function(){return y},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"positionAlign",r({},o,{get:function(){return _},set:function(e){var t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");_=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"size",r({},o,{get:function(){return b},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");b=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"align",r({},o,{get:function(){return T},set:function(e){var t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");T=t,this.hasBeenReset=!0}})),s.displayState=void 0}return n.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},n}(),Xe=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}};function Qe(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new Xe,this.regionList=[]}function $e(){this.values=Object.create(null)}function Je(e,t,i,r){var n=r?e.split(r):[e];for(var a in n)if("string"==typeof n[a]){var s=n[a].split(i);2===s.length&&t(s[0],s[1])}}$e.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,i){return i?this.has(e)?this.values[e]:t[i]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,i){for(var r=0;r<i.length;++r)if(t===i[r]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t))>=0&&t<=100)&&(this.set(e,t),!0)}};var Ze=new Ye(0,0,0),et="middle"===Ze.align?"middle":"center";function tt(e,t,i){var r=e;function n(){var t=function(e){function t(e,t,i,r){return 3600*(0|e)+60*(0|t)+(0|i)+(0|r)/1e3}var i=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return i?i[3]?t(i[1],i[2],i[3].replace(":",""),i[4]):i[1]>59?t(i[1],i[2],0,i[4]):t(0,i[1],i[2],i[4]):null}(e);if(null===t)throw new Error("Malformed timestamp: "+r);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function a(){e=e.replace(/^\s+/,"")}if(a(),t.startTime=n(),a(),"--\x3e"!==e.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+r);e=e.substr(3),a(),t.endTime=n(),a(),function(e,t){var r=new $e;Je(e,(function(e,t){switch(e){case"region":for(var n=i.length-1;n>=0;n--)if(i[n].id===t){r.set(e,i[n].region);break}break;case"vertical":r.alt(e,t,["rl","lr"]);break;case"line":var a=t.split(","),s=a[0];r.integer(e,s),r.percent(e,s)&&r.set("snapToLines",!1),r.alt(e,s,["auto"]),2===a.length&&r.alt("lineAlign",a[1],["start",et,"end"]);break;case"position":a=t.split(","),r.percent(e,a[0]),2===a.length&&r.alt("positionAlign",a[1],["start",et,"end","line-left","line-right","auto"]);break;case"size":r.percent(e,t);break;case"align":r.alt(e,t,["start",et,"end","left","right"])}}),/:/,/\s/),t.region=r.get("region",null),t.vertical=r.get("vertical","");var n=r.get("line","auto");"auto"===n&&-1===Ze.line&&(n=-1),t.line=n,t.lineAlign=r.get("lineAlign","start"),t.snapToLines=r.get("snapToLines",!0),t.size=r.get("size",100),t.align=r.get("align",et);var a=r.get("position","auto");"auto"===a&&50===Ze.position&&(a="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=a}(e,t)}function it(e){return e.replace(/<br(?: \/)?>/gi,"\n")}Qe.prototype={parse:function(e){var t=this;function i(){var e=t.buffer,i=0;for(e=it(e);i<e.length&&"\r"!==e[i]&&"\n"!==e[i];)++i;var r=e.substr(0,i);return"\r"===e[i]&&++i,"\n"===e[i]&&++i,t.buffer=e.substr(i),r}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var r;if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var n=(r=i()).match(/^()?WEBVTT([ \t].*)?$/);if(!n||!n[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}for(var a=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(a?a=!1:r=i(),t.state){case"HEADER":/:/.test(r)?Je(r,(function(e,t){}),/:/):r||(t.state="ID");continue;case"NOTE":r||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(r)){t.state="NOTE";break}if(!r)continue;if(t.cue=new Ye(0,0,""),t.state="CUE",-1===r.indexOf("--\x3e")){t.cue.id=r;continue}case"CUE":try{tt(r,t.cue,t.regionList)}catch(e){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var s=-1!==r.indexOf("--\x3e");if(!r||s&&(a=!0)){t.oncue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}t.cue.text&&(t.cue.text+="\n"),t.cue.text+=r;continue;case"BADCUE":r||(t.state="ID");continue}}}catch(e){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),(this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new Error("Malformed WebVTT signature.")}catch(e){throw e}return this.onflush&&this.onflush(),this}};var rt=Qe;function nt(e,t,i,r){for(var n,a,s,o,u,l=[],c=window.VTTCue||TextTrackCue,d=0;d<r.rows.length;d++)if(s=!0,o=0,u="",!(n=r.rows[d]).isEmpty()){for(var h=0;h<n.chars.length;h++)n.chars[h].uchar.match(/\s/)&&s?o++:(u+=n.chars[h].uchar,s=!1);n.cueStartTime=t,t===i&&(i+=1e-4),o>=16?o--:o++,(a=new c(t,i,it(u.trim()))).line=navigator.userAgent.match(/Firefox\//)?d+1:d>7?d-2:d+1,a.align="left",a.position=Math.max(0,Math.min(100,o/32*100)),l.push(a),e&&e.addCue(a)}return l}var at,st={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},ot=function(e){var t=e;return st.hasOwnProperty(e)&&(t=st[e]),String.fromCharCode(t)},ut={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},lt={17:2,18:4,21:6,22:8,23:10,19:13,20:15},ct={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},dt={25:2,26:4,29:6,30:8,31:10,27:13,28:15},ht=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];!function(e){e[e.ERROR=0]="ERROR",e[e.TEXT=1]="TEXT",e[e.WARNING=2]="WARNING",e[e.INFO=2]="INFO",e[e.DEBUG=3]="DEBUG",e[e.DATA=3]="DATA"}(at||(at={}));var ft=function(){function e(){this.time=null,this.verboseLevel=at.ERROR}return e.prototype.log=function(e,t){this.verboseLevel>=e&&c.b.log(this.time+" ["+e+"] "+t)},e}(),pt=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i].toString(16));return t},gt=function(){function e(e,t,i,r,n){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=e||"white",this.underline=t||!1,this.italics=i||!1,this.background=r||"black",this.flash=n||!1}var t=e.prototype;return t.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},t.setStyles=function(e){for(var t=["foreground","underline","italics","background","flash"],i=0;i<t.length;i++){var r=t[i];e.hasOwnProperty(r)&&(this[r]=e[r])}},t.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},t.equals=function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},t.copy=function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},t.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},e}(),mt=function(){function e(e,t,i,r,n,a){this.uchar=void 0,this.penState=void 0,this.uchar=e||" ",this.penState=new gt(t,i,r,n,a)}var t=e.prototype;return t.reset=function(){this.uchar=" ",this.penState.reset()},t.setChar=function(e,t){this.uchar=e,this.penState.copy(t)},t.setPenState=function(e){this.penState.copy(e)},t.equals=function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},t.copy=function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},t.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},e}(),vt=function(){function e(e){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var t=0;t<100;t++)this.chars.push(new mt);this.logger=e,this.pos=0,this.currPenState=new gt}var t=e.prototype;return t.equals=function(e){for(var t=!0,i=0;i<100;i++)if(!this.chars[i].equals(e.chars[i])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<100;t++)this.chars[t].copy(e.chars[t])},t.isEmpty=function(){for(var e=!0,t=0;t<100;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},t.setCursor=function(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(at.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>100&&(this.logger.log(at.DEBUG,"Too large cursor position "+this.pos),this.pos=100)},t.moveCursor=function(e){var t=this.pos+e;if(e>1)for(var i=this.pos+1;i<t+1;i++)this.chars[i].setPenState(this.currPenState);this.setCursor(t)},t.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},t.insertChar=function(e){e>=144&&this.backSpace();var t=ot(e);this.pos>=100?this.logger.log(at.ERROR,"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},t.clearFromPos=function(e){var t;for(t=e;t<100;t++)this.chars[t].reset()},t.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},t.clearToEndOfRow=function(){this.clearFromPos(this.pos)},t.getTextString=function(){for(var e=[],t=!0,i=0;i<100;i++){var r=this.chars[i].uchar;" "!==r&&(t=!1),e.push(r)}return t?"":e.join("")},t.setPenStyles=function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)},e}(),yt=function(){function e(e){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var t=0;t<15;t++)this.rows.push(new vt(e));this.logger=e,this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var t=e.prototype;return t.reset=function(){for(var e=0;e<15;e++)this.rows[e].clear();this.currRow=14},t.equals=function(e){for(var t=!0,i=0;i<15;i++)if(!this.rows[i].equals(e.rows[i])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<15;t++)this.rows[t].copy(e.rows[t])},t.isEmpty=function(){for(var e=!0,t=0;t<15;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},t.backSpace=function(){this.rows[this.currRow].backSpace()},t.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},t.insertChar=function(e){this.rows[this.currRow].insertChar(e)},t.setPen=function(e){this.rows[this.currRow].setPenStyles(e)},t.moveCursor=function(e){this.rows[this.currRow].moveCursor(e)},t.setCursor=function(e){this.logger.log(at.INFO,"setCursor: "+e),this.rows[this.currRow].setCursor(e)},t.setPAC=function(e){this.logger.log(at.INFO,"pacData = "+JSON.stringify(e));var t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var i=0;i<15;i++)this.rows[i].clear();var r=this.currRow+1-this.nrRollUpRows,n=this.lastOutputScreen;if(n){var a=n.rows[r].cueStartTime,s=this.logger.time;if(a&&null!==s&&a<s)for(var o=0;o<this.nrRollUpRows;o++)this.rows[t-this.nrRollUpRows+o+1].copy(n.rows[r+o])}}this.currRow=t;var u=this.rows[this.currRow];if(null!==e.indent){var l=Math.max(e.indent-1,0);u.setCursor(e.indent),e.color=u.chars[l].penState.foreground}this.setPen({foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1})},t.setBkgData=function(e){this.logger.log(at.INFO,"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},t.setRollUpRows=function(e){this.nrRollUpRows=e},t.rollUp=function(){if(null!==this.nrRollUpRows){this.logger.log(at.TEXT,this.getDisplayText());var e=this.rows.splice(this.currRow+1-this.nrRollUpRows,1)[0];e.clear(),this.rows.splice(this.currRow,0,e),this.logger.log(at.INFO,"Rolling up")}else this.logger.log(at.DEBUG,"roll_up but nrRollUpRows not set yet")},t.getDisplayText=function(e){e=e||!1;for(var t=[],i="",r=0;r<15;r++){var n=this.rows[r].getTextString();n&&t.push(e?"Row "+(r+1)+": '"+n+"'":n.trim())}return t.length>0&&(i=e?"["+t.join(" | ")+"]":t.join("\n")),i},t.getTextAndFormat=function(){return this.rows},e}(),_t=function(){function e(e,t,i){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new yt(i),this.nonDisplayedMemory=new yt(i),this.lastOutputScreen=new yt(i),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=i}var t=e.prototype;return t.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},t.getHandler=function(){return this.outputFilter},t.setHandler=function(e){this.outputFilter=e},t.setPAC=function(e){this.writeScreen.setPAC(e)},t.setBkgData=function(e){this.writeScreen.setBkgData(e)},t.setMode=function(e){e!==this.mode&&(this.mode=e,this.logger.log(at.INFO,"MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},t.insertChars=function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);this.logger.log(at.INFO,(this.writeScreen===this.displayedMemory?"DISP":"NON_DISP")+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(at.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},t.ccRCL=function(){this.logger.log(at.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},t.ccBS=function(){this.logger.log(at.INFO,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},t.ccAOF=function(){},t.ccAON=function(){},t.ccDER=function(){this.logger.log(at.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},t.ccRU=function(e){this.logger.log(at.INFO,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},t.ccFON=function(){this.logger.log(at.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},t.ccRDC=function(){this.logger.log(at.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},t.ccTR=function(){this.logger.log(at.INFO,"TR"),this.setMode("MODE_TEXT")},t.ccRTD=function(){this.logger.log(at.INFO,"RTD"),this.setMode("MODE_TEXT")},t.ccEDM=function(){this.logger.log(at.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},t.ccCR=function(){this.logger.log(at.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},t.ccENM=function(){this.logger.log(at.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},t.ccEOC=function(){if(this.logger.log(at.INFO,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(at.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},t.ccTO=function(e){this.logger.log(at.INFO,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},t.ccMIDROW=function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{var i=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][i]}this.logger.log(at.INFO,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},t.outputDataUpdate=function(e){void 0===e&&(e=!1);var t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))},t.cueSplitAtTime=function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))},e}();function bt(e,t,i){i.a=e,i.b=t}function Tt(e,t,i){return i.a===e&&i.b===t}var St=function(){function e(e,t,i){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var r=new ft;this.channels=[null,new _t(e,t,r),new _t(e+1,i,r)],this.cmdHistory={a:null,b:null},this.logger=r}var t=e.prototype;return t.getHandler=function(e){return this.channels[e].getHandler()},t.setHandler=function(e,t){this.channels[e].setHandler(t)},t.addData=function(e,t){var i,r,n,a=!1;this.logger.time=e;for(var s=0;s<t.length;s+=2)if(n=127&t[s+1],0!=(r=127&t[s])||0!==n){if(this.logger.log(at.DATA,"["+pt([t[s],t[s+1]])+"] -> ("+pt([r,n])+")"),(i=this.parseCmd(r,n))||(i=this.parseMidrow(r,n)),i||(i=this.parsePAC(r,n)),i||(i=this.parseBackgroundAttributes(r,n)),!i&&(a=this.parseChars(r,n))){var o=this.currentChannel;o&&o>0?this.channels[o].insertChars(a):this.logger.log(at.WARNING,"No channel found yet. TEXT-MODE?")}i||a||this.logger.log(at.WARNING,"Couldn't parse cleaned data "+pt([r,n])+" orig: "+pt([t[s],t[s+1]]))}},t.parseCmd=function(e,t){var i=this.cmdHistory;if(!((20===e||28===e||21===e||29===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=33&&t<=35))return!1;if(Tt(e,t,i))return bt(null,null,i),this.logger.log(at.DEBUG,"Repeated command ("+pt([e,t])+") is dropped"),!0;var r=20===e||21===e||23===e?1:2,n=this.channels[r];return 20===e||21===e||28===e||29===e?32===t?n.ccRCL():33===t?n.ccBS():34===t?n.ccAOF():35===t?n.ccAON():36===t?n.ccDER():37===t?n.ccRU(2):38===t?n.ccRU(3):39===t?n.ccRU(4):40===t?n.ccFON():41===t?n.ccRDC():42===t?n.ccTR():43===t?n.ccRTD():44===t?n.ccEDM():45===t?n.ccCR():46===t?n.ccENM():47===t&&n.ccEOC():n.ccTO(t-32),bt(e,t,i),this.currentChannel=r,!0},t.parseMidrow=function(e,t){var i=0;if((17===e||25===e)&&t>=32&&t<=47){if((i=17===e?1:2)!==this.currentChannel)return this.logger.log(at.ERROR,"Mismatch channel in midrow parsing"),!1;var r=this.channels[i];return!!r&&(r.ccMIDROW(t),this.logger.log(at.DEBUG,"MIDROW ("+pt([e,t])+")"),!0)}return!1},t.parsePAC=function(e,t){var i=this.cmdHistory;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127||(16===e||24===e)&&t>=64&&t<=95))return!1;if(Tt(e,t,i))return bt(null,null,i),!0;var r=e<=23?1:2,n=this.channels[r];return!!n&&(n.setPAC(this.interpretPAC(t>=64&&t<=95?1===r?ut[e]:ct[e]:1===r?lt[e]:dt[e],t)),bt(e,t,i),this.currentChannel=r,!0)},t.interpretPAC=function(e,t){var i,r={color:null,italics:!1,indent:null,underline:!1,row:e};return r.underline=1==(1&(i=t>95?t-96:t-64)),i<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(r.italics=!0,r.color="white"):r.indent=4*Math.floor((i-16)/2),r},t.parseChars=function(e,t){var i,r,n=null,a=null;if(e>=25?(i=2,a=e-8):(i=1,a=e),a>=17&&a<=19?(this.logger.log(at.INFO,"Special char '"+ot(r=17===a?t+80:18===a?t+112:t+144)+"' in channel "+i),n=[r]):e>=32&&e<=127&&(n=0===t?[e]:[e,t]),n){var s=pt(n);this.logger.log(at.DEBUG,"Char codes =  "+s.join(",")),bt(e,t,this.cmdHistory)}return n},t.parseBackgroundAttributes=function(e,t){var i;if(!((16===e||24===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=45&&t<=47))return!1;var r={};return 16===e||24===e?(i=Math.floor((t-32)/2),r.background=ht[i],t%2==1&&(r.background=r.background+"_semi")):45===t?r.background="transparent":(r.foreground="black",47===t&&(r.underline=!0)),this.channels[e<=23?1:2].setBkgData(r),bt(e,t,this.cmdHistory),!0},t.reset=function(){for(var e=0;e<Object.keys(this.channels).length;e++){var t=this.channels[e];t&&t.reset()}this.cmdHistory={a:null,b:null}},t.cueSplitAtTime=function(e){for(var t=0;t<this.channels.length;t++){var i=this.channels[t];i&&i.cueSplitAtTime(e)}},e}(),Et=function(){function e(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}var t=e.prototype;return t.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},t.newCue=function(e,t,i){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=i,this.timelineController.createCaptionsTrack(this.trackName)},t.reset=function(){this.cueRanges=[]},e}(),kt=function(e,t,i){return e.substr(i||0,t.length)===t},wt=function(e){for(var t=5381,i=e.length;i;)t=33*t^e.charCodeAt(--i);return(t>>>0).toString()};function Ct(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function At(e,t){return e&&e.label===t.name&&!(e.textTrack1||e.textTrack2)}var Lt=function(e){var t,i;function r(t){var i;if((i=e.call(this,t,l.a.MEDIA_ATTACHING,l.a.MEDIA_DETACHING,l.a.FRAG_PARSING_USERDATA,l.a.FRAG_DECRYPTED,l.a.MANIFEST_LOADING,l.a.MANIFEST_LOADED,l.a.FRAG_LOADED,l.a.INIT_PTS_FOUND)||this).media=null,i.config=void 0,i.enabled=!0,i.Cues=void 0,i.textTracks=[],i.tracks=[],i.initPTS=[],i.unparsedVttFrags=[],i.captionsTracks={},i.nonNativeCaptionsTracks={},i.captionsProperties=void 0,i.cea608Parser1=void 0,i.cea608Parser2=void 0,i.lastSn=-1,i.prevCC=-1,i.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},i.hls=t,i.config=t.config,i.Cues=t.config.cueHandler,i.captionsProperties={textTrack1:{label:i.config.captionsTextTrack1Label,languageCode:i.config.captionsTextTrack1LanguageCode},textTrack2:{label:i.config.captionsTextTrack2Label,languageCode:i.config.captionsTextTrack2LanguageCode},textTrack3:{label:i.config.captionsTextTrack3Label,languageCode:i.config.captionsTextTrack3LanguageCode},textTrack4:{label:i.config.captionsTextTrack4Label,languageCode:i.config.captionsTextTrack4LanguageCode}},i.config.enableCEA708Captions){var r=new Et(Ct(i),"textTrack1"),n=new Et(Ct(i),"textTrack2"),a=new Et(Ct(i),"textTrack3"),s=new Et(Ct(i),"textTrack4");i.cea608Parser1=new St(1,r,n),i.cea608Parser2=new St(3,a,s)}return i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n=r.prototype;return n.addCues=function(e,t,i,r,n){for(var a,s,o=!1,u=n.length;u--;){var c=n[u],d=(a=c[0],s=t,Math.min(c[1],i)-Math.max(a,s));if(d>=0&&(c[0]=Math.min(c[0],t),c[1]=Math.max(c[1],i),o=!0,d/(i-t)>.5))return}if(o||n.push([t,i]),this.config.renderTextTracksNatively)this.Cues.newCue(this.captionsTracks[e],t,i,r);else{var h=this.Cues.newCue(null,t,i,r);this.hls.trigger(l.a.CUES_PARSED,{type:"captions",cues:h,track:e})}},n.onInitPtsFound=function(e){var t=this,i=this.unparsedVttFrags;"main"===e.id&&(this.initPTS[e.frag.cc]=e.initPTS),i.length&&(this.unparsedVttFrags=[],i.forEach((function(e){t.onFragLoaded(e)})))},n.getExistingTrack=function(e){var t=this.media;if(t)for(var i=0;i<t.textTracks.length;i++){var r=t.textTracks[i];if(r[e])return r}return null},n.createCaptionsTrack=function(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)},n.createNativeTrack=function(e){if(!this.captionsTracks[e]){var t=this.captionsTracks,i=this.media,r=this.captionsProperties[e],n=r.label,a=r.languageCode,s=this.getExistingTrack(e);if(s)t[e]=s,Oe(t[e]),De(t[e],i);else{var o=this.createTextTrack("captions",n,a);o&&(o[e]=!0,t[e]=o)}}},n.createNonNativeTrack=function(e){if(!this.nonNativeCaptionsTracks[e]){var t=this.captionsProperties[e];if(t){var i={_id:e,label:t.label,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=i,this.hls.trigger(l.a.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[i]})}}},n.createTextTrack=function(e,t,i){var r=this.media;if(r)return r.addTextTrack(e,t,i)},n.destroy=function(){e.prototype.destroy.call(this)},n.onMediaAttaching=function(e){this.media=e.media,this._cleanTracks()},n.onMediaDetaching=function(){var e=this.captionsTracks;Object.keys(e).forEach((function(t){Oe(e[t]),delete e[t]})),this.nonNativeCaptionsTracks={}},n.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={}},n._cleanTracks=function(){var e=this.media;if(e){var t=e.textTracks;if(t)for(var i=0;i<t.length;i++)Oe(t[i])}},n.onManifestLoaded=function(e){var t=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset()),this.config.enableWebVTT){var i=e.subtitles||[],r=this.tracks&&i&&this.tracks.length===i.length;if(this.tracks=e.subtitles||[],this.config.renderTextTracksNatively){var n=this.media?this.media.textTracks:[];this.tracks.forEach((function(e,i){var r;if(i<n.length){for(var a=null,s=0;s<n.length;s++)if(At(n[s],e)){a=n[s];break}a&&(r=a)}r||(r=t.createTextTrack("subtitles",e.name,e.lang)),r.mode=e.default?t.hls.subtitleDisplay?"showing":"hidden":"disabled",t.textTracks.push(r)}))}else if(!r&&this.tracks&&this.tracks.length){var a=this.tracks.map((function(e){return{label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e}}));this.hls.trigger(l.a.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:a})}}this.config.enableCEA708Captions&&e.captions&&e.captions.forEach((function(e){var i=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(i){var r=t.captionsProperties["textTrack"+i[1]];r&&(r.label=e.name,e.lang&&(r.languageCode=e.lang),r.media=e)}}))},n.onFragLoaded=function(e){var t=e.frag,i=e.payload,r=this.cea608Parser1,n=this.cea608Parser2,a=this.initPTS,s=this.unparsedVttFrags;if("main"===t.type){var o=t.sn;t.sn!==this.lastSn+1&&r&&n&&(r.reset(),n.reset()),this.lastSn=o}else if("subtitle"===t.type)if(i.byteLength){if(!Object(u.a)(a[t.cc]))return s.push(e),void(a.length&&this.hls.trigger(l.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t}));var c=t.decryptdata;null!=c&&null!=c.key&&"AES-128"===c.method||this._parseVTTs(t,i)}else this.hls.trigger(l.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})},n._parseVTTs=function(e,t){var i=this,r=this.hls,n=this.textTracks,a=this.vttCCs;a[e.cc]||(a[e.cc]={start:e.start,prevCC:this.prevCC,new:!0},this.prevCC=e.cc),function(e,t,i,r,n,a){var s,o=Object(Re.b)(new Uint8Array(e)).trim().replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n"),l="00:00.000",c=0,d=0,h=0,f=[],p=!0,g=!1,m=new rt;m.oncue=function(e){var t=i[r],n=i.ccOffset;t&&t.new&&(void 0!==d?n=i.ccOffset=t.start:function(e,t,i){var r=e[t],n=e[r.prevCC];if(!n||!n.new&&r.new)return e.ccOffset=e.presentationOffset=r.start,void(r.new=!1);for(;n&&n.new;)e.ccOffset+=r.start-n.start,r.new=!1,n=e[(r=n).prevCC];e.presentationOffset=i}(i,r,h)),h&&(n=h-i.presentationOffset),g&&(e.startTime+=n-d,e.endTime+=n-d),e.id=wt(e.startTime.toString())+wt(e.endTime.toString())+wt(e.text),e.text=decodeURIComponent(encodeURIComponent(e.text)),e.endTime>0&&f.push(e)},m.onparsingerror=function(e){s=e},m.onflush=function(){s&&a?a(s):n(f)},o.forEach((function(e){if(p){if(kt(e,"X-TIMESTAMP-MAP=")){p=!1,g=!0,e.substr(16).split(",").forEach((function(e){kt(e,"LOCAL:")?l=e.substr(6):kt(e,"MPEGTS:")&&(c=parseInt(e.substr(7)))}));try{t+(9e4*i[r].start||0)<0&&(t+=8589934592),c-=t,d=function(e){var t=parseInt(e.substr(-3)),i=parseInt(e.substr(-6,2)),r=parseInt(e.substr(-9,2)),n=e.length>9?parseInt(e.substr(0,e.indexOf(":"))):0;if(!(Object(u.a)(t)&&Object(u.a)(i)&&Object(u.a)(r)&&Object(u.a)(n)))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+e);return t+=1e3*i,(t+=6e4*r)+36e5*n}(l)/1e3,h=c/9e4}catch(e){g=!1,s=e}return}""===e&&(p=!1)}m.parse(e+"\n")})),m.flush()}(t,this.initPTS[e.cc],a,e.cc,(function(t){if(i.config.renderTextTracksNatively){var a=n[e.level];if("disabled"===a.mode)return void r.trigger(l.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e});t.forEach((function(e){if(!a.cues.getCueById(e.id))try{if(a.addCue(e),!a.cues.getCueById(e.id))throw new Error("addCue is failed for: "+e)}catch(i){c.b.debug("Failed occurred on adding cues: "+i);var t=new window.TextTrackCue(e.startTime,e.endTime,e.text);t.id=e.id,a.addCue(t)}}))}else r.trigger(l.a.CUES_PARSED,{type:"subtitles",cues:t,track:i.tracks[e.level].default?"default":"subtitles"+e.level});r.trigger(l.a.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})}),(function(t){c.b.log("Failed to parse VTT cue: "+t),r.trigger(l.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})}))},n.onFragDecrypted=function(e){var t=e.frag,i=e.payload;if("subtitle"===t.type){if(!Object(u.a)(this.initPTS[t.cc]))return void this.unparsedVttFrags.push(e);this._parseVTTs(t,i)}},n.onFragParsingUserdata=function(e){var t=this.cea608Parser1,i=this.cea608Parser2;if(this.enabled&&t&&i)for(var r=0;r<e.samples.length;r++){var n=e.samples[r].bytes;if(n){var a=this.extractCea608Data(n);t.addData(e.samples[r].pts,a[0]),i.addData(e.samples[r].pts,a[1])}}},n.extractCea608Data=function(e){for(var t=31&e[0],i=2,r=[[],[]],n=0;n<t;n++){var a=e[i++],s=127&e[i++],o=127&e[i++],u=3&a;0===s&&0===o||0!=(4&a)&&(0!==u&&1!==u||(r[u].push(s),r[u].push(o)))}return r},r}(h);function It(e){for(var t=[],i=0;i<e.length;i++){var r=e[i];"subtitles"===r.kind&&r.label&&t.push(e[i])}return t}var Rt,Dt=function(e){var t,i;function r(t){var i;return(i=e.call(this,t,l.a.MEDIA_ATTACHED,l.a.MEDIA_DETACHING,l.a.MANIFEST_LOADED,l.a.SUBTITLE_TRACK_LOADED)||this).tracks=[],i.trackId=-1,i.media=null,i.stopped=!0,i.subtitleDisplay=!0,i.queuedDefaultTrack=null,i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n,a=r.prototype;return a.destroy=function(){h.prototype.destroy.call(this)},a.onMediaAttached=function(e){var t=this;this.media=e.media,this.media&&(Object(u.a)(this.queuedDefaultTrack)&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=null),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval((function(){t.trackChangeListener()}),500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},a.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),Object(u.a)(this.subtitleTrack)&&(this.queuedDefaultTrack=this.subtitleTrack),It(this.media.textTracks).forEach((function(e){Oe(e)})),this.subtitleTrack=-1,this.media=null)},a.onManifestLoaded=function(e){var t=this,i=e.subtitles||[];this.tracks=i,this.hls.trigger(l.a.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:i}),i.forEach((function(e){e.default&&(t.media?t.subtitleTrack=e.id:t.queuedDefaultTrack=e.id)}))},a.onSubtitleTrackLoaded=function(e){var t=this,i=e.id,r=e.details,n=this.trackId,a=this.tracks,s=a[n];if(i>=a.length||i!==n||!s||this.stopped)this._clearReloadTimer();else if(c.b.log("subtitle track "+i+" loaded"),r.live){var o=te(s.details,r,e.stats.trequest);c.b.log("Reloading live subtitle playlist in "+o+"ms"),this.timer=setTimeout((function(){t._loadCurrentTrack()}),o)}else this._clearReloadTimer()},a.startLoad=function(){this.stopped=!1,this._loadCurrentTrack()},a.stopLoad=function(){this.stopped=!0,this._clearReloadTimer()},a._clearReloadTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},a._loadCurrentTrack=function(){var e=this.trackId,t=this.hls,i=this.tracks[e];e<0||!i||i.details&&!i.details.live||(c.b.log("Loading subtitle track "+e),t.trigger(l.a.SUBTITLE_TRACK_LOADING,{url:i.url,id:e}))},a._toggleTrackModes=function(e){var t=this.media,i=this.subtitleDisplay,r=this.trackId;if(t){var n=It(t.textTracks);if(-1===e)[].slice.call(n).forEach((function(e){e.mode="disabled"}));else{var a=n[r];a&&(a.mode="disabled")}var s=n[e];s&&(s.mode=i?"showing":"hidden")}},a._setSubtitleTrackInternal=function(e){var t=this.hls,i=this.tracks;!Object(u.a)(e)||e<-1||e>=i.length||(this.trackId=e,c.b.log("Switching to subtitle track "+e),t.trigger(l.a.SUBTITLE_TRACK_SWITCH,{id:e}),this._loadCurrentTrack())},a._onTextTracksChanged=function(){if(this.media&&this.hls.config.renderTextTracksNatively){for(var e=-1,t=It(this.media.textTracks),i=0;i<t.length;i++)if("hidden"===t[i].mode)e=i;else if("showing"===t[i].mode){e=i;break}this.subtitleTrack=e}},(n=[{key:"subtitleTracks",get:function(){return this.tracks}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(e){this.trackId!==e&&(this._toggleTrackModes(e),this._setSubtitleTrackInternal(e))}}])&&function(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(r.prototype,n),r}(h),Ot=i(7),xt=window.performance,Pt=function(e){var t,i;function r(t,i){var r;return(r=e.call(this,t,l.a.MEDIA_ATTACHED,l.a.MEDIA_DETACHING,l.a.ERROR,l.a.KEY_LOADED,l.a.FRAG_LOADED,l.a.SUBTITLE_TRACKS_UPDATED,l.a.SUBTITLE_TRACK_SWITCH,l.a.SUBTITLE_TRACK_LOADED,l.a.SUBTITLE_FRAG_PROCESSED,l.a.LEVEL_UPDATED)||this).fragmentTracker=i,r.config=t.config,r.state=fe,r.tracks=[],r.tracksBuffered=[],r.currentTrackId=-1,r.decrypter=new Ot.a(t,t.config),r.lastAVStart=0,r._onMediaSeeking=r.onMediaSeeking.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r)),r}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n=r.prototype;return n.startLoad=function(){this.stopLoad(),this.state=ge;var e=this.tracks[this.currentTrackId];e&&e.details&&(this.setInterval(500),this.tick())},n.onSubtitleFragProcessed=function(e){var t=e.frag,i=e.success;if(this.fragPrevious=t,this.state=ge,i){var r=this.tracksBuffered[this.currentTrackId];if(r){for(var n,a=t.start,s=0;s<r.length;s++)if(a>=r[s].start&&a<=r[s].end){n=r[s];break}var o=t.start+t.duration;n?n.end=o:r.push(n={start:a,end:o})}}},n.onMediaAttached=function(e){var t=e.media;this.media=t,t.addEventListener("seeking",this._onMediaSeeking),this.state=ge},n.onMediaDetaching=function(){var e=this;this.media&&(this.media.removeEventListener("seeking",this._onMediaSeeking),this.fragmentTracker.removeAllFragments(),this.currentTrackId=-1,this.tracks.forEach((function(t){e.tracksBuffered[t.id]=[]})),this.media=null,this.state=fe)},n.onError=function(e){var t=e.frag;t&&"subtitle"===t.type&&(this.fragCurrent&&this.fragCurrent.loader&&this.fragCurrent.loader.abort(),this.state=ge)},n.onSubtitleTracksUpdated=function(e){var t=this;c.b.log("subtitle tracks updated"),this.tracksBuffered=[],this.tracks=e.subtitleTracks,this.tracks.forEach((function(e){t.tracksBuffered[e.id]=[]}))},n.onSubtitleTrackSwitch=function(e){if(this.currentTrackId=e.id,this.tracks&&this.tracks.length&&-1!==this.currentTrackId){var t=this.tracks[this.currentTrackId];t&&t.details&&this.setInterval(500)}else this.clearInterval()},n.onSubtitleTrackLoaded=function(e){var t=e.id,i=e.details,r=this.currentTrackId,n=this.tracks,a=n[r];t>=n.length||t!==r||!a||(i.live&&function(e,t,i){void 0===i&&(i=0);var r=-1;ee(e,t,(function(e,t,i){t.start=e.start,r=i}));var n=t.fragments;if(r<0)n.forEach((function(e){e.start+=i}));else for(var a=r+1;a<n.length;a++)n[a].start=n[a-1].start+n[a-1].duration}(a.details,i,this.lastAVStart),a.details=i,this.setInterval(500))},n.onKeyLoaded=function(){this.state===me&&(this.state=ge)},n.onFragLoaded=function(e){var t=this.fragCurrent,i=e.frag.decryptdata,r=e.frag,n=this.hls;if(this.state===ve&&t&&"subtitle"===e.frag.type&&t.sn===e.frag.sn&&e.payload.byteLength>0&&i&&i.key&&"AES-128"===i.method){var a=xt.now();this.decrypter.decrypt(e.payload,i.key.buffer,i.iv.buffer,(function(e){var t=xt.now();n.trigger(l.a.FRAG_DECRYPTED,{frag:r,payload:e,stats:{tstart:a,tdecrypt:t}})}))}},n.onLevelUpdated=function(e){var t=e.details.fragments;this.lastAVStart=t.length?t[0].start:0},n.doTick=function(){if(this.media)switch(this.state){case ge:var e=this.config,t=this.currentTrackId,i=this.fragmentTracker,r=this.media,n=this.tracks;if(!n||!n[t]||!n[t].details)break;var a,s=e.maxBufferHole,o=e.maxFragLookUpTolerance,u=Math.min(e.maxBufferLength,e.maxMaxBufferLength),d=j.bufferedInfo(this._getBuffered(),r.currentTime,s),h=d.end,f=n[t].details,p=f.fragments,g=p.length;if(d.len>u)return;var m=this.fragPrevious;h<p[g-1].start+p[g-1].duration?(m&&f.hasProgramDateTime&&(a=ae(p,m.endProgramDateTime,o)),a||(a=se(m,p,h,o))):a=p[g-1],a&&a.encrypted?(c.b.log("Loading key for "+a.sn),this.state=me,this.hls.trigger(l.a.KEY_LOADING,{frag:a})):a&&i.getState(a)===P&&(this.fragCurrent=a,this.state=ve,this.hls.trigger(l.a.FRAG_LOADING,{frag:a}))}else this.state=ge},n.stopLoad=function(){this.lastAVStart=0,this.fragPrevious=null,e.prototype.stopLoad.call(this)},n._getBuffered=function(){return this.tracksBuffered[this.currentTrackId]||[]},n.onMediaSeeking=function(){if(this.fragCurrent){var e=this.media?this.media.currentTime:0,t=this.config.maxFragLookUpTolerance;(e<this.fragCurrent.start-t||e>this.fragCurrent.start+this.fragCurrent.duration+t)&&(this.fragCurrent.loader&&this.fragCurrent.loader.abort(),this.fragmentTracker.removeFragment(this.fragCurrent),this.fragCurrent=null,this.fragPrevious=null,this.state=ge,this.tick())}},r}(Ae);!function(e){e.WIDEVINE="com.widevine.alpha",e.PLAYREADY="com.microsoft.playready"}(Rt||(Rt={}));var Mt="undefined"!=typeof window&&window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null,Nt=function(e){var t,i;function r(t){var i;return(i=e.call(this,t,l.a.MEDIA_ATTACHED,l.a.MEDIA_DETACHED,l.a.MANIFEST_PARSED)||this)._widevineLicenseUrl=void 0,i._licenseXhrSetup=void 0,i._emeEnabled=void 0,i._requestMediaKeySystemAccess=void 0,i._drmSystemOptions=void 0,i._config=void 0,i._mediaKeysList=[],i._media=null,i._hasSetMediaKeys=!1,i._requestLicenseFailureCount=0,i.mediaKeysPromise=null,i._onMediaEncrypted=function(e){if(c.b.log('Media is encrypted using "'+e.initDataType+'" init data type'),!i.mediaKeysPromise)return c.b.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),void i.hls.trigger(l.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_NO_KEYS,fatal:!0});var t=function(t){i._media&&(i._attemptSetMediaKeys(t),i._generateRequestWithPreferredKeySession(e.initDataType,e.initData))};i.mediaKeysPromise.then(t).catch(t)},i._config=t.config,i._widevineLicenseUrl=i._config.widevineLicenseUrl,i._licenseXhrSetup=i._config.licenseXhrSetup,i._emeEnabled=i._config.emeEnabled,i._requestMediaKeySystemAccess=i._config.requestMediaKeySystemAccessFunc,i._drmSystemOptions=t.config.drmSystemOptions,i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var n,a=r.prototype;return a.getLicenseServerUrl=function(e){switch(e){case Rt.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+e+'"')},a._attemptKeySystemAccess=function(e,t,i){var r=this,n=function(e,t,i,r){switch(e){case Rt.WIDEVINE:return function(e,t,i){var r={audioCapabilities:[],videoCapabilities:[]};return e.forEach((function(e){r.audioCapabilities.push({contentType:'audio/mp4; codecs="'+e+'"',robustness:i.audioRobustness||""})})),t.forEach((function(e){r.videoCapabilities.push({contentType:'video/mp4; codecs="'+e+'"',robustness:i.videoRobustness||""})})),[r]}(t,i,r);default:throw new Error("Unknown key-system: "+e)}}(e,t,i,this._drmSystemOptions);c.b.log("Requesting encrypted media key-system access");var a=this.requestMediaKeySystemAccess(e,n);this.mediaKeysPromise=a.then((function(t){return r._onMediaKeySystemAccessObtained(e,t)})),a.catch((function(t){c.b.error('Failed to obtain key-system "'+e+'" access:',t)}))},a._onMediaKeySystemAccessObtained=function(e,t){var i=this;c.b.log('Access for key-system "'+e+'" obtained');var r={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:t,mediaKeySystemDomain:e};this._mediaKeysList.push(r);var n=Promise.resolve().then((function(){return t.createMediaKeys()})).then((function(t){return r.mediaKeys=t,c.b.log('Media-keys created for key-system "'+e+'"'),i._onMediaKeysCreated(),t}));return n.catch((function(e){c.b.error("Failed to create media-keys:",e)})),n},a._onMediaKeysCreated=function(){var e=this;this._mediaKeysList.forEach((function(t){t.mediaKeysSession||(t.mediaKeysSession=t.mediaKeys.createSession(),e._onNewMediaKeySession(t.mediaKeysSession))}))},a._onNewMediaKeySession=function(e){var t=this;c.b.log("New key-system session "+e.sessionId),e.addEventListener("message",(function(i){t._onKeySessionMessage(e,i.message)}),!1)},a._onKeySessionMessage=function(e,t){c.b.log("Got EME message event, creating license request"),this._requestLicense(t,(function(t){c.b.log("Received license data (length: "+(t?t.byteLength:t)+"), updating key-session"),e.update(t)}))},a._attemptSetMediaKeys=function(e){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var t=this._mediaKeysList[0];if(!t||!t.mediaKeys)return c.b.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(l.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_NO_KEYS,fatal:!0});c.b.log("Setting keys for encrypted media"),this._media.setMediaKeys(t.mediaKeys),this._hasSetMediaKeys=!0}},a._generateRequestWithPreferredKeySession=function(e,t){var i=this,r=this._mediaKeysList[0];if(!r)return c.b.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(l.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(r.mediaKeysSessionInitialized)c.b.warn("Key-Session already initialized but requested again");else{var n=r.mediaKeysSession;if(!n)return c.b.error("Fatal: Media is encrypted but no key-session existing"),void this.hls.trigger(l.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_NO_SESSION,fatal:!0});if(!t)return c.b.warn("Fatal: initData required for generating a key session is null"),void this.hls.trigger(l.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});c.b.log('Generating key-session request for "'+e+'" init data type'),r.mediaKeysSessionInitialized=!0,n.generateRequest(e,t).then((function(){c.b.debug("Key-session generation succeeded")})).catch((function(e){c.b.error("Error generating key-session request:",e),i.hls.trigger(l.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_NO_SESSION,fatal:!1})}))}},a._createLicenseXhr=function(e,t,i){var r=new XMLHttpRequest,n=this._licenseXhrSetup;try{if(n)try{n(r,e)}catch(t){r.open("POST",e,!0),n(r,e)}r.readyState||r.open("POST",e,!0)}catch(e){throw new Error("issue setting up KeySystem license XHR "+e)}return r.responseType="arraybuffer",r.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,r,e,t,i),r},a._onLicenseRequestReadyStageChange=function(e,t,i,r){switch(e.readyState){case 4:if(200===e.status)this._requestLicenseFailureCount=0,c.b.log("License request succeeded"),"arraybuffer"!==e.responseType&&c.b.warn("xhr response type was not set to the expected arraybuffer for license request"),r(e.response);else{if(c.b.error("License Request XHR failed ("+t+"). Status: "+e.status+" ("+e.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>3)return void this.hls.trigger(l.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});c.b.warn("Retrying license request, "+(3-this._requestLicenseFailureCount+1)+" attempts left"),this._requestLicense(i,r)}}},a._generateLicenseRequestChallenge=function(e,t){switch(e.mediaKeySystemDomain){case Rt.WIDEVINE:return t}throw new Error("unsupported key-system: "+e.mediaKeySystemDomain)},a._requestLicense=function(e,t){c.b.log("Requesting content license for key-system");var i=this._mediaKeysList[0];if(!i)return c.b.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(l.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_NO_ACCESS,fatal:!0});try{var r=this.getLicenseServerUrl(i.mediaKeySystemDomain),n=this._createLicenseXhr(r,e,t);c.b.log("Sending license request to URL: "+r);var a=this._generateLicenseRequestChallenge(i,e);n.send(a)}catch(e){c.b.error("Failure requesting DRM license: "+e),this.hls.trigger(l.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},a.onMediaAttached=function(e){if(this._emeEnabled){var t=e.media;this._media=t,t.addEventListener("encrypted",this._onMediaEncrypted)}},a.onMediaDetached=function(){var e=this._media,t=this._mediaKeysList;e&&(e.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(t.map((function(e){if(e.mediaKeysSession)return e.mediaKeysSession.close().catch((function(){}))}))).then((function(){return e.setMediaKeys(null)})).catch((function(){})))},a.onManifestParsed=function(e){if(this._emeEnabled){var t=e.levels.map((function(e){return e.audioCodec})),i=e.levels.map((function(e){return e.videoCodec}));this._attemptKeySystemAccess(Rt.WIDEVINE,t,i)}},(n=[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}])&&function(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(r.prototype,n),r}(h);function Ut(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function Ft(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Ut(Object(i),!0).forEach((function(t){Bt(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Ut(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Bt(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var jt=Ft(Ft({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,liveBackBufferLength:1/0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:qe,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:Ue,bufferController:Be,capLevelController:Ve,fpsController:Ge,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:Mt,testBandwidth:!0},{cueHandler:r,enableCEA708Captions:!0,enableWebVTT:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:Pt,subtitleTrackController:Dt,timelineController:Lt,audioStreamController:ze,audioTrackController:Ke,emeController:Nt});function Vt(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function Ht(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Vt(Object(i),!0).forEach((function(t){Gt(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Vt(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Gt(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function qt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kt(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wt(e,t,i){return t&&Kt(e.prototype,t),i&&Kt(e,i),e}var zt=function(e){var t,i;function r(t){var i;void 0===t&&(t={}),(i=e.call(this)||this).config=void 0,i._autoLevelCapping=void 0,i.abrController=void 0,i.capLevelController=void 0,i.levelController=void 0,i.streamController=void 0,i.networkControllers=void 0,i.audioTrackController=void 0,i.subtitleTrackController=void 0,i.emeController=void 0,i.coreComponents=void 0,i.media=null,i.url=null;var n=r.DefaultConfig;if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");i.config=Ht(Ht({},n),t);var a=qt(i).config;if(void 0!==a.liveMaxLatencyDurationCount&&a.liveMaxLatencyDurationCount<=a.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==a.liveMaxLatencyDuration&&(void 0===a.liveSyncDuration||a.liveMaxLatencyDuration<=a.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');Object(c.a)(a.debug),i._autoLevelCapping=-1;var s=i.abrController=new a.abrController(qt(i)),o=new a.bufferController(qt(i)),u=i.capLevelController=new a.capLevelController(qt(i)),l=new a.fpsController(qt(i)),d=new D(qt(i)),h=new O(qt(i)),f=new x(qt(i)),p=new xe(qt(i)),g=i.levelController=new Ie(qt(i)),m=new F(qt(i)),v=[g,i.streamController=new Le(qt(i),m)],y=a.audioStreamController;y&&v.push(new y(qt(i),m)),i.networkControllers=v;var _=[d,h,f,s,o,u,l,p,m];if(y=a.audioTrackController){var b=new y(qt(i));i.audioTrackController=b,_.push(b)}if(y=a.subtitleTrackController){var T=new y(qt(i));i.subtitleTrackController=T,v.push(T)}if(y=a.emeController){var S=new y(qt(i));i.emeController=S,_.push(S)}return(y=a.subtitleStreamController)&&v.push(new y(qt(i),m)),(y=a.timelineController)&&_.push(new y(qt(i))),i.coreComponents=_,i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i,r.isSupported=function(){return function(){var e=q();if(!e)return!1;var t=self.SourceBuffer||self.WebKitSourceBuffer;return!(!e||"function"!=typeof e.isTypeSupported||!e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')||t&&(!t.prototype||"function"!=typeof t.prototype.appendBuffer||"function"!=typeof t.prototype.remove))}()},Wt(r,null,[{key:"version",get:function(){return"0.14.17"}},{key:"Events",get:function(){return l.a}},{key:"ErrorTypes",get:function(){return o.b}},{key:"ErrorDetails",get:function(){return o.a}},{key:"DefaultConfig",get:function(){return r.defaultConfig?r.defaultConfig:jt},set:function(e){r.defaultConfig=e}}]);var n=r.prototype;return n.destroy=function(){c.b.log("destroy"),this.trigger(l.a.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach((function(e){e.destroy()})),this.url=null,this.removeAllListeners(),this._autoLevelCapping=-1},n.attachMedia=function(e){c.b.log("attachMedia"),this.media=e,this.trigger(l.a.MEDIA_ATTACHING,{media:e})},n.detachMedia=function(){c.b.log("detachMedia"),this.trigger(l.a.MEDIA_DETACHING),this.media=null},n.loadSource=function(e){e=s.buildAbsoluteURL(window.location.href,e,{alwaysNormalize:!0}),c.b.log("loadSource:"+e),this.url=e,this.trigger(l.a.MANIFEST_LOADING,{url:e})},n.startLoad=function(e){void 0===e&&(e=-1),c.b.log("startLoad("+e+")"),this.networkControllers.forEach((function(t){t.startLoad(e)}))},n.stopLoad=function(){c.b.log("stopLoad"),this.networkControllers.forEach((function(e){e.stopLoad()}))},n.swapAudioCodec=function(){c.b.log("swapAudioCodec"),this.streamController.swapAudioCodec()},n.recoverMediaError=function(){c.b.log("recoverMediaError");var e=this.media;this.detachMedia(),e&&this.attachMedia(e)},n.removeLevel=function(e,t){void 0===t&&(t=0),this.levelController.removeLevel(e,t)},Wt(r,[{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){c.b.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){c.b.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){c.b.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){c.b.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){c.b.log("set startLevel:"+e),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}},{key:"capLevelToPlayerSize",set:function(e){var t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){c.b.log("set autoLevelCapping:"+e),this._autoLevelCapping=e}},{key:"bandwidthEstimate",get:function(){var e=this.abrController._bwEstimator;return e?e.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var e=this.levels,t=this.config.minAutoBitrate,i=e?e.length:0,r=0;r<i;r++)if((e[r].realBitrate?Math.max(e[r].realBitrate,e[r].bitrate):e[r].bitrate)>t)return r;return 0}},{key:"maxAutoLevel",get:function(){var e=this.levels,t=this.autoLevelCapping;return-1===t&&e&&e.length?e.length-1:t}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}},{key:"subtitleDisplay",get:function(){var e=this.subtitleTrackController;return!!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}}]),r}(W);zt.defaultConfig=void 0}]).default})),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("global/window"),require("global/document")):"function"==typeof define&&define.amd?define(["global/window","global/document"],t):(e=e||self).videojs=t(e.window,e.document)}(this,(function(e,t){"use strict";e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e,t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t;var i="7.10.2",r=[],n=function t(i){function n(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];a("log",s,t)}var a,s="info";return a=function(t,i){return function(n,a,s){var o=i.levels[a],u=new RegExp("^("+o+")$");if("log"!==n&&s.unshift(n.toUpperCase()+":"),s.unshift(t+":"),r){r.push([].concat(s));var l=r.length-1e3;r.splice(0,0<l?l:0)}if(e.console){var c=e.console[n];c||"debug"!==n||(c=e.console.info||e.console.log),c&&o&&u.test(n)&&c[Array.isArray(s)?"apply":"call"](e.console,s)}}}(i,n),n.createLogger=function(e){return t(i+": "+e)},n.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:s},n.level=function(e){if("string"==typeof e){if(!n.levels.hasOwnProperty(e))throw new Error('"'+e+'" in not a valid log level');s=e}return s},(n.history=function(){return r?[].concat(r):[]}).filter=function(e){return(r||[]).filter((function(t){return new RegExp(".*"+e+".*").test(t[0])}))},n.history.clear=function(){r&&(r.length=0)},n.history.disable=function(){null!==r&&(r.length=0,r=null)},n.history.enable=function(){null===r&&(r=[])},n.error=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return a("error",s,t)},n.warn=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return a("warn",s,t)},n.debug=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return a("debug",s,t)},n}("VIDEOJS"),a=n.createLogger;function s(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function o(e,t){return e(t={exports:{}},t.exports),t.exports}var u=o((function(e){function t(){return e.exports=t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},t.apply(this,arguments)}e.exports=t})),l=Object.prototype.toString,c=function(e){return f(e)?Object.keys(e):[]};function d(e,t){c(e).forEach((function(i){return t(e[i],i)}))}function h(e){for(var t=arguments.length,i=new Array(1<t?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return Object.assign?u.apply(void 0,[e].concat(i)):(i.forEach((function(t){t&&d(t,(function(t,i){e[i]=t}))})),e)}function f(e){return!!e&&"object"==typeof e}function p(e){return f(e)&&"[object Object]"===l.call(e)&&e.constructor===Object}function g(t,i){if(!t||!i)return"";if("function"!=typeof e.getComputedStyle)return"";var r=e.getComputedStyle(t);return r?r.getPropertyValue(i)||r[i]:""}function m(e){return"string"==typeof e&&Boolean(e.trim())}function v(e){if(0<=e.indexOf(" "))throw new Error("class has illegal whitespace characters")}function y(){return t===e.document}function _(e){return f(e)&&1===e.nodeType}function b(){try{return e.parent!==e.self}catch(na){return!0}}function T(e){return function(i,r){if(!m(i))return t[e](null);m(r)&&(r=t.querySelector(r));var n=_(r)?r:t;return n[e]&&n[e](i)}}function S(e,i,r,a){void 0===e&&(e="div"),void 0===i&&(i={}),void 0===r&&(r={});var s=t.createElement(e);return Object.getOwnPropertyNames(i).forEach((function(e){var t=i[e];-1!==e.indexOf("aria-")||"role"===e||"type"===e?(n.warn("Setting attributes in the second argument of createEl()\nhas been deprecated. Use the third argument instead.\ncreateEl(type, properties, attributes). Attempting to set "+e+" to "+t+"."),s.setAttribute(e,t)):"textContent"===e?E(s,t):s[e]!==t&&(s[e]=t)})),Object.getOwnPropertyNames(r).forEach((function(e){s.setAttribute(e,r[e])})),a&&H(s,a),s}function E(e,t){return void 0===e.textContent?e.innerText=t:e.textContent=t,e}function k(e,t){t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)}function w(e,t){return v(t),e.classList?e.classList.contains(t):function(e){return new RegExp("(^|\\s)"+e+"($|\\s)")}(t).test(e.className)}function C(e,t){return e.classList?e.classList.add(t):w(e,t)||(e.className=(e.className+" "+t).trim()),e}function A(e,t){return e.classList?e.classList.remove(t):(v(t),e.className=e.className.split(/\s+/).filter((function(e){return e!==t})).join(" ")),e}function L(e,t,i){var r=w(e,t);if("function"==typeof i&&(i=i(e,t)),"boolean"!=typeof i&&(i=!r),i!==r)return i?C(e,t):A(e,t),e}function I(e,t){Object.getOwnPropertyNames(t).forEach((function(i){var r=t[i];null==r||!1===r?e.removeAttribute(i):e.setAttribute(i,!0===r?"":r)}))}function R(e){var t={};if(e&&e.attributes&&0<e.attributes.length)for(var i=e.attributes,r=i.length-1;0<=r;r--){var n=i[r].name,a=i[r].value;"boolean"!=typeof e[n]&&-1===",autoplay,controls,playsinline,loop,muted,default,defaultMuted,".indexOf(","+n+",")||(a=null!==a),t[n]=a}return t}function D(e,t){return e.getAttribute(t)}function O(e,t,i){e.setAttribute(t,i)}function x(e,t){e.removeAttribute(t)}function P(){t.body.focus(),t.onselectstart=function(){return!1}}function M(){t.onselectstart=function(){return!0}}function N(e){if(e&&e.getBoundingClientRect&&e.parentNode){var t=e.getBoundingClientRect(),i={};return["bottom","height","left","right","top","width"].forEach((function(e){void 0!==t[e]&&(i[e]=t[e])})),i.height||(i.height=parseFloat(g(e,"height"))),i.width||(i.width=parseFloat(g(e,"width"))),i}}function U(e){if(!e||e&&!e.offsetParent)return{left:0,top:0,width:0,height:0};for(var t=e.offsetWidth,i=e.offsetHeight,r=0,n=0;r+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;);return{left:r,top:n,width:t,height:i}}function F(e,t){var i={},r=U(t.target),n=U(e),a=n.width,s=t.offsetY-(n.top-r.top),o=t.offsetX-(n.left-r.left);return t.changedTouches&&(o=t.changedTouches[0].pageX-n.left,s=t.changedTouches[0].pageY+n.top),i.y=1-Math.max(0,Math.min(1,s/n.height)),i.x=Math.max(0,Math.min(1,o/a)),i}function B(e){return f(e)&&3===e.nodeType}function j(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e}function V(e){return"function"==typeof e&&(e=e()),(Array.isArray(e)?e:[e]).map((function(e){return"function"==typeof e&&(e=e()),_(e)||B(e)?e:"string"==typeof e&&/\S/.test(e)?t.createTextNode(e):void 0})).filter((function(e){return e}))}function H(e,t){return V(t).forEach((function(t){return e.appendChild(t)})),e}function G(e,t){return H(j(e),t)}function q(e){return void 0===e.button&&void 0===e.buttons||0===e.button&&void 0===e.buttons||"mouseup"===e.type&&0===e.button&&0===e.buttons||0===e.button&&1===e.buttons}var K,W=T("querySelector"),z=T("querySelectorAll"),Y=Object.freeze({__proto__:null,isReal:y,isEl:_,isInFrame:b,createEl:S,textContent:E,prependTo:k,hasClass:w,addClass:C,removeClass:A,toggleClass:L,setAttributes:I,getAttributes:R,getAttribute:D,setAttribute:O,removeAttribute:x,blockTextSelection:P,unblockTextSelection:M,getBoundingClientRect:N,findPosition:U,getPointerPosition:F,isTextNode:B,emptyEl:j,normalizeContent:V,appendContent:H,insertContent:G,isSingleLeftClick:q,$:W,$$:z}),X=!1,Q=function(){if(y()&&!1!==K.options.autoSetup){var e=Array.prototype.slice.call(t.getElementsByTagName("video")),i=Array.prototype.slice.call(t.getElementsByTagName("audio")),r=Array.prototype.slice.call(t.getElementsByTagName("video-js")),n=e.concat(i,r);if(n&&0<n.length)for(var a=0,s=n.length;a<s;a++){var o=n[a];if(!o||!o.getAttribute){$(1);break}void 0===o.player&&null!==o.getAttribute("data-setup")&&K(o)}else X||$(1)}};function $(t,i){i&&(K=i),e.setTimeout(Q,t)}function J(){X=!0,e.removeEventListener("load",J)}function Z(e){var i=t.createElement("style");return i.className=e,i}function ee(e,t){e.styleSheet?e.styleSheet.cssText=t:e.textContent=t}y()&&("complete"===t.readyState?J():e.addEventListener("load",J));var te,ie=3;function re(){return ie++}e.WeakMap||(te=function(){function t(){this.vdata="vdata"+Math.floor(e.performance&&e.performance.now()||Date.now()),this.data={}}var i=t.prototype;return i.set=function(e,t){var i=e[this.vdata]||re();return e[this.vdata]||(e[this.vdata]=i),this.data[i]=t,this},i.get=function(e){var t=e[this.vdata];if(t)return this.data[t];n("We have no data for this element",e)},i.has=function(e){return e[this.vdata]in this.data},i.delete=function(e){var t=e[this.vdata];t&&(delete this.data[t],delete e[this.vdata])},t}());var ne,ae=e.WeakMap?new WeakMap:new te;function se(e,t){if(ae.has(e)){var i=ae.get(e);0===i.handlers[t].length&&(delete i.handlers[t],e.removeEventListener?e.removeEventListener(t,i.dispatcher,!1):e.detachEvent&&e.detachEvent("on"+t,i.dispatcher)),Object.getOwnPropertyNames(i.handlers).length<=0&&(delete i.handlers,delete i.dispatcher,delete i.disabled),0===Object.getOwnPropertyNames(i).length&&ae.delete(e)}}function oe(e,t,i,r){i.forEach((function(i){e(t,i,r)}))}function ue(i){if(i.fixed_)return i;function r(){return!0}function n(){return!1}if(!i||!i.isPropagationStopped){var a=i||e.event;for(var s in i={},a)"layerX"!==s&&"layerY"!==s&&"keyLocation"!==s&&"webkitMovementX"!==s&&"webkitMovementY"!==s&&("returnValue"===s&&a.preventDefault||(i[s]=a[s]));if(i.target||(i.target=i.srcElement||t),i.relatedTarget||(i.relatedTarget=i.fromElement===i.target?i.toElement:i.fromElement),i.preventDefault=function(){a.preventDefault&&a.preventDefault(),i.returnValue=!1,a.returnValue=!1,i.defaultPrevented=!0},i.defaultPrevented=!1,i.stopPropagation=function(){a.stopPropagation&&a.stopPropagation(),i.cancelBubble=!0,a.cancelBubble=!0,i.isPropagationStopped=r},i.isPropagationStopped=n,i.stopImmediatePropagation=function(){a.stopImmediatePropagation&&a.stopImmediatePropagation(),i.isImmediatePropagationStopped=r,i.stopPropagation()},i.isImmediatePropagationStopped=n,null!=i.clientX){var o=t.documentElement,u=t.body;i.pageX=i.clientX+(o&&o.scrollLeft||u&&u.scrollLeft||0)-(o&&o.clientLeft||u&&u.clientLeft||0),i.pageY=i.clientY+(o&&o.scrollTop||u&&u.scrollTop||0)-(o&&o.clientTop||u&&u.clientTop||0)}i.which=i.charCode||i.keyCode,null!=i.button&&(i.button=1&i.button?0:4&i.button?1:2&i.button?2:0)}return i.fixed_=!0,i}var le=["touchstart","touchmove"];function ce(t,i,r){if(Array.isArray(i))return oe(ce,t,i,r);ae.has(t)||ae.set(t,{});var a=ae.get(t);if(a.handlers||(a.handlers={}),a.handlers[i]||(a.handlers[i]=[]),r.guid||(r.guid=re()),a.handlers[i].push(r),a.dispatcher||(a.disabled=!1,a.dispatcher=function(e,i){if(!a.disabled){e=ue(e);var r=a.handlers[e.type];if(r)for(var s=r.slice(0),o=0,u=s.length;o<u&&!e.isImmediatePropagationStopped();o++)try{s[o].call(t,e,i)}catch(e){n.error(e)}}}),1===a.handlers[i].length)if(t.addEventListener){var s=!1;(function(){if("boolean"!=typeof ne){ne=!1;try{var t=Object.defineProperty({},"passive",{get:function(){ne=!0}});e.addEventListener("test",null,t),e.removeEventListener("test",null,t)}catch(t){}}return ne})()&&-1<le.indexOf(i)&&(s={passive:!0}),t.addEventListener(i,a.dispatcher,s)}else t.attachEvent&&t.attachEvent("on"+i,a.dispatcher)}function de(e,t,i){if(ae.has(e)){var r=ae.get(e);if(r.handlers){if(Array.isArray(t))return oe(de,e,t,i);var n=function(e,t){r.handlers[t]=[],se(e,t)};if(void 0!==t){var a=r.handlers[t];if(a)if(i){if(i.guid)for(var s=0;s<a.length;s++)a[s].guid===i.guid&&a.splice(s--,1);se(e,t)}else n(e,t)}else for(var o in r.handlers)Object.prototype.hasOwnProperty.call(r.handlers||{},o)&&n(e,o)}}}function he(e,t,i){var r=ae.has(e)?ae.get(e):{},n=e.parentNode||e.ownerDocument;if("string"==typeof t?t={type:t,target:e}:t.target||(t.target=e),t=ue(t),r.dispatcher&&r.dispatcher.call(e,t,i),n&&!t.isPropagationStopped()&&!0===t.bubbles)he.call(null,n,t,i);else if(!n&&!t.defaultPrevented&&t.target&&t.target[t.type]){ae.has(t.target)||ae.set(t.target,{});var a=ae.get(t.target);t.target[t.type]&&(a.disabled=!0,"function"==typeof t.target[t.type]&&t.target[t.type](),a.disabled=!1)}return!t.defaultPrevented}function fe(e,t,i){if(Array.isArray(t))return oe(fe,e,t,i);function r(){de(e,t,r),i.apply(this,arguments)}r.guid=i.guid=i.guid||re(),ce(e,t,r)}function pe(e,t,i){function r(){de(e,t,r),i.apply(this,arguments)}r.guid=i.guid=i.guid||re(),ce(e,t,r)}function ge(e,t,i){t.guid||(t.guid=re());var r=t.bind(e);return r.guid=i?i+"_"+t.guid:t.guid,r}function me(t,i){var r=e.performance.now();return function(){var n=e.performance.now();i<=n-r&&(t.apply(void 0,arguments),r=n)}}function ve(){}var ye,_e=Object.freeze({__proto__:null,fixEvent:ue,on:ce,off:de,trigger:he,one:fe,any:pe});function be(e){return"string"==typeof e&&/\S/.test(e)||Array.isArray(e)&&!!e.length}function Te(e){if(!e.nodeName&&!Ce(e))throw new Error("Invalid target; must be a DOM node or evented object.")}function Se(e){if(!be(e))throw new Error("Invalid event type; must be a non-empty string or array.")}function Ee(e){if("function"!=typeof e)throw new Error("Invalid listener; must be a function.")}function ke(e,t){var i,r,n,a=t.length<3||t[0]===e||t[0]===e.eventBusEl_;return n=a?(i=e.eventBusEl_,3<=t.length&&t.shift(),r=t[0],t[1]):(i=t[0],r=t[1],t[2]),Te(i),Se(r),Ee(n),{isTargetingSelf:a,target:i,type:r,listener:n=ge(e,n)}}function we(e,t,i,r){Te(e),e.nodeName?_e[t](e,i,r):e[t](i,r)}ve.prototype.allowedEvents_={},ve.prototype.addEventListener=ve.prototype.on=function(e,t){var i=this.addEventListener;this.addEventListener=function(){},ce(this,e,t),this.addEventListener=i},ve.prototype.removeEventListener=ve.prototype.off=function(e,t){de(this,e,t)},ve.prototype.one=function(e,t){var i=this.addEventListener;this.addEventListener=function(){},fe(this,e,t),this.addEventListener=i},ve.prototype.any=function(e,t){var i=this.addEventListener;this.addEventListener=function(){},pe(this,e,t),this.addEventListener=i},ve.prototype.dispatchEvent=ve.prototype.trigger=function(e){var t=e.type||e;"string"==typeof e&&(e={type:t}),e=ue(e),this.allowedEvents_[t]&&this["on"+t]&&this["on"+t](e),he(this,e)},ve.prototype.queueTrigger=function(t){var i=this;ye=ye||new Map;var r=t.type||t,n=ye.get(this);n||(n=new Map,ye.set(this,n));var a=n.get(r);n.delete(r),e.clearTimeout(a);var s=e.setTimeout((function(){0===n.size&&(n=null,ye.delete(i)),i.trigger(t)}),0);n.set(r,s)};var Ce=function(e){return e instanceof ve||!!e.eventBusEl_&&["on","one","off","trigger"].every((function(t){return"function"==typeof e[t]}))},Ae={on:function(){for(var e=this,t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];var n=ke(this,i),a=n.isTargetingSelf,s=n.target,o=n.type,u=n.listener;if(we(s,"on",o,u),!a){var l=function(){return e.off(s,o,u)};l.guid=u.guid;var c=function(){return e.off("dispose",l)};c.guid=u.guid,we(this,"on","dispose",l),we(s,"on","dispose",c)}},one:function(){for(var e=this,t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];var n=ke(this,i),a=n.isTargetingSelf,s=n.target,o=n.type,u=n.listener;if(a)we(s,"one",o,u);else{var l=function t(){e.off(s,o,t);for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];u.apply(null,r)};l.guid=u.guid,we(s,"one",o,l)}},any:function(){for(var e=this,t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];var n=ke(this,i),a=n.isTargetingSelf,s=n.target,o=n.type,u=n.listener;if(a)we(s,"any",o,u);else{var l=function t(){e.off(s,o,t);for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];u.apply(null,r)};l.guid=u.guid,we(s,"any",o,l)}},off:function(e,t,i){if(!e||be(e))de(this.eventBusEl_,e,t);else{var r=e,n=t;Te(r),Se(n),Ee(i),i=ge(this,i),this.off("dispose",i),r.nodeName?(de(r,n,i),de(r,"dispose",i)):Ce(r)&&(r.off(n,i),r.off("dispose",i))}},trigger:function(e,t){return he(this.eventBusEl_,e,t)}};function Le(t,i){void 0===i&&(i={});var r=i.eventBusKey;if(r){if(!t[r].nodeName)throw new Error('The eventBusKey "'+r+'" does not refer to an element.');t.eventBusEl_=t[r]}else t.eventBusEl_=S("span",{className:"vjs-event-bus"});return h(t,Ae),t.eventedCallbacks&&t.eventedCallbacks.forEach((function(e){e()})),t.on("dispose",(function(){t.off(),e.setTimeout((function(){t.eventBusEl_=null}),0)})),t}var Ie={state:{},setState:function(e){var t,i=this;return"function"==typeof e&&(e=e()),d(e,(function(e,r){i.state[r]!==e&&((t=t||{})[r]={from:i.state[r],to:e}),i.state[r]=e})),t&&Ce(this)&&this.trigger({changes:t,type:"statechanged"}),t}};function Re(e,t){return h(e,Ie),e.state=h({},e.state,t),"function"==typeof e.handleStateChanged&&Ce(e)&&e.on("statechanged",e.handleStateChanged),e}function De(e){return"string"!=typeof e?e:e.replace(/./,(function(e){return e.toLowerCase()}))}function Oe(e){return"string"!=typeof e?e:e.replace(/./,(function(e){return e.toUpperCase()}))}function xe(){for(var e={},t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return i.forEach((function(t){t&&d(t,(function(t,i){p(t)?(p(e[i])||(e[i]={}),e[i]=xe(e[i],t)):e[i]=t}))})),e}var Pe=function(){function e(){this.map_={}}var t=e.prototype;return t.has=function(e){return e in this.map_},t.delete=function(e){var t=this.has(e);return delete this.map_[e],t},t.set=function(e,t){return this.set_[e]=t,this},t.forEach=function(e,t){for(var i in this.map_)e.call(t,this.map_[i],i,this)},e}(),Me=e.Map?e.Map:Pe,Ne=function(){function e(){this.set_={}}var t=e.prototype;return t.has=function(e){return e in this.set_},t.delete=function(e){var t=this.has(e);return delete this.set_[e],t},t.add=function(e){return this.set_[e]=1,this},t.forEach=function(e,t){for(var i in this.set_)e.call(t,i,i,this)},e}(),Ue=e.Set?e.Set:Ne,Fe=function(){function t(e,t,i){if(this.player_=!e&&this.play?e=this:e,this.isDisposed_=!1,this.parentComponent_=null,this.options_=xe({},this.options_),t=this.options_=xe(this.options_,t),this.id_=t.id||t.el&&t.el.id,!this.id_){var r=e&&e.id&&e.id()||"no_player";this.id_=r+"_component_"+re()}this.name_=t.name||null,t.el?this.el_=t.el:!1!==t.createEl&&(this.el_=this.createEl()),!1!==t.evented&&Le(this,{eventBusKey:this.el_?"el_":null}),Re(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.setTimeoutIds_=new Ue,this.setIntervalIds_=new Ue,this.rafIds_=new Ue,this.namedRafs_=new Me,(this.clearingTimersOnDispose_=!1)!==t.initChildren&&this.initChildren(),this.ready(i),!1!==t.reportTouchActivity&&this.enableTouchActivity()}var i=t.prototype;return i.dispose=function(){if(!this.isDisposed_){if(this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(var e=this.children_.length-1;0<=e;e--)this.children_[e].dispose&&this.children_[e].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),ae.has(this.el_)&&ae.delete(this.el_),this.el_=null),this.player_=null}},i.isDisposed=function(){return Boolean(this.isDisposed_)},i.player=function(){return this.player_},i.options=function(e){return e&&(this.options_=xe(this.options_,e)),this.options_},i.el=function(){return this.el_},i.createEl=function(e,t,i){return S(e,t,i)},i.localize=function(e,t,i){void 0===i&&(i=e);var r=this.player_.language&&this.player_.language(),n=this.player_.languages&&this.player_.languages(),a=n&&n[r],s=r&&r.split("-")[0],o=n&&n[s],u=i;return a&&a[e]?u=a[e]:o&&o[e]&&(u=o[e]),t&&(u=u.replace(/\{(\d+)\}/g,(function(e,i){var r=t[i-1],n=r;return void 0===r&&(n=e),n}))),u},i.contentEl=function(){return this.contentEl_||this.el_},i.id=function(){return this.id_},i.name=function(){return this.name_},i.children=function(){return this.children_},i.getChildById=function(e){return this.childIndex_[e]},i.getChild=function(e){if(e)return this.childNameIndex_[e]},i.getDescendant=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t=t.reduce((function(e,t){return e.concat(t)}),[]);for(var r=this,n=0;n<t.length;n++)if(!(r=r.getChild(t[n]))||!r.getChild)return;return r},i.addChild=function(e,i,r){var n,a;if(void 0===i&&(i={}),void 0===r&&(r=this.children_.length),"string"==typeof e){a=Oe(e);var s=i.componentClass||a;i.name=a;var o=t.getComponent(s);if(!o)throw new Error("Component "+s+" does not exist");if("function"!=typeof o)return null;n=new o(this.player_||this,i)}else n=e;if(n.parentComponent_&&n.parentComponent_.removeChild(n),this.children_.splice(r,0,n),n.parentComponent_=this,"function"==typeof n.id&&(this.childIndex_[n.id()]=n),(a=a||n.name&&Oe(n.name()))&&(this.childNameIndex_[a]=n,this.childNameIndex_[De(a)]=n),"function"==typeof n.el&&n.el()){var u=null;this.children_[r+1]&&(this.children_[r+1].el_?u=this.children_[r+1].el_:_(this.children_[r+1])&&(u=this.children_[r+1])),this.contentEl().insertBefore(n.el(),u)}return n},i.removeChild=function(e){if("string"==typeof e&&(e=this.getChild(e)),e&&this.children_){for(var t=!1,i=this.children_.length-1;0<=i;i--)if(this.children_[i]===e){t=!0,this.children_.splice(i,1);break}if(t){e.parentComponent_=null,this.childIndex_[e.id()]=null,this.childNameIndex_[Oe(e.name())]=null,this.childNameIndex_[De(e.name())]=null;var r=e.el();r&&r.parentNode===this.contentEl()&&this.contentEl().removeChild(e.el())}}},i.initChildren=function(){var e=this,i=this.options_.children;if(i){var r,n=this.options_,a=t.getComponent("Tech");(r=Array.isArray(i)?i:Object.keys(i)).concat(Object.keys(this.options_).filter((function(e){return!r.some((function(t){return"string"==typeof t?e===t:e===t.name}))}))).map((function(t){var r,n;return n="string"==typeof t?i[r=t]||e.options_[r]||{}:(r=t.name,t),{name:r,opts:n}})).filter((function(e){var i=t.getComponent(e.opts.componentClass||Oe(e.name));return i&&!a.isTech(i)})).forEach((function(t){var i=t.name,r=t.opts;if(void 0!==n[i]&&(r=n[i]),!1!==r){!0===r&&(r={}),r.playerOptions=e.options_.playerOptions;var a=e.addChild(i,r);a&&(e[i]=a)}}))}},i.buildCSSClass=function(){return""},i.ready=function(e,t){if(void 0===t&&(t=!1),e)return this.isReady_?void(t?e.call(this):this.setTimeout(e,1)):(this.readyQueue_=this.readyQueue_||[],void this.readyQueue_.push(e))},i.triggerReady=function(){this.isReady_=!0,this.setTimeout((function(){var e=this.readyQueue_;this.readyQueue_=[],e&&0<e.length&&e.forEach((function(e){e.call(this)}),this),this.trigger("ready")}),1)},i.$=function(e,t){return W(e,t||this.contentEl())},i.$$=function(e,t){return z(e,t||this.contentEl())},i.hasClass=function(e){return w(this.el_,e)},i.addClass=function(e){C(this.el_,e)},i.removeClass=function(e){A(this.el_,e)},i.toggleClass=function(e,t){L(this.el_,e,t)},i.show=function(){this.removeClass("vjs-hidden")},i.hide=function(){this.addClass("vjs-hidden")},i.lockShowing=function(){this.addClass("vjs-lock-showing")},i.unlockShowing=function(){this.removeClass("vjs-lock-showing")},i.getAttribute=function(e){return D(this.el_,e)},i.setAttribute=function(e,t){O(this.el_,e,t)},i.removeAttribute=function(e){x(this.el_,e)},i.width=function(e,t){return this.dimension("width",e,t)},i.height=function(e,t){return this.dimension("height",e,t)},i.dimensions=function(e,t){this.width(e,!0),this.height(t)},i.dimension=function(e,t,i){if(void 0!==t)return null!==t&&t==t||(t=0),this.el_.style[e]=-1!==(""+t).indexOf("%")||-1!==(""+t).indexOf("px")?t:"auto"===t?"":t+"px",void(i||this.trigger("componentresize"));if(!this.el_)return 0;var r=this.el_.style[e],n=r.indexOf("px");return-1!==n?parseInt(r.slice(0,n),10):parseInt(this.el_["offset"+Oe(e)],10)},i.currentDimension=function(e){var t=0;if("width"!==e&&"height"!==e)throw new Error("currentDimension only accepts width or height value");if(t=g(this.el_,e),0===(t=parseFloat(t))||isNaN(t)){var i="offset"+Oe(e);t=this.el_[i]}return t},i.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}},i.currentWidth=function(){return this.currentDimension("width")},i.currentHeight=function(){return this.currentDimension("height")},i.focus=function(){this.el_.focus()},i.blur=function(){this.el_.blur()},i.handleKeyDown=function(e){this.player_&&(e.stopPropagation(),this.player_.handleKeyDown(e))},i.handleKeyPress=function(e){this.handleKeyDown(e)},i.emitTapEvents=function(){var t,i=0,r=null;function n(){t=!1}this.on("touchstart",(function(n){1===n.touches.length&&(r={pageX:n.touches[0].pageX,pageY:n.touches[0].pageY},i=e.performance.now(),t=!0)})),this.on("touchmove",(function(e){if(1<e.touches.length)t=!1;else if(r){var i=e.touches[0].pageX-r.pageX,n=e.touches[0].pageY-r.pageY;10<Math.sqrt(i*i+n*n)&&(t=!1)}})),this.on("touchleave",n),this.on("touchcancel",n),this.on("touchend",(function(n){!(r=null)===t&&e.performance.now()-i<200&&(n.preventDefault(),this.trigger("tap"))}))},i.enableTouchActivity=function(){if(this.player()&&this.player().reportUserActivity){var e,t=ge(this.player(),this.player().reportUserActivity);this.on("touchstart",(function(){t(),this.clearInterval(e),e=this.setInterval(t,250)}));var i=function(i){t(),this.clearInterval(e)};this.on("touchmove",t),this.on("touchend",i),this.on("touchcancel",i)}},i.setTimeout=function(t,i){var r,n=this;return t=ge(this,t),this.clearTimersOnDispose_(),r=e.setTimeout((function(){n.setTimeoutIds_.has(r)&&n.setTimeoutIds_.delete(r),t()}),i),this.setTimeoutIds_.add(r),r},i.clearTimeout=function(t){return this.setTimeoutIds_.has(t)&&(this.setTimeoutIds_.delete(t),e.clearTimeout(t)),t},i.setInterval=function(t,i){t=ge(this,t),this.clearTimersOnDispose_();var r=e.setInterval(t,i);return this.setIntervalIds_.add(r),r},i.clearInterval=function(t){return this.setIntervalIds_.has(t)&&(this.setIntervalIds_.delete(t),e.clearInterval(t)),t},i.requestAnimationFrame=function(t){var i,r=this;return this.supportsRaf_?(this.clearTimersOnDispose_(),t=ge(this,t),i=e.requestAnimationFrame((function(){r.rafIds_.has(i)&&r.rafIds_.delete(i),t()})),this.rafIds_.add(i),i):this.setTimeout(t,1e3/60)},i.requestNamedAnimationFrame=function(e,t){var i=this;if(!this.namedRafs_.has(e)){this.clearTimersOnDispose_(),t=ge(this,t);var r=this.requestAnimationFrame((function(){t(),i.namedRafs_.has(e)&&i.namedRafs_.delete(e)}));return this.namedRafs_.set(e,r),e}},i.cancelNamedAnimationFrame=function(e){this.namedRafs_.has(e)&&(this.cancelAnimationFrame(this.namedRafs_.get(e)),this.namedRafs_.delete(e))},i.cancelAnimationFrame=function(t){return this.supportsRaf_?(this.rafIds_.has(t)&&(this.rafIds_.delete(t),e.cancelAnimationFrame(t)),t):this.clearTimeout(t)},i.clearTimersOnDispose_=function(){var e=this;this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",(function(){[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach((function(t){var i=t[1];e[t[0]].forEach((function(t,r){return e[i](r)}))})),e.clearingTimersOnDispose_=!1})))},t.registerComponent=function(e,i){if("string"!=typeof e||!e)throw new Error('Illegal component name, "'+e+'"; must be a non-empty string.');var r=t.getComponent("Tech"),n=r&&r.isTech(i),a=t===i||t.prototype.isPrototypeOf(i.prototype);if(n||!a)throw new Error('Illegal component, "'+e+'"; '+(n?"techs must be registered using Tech.registerTech()":"must be a Component subclass")+".");e=Oe(e),t.components_||(t.components_={});var s=t.getComponent("Player");if("Player"===e&&s&&s.players){var o=s.players,u=Object.keys(o);if(o&&0<u.length&&u.map((function(e){return o[e]})).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return t.components_[e]=i,t.components_[De(e)]=i},t.getComponent=function(e){if(e&&t.components_)return t.components_[e]},t}();Fe.prototype.supportsRaf_="function"==typeof e.requestAnimationFrame&&"function"==typeof e.cancelAnimationFrame,Fe.registerComponent("Component",Fe);var Be=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e};o((function(e){function t(i){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(i)}e.exports=t})),o((function(e){function t(i){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},t(i)}e.exports=t}));var je,Ve,He,Ge,qe=function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t},Ke=e.navigator&&e.navigator.userAgent||"",We=/AppleWebKit\/([\d.]+)/i.exec(Ke),ze=We?parseFloat(We.pop()):null,Ye=/iPod/i.test(Ke),Xe=(je=Ke.match(/OS (\d+)_/i))&&je[1]?je[1]:null,Qe=/Android/i.test(Ke),$e=function(){var e=Ke.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;var t=e[1]&&parseFloat(e[1]),i=e[2]&&parseFloat(e[2]);return t&&i?parseFloat(e[1]+"."+e[2]):t||null}(),Je=Qe&&$e<5&&ze<537,Ze=/Firefox/i.test(Ke),et=/Edg/i.test(Ke),tt=!et&&(/Chrome/i.test(Ke)||/CriOS/i.test(Ke)),it=(Ve=Ke.match(/(Chrome|CriOS)\/(\d+)/))&&Ve[2]?parseFloat(Ve[2]):null,rt=(!(Ge=(He=/MSIE\s(\d+)\.\d/.exec(Ke))&&parseFloat(He[1]))&&/Trident\/7.0/i.test(Ke)&&/rv:11.0/.test(Ke)&&(Ge=11),Ge),nt=/Safari/i.test(Ke)&&!tt&&!Qe&&!et,at=/Windows/i.test(Ke),st=y()&&("ontouchstart"in e||e.navigator.maxTouchPoints||e.DocumentTouch&&e.document instanceof e.DocumentTouch),ot=/iPad/i.test(Ke)||nt&&st&&!/iPhone/i.test(Ke),ut=/iPhone/i.test(Ke)&&!ot,lt=ut||ot||Ye,ct=(nt||lt)&&!tt,dt=Object.freeze({__proto__:null,IS_IPOD:Ye,IOS_VERSION:Xe,IS_ANDROID:Qe,ANDROID_VERSION:$e,IS_NATIVE_ANDROID:Je,IS_FIREFOX:Ze,IS_EDGE:et,IS_CHROME:tt,CHROME_VERSION:it,IE_VERSION:rt,IS_SAFARI:nt,IS_WINDOWS:at,TOUCH_ENABLED:st,IS_IPAD:ot,IS_IPHONE:ut,IS_IOS:lt,IS_ANY_SAFARI:ct});function ht(e,t,i,r){return function(e,t,i){if("number"!=typeof t||t<0||i<t)throw new Error("Failed to execute '"+e+"' on 'TimeRanges': The index provided ("+t+") is non-numeric or out of bounds (0-"+i+").")}(e,r,i.length-1),i[r][t]}function ft(e){return void 0===e||0===e.length?{length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:{length:e.length,start:ht.bind(null,"start",0,e),end:ht.bind(null,"end",1,e)}}function pt(e,t){return Array.isArray(e)?ft(e):void 0===e||void 0===t?ft():ft([[e,t]])}function gt(e,t){var i,r,n=0;if(!t)return 0;e&&e.length||(e=pt(0,0));for(var a=0;a<e.length;a++)i=e.start(a),t<(r=e.end(a))&&(r=t),n+=r-i;return n/t}for(var mt,vt={prefixed:!0},yt=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"]],_t=yt[0],bt=0;bt<yt.length;bt++)if(yt[bt][1]in t){mt=yt[bt];break}if(mt){for(var Tt=0;Tt<mt.length;Tt++)vt[_t[Tt]]=mt[Tt];vt.prefixed=mt[0]!==_t[0]}function St(e){if(e instanceof St)return e;"number"==typeof e?this.code=e:"string"==typeof e?this.message=e:f(e)&&("number"==typeof e.code&&(this.code=e.code),h(this,e)),this.message||(this.message=St.defaultMessages[this.code]||"")}St.prototype.code=0,St.prototype.message="",St.prototype.status=null,St.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],St.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var Et=0;Et<St.errorTypes.length;Et++)St[St.errorTypes[Et]]=Et,St.prototype[St.errorTypes[Et]]=Et;function kt(e){return null!=e&&"function"==typeof e.then}function wt(e){kt(e)&&e.then(null,(function(e){}))}function Ct(e){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce((function(t,i,r){return e[i]&&(t[i]=e[i]),t}),{cues:e.cues&&Array.prototype.map.call(e.cues,(function(e){return{startTime:e.startTime,endTime:e.endTime,text:e.text,id:e.id}}))})}var At=o((function(e,t){function i(e){if(e&&"object"==typeof e){var t=e.which||e.keyCode||e.charCode;t&&(e=t)}if("number"==typeof e)return s[e];var i,a=String(e);return(i=r[a.toLowerCase()])?i:(i=n[a.toLowerCase()])||(1===a.length?a.charCodeAt(0):void 0)}i.isEventKey=function(e,t){if(e&&"object"==typeof e){var i=e.which||e.keyCode||e.charCode;if(null==i)return!1;if("string"==typeof t){var a;if(a=r[t.toLowerCase()])return a===i;if(a=n[t.toLowerCase()])return a===i}else if("number"==typeof t)return t===i;return!1}};var r=(t=e.exports=i).code=t.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},n=t.aliases={windows:91,"":16,"":18,"":17,"":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};for(a=97;a<123;a++)r[String.fromCharCode(a)]=a-32;for(var a=48;a<58;a++)r[a-48]=a;for(a=1;a<13;a++)r["f"+a]=a+111;for(a=0;a<10;a++)r["numpad "+a]=a+96;var s=t.names=t.title={};for(a in r)s[r[a]]=a;for(var o in n)r[o]=n[o]})),Lt="vjs-modal-dialog",It=function(i){function r(e,t){var r;return(r=i.call(this,e,t)||this).opened_=r.hasBeenOpened_=r.hasBeenFilled_=!1,r.closeable(!r.options_.uncloseable),r.content(r.options_.content),r.contentEl_=S("div",{className:Lt+"-content"},{role:"document"}),r.descEl_=S("p",{className:Lt+"-description vjs-control-text",id:r.el().getAttribute("aria-describedby")}),E(r.descEl_,r.description()),r.el_.appendChild(r.descEl_),r.el_.appendChild(r.contentEl_),r}qe(r,i);var n=r.prototype;return n.createEl=function(){return i.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})},n.dispose=function(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,i.prototype.dispose.call(this)},n.buildCSSClass=function(){return Lt+" vjs-hidden "+i.prototype.buildCSSClass.call(this)},n.label=function(){return this.localize(this.options_.label||"Modal Window")},n.description=function(){var e=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),e},n.open=function(){if(!this.opened_){var e=this.player();this.trigger("beforemodalopen"),this.opened_=!0,!this.options_.fillAlways&&(this.hasBeenOpened_||this.hasBeenFilled_)||this.fill(),this.wasPlaying_=!e.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&e.pause(),this.on("keydown",this.handleKeyDown),this.hadControls_=e.controls(),e.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}},n.opened=function(e){return"boolean"==typeof e&&this[e?"open":"close"](),this.opened_},n.close=function(){if(this.opened_){var e=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&e.play(),this.off("keydown",this.handleKeyDown),this.hadControls_&&e.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}},n.closeable=function(e){if("boolean"==typeof e){var t=this.closeable_=!!e,i=this.getChild("closeButton");if(t&&!i){var r=this.contentEl_;this.contentEl_=this.el_,i=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=r,this.on(i,"close",this.close)}!t&&i&&(this.off(i,"close",this.close),this.removeChild(i),i.dispose())}return this.closeable_},n.fill=function(){this.fillWith(this.content())},n.fillWith=function(e){var t=this.contentEl(),i=t.parentNode,r=t.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,i.removeChild(t),this.empty(),G(t,e),this.trigger("modalfill"),r?i.insertBefore(t,r):i.appendChild(t);var n=this.getChild("closeButton");n&&i.appendChild(n.el_)},n.empty=function(){this.trigger("beforemodalempty"),j(this.contentEl()),this.trigger("modalempty")},n.content=function(e){return void 0!==e&&(this.content_=e),this.content_},n.conditionalFocus_=function(){var e=t.activeElement,i=this.player_.el_;this.previouslyActiveEl_=null,!i.contains(e)&&i!==e||(this.previouslyActiveEl_=e,this.focus())},n.conditionalBlur_=function(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)},n.handleKeyDown=function(e){if(e.stopPropagation(),At.isEventKey(e,"Escape")&&this.closeable())return e.preventDefault(),void this.close();if(At.isEventKey(e,"Tab")){for(var i,r=this.focusableEls_(),n=this.el_.querySelector(":focus"),a=0;a<r.length;a++)if(n===r[a]){i=a;break}t.activeElement===this.el_&&(i=0),e.shiftKey&&0===i?(r[r.length-1].focus(),e.preventDefault()):e.shiftKey||i!==r.length-1||(r[0].focus(),e.preventDefault())}},n.focusableEls_=function(){var t=this.el_.querySelectorAll("*");return Array.prototype.filter.call(t,(function(t){return(t instanceof e.HTMLAnchorElement||t instanceof e.HTMLAreaElement)&&t.hasAttribute("href")||(t instanceof e.HTMLInputElement||t instanceof e.HTMLSelectElement||t instanceof e.HTMLTextAreaElement||t instanceof e.HTMLButtonElement)&&!t.hasAttribute("disabled")||t instanceof e.HTMLIFrameElement||t instanceof e.HTMLObjectElement||t instanceof e.HTMLEmbedElement||t.hasAttribute("tabindex")&&-1!==t.getAttribute("tabindex")||t.hasAttribute("contenteditable")}))},r}(Fe);It.prototype.options_={pauseOnOpen:!0,temporary:!0},Fe.registerComponent("ModalDialog",It);var Rt=function(e){function t(t){var i;void 0===t&&(t=[]),(i=e.call(this)||this).tracks_=[],Object.defineProperty(Be(i),"length",{get:function(){return this.tracks_.length}});for(var r=0;r<t.length;r++)i.addTrack(t[r]);return i}qe(t,e);var i=t.prototype;return i.addTrack=function(e){var t=this.tracks_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.tracks_[t]}}),-1===this.tracks_.indexOf(e)&&(this.tracks_.push(e),this.trigger({track:e,type:"addtrack",target:this}))},i.removeTrack=function(e){for(var t,i=0,r=this.length;i<r;i++)if(this[i]===e){(t=this[i]).off&&t.off(),this.tracks_.splice(i,1);break}t&&this.trigger({track:t,type:"removetrack",target:this})},i.getTrackById=function(e){for(var t=null,i=0,r=this.length;i<r;i++){var n=this[i];if(n.id===e){t=n;break}}return t},t}(ve);for(var Dt in Rt.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"},Rt.prototype.allowedEvents_)Rt.prototype["on"+Dt]=null;function Ot(e,t){for(var i=0;i<e.length;i++)Object.keys(e[i]).length&&t.id!==e[i].id&&(e[i].enabled=!1)}function xt(e,t){for(var i=0;i<e.length;i++)Object.keys(e[i]).length&&t.id!==e[i].id&&(e[i].selected=!1)}function Pt(i){var r=["protocol","hostname","port","pathname","search","hash","host"],n=t.createElement("a");n.href=i;var a,s=""===n.host&&"file:"!==n.protocol;s&&((a=t.createElement("div")).innerHTML='<a href="'+i+'"></a>',n=a.firstChild,a.setAttribute("style","display:none; position:absolute;"),t.body.appendChild(a));for(var o={},u=0;u<r.length;u++)o[r[u]]=n[r[u]];return"http:"===o.protocol&&(o.host=o.host.replace(/:80$/,"")),"https:"===o.protocol&&(o.host=o.host.replace(/:443$/,"")),o.protocol||(o.protocol=e.location.protocol),s&&t.body.removeChild(a),o}function Mt(e){if(!e.match(/^https?:\/\//)){var i=t.createElement("div");i.innerHTML='<a href="'+e+'">x</a>',e=i.firstChild.href}return e}function Nt(e){if("string"==typeof e){var t=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/.exec(e);if(t)return t.pop().toLowerCase()}return""}function Ut(t,i){void 0===i&&(i=e.location);var r=Pt(t);return(":"===r.protocol?i.protocol:r.protocol)+r.host!==i.protocol+i.host}var Ft=function(e){function t(t){var i;void 0===t&&(t=[]);for(var r=t.length-1;0<=r;r--)if(t[r].enabled){Ot(t,t[r]);break}return(i=e.call(this,t)||this).changing_=!1,i}qe(t,e);var i=t.prototype;return i.addTrack=function(t){var i=this;t.enabled&&Ot(this,t),e.prototype.addTrack.call(this,t),t.addEventListener&&(t.enabledChange_=function(){i.changing_||(i.changing_=!0,Ot(i,t),i.changing_=!1,i.trigger("change"))},t.addEventListener("enabledchange",t.enabledChange_))},i.removeTrack=function(t){e.prototype.removeTrack.call(this,t),t.removeEventListener&&t.enabledChange_&&(t.removeEventListener("enabledchange",t.enabledChange_),t.enabledChange_=null)},t}(Rt),Bt=function(e){function t(t){var i;void 0===t&&(t=[]);for(var r=t.length-1;0<=r;r--)if(t[r].selected){xt(t,t[r]);break}return(i=e.call(this,t)||this).changing_=!1,Object.defineProperty(Be(i),"selectedIndex",{get:function(){for(var e=0;e<this.length;e++)if(this[e].selected)return e;return-1},set:function(){}}),i}qe(t,e);var i=t.prototype;return i.addTrack=function(t){var i=this;t.selected&&xt(this,t),e.prototype.addTrack.call(this,t),t.addEventListener&&(t.selectedChange_=function(){i.changing_||(i.changing_=!0,xt(i,t),i.changing_=!1,i.trigger("change"))},t.addEventListener("selectedchange",t.selectedChange_))},i.removeTrack=function(t){e.prototype.removeTrack.call(this,t),t.removeEventListener&&t.selectedChange_&&(t.removeEventListener("selectedchange",t.selectedChange_),t.selectedChange_=null)},t}(Rt),jt=function(e){function t(){return e.apply(this,arguments)||this}qe(t,e);var i=t.prototype;return i.addTrack=function(t){var i=this;e.prototype.addTrack.call(this,t),this.queueChange_||(this.queueChange_=function(){return i.queueTrigger("change")}),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=function(){return i.trigger("selectedlanguagechange")}),t.addEventListener("modechange",this.queueChange_),-1===["metadata","chapters"].indexOf(t.kind)&&t.addEventListener("modechange",this.triggerSelectedlanguagechange_)},i.removeTrack=function(t){e.prototype.removeTrack.call(this,t),t.removeEventListener&&(this.queueChange_&&t.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&t.removeEventListener("modechange",this.triggerSelectedlanguagechange_))},t}(Rt),Vt=function(){function e(e){void 0===e&&(e=[]),this.trackElements_=[],Object.defineProperty(this,"length",{get:function(){return this.trackElements_.length}});for(var t=0,i=e.length;t<i;t++)this.addTrackElement_(e[t])}var t=e.prototype;return t.addTrackElement_=function(e){var t=this.trackElements_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.trackElements_[t]}}),-1===this.trackElements_.indexOf(e)&&this.trackElements_.push(e)},t.getTrackElementByTrack_=function(e){for(var t,i=0,r=this.trackElements_.length;i<r;i++)if(e===this.trackElements_[i].track){t=this.trackElements_[i];break}return t},t.removeTrackElement_=function(e){for(var t=0,i=this.trackElements_.length;t<i;t++)if(e===this.trackElements_[t]){this.trackElements_[t].track&&"function"==typeof this.trackElements_[t].track.off&&this.trackElements_[t].track.off(),"function"==typeof this.trackElements_[t].off&&this.trackElements_[t].off(),this.trackElements_.splice(t,1);break}},e}(),Ht=function(){function e(t){e.prototype.setCues_.call(this,t),Object.defineProperty(this,"length",{get:function(){return this.length_}})}var t=e.prototype;return t.setCues_=function(e){var t=this.length||0,i=0,r=e.length;function n(e){""+e in this||Object.defineProperty(this,""+e,{get:function(){return this.cues_[e]}})}if(this.cues_=e,this.length_=e.length,t<r)for(i=t;i<r;i++)n.call(this,i)},t.getCueById=function(e){for(var t=null,i=0,r=this.length;i<r;i++){var n=this[i];if(n.id===e){t=n;break}}return t},e}(),Gt={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},qt={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},Kt={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},Wt={disabled:"disabled",hidden:"hidden",showing:"showing"},zt=function(e){function t(t){var i;function r(e){Object.defineProperty(Be(i),e,{get:function(){return n[e]},set:function(){}})}void 0===t&&(t={}),i=e.call(this)||this;var n={id:t.id||"vjs_track_"+re(),kind:t.kind||"",label:t.label||"",language:t.language||""};for(var a in n)r(a);return i}return qe(t,e),t}(ve),Yt=Object.freeze({__proto__:null,parseUrl:Pt,getAbsoluteURL:Mt,getFileExtension:Nt,isCrossOrigin:Ut}),Xt=Object.prototype.toString,Qt=Zt,$t=Zt;function Jt(e,t,i){var r=e;return function(e){var t=Xt.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)}(t)?(i=t,"string"==typeof e&&(r={uri:e})):r=u({},t,{uri:e}),r.callback=i,r}function Zt(e,t,i){return ei(t=Jt(e,t,i))}function ei(e){if(void 0===e.callback)throw new Error("callback argument missing");var t=!1,i=function(i,r,n){t||(t=!0,e.callback(i,r,n))};function r(e){return clearTimeout(o),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,i(e,g)}function n(){if(!s){var t;clearTimeout(o);var r=g,n=null;return 0!==(t=e.useXDR&&void 0===u.status?200:1223===u.status?204:u.status)?(r={body:function(){var e=void 0;if(e=u.response?u.response:u.responseText||function(e){try{if("document"===e.responseType)return e.responseXML;if(""===e.responseType&&(!e.responseXML||"parsererror"!==e.responseXML.documentElement.nodeName))return e.responseXML}catch(e){}return null}(u),p)try{e=JSON.parse(e)}catch(e){}return e}(),statusCode:t,method:c,headers:{},url:l,rawRequest:u},u.getAllResponseHeaders&&(r.headers=function(e){var t={};return e&&e.trim().split("\n").forEach((function(e){var i=e.indexOf(":"),r=e.slice(0,i).trim().toLowerCase(),n=e.slice(i+1).trim();void 0===t[r]?t[r]=n:Array.isArray(t[r])?t[r].push(n):t[r]=[t[r],n]})),t}(u.getAllResponseHeaders()))):n=new Error("Internal XMLHttpRequest Error"),i(n,r,r.body)}}var a,s,o,u=e.xhr||null,l=(u=u||(e.cors||e.useXDR?new Zt.XDomainRequest:new Zt.XMLHttpRequest)).url=e.uri||e.url,c=u.method=e.method||"GET",d=e.body||e.data,h=u.headers=e.headers||{},f=!!e.sync,p=!1,g={body:void 0,headers:{},statusCode:0,method:c,url:l,rawRequest:u};if("json"in e&&!1!==e.json&&(p=!0,h.accept||h.Accept||(h.Accept="application/json"),"GET"!==c&&"HEAD"!==c&&(h["content-type"]||h["Content-Type"]||(h["Content-Type"]="application/json"),d=JSON.stringify(!0===e.json?d:e.json))),u.onreadystatechange=function(){4===u.readyState&&setTimeout(n,0)},u.onload=n,u.onerror=r,u.onprogress=function(){},u.onabort=function(){s=!0},u.ontimeout=r,u.open(c,l,!f,e.username,e.password),f||(u.withCredentials=!!e.withCredentials),!f&&0<e.timeout&&(o=setTimeout((function(){if(!s){s=!0,u.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",r(e)}}),e.timeout)),u.setRequestHeader)for(a in h)h.hasOwnProperty(a)&&u.setRequestHeader(a,h[a]);else if(e.headers&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(u.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(u),u.send(d||null),u}function ti(t,i){var r=new e.WebVTT.Parser(e,e.vttjs,e.WebVTT.StringDecoder()),a=[];r.oncue=function(e){i.addCue(e)},r.onparsingerror=function(e){a.push(e)},r.onflush=function(){i.trigger({type:"loadeddata",target:i})},r.parse(t),0<a.length&&(e.console&&e.console.groupCollapsed&&e.console.groupCollapsed("Text Track parsing errors for "+i.src),a.forEach((function(e){return n.error(e)})),e.console&&e.console.groupEnd&&e.console.groupEnd()),r.flush()}function ii(t,i){var r={uri:t},a=Ut(t);a&&(r.cors=a);var s="use-credentials"===i.tech_.crossOrigin();s&&(r.withCredentials=s),Qt(r,ge(this,(function(t,r,a){if(t)return n.error(t,r);i.loaded_=!0,"function"!=typeof e.WebVTT?i.tech_&&i.tech_.any(["vttjsloaded","vttjserror"],(function(e){if("vttjserror"!==e.type)return ti(a,i);n.error("vttjs failed to load, stopping trying to process "+i.src)})):ti(a,i)})))}Zt.XMLHttpRequest=e.XMLHttpRequest||function(){},Zt.XDomainRequest="withCredentials"in new Zt.XMLHttpRequest?Zt.XMLHttpRequest:e.XDomainRequest,function(e,t){for(var i=0;i<e.length;i++)t(e[i])}(["get","put","post","patch","head","delete"],(function(e){Zt["delete"===e?"del":e]=function(t,i,r){return(i=Jt(t,i,r)).method=e.toUpperCase(),ei(i)}})),Qt.default=$t;var ri=function(t){function i(e){var i;if(void 0===e&&(e={}),!e.tech)throw new Error("A tech was not provided.");var r=xe(e,{kind:Kt[e.kind]||"subtitles",language:e.language||e.srclang||""}),n=Wt[r.mode]||"disabled",a=r.default;"metadata"!==r.kind&&"chapters"!==r.kind||(n="hidden"),(i=t.call(this,r)||this).tech_=r.tech,i.cues_=[],i.activeCues_=[],i.preload_=!1!==i.tech_.preloadTextTracks;var s=new Ht(i.cues_),o=new Ht(i.activeCues_),u=!1,l=ge(Be(i),(function(){this.activeCues=this.activeCues,u&&(this.trigger("cuechange"),u=!1)}));return"disabled"!==n&&i.tech_.ready((function(){i.tech_.on("timeupdate",l)}),!0),Object.defineProperties(Be(i),{default:{get:function(){return a},set:function(){}},mode:{get:function(){return n},set:function(e){var t=this;Wt[e]&&(n=e,this.preload_||"disabled"===n||0!==this.cues.length||ii(this.src,this),"disabled"!==n?this.tech_.ready((function(){t.tech_.on("timeupdate",l)}),!0):this.tech_.off("timeupdate",l),this.trigger("modechange"))}},cues:{get:function(){return this.loaded_?s:null},set:function(){}},activeCues:{get:function(){if(!this.loaded_)return null;if(0===this.cues.length)return o;for(var e=this.tech_.currentTime(),t=[],i=0,r=this.cues.length;i<r;i++){var n=this.cues[i];(n.startTime<=e&&n.endTime>=e||n.startTime===n.endTime&&n.startTime<=e&&n.startTime+.5>=e)&&t.push(n)}if(u=!1,t.length!==this.activeCues_.length)u=!0;else for(var a=0;a<t.length;a++)-1===this.activeCues_.indexOf(t[a])&&(u=!0);return this.activeCues_=t,o.setCues_(this.activeCues_),o},set:function(){}}}),r.src?(i.src=r.src,i.preload_||(i.loaded_=!0),(i.preload_||a||"subtitles"!==r.kind&&"captions"!==r.kind)&&ii(i.src,Be(i))):i.loaded_=!0,i}qe(i,t);var r=i.prototype;return r.addCue=function(t){var i=t;if(e.vttjs&&!(t instanceof e.vttjs.VTTCue)){for(var r in i=new e.vttjs.VTTCue(t.startTime,t.endTime,t.text),t)r in i||(i[r]=t[r]);i.id=t.id,i.originalCue_=t}for(var n=this.tech_.textTracks(),a=0;a<n.length;a++)n[a]!==this&&n[a].removeCue(i);this.cues_.push(i),this.cues.setCues_(this.cues_)},r.removeCue=function(e){for(var t=this.cues_.length;t--;){var i=this.cues_[t];if(i===e||i.originalCue_&&i.originalCue_===e){this.cues_.splice(t,1),this.cues.setCues_(this.cues_);break}}},i}(zt);ri.prototype.allowedEvents_={cuechange:"cuechange"};var ni=function(e){function t(t){var i;void 0===t&&(t={});var r=xe(t,{kind:qt[t.kind]||""});i=e.call(this,r)||this;var n=!1;return Object.defineProperty(Be(i),"enabled",{get:function(){return n},set:function(e){"boolean"==typeof e&&e!==n&&(n=e,this.trigger("enabledchange"))}}),r.enabled&&(i.enabled=r.enabled),i.loaded_=!0,i}return qe(t,e),t}(zt),ai=function(e){function t(t){var i;void 0===t&&(t={});var r=xe(t,{kind:Gt[t.kind]||""});i=e.call(this,r)||this;var n=!1;return Object.defineProperty(Be(i),"selected",{get:function(){return n},set:function(e){"boolean"==typeof e&&e!==n&&(n=e,this.trigger("selectedchange"))}}),r.selected&&(i.selected=r.selected),i}return qe(t,e),t}(zt),si=function(e){function t(t){var i,r;void 0===t&&(t={}),i=e.call(this)||this;var n=new ri(t);return i.kind=n.kind,i.src=n.src,i.srclang=n.language,i.label=n.label,i.default=n.default,Object.defineProperties(Be(i),{readyState:{get:function(){return r}},track:{get:function(){return n}}}),r=0,n.addEventListener("loadeddata",(function(){r=2,i.trigger({type:"load",target:Be(i)})})),i}return qe(t,e),t}(ve);si.prototype.allowedEvents_={load:"load"},si.NONE=0,si.LOADING=1,si.LOADED=2,si.ERROR=3;var oi={audio:{ListClass:Ft,TrackClass:ni,capitalName:"Audio"},video:{ListClass:Bt,TrackClass:ai,capitalName:"Video"},text:{ListClass:jt,TrackClass:ri,capitalName:"Text"}};Object.keys(oi).forEach((function(e){oi[e].getterName=e+"Tracks",oi[e].privateName=e+"Tracks_"}));var ui={remoteText:{ListClass:jt,TrackClass:ri,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:Vt,TrackClass:si,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},li=u({},oi,ui);ui.names=Object.keys(ui),oi.names=Object.keys(oi),li.names=[].concat(ui.names).concat(oi.names);var ci=Object.create||function(e){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return di.prototype=e,new di};function di(){}function hi(e,t){this.name="ParsingError",this.code=e.code,this.message=t||e.message}function fi(e){function t(e,t,i,r){return 3600*(0|e)+60*(0|t)+(0|i)+(0|r)/1e3}var i=e.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);return i?i[3]?t(i[1],i[2],i[3].replace(":",""),i[4]):59<i[1]?t(i[1],i[2],0,i[4]):t(0,i[1],i[2],i[4]):null}function pi(){this.values=ci(null)}function gi(e,t,i,r){var n=r?e.split(r):[e];for(var a in n)if("string"==typeof n[a]){var s=n[a].split(i);2===s.length&&t(s[0],s[1])}}function mi(e,t,i){var r=e;function n(){var t=fi(e);if(null===t)throw new hi(hi.Errors.BadTimeStamp,"Malformed timestamp: "+r);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function a(){e=e.replace(/^\s+/,"")}if(a(),t.startTime=n(),a(),"--\x3e"!==e.substr(0,3))throw new hi(hi.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+r);e=e.substr(3),a(),t.endTime=n(),a(),function(e,t){var r=new pi;gi(e,(function(e,t){switch(e){case"region":for(var n=i.length-1;0<=n;n--)if(i[n].id===t){r.set(e,i[n].region);break}break;case"vertical":r.alt(e,t,["rl","lr"]);break;case"line":var a=t.split(","),s=a[0];r.integer(e,s),r.percent(e,s)&&r.set("snapToLines",!1),r.alt(e,s,["auto"]),2===a.length&&r.alt("lineAlign",a[1],["start","center","end"]);break;case"position":a=t.split(","),r.percent(e,a[0]),2===a.length&&r.alt("positionAlign",a[1],["start","center","end"]);break;case"size":r.percent(e,t);break;case"align":r.alt(e,t,["start","center","end","left","right"])}}),/:/,/\s/),t.region=r.get("region",null),t.vertical=r.get("vertical","");try{t.line=r.get("line","auto")}catch(e){}t.lineAlign=r.get("lineAlign","start"),t.snapToLines=r.get("snapToLines",!0),t.size=r.get("size",100);try{t.align=r.get("align","center")}catch(e){t.align=r.get("align","middle")}try{t.position=r.get("position","auto")}catch(e){t.position=r.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},t.align)}t.positionAlign=r.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},t.align)}(e,t)}((hi.prototype=ci(Error.prototype)).constructor=hi).Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},pi.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,i){return i?this.has(e)?this.values[e]:t[i]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,i){for(var r=0;r<i.length;++r)if(t===i[r]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&0<=(t=parseFloat(t))&&t<=100)&&(this.set(e,t),!0)}};var vi=t.createElement("textarea"),yi={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},_i={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},bi={v:"title",lang:"lang"},Ti={rt:"ruby"};function Si(e,t){function i(){if(!t)return null;var e,i=t.match(/^([^<]*)(<[^>]*>?)?/);return t=t.substr((e=i[1]?i[1]:i[2]).length),e}function r(t,i){var r=yi[t];if(!r)return null;var n=e.document.createElement(r),a=bi[t];return a&&i&&(n[a]=i.trim()),n}for(var n,a,s,o=e.document.createElement("div"),u=o,l=[];null!==(n=i());)if("<"!==n[0])u.appendChild(e.document.createTextNode((vi.innerHTML=n,a=vi.textContent,vi.textContent="",a)));else{if("/"===n[1]){l.length&&l[l.length-1]===n.substr(2).replace(">","")&&(l.pop(),u=u.parentNode);continue}var c,d=fi(n.substr(1,n.length-2));if(d){c=e.document.createProcessingInstruction("timestamp",d),u.appendChild(c);continue}var h=n.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!h)continue;if(!(c=r(h[1],h[3])))continue;if(Ti[(s=c).localName]&&Ti[s.localName]!==u.localName)continue;if(h[2]){var f=h[2].split(".");f.forEach((function(e){var t=/^bg_/.test(e),i=t?e.slice(3):e;_i.hasOwnProperty(i)&&(c.style[t?"background-color":"color"]=_i[i])})),c.className=f.join(" ")}l.push(h[1]),u.appendChild(c),u=c}return o}var Ei=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function ki(e){for(var t=0;t<Ei.length;t++){var i=Ei[t];if(e>=i[0]&&e<=i[1])return!0}return!1}function wi(){}function Ci(e,t,i){wi.call(this),this.cue=t,this.cueDiv=Si(e,t.text);var r={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(r,this.cueDiv),this.div=e.document.createElement("div"),r={direction:function(e){var t=[],i="";if(!e||!e.childNodes)return"ltr";function r(e,t){for(var i=t.childNodes.length-1;0<=i;i--)e.push(t.childNodes[i])}function n(e){if(!e||!e.length)return null;var t=e.pop(),i=t.textContent||t.innerText;if(i){var a=i.match(/^.*(\n|\r)/);return a?a[e.length=0]:i}return"ruby"===t.tagName?n(e):t.childNodes?(r(e,t),n(e)):void 0}for(r(t,e);i=n(t);)for(var a=0;a<i.length;a++)if(ki(i.charCodeAt(a)))return"rtl";return"ltr"}(this.cueDiv),writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:"middle"===t.align?"center":t.align,font:i.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(r),this.div.appendChild(this.cueDiv);var n=0;switch(t.positionAlign){case"start":n=t.position;break;case"center":n=t.position-t.size/2;break;case"end":n=t.position-t.size}this.applyStyles(""===t.vertical?{left:this.formatStyle(n,"%"),width:this.formatStyle(t.size,"%")}:{top:this.formatStyle(n,"%"),height:this.formatStyle(t.size,"%")}),this.move=function(e){this.applyStyles({top:this.formatStyle(e.top,"px"),bottom:this.formatStyle(e.bottom,"px"),left:this.formatStyle(e.left,"px"),right:this.formatStyle(e.right,"px"),height:this.formatStyle(e.height,"px"),width:this.formatStyle(e.width,"px")})}}function Ai(e){var t,i,r,n;if(e.div){i=e.div.offsetHeight,r=e.div.offsetWidth,n=e.div.offsetTop;var a=(a=e.div.childNodes)&&(a=a[0])&&a.getClientRects&&a.getClientRects();e=e.div.getBoundingClientRect(),t=a?Math.max(a[0]&&a[0].height||0,e.height/a.length):0}this.left=e.left,this.right=e.right,this.top=e.top||n,this.height=e.height||i,this.bottom=e.bottom||n+(e.height||i),this.width=e.width||r,this.lineHeight=void 0!==t?t:e.lineHeight}function Li(e,t,i,r){var n=new Ai(t),a=t.cue,s=function(e){if("number"==typeof e.line&&(e.snapToLines||0<=e.line&&e.line<=100))return e.line;if(!e.track||!e.track.textTrackList||!e.track.textTrackList.mediaElement)return-1;for(var t=e.track,i=t.textTrackList,r=0,n=0;n<i.length&&i[n]!==t;n++)"showing"===i[n].mode&&r++;return-1*++r}(a),o=[];if(a.snapToLines){var u;switch(a.vertical){case"":o=["+y","-y"],u="height";break;case"rl":o=["+x","-x"],u="width";break;case"lr":o=["-x","+x"],u="width"}var l=n.lineHeight,c=l*Math.round(s),d=i[u]+l,h=o[0];Math.abs(c)>d&&(c=c<0?-1:1,c*=Math.ceil(d/l)*l),s<0&&(c+=""===a.vertical?i.height:i.width,o=o.reverse()),n.move(h,c)}else{var f=n.lineHeight/i.height*100;switch(a.lineAlign){case"center":s-=f/2;break;case"end":s-=f}switch(a.vertical){case"":t.applyStyles({top:t.formatStyle(s,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(s,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(s,"%")})}o=["+y","-x","+x","-y"],n=new Ai(t)}var p=function(e,t){for(var n,a=new Ai(e),s=1,o=0;o<t.length;o++){for(;e.overlapsOppositeAxis(i,t[o])||e.within(i)&&e.overlapsAny(r);)e.move(t[o]);if(e.within(i))return e;var u=e.intersectPercentage(i);u<s&&(n=new Ai(e),s=u),e=new Ai(a)}return n||a}(n,o);t.move(p.toCSSCompatValues(i))}function Ii(){}wi.prototype.applyStyles=function(e,t){for(var i in t=t||this.div,e)e.hasOwnProperty(i)&&(t.style[i]=e[i])},wi.prototype.formatStyle=function(e,t){return 0===e?0:e+t},(Ci.prototype=ci(wi.prototype)).constructor=Ci,Ai.prototype.move=function(e,t){switch(t=void 0!==t?t:this.lineHeight,e){case"+x":this.left+=t,this.right+=t;break;case"-x":this.left-=t,this.right-=t;break;case"+y":this.top+=t,this.bottom+=t;break;case"-y":this.top-=t,this.bottom-=t}},Ai.prototype.overlaps=function(e){return this.left<e.right&&this.right>e.left&&this.top<e.bottom&&this.bottom>e.top},Ai.prototype.overlapsAny=function(e){for(var t=0;t<e.length;t++)if(this.overlaps(e[t]))return!0;return!1},Ai.prototype.within=function(e){return this.top>=e.top&&this.bottom<=e.bottom&&this.left>=e.left&&this.right<=e.right},Ai.prototype.overlapsOppositeAxis=function(e,t){switch(t){case"+x":return this.left<e.left;case"-x":return this.right>e.right;case"+y":return this.top<e.top;case"-y":return this.bottom>e.bottom}},Ai.prototype.intersectPercentage=function(e){return Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left))*Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top))/(this.height*this.width)},Ai.prototype.toCSSCompatValues=function(e){return{top:this.top-e.top,bottom:e.bottom-this.bottom,left:this.left-e.left,right:e.right-this.right,height:this.height,width:this.width}},Ai.getSimpleBoxPosition=function(e){var t=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0,i=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0,r=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;return{left:(e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e).left,right:e.right,top:e.top||r,height:e.height||t,bottom:e.bottom||r+(e.height||t),width:e.width||i}},Ii.StringDecoder=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}},Ii.convertCueToDOMTree=function(e,t){return e&&t?Si(e,t):null},Ii.processCues=function(e,t,i){if(!e||!t||!i)return null;for(;i.firstChild;)i.removeChild(i.firstChild);var r=e.document.createElement("div");if(r.style.position="absolute",r.style.left="0",r.style.right="0",r.style.top="0",r.style.bottom="0",r.style.margin="1.5%",i.appendChild(r),function(e){for(var t=0;t<e.length;t++)if(e[t].hasBeenReset||!e[t].displayState)return!0;return!1}(t)){var n=[],a=Ai.getSimpleBoxPosition(r),s={font:Math.round(.05*a.height*100)/100+"px sans-serif"};!function(){for(var i,o,u=0;u<t.length;u++)i=new Ci(e,o=t[u],s),r.appendChild(i.div),Li(0,i,a,n),o.displayState=i.div,n.push(Ai.getSimpleBoxPosition(i))}()}else for(var o=0;o<t.length;o++)r.appendChild(t[o].displayState)},(Ii.Parser=function(e,t,i){i||(i=t,t={}),t=t||{},this.window=e,this.vttjs=t,this.state="INITIAL",this.buffer="",this.decoder=i||new TextDecoder("utf8"),this.regionList=[]}).prototype={reportOrThrowError:function(e){if(!(e instanceof hi))throw e;this.onparsingerror&&this.onparsingerror(e)},parse:function(e){var t=this;function i(){for(var e=t.buffer,i=0;i<e.length&&"\r"!==e[i]&&"\n"!==e[i];)++i;var r=e.substr(0,i);return"\r"===e[i]&&++i,"\n"===e[i]&&++i,t.buffer=e.substr(i),r}function r(e){e.match(/X-TIMESTAMP-MAP/)?gi(e,(function(e,i){switch(e){case"X-TIMESTAMP-MAP":!function(e){var i=new pi;gi(e,(function(e,t){switch(e){case"MPEGT":i.integer(e+"S",t);break;case"LOCA":i.set(e+"L",fi(t))}}),/[^\d]:/,/,/),t.ontimestampmap&&t.ontimestampmap({MPEGTS:i.get("MPEGTS"),LOCAL:i.get("LOCAL")})}(i)}}),/=/):gi(e,(function(e,i){switch(e){case"Region":!function(e){var i=new pi;if(gi(e,(function(e,t){switch(e){case"id":i.set(e,t);break;case"width":i.percent(e,t);break;case"lines":i.integer(e,t);break;case"regionanchor":case"viewportanchor":var r=t.split(",");if(2!==r.length)break;var n=new pi;if(n.percent("x",r[0]),n.percent("y",r[1]),!n.has("x")||!n.has("y"))break;i.set(e+"X",n.get("x")),i.set(e+"Y",n.get("y"));break;case"scroll":i.alt(e,t,["up"])}}),/=/,/\s/),i.has("id")){var r=new(t.vttjs.VTTRegion||t.window.VTTRegion);r.width=i.get("width",100),r.lines=i.get("lines",3),r.regionAnchorX=i.get("regionanchorX",0),r.regionAnchorY=i.get("regionanchorY",100),r.viewportAnchorX=i.get("viewportanchorX",0),r.viewportAnchorY=i.get("viewportanchorY",100),r.scroll=i.get("scroll",""),t.onregion&&t.onregion(r),t.regionList.push({id:i.get("id"),region:r})}}(i)}}),/:/)}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var n;if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var a=(n=i()).match(/^WEBVTT([ \t].*)?$/);if(!a||!a[0])throw new hi(hi.Errors.BadSignature);t.state="HEADER"}for(var s=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(s?s=!1:n=i(),t.state){case"HEADER":/:/.test(n)?r(n):n||(t.state="ID");continue;case"NOTE":n||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(n)){t.state="NOTE";break}if(!n)continue;t.cue=new(t.vttjs.VTTCue||t.window.VTTCue)(0,0,"");try{t.cue.align="center"}catch(e){t.cue.align="middle"}if(t.state="CUE",-1===n.indexOf("--\x3e")){t.cue.id=n;continue}case"CUE":try{mi(n,t.cue,t.regionList)}catch(e){t.reportOrThrowError(e),t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var o=-1!==n.indexOf("--\x3e");if(!n||o&&(s=!0)){t.oncue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}t.cue.text&&(t.cue.text+="\n"),t.cue.text+=n.replace(/\u2028/g,"\n").replace(/u2029/g,"\n");continue;case"BADCUE":n||(t.state="ID");continue}}}catch(e){t.reportOrThrowError(e),"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var e=this;try{if(e.buffer+=e.decoder.decode(),!e.cue&&"HEADER"!==e.state||(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state)throw new hi(hi.Errors.BadSignature)}catch(na){e.reportOrThrowError(na)}return e.onflush&&e.onflush(),this}};var Ri=Ii,Di={"":1,lr:1,rl:1},Oi={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function xi(e){return"string"==typeof e&&!!Oi[e.toLowerCase()]&&e.toLowerCase()}function Pi(e,t,i){this.hasBeenReset=!1;var r="",n=!1,a=e,s=t,o=i,u=null,l="",c=!0,d="auto",h="start",f="auto",p="auto",g=100,m="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return r},set:function(e){r=""+e}},pauseOnExit:{enumerable:!0,get:function(){return n},set:function(e){n=!!e}},startTime:{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");a=e,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");s=e,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return o},set:function(e){o=""+e,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return u},set:function(e){u=e,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return l},set:function(e){var t=function(e){return"string"==typeof e&&!!Di[e.toLowerCase()]&&e.toLowerCase()}(e);if(!1===t)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");l=t,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return c},set:function(e){c=!!e,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return d},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("Line: an invalid number or illegal string was specified.");d=e,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return h},set:function(e){var t=xi(e);t&&(h=t,this.hasBeenReset=!0)}},position:{enumerable:!0,get:function(){return f},set:function(e){if(e<0||100<e)throw new Error("Position must be between 0 and 100.");f=e,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return p},set:function(e){var t=xi(e);t&&(p=t,this.hasBeenReset=!0)}},size:{enumerable:!0,get:function(){return g},set:function(e){if(e<0||100<e)throw new Error("Size must be between 0 and 100.");g=e,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return m},set:function(e){var t=xi(e);if(!t)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");m=t,this.hasBeenReset=!0}}}),this.displayState=void 0}Pi.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)};var Mi=Pi,Ni={"":!0,up:!0};function Ui(e){return"number"==typeof e&&0<=e&&e<=100}function Fi(){var e=100,t=3,i=0,r=100,n=0,a=100,s="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return e},set:function(t){if(!Ui(t))throw new Error("Width must be between 0 and 100.");e=t}},lines:{enumerable:!0,get:function(){return t},set:function(e){if("number"!=typeof e)throw new TypeError("Lines must be set to a number.");t=e}},regionAnchorY:{enumerable:!0,get:function(){return r},set:function(e){if(!Ui(e))throw new Error("RegionAnchorX must be between 0 and 100.");r=e}},regionAnchorX:{enumerable:!0,get:function(){return i},set:function(e){if(!Ui(e))throw new Error("RegionAnchorY must be between 0 and 100.");i=e}},viewportAnchorY:{enumerable:!0,get:function(){return a},set:function(e){if(!Ui(e))throw new Error("ViewportAnchorY must be between 0 and 100.");a=e}},viewportAnchorX:{enumerable:!0,get:function(){return n},set:function(e){if(!Ui(e))throw new Error("ViewportAnchorX must be between 0 and 100.");n=e}},scroll:{enumerable:!0,get:function(){return s},set:function(e){var t=function(e){return"string"==typeof e&&!!Ni[e.toLowerCase()]&&e.toLowerCase()}(e);!1===t||(s=t)}}})}var Bi=o((function(t){var i=t.exports={WebVTT:Ri,VTTCue:Mi,VTTRegion:Fi};e.vttjs=i,e.WebVTT=i.WebVTT;var r=i.VTTCue,n=i.VTTRegion,a=e.VTTCue,s=e.VTTRegion;i.shim=function(){e.VTTCue=r,e.VTTRegion=n},i.restore=function(){e.VTTCue=a,e.VTTRegion=s},e.VTTCue||i.shim()})),ji=function(i){function r(e,t){var r;return void 0===e&&(e={}),void 0===t&&(t=function(){}),e.reportTouchActivity=!1,(r=i.call(this,null,e,t)||this).hasStarted_=!1,r.on("playing",(function(){this.hasStarted_=!0})),r.on("loadstart",(function(){this.hasStarted_=!1})),li.names.forEach((function(t){var i=li[t];e&&e[i.getterName]&&(r[i.privateName]=e[i.getterName])})),r.featuresProgressEvents||r.manualProgressOn(),r.featuresTimeupdateEvents||r.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach((function(t){!1===e["native"+t+"Tracks"]&&(r["featuresNative"+t+"Tracks"]=!1)})),!1===e.nativeCaptions||!1===e.nativeTextTracks?r.featuresNativeTextTracks=!1:!0!==e.nativeCaptions&&!0!==e.nativeTextTracks||(r.featuresNativeTextTracks=!0),r.featuresNativeTextTracks||r.emulateTextTracks(),r.preloadTextTracks=!1!==e.preloadTextTracks,r.autoRemoteTextTracks_=new li.text.ListClass,r.initTrackListeners(),e.nativeControlsForTouch||r.emitTapEvents(),r.constructor&&(r.name_=r.constructor.name||"Unknown Tech"),r}qe(r,i);var a=r.prototype;return a.triggerSourceset=function(e){var t=this;this.isReady_||this.one("ready",(function(){return t.setTimeout((function(){return t.triggerSourceset(e)}),1)})),this.trigger({src:e,type:"sourceset"})},a.manualProgressOn=function(){this.on("durationchange",this.onDurationChange),this.manualProgress=!0,this.one("ready",this.trackProgress)},a.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange)},a.trackProgress=function(e){this.stopTrackingProgress(),this.progressInterval=this.setInterval(ge(this,(function(){var e=this.bufferedPercent();this.bufferedPercent_!==e&&this.trigger("progress"),1===(this.bufferedPercent_=e)&&this.stopTrackingProgress()})),500)},a.onDurationChange=function(e){this.duration_=this.duration()},a.buffered=function(){return pt(0,0)},a.bufferedPercent=function(){return gt(this.buffered(),this.duration_)},a.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},a.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime),this.on("pause",this.stopTrackingCurrentTime)},a.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime),this.off("pause",this.stopTrackingCurrentTime)},a.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval((function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}),250)},a.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},a.dispose=function(){this.clearTracks(oi.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),i.prototype.dispose.call(this)},a.clearTracks=function(e){var t=this;(e=[].concat(e)).forEach((function(e){for(var i=t[e+"Tracks"]()||[],r=i.length;r--;){var n=i[r];"text"===e&&t.removeRemoteTextTrack(n),i.removeTrack(n)}}))},a.cleanupAutoTextTracks=function(){for(var e=this.autoRemoteTextTracks_||[],t=e.length;t--;)this.removeRemoteTextTrack(e[t])},a.reset=function(){},a.crossOrigin=function(){},a.setCrossOrigin=function(){},a.error=function(e){return void 0!==e&&(this.error_=new St(e),this.trigger("error")),this.error_},a.played=function(){return this.hasStarted_?pt(0,0):pt()},a.setScrubbing=function(){},a.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},a.initTrackListeners=function(){var e=this;oi.names.forEach((function(t){function i(){e.trigger(t+"trackchange")}var r=e[oi[t].getterName]();r.addEventListener("removetrack",i),r.addEventListener("addtrack",i),e.on("dispose",(function(){r.removeEventListener("removetrack",i),r.removeEventListener("addtrack",i)}))}))},a.addWebVttScript_=function(){var i=this;if(!e.WebVTT)if(t.body.contains(this.el())){if(!this.options_["vtt.js"]&&p(Bi)&&0<Object.keys(Bi).length)return void this.trigger("vttjsloaded");var r=t.createElement("script");r.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",r.onload=function(){i.trigger("vttjsloaded")},r.onerror=function(){i.trigger("vttjserror")},this.on("dispose",(function(){r.onload=null,r.onerror=null})),e.WebVTT=!0,this.el().parentNode.appendChild(r)}else this.ready(this.addWebVttScript_)},a.emulateTextTracks=function(){function e(e){return r.addTrack(e.track)}function t(e){return r.removeTrack(e.track)}var i=this,r=this.textTracks(),n=this.remoteTextTracks();function a(){return i.trigger("texttrackchange")}function s(){a();for(var e=0;e<r.length;e++){var t=r[e];t.removeEventListener("cuechange",a),"showing"===t.mode&&t.addEventListener("cuechange",a)}}n.on("addtrack",e),n.on("removetrack",t),this.addWebVttScript_(),s(),r.addEventListener("change",s),r.addEventListener("addtrack",s),r.addEventListener("removetrack",s),this.on("dispose",(function(){n.off("addtrack",e),n.off("removetrack",t),r.removeEventListener("change",s),r.removeEventListener("addtrack",s),r.removeEventListener("removetrack",s);for(var i=0;i<r.length;i++)r[i].removeEventListener("cuechange",a)}))},a.addTextTrack=function(e,t,i){if(!e)throw new Error("TextTrack kind is required but was not provided");return function(e,t,i,r,n){void 0===n&&(n={});var a=e.textTracks();n.kind=t,i&&(n.label=i),r&&(n.language=r),n.tech=e;var s=new li.text.TrackClass(n);return a.addTrack(s),s}(this,e,t,i)},a.createRemoteTextTrack=function(e){var t=xe(e,{tech:this});return new ui.remoteTextEl.TrackClass(t)},a.addRemoteTextTrack=function(e,t){var i=this;void 0===e&&(e={});var r=this.createRemoteTextTrack(e);return!0!==t&&!1!==t&&(n.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'),t=!0),this.remoteTextTrackEls().addTrackElement_(r),this.remoteTextTracks().addTrack(r.track),!0!==t&&this.ready((function(){return i.autoRemoteTextTracks_.addTrack(r.track)})),r},a.removeRemoteTextTrack=function(e){var t=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(t),this.remoteTextTracks().removeTrack(e),this.autoRemoteTextTracks_.removeTrack(e)},a.getVideoPlaybackQuality=function(){return{}},a.requestPictureInPicture=function(){var t=this.options_.Promise||e.Promise;if(t)return t.reject()},a.disablePictureInPicture=function(){return!0},a.setDisablePictureInPicture=function(){},a.setPoster=function(){},a.playsinline=function(){},a.setPlaysinline=function(){},a.overrideNativeAudioTracks=function(){},a.overrideNativeVideoTracks=function(){},a.canPlayType=function(){return""},r.canPlayType=function(){return""},r.canPlaySource=function(e,t){return r.canPlayType(e.type)},r.isTech=function(e){return e.prototype instanceof r||e instanceof r||e===r},r.registerTech=function(e,t){if(r.techs_||(r.techs_={}),!r.isTech(t))throw new Error("Tech "+e+" must be a Tech");if(!r.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!r.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return e=Oe(e),r.techs_[e]=t,r.techs_[De(e)]=t,"Tech"!==e&&r.defaultTechOrder_.push(e),t},r.getTech=function(t){if(t)return r.techs_&&r.techs_[t]?r.techs_[t]:(t=Oe(t),e&&e.videojs&&e.videojs[t]?(n.warn("The "+t+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),e.videojs[t]):void 0)},r}(Fe);li.names.forEach((function(e){var t=li[e];ji.prototype[t.getterName]=function(){return this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName]}})),ji.prototype.featuresVolumeControl=!0,ji.prototype.featuresMuteControl=!0,ji.prototype.featuresFullscreenResize=!1,ji.prototype.featuresPlaybackRate=!1,ji.prototype.featuresProgressEvents=!1,ji.prototype.featuresSourceset=!1,ji.prototype.featuresTimeupdateEvents=!1,ji.prototype.featuresNativeTextTracks=!1,ji.withSourceHandlers=function(e){e.registerSourceHandler=function(t,i){var r=e.sourceHandlers;r=r||(e.sourceHandlers=[]),void 0===i&&(i=r.length),r.splice(i,0,t)},e.canPlayType=function(t){for(var i,r=e.sourceHandlers||[],n=0;n<r.length;n++)if(i=r[n].canPlayType(t))return i;return""},e.selectSourceHandler=function(t,i){for(var r=e.sourceHandlers||[],n=0;n<r.length;n++)if(r[n].canHandleSource(t,i))return r[n];return null},e.canPlaySource=function(t,i){var r=e.selectSourceHandler(t,i);return r?r.canHandleSource(t,i):""},["seekable","seeking","duration"].forEach((function(e){var t=this[e];"function"==typeof t&&(this[e]=function(){return this.sourceHandler_&&this.sourceHandler_[e]?this.sourceHandler_[e].apply(this.sourceHandler_,arguments):t.apply(this,arguments)})}),e.prototype),e.prototype.setSource=function(t){var i=e.selectSourceHandler(t,this.options_);i||(e.nativeSourceHandler?i=e.nativeSourceHandler:n.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler),i!==e.nativeSourceHandler&&(this.currentSource_=t),this.sourceHandler_=i.handleSource(t,this,this.options_),this.one("dispose",this.disposeSourceHandler)},e.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},Fe.registerComponent("Tech",ji),ji.registerTech("Tech",ji),ji.defaultTechOrder_=[];var Vi={},Hi={},Gi={};function qi(e,t,i,r){void 0===r&&(r=null);var n="call"+Oe(i),a=e.reduce(Yi(n),r),s=a===Gi,o=s?null:t[i](a);return function(e,t,i,r){for(var n=e.length-1;0<=n;n--){var a=e[n];a[t]&&a[t](r,i)}}(e,i,o,s),o}var Ki={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1},Wi={setCurrentTime:1,setMuted:1,setVolume:1},zi={play:1,pause:1};function Yi(e){return function(t,i){return t===Gi?Gi:i[e]?i[e](t):t}}function Xi(e){void 0===e&&(e="");var t=Nt(e);return Qi[t.toLowerCase()]||""}var Qi={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",caf:"audio/x-caf",flac:"audio/flac",oga:"audio/ogg",wav:"audio/wav",m3u8:"application/x-mpegURL",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"};function $i(e){if(!e.type){var t=Xi(e.src);t&&(e.type=t)}return e}var Ji=function(e){function t(t,i,r){var n,a=xe({createEl:!1},i);if(n=e.call(this,t,a,r)||this,i.playerOptions.sources&&0!==i.playerOptions.sources.length)t.src(i.playerOptions.sources);else for(var s=0,o=i.playerOptions.techOrder;s<o.length;s++){var u=Oe(o[s]),l=ji.getTech(u);if(u||(l=Fe.getComponent(u)),l&&l.isSupported()){t.loadTech_(u);break}}return n}return qe(t,e),t}(Fe);Fe.registerComponent("MediaLoader",Ji);var Zi=function(e){function t(t,i){var r;return(r=e.call(this,t,i)||this).emitTapEvents(),r.enable(),r}qe(t,e);var i=t.prototype;return i.createEl=function(t,i,r){void 0===t&&(t="div"),void 0===i&&(i={}),void 0===r&&(r={}),i=h({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass(),tabIndex:0},i),"button"===t&&n.error("Creating a ClickableComponent with an HTML element of "+t+" is not supported; use a Button instead."),r=h({role:"button"},r),this.tabIndex_=i.tabIndex;var a=e.prototype.createEl.call(this,t,i,r);return this.createControlTextEl(a),a},i.dispose=function(){this.controlTextEl_=null,e.prototype.dispose.call(this)},i.createControlTextEl=function(e){return this.controlTextEl_=S("span",{className:"vjs-control-text"},{"aria-live":"polite"}),e&&e.appendChild(this.controlTextEl_),this.controlText(this.controlText_,e),this.controlTextEl_},i.controlText=function(e,t){if(void 0===t&&(t=this.el()),void 0===e)return this.controlText_||"Need Text";var i=this.localize(e);this.controlText_=e,E(this.controlTextEl_,i),this.nonIconControl||t.setAttribute("title",i)},i.buildCSSClass=function(){return"vjs-control vjs-button "+e.prototype.buildCSSClass.call(this)},i.enable=function(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),void 0!==this.tabIndex_&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick),this.on("keydown",this.handleKeyDown))},i.disable=function(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),void 0!==this.tabIndex_&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver),this.off("mouseout",this.handleMouseOut),this.off(["tap","click"],this.handleClick),this.off("keydown",this.handleKeyDown)},i.handleClick=function(e){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)},i.handleKeyDown=function(t){At.isEventKey(t,"Space")||At.isEventKey(t,"Enter")?(t.preventDefault(),t.stopPropagation(),this.trigger("click")):e.prototype.handleKeyDown.call(this,t)},t}(Fe);Fe.registerComponent("ClickableComponent",Zi);var er=function(e){function t(t,i){var r;return(r=e.call(this,t,i)||this).update(),t.on("posterchange",ge(Be(r),r.update)),r}qe(t,e);var i=t.prototype;return i.dispose=function(){this.player().off("posterchange",this.update),e.prototype.dispose.call(this)},i.createEl=function(){return S("div",{className:"vjs-poster",tabIndex:-1})},i.update=function(e){var t=this.player().poster();this.setSrc(t),t?this.show():this.hide()},i.setSrc=function(e){var t="";e&&(t='url("'+e+'")'),this.el_.style.backgroundImage=t},i.handleClick=function(e){if(this.player_.controls()){var t=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&0<this.player_.eme.sessions.length;!this.player_.tech(!0)||(rt||et)&&t||this.player_.tech(!0).focus(),this.player_.paused()?wt(this.player_.play()):this.player_.pause()}},t}(Zi);Fe.registerComponent("PosterImage",er);var tr="#222",ir={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function rr(e,t){var i;if(4===e.length)i=e[1]+e[1]+e[2]+e[2]+e[3]+e[3];else{if(7!==e.length)throw new Error("Invalid color code provided, "+e+"; must be formatted as e.g. #f0e or #f604e2.");i=e.slice(1)}return"rgba("+parseInt(i.slice(0,2),16)+","+parseInt(i.slice(2,4),16)+","+parseInt(i.slice(4,6),16)+","+t+")"}function nr(e,t,i){try{e.style[t]=i}catch(e){return}}var ar=function(t){function i(i,r,n){var a;a=t.call(this,i,r,n)||this;var s=ge(Be(a),a.updateDisplay);return i.on("loadstart",ge(Be(a),a.toggleDisplay)),i.on("texttrackchange",s),i.on("loadedmetadata",ge(Be(a),a.preselectTrack)),i.ready(ge(Be(a),(function(){if(i.tech_&&i.tech_.featuresNativeTextTracks)this.hide();else{i.on("fullscreenchange",s),i.on("playerresize",s),e.addEventListener("orientationchange",s),i.on("dispose",(function(){return e.removeEventListener("orientationchange",s)}));for(var t=this.options_.playerOptions.tracks||[],r=0;r<t.length;r++)this.player_.addRemoteTextTrack(t[r],!0);this.preselectTrack()}}))),a}qe(i,t);var r=i.prototype;return r.preselectTrack=function(){for(var e,t,i,r={captions:1,subtitles:1},n=this.player_.textTracks(),a=this.player_.cache_.selectedLanguage,s=0;s<n.length;s++){var o=n[s];a&&a.enabled&&a.language&&a.language===o.language&&o.kind in r?i=o.kind===a.kind?o:i||o:a&&!a.enabled?t=e=i=null:o.default&&("descriptions"!==o.kind||e?o.kind in r&&!t&&(t=o):e=o)}i?i.mode="showing":t?t.mode="showing":e&&(e.mode="showing")},r.toggleDisplay=function(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},r.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})},r.clearDisplay=function(){"function"==typeof e.WebVTT&&e.WebVTT.processCues(e,[],this.el_)},r.updateDisplay=function(){var e=this.player_.textTracks(),t=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),t){for(var i=[],r=0;r<e.length;++r){var n=e[r];"showing"===n.mode&&i.push(n)}this.updateForTrack(i)}else{for(var a=null,s=null,o=e.length;o--;){var u=e[o];"showing"===u.mode&&("descriptions"===u.kind?a=u:s=u)}s?("off"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","off"),this.updateForTrack(s)):a&&("assertive"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","assertive"),this.updateForTrack(a))}},r.updateDisplayState=function(t){for(var i=this.player_.textTrackSettings.getValues(),r=t.activeCues,n=r.length;n--;){var a=r[n];if(a){var s=a.displayState;if(i.color&&(s.firstChild.style.color=i.color),i.textOpacity&&nr(s.firstChild,"color",rr(i.color||"#fff",i.textOpacity)),i.backgroundColor&&(s.firstChild.style.backgroundColor=i.backgroundColor),i.backgroundOpacity&&nr(s.firstChild,"backgroundColor",rr(i.backgroundColor||"#000",i.backgroundOpacity)),i.windowColor&&(i.windowOpacity?nr(s,"backgroundColor",rr(i.windowColor,i.windowOpacity)):s.style.backgroundColor=i.windowColor),i.edgeStyle&&("dropshadow"===i.edgeStyle?s.firstChild.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px "+tr:"raised"===i.edgeStyle?s.firstChild.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px "+tr:"depressed"===i.edgeStyle?s.firstChild.style.textShadow="1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px "+tr:"uniform"===i.edgeStyle&&(s.firstChild.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px "+tr)),i.fontPercent&&1!==i.fontPercent){var o=e.parseFloat(s.style.fontSize);s.style.fontSize=o*i.fontPercent+"px",s.style.height="auto",s.style.top="auto"}i.fontFamily&&"default"!==i.fontFamily&&("small-caps"===i.fontFamily?s.firstChild.style.fontVariant="small-caps":s.firstChild.style.fontFamily=ir[i.fontFamily])}}},r.updateForTrack=function(t){if(Array.isArray(t)||(t=[t]),"function"==typeof e.WebVTT&&!t.every((function(e){return!e.activeCues}))){for(var i=[],r=0;r<t.length;++r)for(var n=t[r],a=0;a<n.activeCues.length;++a)i.push(n.activeCues[a]);e.WebVTT.processCues(e,i,this.el_);for(var s=0;s<t.length;++s){for(var o=t[s],u=0;u<o.activeCues.length;++u){var l=o.activeCues[u].displayState;C(l,"vjs-text-track-cue"),C(l,"vjs-text-track-cue-"+(o.language?o.language:s))}this.player_.textTrackSettings&&this.updateDisplayState(o)}}},i}(Fe);Fe.registerComponent("TextTrackDisplay",ar);var sr=function(e){function t(){return e.apply(this,arguments)||this}return qe(t,e),t.prototype.createEl=function(){var t=this.player_.isAudio(),i=this.localize(t?"Audio Player":"Video Player"),r=S("span",{className:"vjs-control-text",innerHTML:this.localize("{1} is loading.",[i])}),n=e.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});return n.appendChild(r),n},t}(Fe);Fe.registerComponent("LoadingSpinner",sr);var or=function(e){function t(){return e.apply(this,arguments)||this}qe(t,e);var i=t.prototype;return i.createEl=function(e,t,i){void 0===t&&(t={}),void 0===i&&(i={}),t=h({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass()},t),i=h({type:"button"},i);var r=Fe.prototype.createEl.call(this,"button",t,i);return this.createControlTextEl(r),r},i.addChild=function(e,t){return void 0===t&&(t={}),n.warn("Adding an actionable (user controllable) child to a Button ("+this.constructor.name+") is not supported; use a ClickableComponent instead."),Fe.prototype.addChild.call(this,e,t)},i.enable=function(){e.prototype.enable.call(this),this.el_.removeAttribute("disabled")},i.disable=function(){e.prototype.disable.call(this),this.el_.setAttribute("disabled","disabled")},i.handleKeyDown=function(t){At.isEventKey(t,"Space")||At.isEventKey(t,"Enter")?t.stopPropagation():e.prototype.handleKeyDown.call(this,t)},t}(Zi);Fe.registerComponent("Button",or);var ur=function(e){function t(t,i){var r;return(r=e.call(this,t,i)||this).mouseused_=!1,r.on("mousedown",r.handleMouseDown),r}qe(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-big-play-button"},i.handleClick=function(e){var t=this.player_.play();if(this.mouseused_&&e.clientX&&e.clientY){var i=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&0<this.player_.eme.sessions.length;return wt(t),void(!this.player_.tech(!0)||(rt||et)&&i||this.player_.tech(!0).focus())}var r=this.player_.getChild("controlBar"),n=r&&r.getChild("playToggle");if(n){var a=function(){return n.focus()};kt(t)?t.then(a,(function(){})):this.setTimeout(a,1)}else this.player_.tech(!0).focus()},i.handleKeyDown=function(t){this.mouseused_=!1,e.prototype.handleKeyDown.call(this,t)},i.handleMouseDown=function(e){this.mouseused_=!0},t}(or);ur.prototype.controlText_="Play Video",Fe.registerComponent("BigPlayButton",ur);var lr=function(e){function t(t,i){var r;return(r=e.call(this,t,i)||this).controlText(i&&i.controlText||r.localize("Close")),r}qe(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-close-button "+e.prototype.buildCSSClass.call(this)},i.handleClick=function(e){this.trigger({type:"close",bubbles:!1})},i.handleKeyDown=function(t){At.isEventKey(t,"Esc")?(t.preventDefault(),t.stopPropagation(),this.trigger("click")):e.prototype.handleKeyDown.call(this,t)},t}(or);Fe.registerComponent("CloseButton",lr);var cr=function(e){function t(t,i){var r;return void 0===i&&(i={}),r=e.call(this,t,i)||this,i.replay=void 0===i.replay||i.replay,r.on(t,"play",r.handlePlay),r.on(t,"pause",r.handlePause),i.replay&&r.on(t,"ended",r.handleEnded),r}qe(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-play-control "+e.prototype.buildCSSClass.call(this)},i.handleClick=function(e){this.player_.paused()?this.player_.play():this.player_.pause()},i.handleSeeked=function(e){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(e):this.handlePlay(e)},i.handlePlay=function(e){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")},i.handlePause=function(e){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")},i.handleEnded=function(e){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.controlText("Replay"),this.one(this.player_,"seeked",this.handleSeeked)},t}(or);function dr(e,t){e=e<0?0:e;var i=Math.floor(e%60),r=Math.floor(e/60%60),n=Math.floor(e/3600),a=Math.floor(t/60%60),s=Math.floor(t/3600);return!isNaN(e)&&e!==1/0||(n=r=i="-"),(n=0<n||0<s?n+":":"")+(r=((n||10<=a)&&r<10?"0"+r:r)+":")+(i<10?"0"+i:i)}cr.prototype.controlText_="Play",Fe.registerComponent("PlayToggle",cr);var hr=dr;function fr(e,t){return void 0===t&&(t=e),hr(e,t)}var pr=function(e){function i(t,i){var r;return(r=e.call(this,t,i)||this).on(t,["timeupdate","ended"],r.updateContent),r.updateTextNode_(),r}qe(i,e);var r=i.prototype;return r.createEl=function(){var t=this.buildCSSClass(),i=e.prototype.createEl.call(this,"div",{className:t+" vjs-time-control vjs-control",innerHTML:'<span class="vjs-control-text" role="presentation">'+this.localize(this.labelText_)+"</span>"});return this.contentEl_=S("span",{className:t+"-display"},{"aria-live":"off",role:"presentation"}),i.appendChild(this.contentEl_),i},r.dispose=function(){this.contentEl_=null,this.textNode_=null,e.prototype.dispose.call(this)},r.updateTextNode_=function(e){var i=this;void 0===e&&(e=0),e=fr(e),this.formattedTime_!==e&&(this.formattedTime_=e,this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",(function(){if(i.contentEl_){var e=i.textNode_;i.textNode_=t.createTextNode(i.formattedTime_),i.textNode_&&(e?i.contentEl_.replaceChild(i.textNode_,e):i.contentEl_.appendChild(i.textNode_))}})))},r.updateContent=function(e){},i}(Fe);pr.prototype.labelText_="Time",pr.prototype.controlText_="Time",Fe.registerComponent("TimeDisplay",pr);var gr=function(e){function t(){return e.apply(this,arguments)||this}qe(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-current-time"},i.updateContent=function(e){var t;t=this.player_.ended()?this.player_.duration():this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),this.updateTextNode_(t)},t}(pr);gr.prototype.labelText_="Current Time",gr.prototype.controlText_="Current Time",Fe.registerComponent("CurrentTimeDisplay",gr);var mr=function(e){function t(t,i){var r;return(r=e.call(this,t,i)||this).on(t,"durationchange",r.updateContent),r.on(t,"loadstart",r.updateContent),r.on(t,"loadedmetadata",r.updateContent),r}qe(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-duration"},i.updateContent=function(e){var t=this.player_.duration();this.updateTextNode_(t)},t}(pr);mr.prototype.labelText_="Duration",mr.prototype.controlText_="Duration",Fe.registerComponent("DurationDisplay",mr);var vr=function(e){function t(){return e.apply(this,arguments)||this}return qe(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider",innerHTML:"<div><span>/</span></div>"},{"aria-hidden":!0})},t}(Fe);Fe.registerComponent("TimeDivider",vr);var yr=function(e){function t(t,i){var r;return(r=e.call(this,t,i)||this).on(t,"durationchange",r.updateContent),r}qe(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-remaining-time"},i.createEl=function(){var t=e.prototype.createEl.call(this);return t.insertBefore(S("span",{},{"aria-hidden":!0},"-"),this.contentEl_),t},i.updateContent=function(e){var t;"number"==typeof this.player_.duration()&&(t=this.player_.ended()?0:this.player_.remainingTimeDisplay?this.player_.remainingTimeDisplay():this.player_.remainingTime(),this.updateTextNode_(t))},t}(pr);yr.prototype.labelText_="Remaining Time",yr.prototype.controlText_="Remaining Time",Fe.registerComponent("RemainingTimeDisplay",yr);var _r=function(e){function t(t,i){var r;return(r=e.call(this,t,i)||this).updateShowing(),r.on(r.player(),"durationchange",r.updateShowing),r}qe(t,e);var i=t.prototype;return i.createEl=function(){var t=e.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});return this.contentEl_=S("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+"</span>"+this.localize("LIVE")},{"aria-live":"off"}),t.appendChild(this.contentEl_),t},i.dispose=function(){this.contentEl_=null,e.prototype.dispose.call(this)},i.updateShowing=function(e){this.player().duration()===1/0?this.show():this.hide()},t}(Fe);Fe.registerComponent("LiveDisplay",_r);var br=function(e){function t(t,i){var r;return(r=e.call(this,t,i)||this).updateLiveEdgeStatus(),r.player_.liveTracker&&r.on(r.player_.liveTracker,"liveedgechange",r.updateLiveEdgeStatus),r}qe(t,e);var i=t.prototype;return i.createEl=function(){var t=e.prototype.createEl.call(this,"button",{className:"vjs-seek-to-live-control vjs-control"});return this.textEl_=S("span",{className:"vjs-seek-to-live-text",innerHTML:this.localize("LIVE")},{"aria-hidden":"true"}),t.appendChild(this.textEl_),t},i.updateLiveEdgeStatus=function(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))},i.handleClick=function(){this.player_.liveTracker.seekToLiveEdge()},i.dispose=function(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatus),this.textEl_=null,e.prototype.dispose.call(this)},t}(or);function Tr(e,t,i){return e=Number(e),Math.min(i,Math.max(t,isNaN(e)?t:e))}br.prototype.controlText_="Seek to live, currently playing live",Fe.registerComponent("SeekToLive",br);var Sr=function(e){function t(t,i){var r;return(r=e.call(this,t,i)||this).bar=r.getChild(r.options_.barName),r.vertical(!!r.options_.vertical),r.enable(),r}qe(t,e);var i=t.prototype;return i.enabled=function(){return this.enabled_},i.enable=function(){this.enabled()||(this.on("mousedown",this.handleMouseDown),this.on("touchstart",this.handleMouseDown),this.on("keydown",this.handleKeyDown),this.on("click",this.handleClick),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)},i.disable=function(){if(this.enabled()){var e=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown),this.off("touchstart",this.handleMouseDown),this.off("keydown",this.handleKeyDown),this.off("click",this.handleClick),this.off(this.player_,"controlsvisible",this.update),this.off(e,"mousemove",this.handleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchmove",this.handleMouseMove),this.off(e,"touchend",this.handleMouseUp),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}},i.createEl=function(t,i,r){return void 0===i&&(i={}),void 0===r&&(r={}),i.className=i.className+" vjs-slider",i=h({tabIndex:0},i),r=h({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},r),e.prototype.createEl.call(this,t,i,r)},i.handleMouseDown=function(e){var t=this.bar.el_.ownerDocument;"mousedown"===e.type&&e.preventDefault(),"touchstart"!==e.type||tt||e.preventDefault(),P(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(t,"mousemove",this.handleMouseMove),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchmove",this.handleMouseMove),this.on(t,"touchend",this.handleMouseUp),this.handleMouseMove(e)},i.handleMouseMove=function(e){},i.handleMouseUp=function(){var e=this.bar.el_.ownerDocument;M(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(e,"mousemove",this.handleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchmove",this.handleMouseMove),this.off(e,"touchend",this.handleMouseUp),this.update()},i.update=function(){var e=this;if(this.el_&&this.bar){var t=this.getProgress();return t===this.progress_||(this.progress_=t,this.requestNamedAnimationFrame("Slider#update",(function(){var i=e.vertical()?"height":"width";e.bar.el().style[i]=(100*t).toFixed(2)+"%"}))),t}},i.getProgress=function(){return Number(Tr(this.getPercent(),0,1).toFixed(4))},i.calculateDistance=function(e){var t=F(this.el_,e);return this.vertical()?t.y:t.x},i.handleKeyDown=function(t){At.isEventKey(t,"Left")||At.isEventKey(t,"Down")?(t.preventDefault(),t.stopPropagation(),this.stepBack()):At.isEventKey(t,"Right")||At.isEventKey(t,"Up")?(t.preventDefault(),t.stopPropagation(),this.stepForward()):e.prototype.handleKeyDown.call(this,t)},i.handleClick=function(e){e.stopPropagation(),e.preventDefault()},i.vertical=function(e){if(void 0===e)return this.vertical_||!1;this.vertical_=!!e,this.addClass(this.vertical_?"vjs-slider-vertical":"vjs-slider-horizontal")},t}(Fe);function Er(e,t){return Tr(e/t*100,0,100).toFixed(2)+"%"}Fe.registerComponent("Slider",Sr);var kr=function(e){function i(t,i){var r;return(r=e.call(this,t,i)||this).partEls_=[],r.on(t,"progress",r.update),r}qe(i,e);var r=i.prototype;return r.createEl=function(){var i=e.prototype.createEl.call(this,"div",{className:"vjs-load-progress"}),r=S("span",{className:"vjs-control-text"}),n=S("span",{textContent:this.localize("Loaded")}),a=t.createTextNode(": ");return this.percentageEl_=S("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),i.appendChild(r),r.appendChild(n),r.appendChild(a),r.appendChild(this.percentageEl_),i},r.dispose=function(){this.partEls_=null,this.percentageEl_=null,e.prototype.dispose.call(this)},r.update=function(e){var t=this;this.requestNamedAnimationFrame("LoadProgressBar#update",(function(){var e=t.player_.liveTracker,i=t.player_.buffered(),r=e&&e.isLive()?e.seekableEnd():t.player_.duration(),n=t.player_.bufferedEnd(),a=t.partEls_,s=Er(n,r);t.percent_!==s&&(t.el_.style.width=s,E(t.percentageEl_,s),t.percent_=s);for(var o=0;o<i.length;o++){var u=i.start(o),l=i.end(o),c=a[o];c||(c=t.el_.appendChild(S()),a[o]=c),c.dataset.start===u&&c.dataset.end===l||(c.dataset.start=u,c.dataset.end=l,c.style.left=Er(u,n),c.style.width=Er(l-u,n))}for(var d=a.length;d>i.length;d--)t.el_.removeChild(a[d-1]);a.length=i.length}))},i}(Fe);Fe.registerComponent("LoadProgressBar",kr);var wr=function(e){function t(t,i){var r;return(r=e.call(this,t,i)||this).update=me(ge(Be(r),r.update),30),r}qe(t,e);var i=t.prototype;return i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})},i.update=function(e,t,i){var r=U(this.el_),n=N(this.player_.el()),a=e.width*t;if(n&&r){var s=e.left-n.left+a,o=e.width-a+(n.right-e.right),u=r.width/2;s<u?u+=u-s:o<u&&(u=o),u<0?u=0:u>r.width&&(u=r.width),this.el_.style.right="-"+u+"px",this.write(i)}},i.write=function(e){E(this.el_,e)},i.updateTime=function(e,t,i,r){var n=this;this.requestNamedAnimationFrame("TimeTooltip#updateTime",(function(){var a,s=n.player_.duration();if(n.player_.liveTracker&&n.player_.liveTracker.isLive()){var o=n.player_.liveTracker.liveWindow(),u=o-t*o;a=(u<1?"":"-")+fr(u,o)}else a=fr(i,s);n.update(e,t,a),r&&r()}))},t}(Fe);Fe.registerComponent("TimeTooltip",wr);var Cr=function(e){function t(t,i){var r;return(r=e.call(this,t,i)||this).update=me(ge(Be(r),r.update),30),r}qe(t,e);var i=t.prototype;return i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})},i.update=function(e,t){var i=this.getChild("timeTooltip");if(i){var r=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();i.updateTime(e,t,r)}},t}(Fe);Cr.prototype.options_={children:[]},lt||Qe||Cr.prototype.options_.children.push("timeTooltip"),Fe.registerComponent("PlayProgressBar",Cr);var Ar=function(e){function t(t,i){var r;return(r=e.call(this,t,i)||this).update=me(ge(Be(r),r.update),30),r}qe(t,e);var i=t.prototype;return i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},i.update=function(e,t){var i=this,r=t*this.player_.duration();this.getChild("timeTooltip").updateTime(e,t,r,(function(){i.el_.style.left=e.width*t+"px"}))},t}(Fe);Ar.prototype.options_={children:["timeTooltip"]},Fe.registerComponent("MouseTimeDisplay",Ar);var Lr=function(e){function i(t,i){var r;return(r=e.call(this,t,i)||this).setEventHandlers_(),r}qe(i,e);var r=i.prototype;return r.setEventHandlers_=function(){this.update_=ge(this,this.update),this.update=me(this.update_,30),this.on(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.on(this.player_,["playing"],this.enableInterval_),this.on(this.player_,["ended","pause","waiting"],this.disableInterval_),"hidden"in t&&"visibilityState"in t&&this.on(t,"visibilitychange",this.toggleVisibility_)},r.toggleVisibility_=function(e){t.hidden?this.disableInterval_(e):(this.enableInterval_(),this.update())},r.enableInterval_=function(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,30))},r.disableInterval_=function(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&e&&"ended"!==e.type||this.updateInterval&&(this.clearInterval(this.updateInterval),this.updateInterval=null)},r.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},r.update=function(t){var i=this,r=e.prototype.update.call(this);return this.requestNamedAnimationFrame("SeekBar#update",(function(){var e=i.player_.ended()?i.player_.duration():i.getCurrentTime_(),t=i.player_.liveTracker,n=i.player_.duration();t&&t.isLive()&&(n=i.player_.liveTracker.liveCurrentTime()),i.percent_!==r&&(i.el_.setAttribute("aria-valuenow",(100*r).toFixed(2)),i.percent_=r),i.currentTime_===e&&i.duration_===n||(i.el_.setAttribute("aria-valuetext",i.localize("progress bar timing: currentTime={1} duration={2}",[fr(e,n),fr(n,n)],"{1} of {2}")),i.currentTime_=e,i.duration_=n),i.bar&&i.bar.update(N(i.el()),i.getProgress())})),r},r.getCurrentTime_=function(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()},r.getPercent=function(){var e,t=this.getCurrentTime_(),i=this.player_.liveTracker;return i&&i.isLive()?(e=(t-i.seekableStart())/i.liveWindow(),i.atLiveEdge()&&(e=1)):e=t/this.player_.duration(),e},r.handleMouseDown=function(t){q(t)&&(t.stopPropagation(),this.player_.scrubbing(!0),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),e.prototype.handleMouseDown.call(this,t))},r.handleMouseMove=function(e){if(q(e)){var t,i=this.calculateDistance(e),r=this.player_.liveTracker;if(r&&r.isLive()){if(.99<=i)return void r.seekToLiveEdge();var n=r.seekableStart(),a=r.liveCurrentTime();if(a<=(t=n+i*r.liveWindow())&&(t=a),t<=n&&(t=n+.1),t===1/0)return}else(t=i*this.player_.duration())===this.player_.duration()&&(t-=.1);this.player_.currentTime(t)}},r.enable=function(){e.prototype.enable.call(this);var t=this.getChild("mouseTimeDisplay");t&&t.show()},r.disable=function(){e.prototype.disable.call(this);var t=this.getChild("mouseTimeDisplay");t&&t.hide()},r.handleMouseUp=function(t){e.prototype.handleMouseUp.call(this,t),t&&t.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying?wt(this.player_.play()):this.update_()},r.stepForward=function(){this.player_.currentTime(this.player_.currentTime()+5)},r.stepBack=function(){this.player_.currentTime(this.player_.currentTime()-5)},r.handleAction=function(e){this.player_.paused()?this.player_.play():this.player_.pause()},r.handleKeyDown=function(t){if(At.isEventKey(t,"Space")||At.isEventKey(t,"Enter"))t.preventDefault(),t.stopPropagation(),this.handleAction(t);else if(At.isEventKey(t,"Home"))t.preventDefault(),t.stopPropagation(),this.player_.currentTime(0);else if(At.isEventKey(t,"End"))t.preventDefault(),t.stopPropagation(),this.player_.currentTime(this.player_.duration());else if(/^[0-9]$/.test(At(t))){t.preventDefault(),t.stopPropagation();var i=10*(At.codes[At(t)]-At.codes[0])/100;this.player_.currentTime(this.player_.duration()*i)}else At.isEventKey(t,"PgDn")?(t.preventDefault(),t.stopPropagation(),this.player_.currentTime(this.player_.currentTime()-60)):At.isEventKey(t,"PgUp")?(t.preventDefault(),t.stopPropagation(),this.player_.currentTime(this.player_.currentTime()+60)):e.prototype.handleKeyDown.call(this,t)},r.dispose=function(){this.disableInterval_(),this.off(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableInterval_),this.off(this.player_,["ended","pause","waiting"],this.disableInterval_),"hidden"in t&&"visibilityState"in t&&this.off(t,"visibilitychange",this.toggleVisibility_),e.prototype.dispose.call(this)},i}(Sr);Lr.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},lt||Qe||Lr.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),Fe.registerComponent("SeekBar",Lr);var Ir=function(e){function t(t,i){var r;return(r=e.call(this,t,i)||this).handleMouseMove=me(ge(Be(r),r.handleMouseMove),30),r.throttledHandleMouseSeek=me(ge(Be(r),r.handleMouseSeek),30),r.enable(),r}qe(t,e);var i=t.prototype;return i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},i.handleMouseMove=function(e){var t=this.getChild("seekBar");if(t){var i=t.getChild("playProgressBar"),r=t.getChild("mouseTimeDisplay");if(i||r){var n=t.el(),a=U(n),s=F(n,e).x;s=Tr(s,0,1),r&&r.update(a,s),i&&i.update(a,t.getProgress())}}},i.handleMouseSeek=function(e){var t=this.getChild("seekBar");t&&t.handleMouseMove(e)},i.enabled=function(){return this.enabled_},i.disable=function(){this.children().forEach((function(e){return e.disable&&e.disable()})),this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDown),this.off(this.el_,"mousemove",this.handleMouseMove),this.handleMouseUp(),this.addClass("disabled"),this.enabled_=!1)},i.enable=function(){this.children().forEach((function(e){return e.enable&&e.enable()})),this.enabled()||(this.on(["mousedown","touchstart"],this.handleMouseDown),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)},i.handleMouseDown=function(e){var t=this.el_.ownerDocument,i=this.getChild("seekBar");i&&i.handleMouseDown(e),this.on(t,"mousemove",this.throttledHandleMouseSeek),this.on(t,"touchmove",this.throttledHandleMouseSeek),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchend",this.handleMouseUp)},i.handleMouseUp=function(e){var t=this.el_.ownerDocument,i=this.getChild("seekBar");i&&i.handleMouseUp(e),this.off(t,"mousemove",this.throttledHandleMouseSeek),this.off(t,"touchmove",this.throttledHandleMouseSeek),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchend",this.handleMouseUp)},t}(Fe);Ir.prototype.options_={children:["seekBar"]},Fe.registerComponent("ProgressControl",Ir);var Rr=function(e){function i(t,i){var r;return(r=e.call(this,t,i)||this).on(t,["enterpictureinpicture","leavepictureinpicture"],r.handlePictureInPictureChange),r.on(t,["disablepictureinpicturechanged","loadedmetadata"],r.handlePictureInPictureEnabledChange),r.disable(),r}qe(i,e);var r=i.prototype;return r.buildCSSClass=function(){return"vjs-picture-in-picture-control "+e.prototype.buildCSSClass.call(this)},r.handlePictureInPictureEnabledChange=function(){t.pictureInPictureEnabled&&!1===this.player_.disablePictureInPicture()?this.enable():this.disable()},r.handlePictureInPictureChange=function(e){this.player_.isInPictureInPicture()?this.controlText("Exit Picture-in-Picture"):this.controlText("Picture-in-Picture"),this.handlePictureInPictureEnabledChange()},r.handleClick=function(e){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()},i}(or);Rr.prototype.controlText_="Picture-in-Picture",Fe.registerComponent("PictureInPictureToggle",Rr);var Dr=function(e){function i(i,r){var n;return(n=e.call(this,i,r)||this).on(i,"fullscreenchange",n.handleFullscreenChange),!1===t[i.fsApi_.fullscreenEnabled]&&n.disable(),n}qe(i,e);var r=i.prototype;return r.buildCSSClass=function(){return"vjs-fullscreen-control "+e.prototype.buildCSSClass.call(this)},r.handleFullscreenChange=function(e){this.player_.isFullscreen()?this.controlText("Non-Fullscreen"):this.controlText("Fullscreen")},r.handleClick=function(e){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()},i}(or);Dr.prototype.controlText_="Fullscreen",Fe.registerComponent("FullscreenToggle",Dr);var Or=function(e){function t(){return e.apply(this,arguments)||this}return qe(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'})},t}(Fe);Fe.registerComponent("VolumeLevel",Or);var xr=function(e){function t(t,i){var r;return(r=e.call(this,t,i)||this).on("slideractive",r.updateLastVolume_),r.on(t,"volumechange",r.updateARIAAttributes),t.ready((function(){return r.updateARIAAttributes()})),r}qe(t,e);var i=t.prototype;return i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})},i.handleMouseDown=function(t){q(t)&&e.prototype.handleMouseDown.call(this,t)},i.handleMouseMove=function(e){q(e)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(e)))},i.checkMuted=function(){this.player_.muted()&&this.player_.muted(!1)},i.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},i.stepForward=function(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)},i.stepBack=function(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)},i.updateARIAAttributes=function(e){var t=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",t),this.el_.setAttribute("aria-valuetext",t+"%")},i.volumeAsPercentage_=function(){return Math.round(100*this.player_.volume())},i.updateLastVolume_=function(){var e=this,t=this.player_.volume();this.one("sliderinactive",(function(){0===e.player_.volume()&&e.player_.lastVolume_(t)}))},t}(Sr);xr.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},xr.prototype.playerEvent="volumechange",Fe.registerComponent("VolumeBar",xr);var Pr=function(e){function t(t,i){var r;return void 0===i&&(i={}),i.vertical=i.vertical||!1,void 0!==i.volumeBar&&!p(i.volumeBar)||(i.volumeBar=i.volumeBar||{},i.volumeBar.vertical=i.vertical),r=e.call(this,t,i)||this,function(e,t){t.tech_&&!t.tech_.featuresVolumeControl&&e.addClass("vjs-hidden"),e.on(t,"loadstart",(function(){t.tech_.featuresVolumeControl?e.removeClass("vjs-hidden"):e.addClass("vjs-hidden")}))}(Be(r),t),r.throttledHandleMouseMove=me(ge(Be(r),r.handleMouseMove),30),r.on("mousedown",r.handleMouseDown),r.on("touchstart",r.handleMouseDown),r.on(r.volumeBar,["focus","slideractive"],(function(){r.volumeBar.addClass("vjs-slider-active"),r.addClass("vjs-slider-active"),r.trigger("slideractive")})),r.on(r.volumeBar,["blur","sliderinactive"],(function(){r.volumeBar.removeClass("vjs-slider-active"),r.removeClass("vjs-slider-active"),r.trigger("sliderinactive")})),r}qe(t,e);var i=t.prototype;return i.createEl=function(){var t="vjs-volume-horizontal";return this.options_.vertical&&(t="vjs-volume-vertical"),e.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+t})},i.handleMouseDown=function(e){var t=this.el_.ownerDocument;this.on(t,"mousemove",this.throttledHandleMouseMove),this.on(t,"touchmove",this.throttledHandleMouseMove),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchend",this.handleMouseUp)},i.handleMouseUp=function(e){var t=this.el_.ownerDocument;this.off(t,"mousemove",this.throttledHandleMouseMove),this.off(t,"touchmove",this.throttledHandleMouseMove),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchend",this.handleMouseUp)},i.handleMouseMove=function(e){this.volumeBar.handleMouseMove(e)},t}(Fe);Pr.prototype.options_={children:["volumeBar"]},Fe.registerComponent("VolumeControl",Pr);var Mr=function(e){function t(t,i){var r;return r=e.call(this,t,i)||this,function(e,t){t.tech_&&!t.tech_.featuresMuteControl&&e.addClass("vjs-hidden"),e.on(t,"loadstart",(function(){t.tech_.featuresMuteControl?e.removeClass("vjs-hidden"):e.addClass("vjs-hidden")}))}(Be(r),t),r.on(t,["loadstart","volumechange"],r.update),r}qe(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-mute-control "+e.prototype.buildCSSClass.call(this)},i.handleClick=function(e){var t=this.player_.volume(),i=this.player_.lastVolume_();0===t?(this.player_.volume(i<.1?.1:i),this.player_.muted(!1)):this.player_.muted(!this.player_.muted())},i.update=function(e){this.updateIcon_(),this.updateControlText_()},i.updateIcon_=function(){var e=this.player_.volume(),t=3;lt&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),0===e||this.player_.muted()?t=0:e<.33?t=1:e<.67&&(t=2);for(var i=0;i<4;i++)A(this.el_,"vjs-vol-"+i);C(this.el_,"vjs-vol-"+t)},i.updateControlText_=function(){var e=this.player_.muted()||0===this.player_.volume()?"Unmute":"Mute";this.controlText()!==e&&this.controlText(e)},t}(or);Mr.prototype.controlText_="Mute",Fe.registerComponent("MuteToggle",Mr);var Nr=function(e){function i(t,i){var r;return void 0===i&&(i={}),i.inline=void 0===i.inline||i.inline,void 0!==i.volumeControl&&!p(i.volumeControl)||(i.volumeControl=i.volumeControl||{},i.volumeControl.vertical=!i.inline),(r=e.call(this,t,i)||this).on(t,["loadstart"],r.volumePanelState_),r.on(r.muteToggle,"keyup",r.handleKeyPress),r.on(r.volumeControl,"keyup",r.handleVolumeControlKeyUp),r.on("keydown",r.handleKeyPress),r.on("mouseover",r.handleMouseOver),r.on("mouseout",r.handleMouseOut),r.on(r.volumeControl,["slideractive"],r.sliderActive_),r.on(r.volumeControl,["sliderinactive"],r.sliderInactive_),r}qe(i,e);var r=i.prototype;return r.sliderActive_=function(){this.addClass("vjs-slider-active")},r.sliderInactive_=function(){this.removeClass("vjs-slider-active")},r.volumePanelState_=function(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")},r.createEl=function(){var t="vjs-volume-panel-horizontal";return this.options_.inline||(t="vjs-volume-panel-vertical"),e.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+t})},r.dispose=function(){this.handleMouseOut(),e.prototype.dispose.call(this)},r.handleVolumeControlKeyUp=function(e){At.isEventKey(e,"Esc")&&this.muteToggle.focus()},r.handleMouseOver=function(e){this.addClass("vjs-hover"),ce(t,"keyup",ge(this,this.handleKeyPress))},r.handleMouseOut=function(e){this.removeClass("vjs-hover"),de(t,"keyup",ge(this,this.handleKeyPress))},r.handleKeyPress=function(e){At.isEventKey(e,"Esc")&&this.handleMouseOut()},i}(Fe);Nr.prototype.options_={children:["muteToggle","volumeControl"]},Fe.registerComponent("VolumePanel",Nr);var Ur=function(e){function i(t,i){var r;return r=e.call(this,t,i)||this,i&&(r.menuButton_=i.menuButton),r.focusedChild_=-1,r.on("keydown",r.handleKeyDown),r.boundHandleBlur_=ge(Be(r),r.handleBlur),r.boundHandleTapClick_=ge(Be(r),r.handleTapClick),r}qe(i,e);var r=i.prototype;return r.addEventListenerForItem=function(e){e instanceof Fe&&(this.on(e,"blur",this.boundHandleBlur_),this.on(e,["tap","click"],this.boundHandleTapClick_))},r.removeEventListenerForItem=function(e){e instanceof Fe&&(this.off(e,"blur",this.boundHandleBlur_),this.off(e,["tap","click"],this.boundHandleTapClick_))},r.removeChild=function(t){"string"==typeof t&&(t=this.getChild(t)),this.removeEventListenerForItem(t),e.prototype.removeChild.call(this,t)},r.addItem=function(e){var t=this.addChild(e);t&&this.addEventListenerForItem(t)},r.createEl=function(){this.contentEl_=S(this.options_.contentElType||"ul",{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");var t=e.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return t.appendChild(this.contentEl_),ce(t,"click",(function(e){e.preventDefault(),e.stopImmediatePropagation()})),t},r.dispose=function(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,e.prototype.dispose.call(this)},r.handleBlur=function(e){var i=e.relatedTarget||t.activeElement;if(!this.children().some((function(e){return e.el()===i}))){var r=this.menuButton_;r&&r.buttonPressed_&&i!==r.el().firstChild&&r.unpressButton()}},r.handleTapClick=function(e){if(this.menuButton_){this.menuButton_.unpressButton();var t=this.children();if(!Array.isArray(t))return;var i=t.filter((function(t){return t.el()===e.target}))[0];if(!i)return;"CaptionSettingsMenuItem"!==i.name()&&this.menuButton_.focus()}},r.handleKeyDown=function(e){At.isEventKey(e,"Left")||At.isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):(At.isEventKey(e,"Right")||At.isEventKey(e,"Up"))&&(e.preventDefault(),e.stopPropagation(),this.stepBack())},r.stepForward=function(){var e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_+1),this.focus(e)},r.stepBack=function(){var e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_-1),this.focus(e)},r.focus=function(e){void 0===e&&(e=0);var t=this.children().slice();t.length&&t[0].className&&/vjs-menu-title/.test(t[0].className)&&t.shift(),0<t.length&&(e<0?e=0:e>=t.length&&(e=t.length-1),t[this.focusedChild_=e].el_.focus())},i}(Fe);Fe.registerComponent("Menu",Ur);var Fr=function(e){function i(i,r){var n;void 0===r&&(r={}),(n=e.call(this,i,r)||this).menuButton_=new or(i,r),n.menuButton_.controlText(n.controlText_),n.menuButton_.el_.setAttribute("aria-haspopup","true");var a=or.prototype.buildCSSClass();return n.menuButton_.el_.className=n.buildCSSClass()+" "+a,n.menuButton_.removeClass("vjs-control"),n.addChild(n.menuButton_),n.update(),n.enabled_=!0,n.on(n.menuButton_,"tap",n.handleClick),n.on(n.menuButton_,"click",n.handleClick),n.on(n.menuButton_,"keydown",n.handleKeyDown),n.on(n.menuButton_,"mouseenter",(function(){n.addClass("vjs-hover"),n.menu.show(),ce(t,"keyup",ge(Be(n),n.handleMenuKeyUp))})),n.on("mouseleave",n.handleMouseLeave),n.on("keydown",n.handleSubmenuKeyDown),n}qe(i,e);var r=i.prototype;return r.update=function(){var e=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=e,this.addChild(e),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?this.hide():this.show()},r.createMenu=function(){var e=new Ur(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){var t=S("li",{className:"vjs-menu-title",innerHTML:Oe(this.options_.title),tabIndex:-1});this.hideThreshold_+=1;var i=new Fe(this.player_,{el:t});e.addItem(i)}if(this.items=this.createItems(),this.items)for(var r=0;r<this.items.length;r++)e.addItem(this.items[r]);return e},r.createItems=function(){},r.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})},r.buildWrapperCSSClass=function(){var t="vjs-menu-button";return"vjs-menu-button "+(t+=!0===this.options_.inline?"-inline":"-popup")+" "+or.prototype.buildCSSClass()+" "+e.prototype.buildCSSClass.call(this)},r.buildCSSClass=function(){var t="vjs-menu-button";return"vjs-menu-button "+(t+=!0===this.options_.inline?"-inline":"-popup")+" "+e.prototype.buildCSSClass.call(this)},r.controlText=function(e,t){return void 0===t&&(t=this.menuButton_.el()),this.menuButton_.controlText(e,t)},r.dispose=function(){this.handleMouseLeave(),e.prototype.dispose.call(this)},r.handleClick=function(e){this.buttonPressed_?this.unpressButton():this.pressButton()},r.handleMouseLeave=function(e){this.removeClass("vjs-hover"),de(t,"keyup",ge(this,this.handleMenuKeyUp))},r.focus=function(){this.menuButton_.focus()},r.blur=function(){this.menuButton_.blur()},r.handleKeyDown=function(e){At.isEventKey(e,"Esc")||At.isEventKey(e,"Tab")?(this.buttonPressed_&&this.unpressButton(),At.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus())):(At.isEventKey(e,"Up")||At.isEventKey(e,"Down"))&&(this.buttonPressed_||(e.preventDefault(),this.pressButton()))},r.handleMenuKeyUp=function(e){(At.isEventKey(e,"Esc")||At.isEventKey(e,"Tab"))&&this.removeClass("vjs-hover")},r.handleSubmenuKeyPress=function(e){this.handleSubmenuKeyDown(e)},r.handleSubmenuKeyDown=function(e){(At.isEventKey(e,"Esc")||At.isEventKey(e,"Tab"))&&(this.buttonPressed_&&this.unpressButton(),At.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus()))},r.pressButton=function(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),lt&&b())return;this.menu.focus()}},r.unpressButton=function(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))},r.disable=function(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()},r.enable=function(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()},i}(Fe);Fe.registerComponent("MenuButton",Fr);var Br=function(e){function t(t,i){var r,n=i.tracks;if((r=e.call(this,t,i)||this).items.length<=1&&r.hide(),!n)return Be(r);var a=ge(Be(r),r.update);return n.addEventListener("removetrack",a),n.addEventListener("addtrack",a),r.player_.on("ready",a),r.player_.on("dispose",(function(){n.removeEventListener("removetrack",a),n.removeEventListener("addtrack",a)})),r}return qe(t,e),t}(Fr);Fe.registerComponent("TrackButton",Br);var jr=["Tab","Esc","Up","Down","Right","Left"],Vr=function(e){function t(t,i){var r;return(r=e.call(this,t,i)||this).selectable=i.selectable,r.isSelected_=i.selected||!1,r.multiSelectable=i.multiSelectable,r.selected(r.isSelected_),r.el_.setAttribute("role",r.selectable?r.multiSelectable?"menuitemcheckbox":"menuitemradio":"menuitem"),r}qe(t,e);var i=t.prototype;return i.createEl=function(t,i,r){return this.nonIconControl=!0,e.prototype.createEl.call(this,"li",h({className:"vjs-menu-item",innerHTML:'<span class="vjs-menu-item-text">'+this.localize(this.options_.label)+"</span>",tabIndex:-1},i),r)},i.handleKeyDown=function(t){jr.some((function(e){return At.isEventKey(t,e)}))||e.prototype.handleKeyDown.call(this,t)},i.handleClick=function(e){this.selected(!0)},i.selected=function(e){this.selectable&&(e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))},t}(Zi);Fe.registerComponent("MenuItem",Vr);var Hr=function(i){function r(r,n){var a,s,o=n.track,u=r.textTracks();function l(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];a.handleTracksChange.apply(Be(a),t)}function c(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];a.handleSelectedLanguageChange.apply(Be(a),t)}return n.label=o.label||o.language||"Unknown",n.selected="showing"===o.mode,(a=i.call(this,r,n)||this).track=o,a.kinds=(n.kinds||[n.kind||a.track.kind]).filter(Boolean),r.on(["loadstart","texttrackchange"],l),u.addEventListener("change",l),u.addEventListener("selectedlanguagechange",c),a.on("dispose",(function(){r.off(["loadstart","texttrackchange"],l),u.removeEventListener("change",l),u.removeEventListener("selectedlanguagechange",c)})),void 0===u.onchange&&a.on(["tap","click"],(function(){if("object"!=typeof e.Event)try{s=new e.Event("change")}catch(r){}s||(s=t.createEvent("Event")).initEvent("change",!0,!0),u.dispatchEvent(s)})),a.handleTracksChange(),a}qe(r,i);var n=r.prototype;return n.handleClick=function(e){var t=this.track,r=this.player_.textTracks();if(i.prototype.handleClick.call(this,e),r)for(var n=0;n<r.length;n++){var a=r[n];-1!==this.kinds.indexOf(a.kind)&&(a===t?"showing"!==a.mode&&(a.mode="showing"):"disabled"!==a.mode&&(a.mode="disabled"))}},n.handleTracksChange=function(e){var t="showing"===this.track.mode;t!==this.isSelected_&&this.selected(t)},n.handleSelectedLanguageChange=function(e){if("showing"===this.track.mode){var t=this.player_.cache_.selectedLanguage;if(t&&t.enabled&&t.language===this.track.language&&t.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}},n.dispose=function(){this.track=null,i.prototype.dispose.call(this)},r}(Vr);Fe.registerComponent("TextTrackMenuItem",Hr);var Gr=function(e){function t(t,i){return i.track={player:t,kind:i.kind,kinds:i.kinds,default:!1,mode:"disabled"},i.kinds||(i.kinds=[i.kind]),i.track.label=i.label?i.label:i.kinds.join(" and ")+" off",i.selectable=!0,i.multiSelectable=!1,e.call(this,t,i)||this}qe(t,e);var i=t.prototype;return i.handleTracksChange=function(e){for(var t=this.player().textTracks(),i=!0,r=0,n=t.length;r<n;r++){var a=t[r];if(-1<this.options_.kinds.indexOf(a.kind)&&"showing"===a.mode){i=!1;break}}i!==this.isSelected_&&this.selected(i)},i.handleSelectedLanguageChange=function(e){for(var t=this.player().textTracks(),i=!0,r=0,n=t.length;r<n;r++){var a=t[r];if(-1<["captions","descriptions","subtitles"].indexOf(a.kind)&&"showing"===a.mode){i=!1;break}}i&&(this.player_.cache_.selectedLanguage={enabled:!1})},t}(Hr);Fe.registerComponent("OffTextTrackMenuItem",Gr);var qr=function(e){function t(t,i){return void 0===i&&(i={}),i.tracks=t.textTracks(),e.call(this,t,i)||this}return qe(t,e),t.prototype.createItems=function(e,t){var i;void 0===e&&(e=[]),void 0===t&&(t=Hr),this.label_&&(i=this.label_+" off"),e.push(new Gr(this.player_,{kinds:this.kinds_,kind:this.kind_,label:i})),this.hideThreshold_+=1;var r=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(var n=0;n<r.length;n++){var a=r[n];if(-1<this.kinds_.indexOf(a.kind)){var s=new t(this.player_,{track:a,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});s.addClass("vjs-"+a.kind+"-menu-item"),e.push(s)}}return e},t}(Br);Fe.registerComponent("TextTrackButton",qr);var Kr=function(e){function t(t,i){var r,n=i.track,a=i.cue,s=t.currentTime();return i.selectable=!0,i.multiSelectable=!1,i.label=a.text,i.selected=a.startTime<=s&&s<a.endTime,(r=e.call(this,t,i)||this).track=n,r.cue=a,n.addEventListener("cuechange",ge(Be(r),r.update)),r}qe(t,e);var i=t.prototype;return i.handleClick=function(t){e.prototype.handleClick.call(this),this.player_.currentTime(this.cue.startTime),this.update(this.cue.startTime)},i.update=function(e){var t=this.cue,i=this.player_.currentTime();this.selected(t.startTime<=i&&i<t.endTime)},t}(Vr);Fe.registerComponent("ChaptersTrackMenuItem",Kr);var Wr=function(e){function t(t,i,r){return e.call(this,t,i,r)||this}qe(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-chapters-button "+e.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-chapters-button "+e.prototype.buildWrapperCSSClass.call(this)},i.update=function(t){this.track_&&(!t||"addtrack"!==t.type&&"removetrack"!==t.type)||this.setTrack(this.findChaptersTrack()),e.prototype.update.call(this)},i.setTrack=function(e){if(this.track_!==e){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){var t=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);t&&t.removeEventListener("load",this.updateHandler_),this.track_=null}if(this.track_=e,this.track_){this.track_.mode="hidden";var i=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);i&&i.addEventListener("load",this.updateHandler_)}}},i.findChaptersTrack=function(){for(var e=this.player_.textTracks()||[],t=e.length-1;0<=t;t--){var i=e[t];if(i.kind===this.kind_)return i}},i.getMenuCaption=function(){return this.track_&&this.track_.label?this.track_.label:this.localize(Oe(this.kind_))},i.createMenu=function(){return this.options_.title=this.getMenuCaption(),e.prototype.createMenu.call(this)},i.createItems=function(){var e=[];if(!this.track_)return e;var t=this.track_.cues;if(!t)return e;for(var i=0,r=t.length;i<r;i++){var n=new Kr(this.player_,{track:this.track_,cue:t[i]});e.push(n)}return e},t}(qr);Wr.prototype.kind_="chapters",Wr.prototype.controlText_="Chapters",Fe.registerComponent("ChaptersButton",Wr);var zr=function(e){function t(t,i,r){var n;n=e.call(this,t,i,r)||this;var a=t.textTracks(),s=ge(Be(n),n.handleTracksChange);return a.addEventListener("change",s),n.on("dispose",(function(){a.removeEventListener("change",s)})),n}qe(t,e);var i=t.prototype;return i.handleTracksChange=function(e){for(var t=this.player().textTracks(),i=!1,r=0,n=t.length;r<n;r++){var a=t[r];if(a.kind!==this.kind_&&"showing"===a.mode){i=!0;break}}i?this.disable():this.enable()},i.buildCSSClass=function(){return"vjs-descriptions-button "+e.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-descriptions-button "+e.prototype.buildWrapperCSSClass.call(this)},t}(qr);zr.prototype.kind_="descriptions",zr.prototype.controlText_="Descriptions",Fe.registerComponent("DescriptionsButton",zr);var Yr=function(e){function t(t,i,r){return e.call(this,t,i,r)||this}qe(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-subtitles-button "+e.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-subtitles-button "+e.prototype.buildWrapperCSSClass.call(this)},t}(qr);Yr.prototype.kind_="subtitles",Yr.prototype.controlText_="Subtitles",Fe.registerComponent("SubtitlesButton",Yr);var Xr=function(e){function t(t,i){var r;return i.track={player:t,kind:i.kind,label:i.kind+" settings",selectable:!1,default:!1,mode:"disabled"},i.selectable=!1,i.name="CaptionSettingsMenuItem",(r=e.call(this,t,i)||this).addClass("vjs-texttrack-settings"),r.controlText(", opens "+i.kind+" settings dialog"),r}return qe(t,e),t.prototype.handleClick=function(e){this.player().getChild("textTrackSettings").open()},t}(Hr);Fe.registerComponent("CaptionSettingsMenuItem",Xr);var Qr=function(e){function t(t,i,r){return e.call(this,t,i,r)||this}qe(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-captions-button "+e.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-captions-button "+e.prototype.buildWrapperCSSClass.call(this)},i.createItems=function(){var t=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(t.push(new Xr(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),e.prototype.createItems.call(this,t)},t}(qr);Qr.prototype.kind_="captions",Qr.prototype.controlText_="Captions",Fe.registerComponent("CaptionsButton",Qr);var $r=function(e){function t(){return e.apply(this,arguments)||this}return qe(t,e),t.prototype.createEl=function(t,i,r){var n='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return"captions"===this.options_.track.kind&&(n+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Captions")+"</span>\n      "),e.prototype.createEl.call(this,t,h({innerHTML:n+="</span>"},i),r)},t}(Hr);Fe.registerComponent("SubsCapsMenuItem",$r);var Jr=function(e){function t(t,i){var r;return void 0===i&&(i={}),(r=e.call(this,t,i)||this).label_="subtitles",-1<["en","en-us","en-ca","fr-ca"].indexOf(r.player_.language_)&&(r.label_="captions"),r.menuButton_.controlText(Oe(r.label_)),r}qe(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-subs-caps-button "+e.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-subs-caps-button "+e.prototype.buildWrapperCSSClass.call(this)},i.createItems=function(){var t=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(t.push(new Xr(this.player_,{kind:this.label_})),this.hideThreshold_+=1),e.prototype.createItems.call(this,t,$r)},t}(qr);Jr.prototype.kinds_=["captions","subtitles"],Jr.prototype.controlText_="Subtitles",Fe.registerComponent("SubsCapsButton",Jr);var Zr=function(e){function t(t,i){var r,n=i.track,a=t.audioTracks();function s(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];r.handleTracksChange.apply(Be(r),t)}return i.label=n.label||n.language||"Unknown",i.selected=n.enabled,(r=e.call(this,t,i)||this).track=n,r.addClass("vjs-"+n.kind+"-menu-item"),a.addEventListener("change",s),r.on("dispose",(function(){a.removeEventListener("change",s)})),r}qe(t,e);var i=t.prototype;return i.createEl=function(t,i,r){var n='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return"main-desc"===this.options_.track.kind&&(n+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Descriptions")+"</span>\n      "),e.prototype.createEl.call(this,t,h({innerHTML:n+="</span>"},i),r)},i.handleClick=function(t){var i=this.player_.audioTracks();e.prototype.handleClick.call(this,t);for(var r=0;r<i.length;r++){var n=i[r];n.enabled=n===this.track}},i.handleTracksChange=function(e){this.selected(this.track.enabled)},t}(Vr);Fe.registerComponent("AudioTrackMenuItem",Zr);var en=function(e){function t(t,i){return void 0===i&&(i={}),i.tracks=t.audioTracks(),e.call(this,t,i)||this}qe(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-audio-button "+e.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-audio-button "+e.prototype.buildWrapperCSSClass.call(this)},i.createItems=function(e){void 0===e&&(e=[]),this.hideThreshold_=1;for(var t=this.player_.audioTracks(),i=0;i<t.length;i++)e.push(new Zr(this.player_,{track:t[i],selectable:!0,multiSelectable:!1}));return e},t}(Br);en.prototype.controlText_="Audio Track",Fe.registerComponent("AudioTrackButton",en);var tn=function(e){function t(t,i){var r,n=i.rate,a=parseFloat(n,10);return i.label=n,i.selected=1===a,i.selectable=!0,i.multiSelectable=!1,(r=e.call(this,t,i)||this).label=n,r.rate=a,r.on(t,"ratechange",r.update),r}qe(t,e);var i=t.prototype;return i.handleClick=function(t){e.prototype.handleClick.call(this),this.player().playbackRate(this.rate)},i.update=function(e){this.selected(this.player().playbackRate()===this.rate)},t}(Vr);tn.prototype.contentElType="button",Fe.registerComponent("PlaybackRateMenuItem",tn);var rn=function(e){function t(t,i){var r;return(r=e.call(this,t,i)||this).updateVisibility(),r.updateLabel(),r.on(t,"loadstart",r.updateVisibility),r.on(t,"ratechange",r.updateLabel),r}qe(t,e);var i=t.prototype;return i.createEl=function(){var t=e.prototype.createEl.call(this);return this.labelEl_=S("div",{className:"vjs-playback-rate-value",innerHTML:"1x"}),t.appendChild(this.labelEl_),t},i.dispose=function(){this.labelEl_=null,e.prototype.dispose.call(this)},i.buildCSSClass=function(){return"vjs-playback-rate "+e.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-playback-rate "+e.prototype.buildWrapperCSSClass.call(this)},i.createMenu=function(){var e=new Ur(this.player()),t=this.playbackRates();if(t)for(var i=t.length-1;0<=i;i--)e.addChild(new tn(this.player(),{rate:t[i]+"x"}));return e},i.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},i.handleClick=function(e){for(var t=this.player().playbackRate(),i=this.playbackRates(),r=i[0],n=0;n<i.length;n++)if(i[n]>t){r=i[n];break}this.player().playbackRate(r)},i.playbackRates=function(){return this.options_.playbackRates||this.options_.playerOptions&&this.options_.playerOptions.playbackRates},i.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&0<this.playbackRates().length},i.updateVisibility=function(e){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},i.updateLabel=function(e){this.playbackRateSupported()&&(this.labelEl_.innerHTML=this.player().playbackRate()+"x")},t}(Fr);rn.prototype.controlText_="Playback Rate",Fe.registerComponent("PlaybackRateMenuButton",rn);var nn=function(e){function t(){return e.apply(this,arguments)||this}qe(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-spacer "+e.prototype.buildCSSClass.call(this)},i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})},t}(Fe);Fe.registerComponent("Spacer",nn);var an=function(e){function t(){return e.apply(this,arguments)||this}qe(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-custom-control-spacer "+e.prototype.buildCSSClass.call(this)},i.createEl=function(){var t=e.prototype.createEl.call(this,{className:this.buildCSSClass()});return t.innerHTML="",t},t}(nn);Fe.registerComponent("CustomControlSpacer",an);var sn=function(e){function t(){return e.apply(this,arguments)||this}return qe(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"})},t}(Fe);sn.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]},"exitPictureInPicture"in t&&sn.prototype.options_.children.splice(sn.prototype.options_.children.length-1,0,"pictureInPictureToggle"),Fe.registerComponent("ControlBar",sn);var on=function(e){function t(t,i){var r;return(r=e.call(this,t,i)||this).on(t,"error",r.open),r}qe(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-error-display "+e.prototype.buildCSSClass.call(this)},i.content=function(){var e=this.player().error();return e?this.localize(e.message):""},t}(It);on.prototype.options_=u({},It.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),Fe.registerComponent("ErrorDisplay",on);var un="vjs-text-track-settings",ln=["#000","Black"],cn=["#00F","Blue"],dn=["#0FF","Cyan"],hn=["#0F0","Green"],fn=["#F0F","Magenta"],pn=["#F00","Red"],gn=["#FFF","White"],mn=["#FF0","Yellow"],vn=["1","Opaque"],yn=["0.5","Semi-Transparent"],_n=["0","Transparent"],bn={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[ln,gn,pn,hn,cn,mn,fn,dn]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[vn,yn,_n]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[gn,ln,pn,hn,cn,mn,fn,dn]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function(e){return"1.00"===e?null:Number(e)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[vn,yn]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[_n,yn,vn]}};function Tn(e,t){if(t&&(e=t(e)),e&&"none"!==e)return e}bn.windowColor.options=bn.backgroundColor.options;var Sn=function(t){function i(e,i){var r;return i.temporary=!1,(r=t.call(this,e,i)||this).updateDisplay=ge(Be(r),r.updateDisplay),r.fill(),r.hasBeenOpened_=r.hasBeenFilled_=!0,r.endDialog=S("p",{className:"vjs-control-text",textContent:r.localize("End of dialog window.")}),r.el().appendChild(r.endDialog),r.setDefaults(),void 0===i.persistTextTrackSettings&&(r.options_.persistTextTrackSettings=r.options_.playerOptions.persistTextTrackSettings),r.on(r.$(".vjs-done-button"),"click",(function(){r.saveSettings(),r.close()})),r.on(r.$(".vjs-default-button"),"click",(function(){r.setDefaults(),r.updateDisplay()})),d(bn,(function(e){r.on(r.$(e.selector),"change",r.updateDisplay)})),r.options_.persistTextTrackSettings&&r.restoreSettings(),r}qe(i,t);var r=i.prototype;return r.dispose=function(){this.endDialog=null,t.prototype.dispose.call(this)},r.createElSelect_=function(e,t,i){var r=this;void 0===t&&(t=""),void 0===i&&(i="label");var n=bn[e],a=n.id.replace("%s",this.id_),s=[t,a].join(" ").trim();return["<"+i+' id="'+a+'" class="'+("label"===i?"vjs-label":"")+'">',this.localize(n.label),"</"+i+">",'<select aria-labelledby="'+s+'">'].concat(n.options.map((function(e){var t=a+"-"+e[1].replace(/\W+/g,"");return['<option id="'+t+'" value="'+e[0]+'" ','aria-labelledby="'+s+" "+t+'">',r.localize(e[1]),"</option>"].join("")}))).concat("</select>").join("")},r.createElFgColor_=function(){var e="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",e),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",e),"</span>","</fieldset>"].join("")},r.createElBgColor_=function(){var e="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",e),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",e),"</span>","</fieldset>"].join("")},r.createElWinColor_=function(){var e="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",e),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",e),"</span>","</fieldset>"].join("")},r.createElColors_=function(){return S("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},r.createElFont_=function(){return S("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})},r.createElControls_=function(){var e=this.localize("restore all settings to the default values");return S("div",{className:"vjs-track-settings-controls",innerHTML:['<button type="button" class="vjs-default-button" title="'+e+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+e+"</span>","</button>",'<button type="button" class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})},r.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},r.label=function(){return this.localize("Caption Settings Dialog")},r.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},r.buildCSSClass=function(){return t.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},r.getValues=function(){var e=this;return function(t,i,r){return void 0===r&&(r=0),c(t).reduce((function(i,r){return function(t,i,r){var n=function(e,t){return Tn(e.options[e.options.selectedIndex].value,t)}(e.$(i.selector),i.parser);return void 0!==n&&(t[r]=n),t}(i,t[r],r)}),r)}(bn,0,{})},r.setValues=function(e){var t=this;d(bn,(function(i,r){!function(e,t,i){if(t)for(var r=0;r<e.options.length;r++)if(Tn(e.options[r].value,i)===t){e.selectedIndex=r;break}}(t.$(i.selector),e[r],i.parser)}))},r.setDefaults=function(){var e=this;d(bn,(function(t){var i=t.hasOwnProperty("default")?t.default:0;e.$(t.selector).selectedIndex=i}))},r.restoreSettings=function(){var t;try{t=JSON.parse(e.localStorage.getItem(un))}catch(t){n.warn(t)}t&&this.setValues(t)},r.saveSettings=function(){if(this.options_.persistTextTrackSettings){var t=this.getValues();try{Object.keys(t).length?e.localStorage.setItem(un,JSON.stringify(t)):e.localStorage.removeItem(un)}catch(t){n.warn(t)}}},r.updateDisplay=function(){var e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()},r.conditionalBlur_=function(){this.previouslyActiveEl_=null;var e=this.player_.controlBar,t=e&&e.subsCapsButton,i=e&&e.captionsButton;t?t.focus():i&&i.focus()},i}(It);Fe.registerComponent("TextTrackSettings",Sn);var En=function(t){function i(i,r){var n,a=r.ResizeObserver||e.ResizeObserver;null===r.ResizeObserver&&(a=!1);var s=xe({createEl:!a,reportTouchActivity:!1},r);return(n=t.call(this,i,s)||this).ResizeObserver=r.ResizeObserver||e.ResizeObserver,n.loadListener_=null,n.resizeObserver_=null,n.debouncedHandler_=function(t,i,r,n){var a;function s(){var e=this,i=arguments,r=function(){r=a=null,t.apply(e,i)};n.clearTimeout(a),a=n.setTimeout(r,100)}return void 0===n&&(n=e),s.cancel=function(){n.clearTimeout(a),a=null},s}((function(){n.resizeHandler()}),0,0,Be(n)),a?(n.resizeObserver_=new n.ResizeObserver(n.debouncedHandler_),n.resizeObserver_.observe(i.el())):(n.loadListener_=function(){if(n.el_&&n.el_.contentWindow){var e=n.debouncedHandler_,t=n.unloadListener_=function(){de(this,"resize",e),de(this,"unload",t),t=null};ce(n.el_.contentWindow,"unload",t),ce(n.el_.contentWindow,"resize",e)}},n.one("load",n.loadListener_)),n}qe(i,t);var r=i.prototype;return r.createEl=function(){return t.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager",tabIndex:-1},{"aria-hidden":"true"})},r.resizeHandler=function(){this.player_&&this.player_.trigger&&this.player_.trigger("playerresize")},r.dispose=function(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,t.prototype.dispose.call(this)},i}(Fe);Fe.registerComponent("ResizeManager",En);var kn={trackingThreshold:30,liveTolerance:15},wn=function(i){function r(e,r){var n,a=xe(kn,r,{createEl:!1});return(n=i.call(this,e,a)||this).reset_(),n.on(n.player_,"durationchange",n.handleDurationchange),rt&&"hidden"in t&&"visibilityState"in t&&n.on(t,"visibilitychange",n.handleVisibilityChange),n}qe(r,i);var n=r.prototype;return n.handleVisibilityChange=function(){this.player_.duration()===1/0&&(t.hidden?this.stopTracking():this.startTracking())},n.trackLive_=function(){var t=this.player_.seekable();if(t&&t.length){var i=Number(e.performance.now().toFixed(4)),r=-1===this.lastTime_?0:(i-this.lastTime_)/1e3;this.lastTime_=i,this.pastSeekEnd_=this.pastSeekEnd()+r;var n=this.liveCurrentTime(),a=this.player_.currentTime(),s=this.player_.paused()||this.seekedBehindLive_||Math.abs(n-a)>this.options_.liveTolerance;this.timeupdateSeen_&&n!==1/0||(s=!1),s!==this.behindLiveEdge_&&(this.behindLiveEdge_=s,this.trigger("liveedgechange"))}},n.handleDurationchange=function(){this.player_.duration()===1/0&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())},n.startTracking=function(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLive_,30),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLive_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked):(this.one(this.player_,"play",this.handlePlay),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate)))},n.handleFirstTimeupdate=function(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked)},n.handleSeeked=function(){var e=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=!this.skipNextSeeked_&&2<e,this.skipNextSeeked_=!1,this.trackLive_()},n.handlePlay=function(){this.one(this.player_,"timeupdate",this.seekToLiveEdge)},n.reset_=function(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.skipNextSeeked_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLive_),this.off(this.player_,"seeked",this.handleSeeked),this.off(this.player_,"play",this.handlePlay),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate),this.off(this.player_,"timeupdate",this.seekToLiveEdge)},n.stopTracking=function(){this.isTracking()&&(this.reset_(),this.trigger("liveedgechange"))},n.seekableEnd=function(){for(var e=this.player_.seekable(),t=[],i=e?e.length:0;i--;)t.push(e.end(i));return t.length?t.sort()[t.length-1]:1/0},n.seekableStart=function(){for(var e=this.player_.seekable(),t=[],i=e?e.length:0;i--;)t.push(e.start(i));return t.length?t.sort()[0]:0},n.liveWindow=function(){var e=this.liveCurrentTime();return e===1/0?1/0:e-this.seekableStart()},n.isLive=function(){return this.isTracking()},n.atLiveEdge=function(){return!this.behindLiveEdge()},n.liveCurrentTime=function(){return this.pastSeekEnd()+this.seekableEnd()},n.pastSeekEnd=function(){var e=this.seekableEnd();return-1!==this.lastSeekEnd_&&e!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=e,this.pastSeekEnd_},n.behindLiveEdge=function(){return this.behindLiveEdge_},n.isTracking=function(){return"number"==typeof this.trackingInterval_},n.seekToLiveEdge=function(){this.seekedBehindLive_=!1,this.atLiveEdge()||(this.skipNextSeeked_=!0,this.player_.currentTime(this.liveCurrentTime()))},n.dispose=function(){this.off(t,"visibilitychange",this.handleVisibilityChange),this.stopTracking(),i.prototype.dispose.call(this)},r}(Fe);function Cn(e){var t=e.el();if(t.hasAttribute("src"))return e.triggerSourceset(t.src),!0;var i=e.$$("source"),r=[],n="";if(!i.length)return!1;for(var a=0;a<i.length;a++){var s=i[a].src;s&&-1===r.indexOf(s)&&r.push(s)}return!!r.length&&(1===r.length&&(n=r[0]),e.triggerSourceset(n),!0)}function An(e,t){for(var i={},r=0;r<e.length&&!((i=Object.getOwnPropertyDescriptor(e[r],t))&&i.set&&i.get);r++);return i.enumerable=!0,i.configurable=!0,i}function Ln(t){var i=t.el();if(!i.resetSourceWatch_){var r={},n=function(t){return An([t.el(),e.HTMLMediaElement.prototype,e.Element.prototype,Dn],"innerHTML")}(t),a=function(e){return function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var s=e.apply(i,n);return Cn(t),s}};["append","appendChild","insertAdjacentHTML"].forEach((function(e){i[e]&&(r[e]=i[e],i[e]=a(r[e]))})),Object.defineProperty(i,"innerHTML",xe(n,{set:a(n.set)})),i.resetSourceWatch_=function(){i.resetSourceWatch_=null,Object.keys(r).forEach((function(e){i[e]=r[e]})),Object.defineProperty(i,"innerHTML",n)},t.one("sourceset",i.resetSourceWatch_)}}function In(e,t,i,r){function n(i){return Object.defineProperty(e,t,{value:i,enumerable:!0,writable:!0})}void 0===r&&(r=!0);var a={configurable:!0,enumerable:!0,get:function(){var e=i();return n(e),e}};return r&&(a.set=n),Object.defineProperty(e,t,a)}Fe.registerComponent("LiveTracker",wn);var Rn,Dn=Object.defineProperty({},"innerHTML",{get:function(){return this.cloneNode(!0).innerHTML},set:function(i){var r=t.createElement(this.nodeName.toLowerCase());r.innerHTML=i;for(var n=t.createDocumentFragment();r.childNodes.length;)n.appendChild(r.childNodes[0]);return this.innerText="",e.Element.prototype.appendChild.call(this,n),this.innerHTML}}),On=Object.defineProperty({},"src",{get:function(){return this.hasAttribute("src")?Mt(e.Element.prototype.getAttribute.call(this,"src")):""},set:function(t){return e.Element.prototype.setAttribute.call(this,"src",t),t}}),xn=function(i){function r(e,t){var r;r=i.call(this,e,t)||this;var a=e.source,s=!1;if(a&&(r.el_.currentSrc!==a.src||e.tag&&3===e.tag.initNetworkState_)?r.setSource(a):r.handleLateInit_(r.el_),e.enableSourceset&&r.setupSourcesetHandling_(),r.el_.hasChildNodes()){for(var o=r.el_.childNodes,u=o.length,l=[];u--;){var c=o[u];"track"===c.nodeName.toLowerCase()&&(r.featuresNativeTextTracks?(r.remoteTextTrackEls().addTrackElement_(c),r.remoteTextTracks().addTrack(c.track),r.textTracks().addTrack(c.track),s||r.el_.hasAttribute("crossorigin")||!Ut(c.src)||(s=!0)):l.push(c))}for(var d=0;d<l.length;d++)r.el_.removeChild(l[d])}return r.proxyNativeTracks_(),r.featuresNativeTextTracks&&s&&n.warn("Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\nThis may prevent text tracks from loading."),r.restoreMetadataTracksInIOSNativePlayer_(),(st||ut||Je)&&!0===e.nativeControlsForTouch&&r.setControls(!0),r.proxyWebkitFullscreen_(),r.triggerReady(),r}qe(r,i);var a=r.prototype;return a.dispose=function(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),r.disposeMediaElement(this.el_),this.options_=null,i.prototype.dispose.call(this)},a.setupSourcesetHandling_=function(){!function(t){if(t.featuresSourceset){var i=t.el();if(!i.resetSourceset_){var r=function(t){return An([t.el(),e.HTMLMediaElement.prototype,On],"src")}(t),n=i.setAttribute,a=i.load;Object.defineProperty(i,"src",xe(r,{set:function(e){var n=r.set.call(i,e);return t.triggerSourceset(i.src),n}})),i.setAttribute=function(e,r){var a=n.call(i,e,r);return/src/i.test(e)&&t.triggerSourceset(i.src),a},i.load=function(){var e=a.call(i);return Cn(t)||(t.triggerSourceset(""),Ln(t)),e},i.currentSrc?t.triggerSourceset(i.currentSrc):Cn(t)||Ln(t),i.resetSourceset_=function(){i.resetSourceset_=null,i.load=a,i.setAttribute=n,Object.defineProperty(i,"src",r),i.resetSourceWatch_&&i.resetSourceWatch_()}}}}(this)},a.restoreMetadataTracksInIOSNativePlayer_=function(){function e(){t=[];for(var e=0;e<i.length;e++){var r=i[e];"metadata"===r.kind&&t.push({track:r,storedMode:r.mode})}}var t,i=this.textTracks();function r(){for(var e=0;e<t.length;e++){var n=t[e];"disabled"===n.track.mode&&n.track.mode!==n.storedMode&&(n.track.mode=n.storedMode)}i.removeEventListener("change",r)}e(),i.addEventListener("change",e),this.on("dispose",(function(){return i.removeEventListener("change",e)})),this.on("webkitbeginfullscreen",(function(){i.removeEventListener("change",e),i.removeEventListener("change",r),i.addEventListener("change",r)})),this.on("webkitendfullscreen",(function(){i.removeEventListener("change",e),i.addEventListener("change",e),i.removeEventListener("change",r)}))},a.overrideNative_=function(e,t){var i=this;if(t===this["featuresNative"+e+"Tracks"]){var r=e.toLowerCase();this[r+"TracksListeners_"]&&Object.keys(this[r+"TracksListeners_"]).forEach((function(e){i.el()[r+"Tracks"].removeEventListener(e,i[r+"TracksListeners_"][e])})),this["featuresNative"+e+"Tracks"]=!t,this[r+"TracksListeners_"]=null,this.proxyNativeTracksForType_(r)}},a.overrideNativeAudioTracks=function(e){this.overrideNative_("Audio",e)},a.overrideNativeVideoTracks=function(e){this.overrideNative_("Video",e)},a.proxyNativeTracksForType_=function(e){var t=this,i=oi[e],r=this.el()[i.getterName],n=this[i.getterName]();if(this["featuresNative"+i.capitalName+"Tracks"]&&r&&r.addEventListener){var a={change:function(i){var r={type:"change",target:n,currentTarget:n,srcElement:n};n.trigger(r),"text"===e&&t[ui.remoteText.getterName]().trigger(r)},addtrack:function(e){n.addTrack(e.track)},removetrack:function(e){n.removeTrack(e.track)}},s=function(){for(var e=[],t=0;t<n.length;t++){for(var i=!1,a=0;a<r.length;a++)if(r[a]===n[t]){i=!0;break}i||e.push(n[t])}for(;e.length;)n.removeTrack(e.shift())};this[i.getterName+"Listeners_"]=a,Object.keys(a).forEach((function(e){var i=a[e];r.addEventListener(e,i),t.on("dispose",(function(t){return r.removeEventListener(e,i)}))})),this.on("loadstart",s),this.on("dispose",(function(e){return t.off("loadstart",s)}))}},a.proxyNativeTracks_=function(){var e=this;oi.names.forEach((function(t){e.proxyNativeTracksForType_(t)}))},a.createEl=function(){var e=this.options_.tag;if(!e||!this.options_.playerElIngest&&!this.movingMediaElementInDOM){if(e){var i=e.cloneNode(!0);e.parentNode&&e.parentNode.insertBefore(i,e),r.disposeMediaElement(e),e=i}else{e=t.createElement("video");var n=xe({},this.options_.tag&&R(this.options_.tag));st&&!0===this.options_.nativeControlsForTouch||delete n.controls,I(e,h(n,{id:this.options_.techId,class:"vjs-tech"}))}e.playerId=this.options_.playerId}void 0!==this.options_.preload&&O(e,"preload",this.options_.preload),void 0!==this.options_.disablePictureInPicture&&(e.disablePictureInPicture=this.options_.disablePictureInPicture);for(var a=["loop","muted","playsinline","autoplay"],s=0;s<a.length;s++){var o=a[s],u=this.options_[o];void 0!==u&&(u?O(e,o,o):x(e,o),e[o]=u)}return e},a.handleLateInit_=function(e){if(0!==e.networkState&&3!==e.networkState){if(0===e.readyState){var t=!1,i=function(){t=!0};this.on("loadstart",i);var r=function(){t||this.trigger("loadstart")};return this.on("loadedmetadata",r),void this.ready((function(){this.off("loadstart",i),this.off("loadedmetadata",r),t||this.trigger("loadstart")}))}var n=["loadstart"];n.push("loadedmetadata"),2<=e.readyState&&n.push("loadeddata"),3<=e.readyState&&n.push("canplay"),4<=e.readyState&&n.push("canplaythrough"),this.ready((function(){n.forEach((function(e){this.trigger(e)}),this)}))}},a.setScrubbing=function(e){this.isScrubbing_=e},a.setCurrentTime=function(e){try{this.isScrubbing_&&this.el_.fastSeek&&ct?this.el_.fastSeek(e):this.el_.currentTime=e}catch(e){n(e,"Video is not ready. (Video.js)")}},a.duration=function(){var e=this;return this.el_.duration===1/0&&Qe&&tt&&0===this.el_.currentTime?(this.on("timeupdate",(function t(){0<e.el_.currentTime&&(e.el_.duration===1/0&&e.trigger("durationchange"),e.off("timeupdate",t))})),NaN):this.el_.duration||NaN},a.width=function(){return this.el_.offsetWidth},a.height=function(){return this.el_.offsetHeight},a.proxyWebkitFullscreen_=function(){var e=this;if("webkitDisplayingFullscreen"in this.el_){var t=function(){this.trigger("fullscreenchange",{isFullscreen:!1})},i=function(){"webkitPresentationMode"in this.el_&&"picture-in-picture"!==this.el_.webkitPresentationMode&&(this.one("webkitendfullscreen",t),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",i),this.on("dispose",(function(){e.off("webkitbeginfullscreen",i),e.off("webkitendfullscreen",t)}))}},a.supportsFullScreen=function(){if("function"==typeof this.el_.webkitEnterFullScreen){var t=e.navigator&&e.navigator.userAgent||"";if(/Android/.test(t)||!/Chrome|Mac OS X 10.5/.test(t))return!0}return!1},a.enterFullScreen=function(){var e=this.el_;if(e.paused&&e.networkState<=e.HAVE_METADATA)wt(this.el_.play()),this.setTimeout((function(){e.pause();try{e.webkitEnterFullScreen()}catch(e){this.trigger("fullscreenerror",e)}}),0);else try{e.webkitEnterFullScreen()}catch(e){this.trigger("fullscreenerror",e)}},a.exitFullScreen=function(){this.el_.webkitDisplayingFullscreen?this.el_.webkitExitFullScreen():this.trigger("fullscreenerror",new Error("The video is not fullscreen"))},a.requestPictureInPicture=function(){return this.el_.requestPictureInPicture()},a.src=function(e){if(void 0===e)return this.el_.src;this.setSrc(e)},a.reset=function(){r.resetMediaElement(this.el_)},a.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc},a.setControls=function(e){this.el_.controls=!!e},a.addTextTrack=function(e,t,r){return this.featuresNativeTextTracks?this.el_.addTextTrack(e,t,r):i.prototype.addTextTrack.call(this,e,t,r)},a.createRemoteTextTrack=function(e){if(!this.featuresNativeTextTracks)return i.prototype.createRemoteTextTrack.call(this,e);var r=t.createElement("track");return e.kind&&(r.kind=e.kind),e.label&&(r.label=e.label),(e.language||e.srclang)&&(r.srclang=e.language||e.srclang),e.default&&(r.default=e.default),e.id&&(r.id=e.id),e.src&&(r.src=e.src),r},a.addRemoteTextTrack=function(e,t){var r=i.prototype.addRemoteTextTrack.call(this,e,t);return this.featuresNativeTextTracks&&this.el().appendChild(r),r},a.removeRemoteTextTrack=function(e){if(i.prototype.removeRemoteTextTrack.call(this,e),this.featuresNativeTextTracks)for(var t=this.$$("track"),r=t.length;r--;)e!==t[r]&&e!==t[r].track||this.el().removeChild(t[r])},a.getVideoPlaybackQuality=function(){if("function"==typeof this.el().getVideoPlaybackQuality)return this.el().getVideoPlaybackQuality();var t={};return void 0!==this.el().webkitDroppedFrameCount&&void 0!==this.el().webkitDecodedFrameCount&&(t.droppedVideoFrames=this.el().webkitDroppedFrameCount,t.totalVideoFrames=this.el().webkitDecodedFrameCount),e.performance&&"function"==typeof e.performance.now?t.creationTime=e.performance.now():e.performance&&e.performance.timing&&"number"==typeof e.performance.timing.navigationStart&&(t.creationTime=e.Date.now()-e.performance.timing.navigationStart),t},r}(ji);In(xn,"TEST_VID",(function(){if(y()){var e=t.createElement("video"),i=t.createElement("track");return i.kind="captions",i.srclang="en",i.label="English",e.appendChild(i),e}})),xn.isSupported=function(){try{xn.TEST_VID.volume=.5}catch(na){return!1}return!(!xn.TEST_VID||!xn.TEST_VID.canPlayType)},xn.canPlayType=function(e){return xn.TEST_VID.canPlayType(e)},xn.canPlaySource=function(e,t){return xn.canPlayType(e.type)},xn.canControlVolume=function(){try{var e=xn.TEST_VID.volume;return xn.TEST_VID.volume=e/2+.1,e!==xn.TEST_VID.volume}catch(e){return!1}},xn.canMuteVolume=function(){try{var e=xn.TEST_VID.muted;return xn.TEST_VID.muted=!e,xn.TEST_VID.muted?O(xn.TEST_VID,"muted","muted"):x(xn.TEST_VID,"muted"),e!==xn.TEST_VID.muted}catch(e){return!1}},xn.canControlPlaybackRate=function(){if(Qe&&tt&&it<58)return!1;try{var e=xn.TEST_VID.playbackRate;return xn.TEST_VID.playbackRate=e/2+.1,e!==xn.TEST_VID.playbackRate}catch(e){return!1}},xn.canOverrideAttributes=function(){try{var e=function(){};Object.defineProperty(t.createElement("video"),"src",{get:e,set:e}),Object.defineProperty(t.createElement("audio"),"src",{get:e,set:e}),Object.defineProperty(t.createElement("video"),"innerHTML",{get:e,set:e}),Object.defineProperty(t.createElement("audio"),"innerHTML",{get:e,set:e})}catch(e){return!1}return!0},xn.supportsNativeTextTracks=function(){return ct||lt&&tt},xn.supportsNativeVideoTracks=function(){return!(!xn.TEST_VID||!xn.TEST_VID.videoTracks)},xn.supportsNativeAudioTracks=function(){return!(!xn.TEST_VID||!xn.TEST_VID.audioTracks)},xn.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],[["featuresVolumeControl","canControlVolume"],["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach((function(e){var t=e[1];In(xn.prototype,e[0],(function(){return xn[t]()}),!0)})),xn.prototype.movingMediaElementInDOM=!lt,xn.prototype.featuresFullscreenResize=!0,xn.prototype.featuresProgressEvents=!0,xn.prototype.featuresTimeupdateEvents=!0,xn.patchCanPlayType=function(){4<=$e&&!Ze&&!tt&&(Rn=xn.TEST_VID&&xn.TEST_VID.constructor.prototype.canPlayType,xn.TEST_VID.constructor.prototype.canPlayType=function(e){return e&&/^application\/(?:x-|vnd\.apple\.)mpegurl/i.test(e)?"maybe":Rn.call(this,e)})},xn.unpatchCanPlayType=function(){var e=xn.TEST_VID.constructor.prototype.canPlayType;return Rn&&(xn.TEST_VID.constructor.prototype.canPlayType=Rn),e},xn.patchCanPlayType(),xn.disposeMediaElement=function(e){if(e){for(e.parentNode&&e.parentNode.removeChild(e);e.hasChildNodes();)e.removeChild(e.firstChild);e.removeAttribute("src"),"function"==typeof e.load&&function(){try{e.load()}catch(e){}}()}},xn.resetMediaElement=function(e){if(e){for(var t=e.querySelectorAll("source"),i=t.length;i--;)e.removeChild(t[i]);e.removeAttribute("src"),"function"==typeof e.load&&function(){try{e.load()}catch(e){}}()}},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach((function(e){xn.prototype[e]=function(){return this.el_[e]||this.el_.hasAttribute(e)}})),["muted","defaultMuted","autoplay","loop","playsinline"].forEach((function(e){xn.prototype["set"+Oe(e)]=function(t){(this.el_[e]=t)?this.el_.setAttribute(e,e):this.el_.removeAttribute(e)}})),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","disablePictureInPicture","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach((function(e){xn.prototype[e]=function(){return this.el_[e]}})),["volume","src","poster","preload","playbackRate","defaultPlaybackRate","disablePictureInPicture","crossOrigin"].forEach((function(e){xn.prototype["set"+Oe(e)]=function(t){this.el_[e]=t}})),["pause","load","play"].forEach((function(e){xn.prototype[e]=function(){return this.el_[e]()}})),ji.withSourceHandlers(xn),xn.nativeSourceHandler={},xn.nativeSourceHandler.canPlayType=function(e){try{return xn.TEST_VID.canPlayType(e)}catch(e){return""}},xn.nativeSourceHandler.canHandleSource=function(e,t){if(e.type)return xn.nativeSourceHandler.canPlayType(e.type);if(e.src){var i=Nt(e.src);return xn.nativeSourceHandler.canPlayType("video/"+i)}return""},xn.nativeSourceHandler.handleSource=function(e,t,i){t.setSrc(e.src)},xn.nativeSourceHandler.dispose=function(){},xn.registerSourceHandler(xn.nativeSourceHandler),ji.registerTech("Html5",xn);var Pn=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],Mn={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},Nn=["tiny","xsmall","small","medium","large","xlarge","huge"],Un={};Nn.forEach((function(e){var t="x"===e.charAt(0)?"x-"+e.substring(1):e;Un[e]="vjs-layout-"+t}));var Fn={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0},Bn=function(r){function s(e,n,o){var u;if(e.id=e.id||n.id||"vjs_video_"+re(),(n=h(s.getTagSettings(e),n)).initChildren=!1,n.createEl=!1,n.evented=!1,n.reportTouchActivity=!1,!n.language)if("function"==typeof e.closest){var l=e.closest("[lang]");l&&l.getAttribute&&(n.language=l.getAttribute("lang"))}else for(var c=e;c&&1===c.nodeType;){if(R(c).hasOwnProperty("lang")){n.language=c.getAttribute("lang");break}c=c.parentNode}if((u=r.call(this,null,n,o)||this).boundDocumentFullscreenChange_=ge(Be(u),u.documentFullscreenChange_),u.boundFullWindowOnEscKey_=ge(Be(u),u.fullWindowOnEscKey),u.isFullscreen_=!1,u.log=a(u.id_),u.fsApi_=vt,u.isPosterFromTech_=!1,u.queuedCallbacks_=[],u.isReady_=!1,u.hasStarted_=!1,u.userActive_=!1,u.debugEnabled_=!1,!u.options_||!u.options_.techOrder||!u.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(u.tag=e,u.tagAttributes=e&&R(e),u.language(u.options_.language),n.languages){var d={};Object.getOwnPropertyNames(n.languages).forEach((function(e){d[e.toLowerCase()]=n.languages[e]})),u.languages_=d}else u.languages_=s.prototype.options_.languages;u.resetCache_(),u.poster_=n.poster||"",u.controls_=!!n.controls,e.controls=!1,e.removeAttribute("controls"),u.changingSrc_=!1,u.playCallbacks_=[],u.playTerminatedQueue_=[],e.hasAttribute("autoplay")?u.autoplay(!0):u.autoplay(u.options_.autoplay),n.plugins&&Object.keys(n.plugins).forEach((function(e){if("function"!=typeof u[e])throw new Error('plugin "'+e+'" does not exist')})),u.scrubbing_=!1,u.el_=u.createEl(),Le(Be(u),{eventBusKey:"el_"}),u.fsApi_.requestFullscreen&&(ce(t,u.fsApi_.fullscreenchange,u.boundDocumentFullscreenChange_),u.on(u.fsApi_.fullscreenchange,u.boundDocumentFullscreenChange_)),u.fluid_&&u.on("playerreset",u.updateStyleEl_);var f=xe(u.options_);n.plugins&&Object.keys(n.plugins).forEach((function(e){u[e](n.plugins[e])})),n.debug&&u.debug(!0),u.options_.playerOptions=f,u.middleware_=[],u.initChildren(),u.isAudio("audio"===e.nodeName.toLowerCase()),u.controls()?u.addClass("vjs-controls-enabled"):u.addClass("vjs-controls-disabled"),u.el_.setAttribute("role","region"),u.isAudio()?u.el_.setAttribute("aria-label",u.localize("Audio Player")):u.el_.setAttribute("aria-label",u.localize("Video Player")),u.isAudio()&&u.addClass("vjs-audio"),u.flexNotSupported_()&&u.addClass("vjs-no-flex"),st&&u.addClass("vjs-touch-enabled"),lt||u.addClass("vjs-workinghover"),s.players[u.id_]=Be(u);var p=i.split(".")[0];return u.addClass("vjs-v"+p),u.userActive(!0),u.reportUserActivity(),u.one("play",u.listenForUserActivity_),u.on("stageclick",u.handleStageClick_),u.on("keydown",u.handleKeyDown),u.breakpoints(u.options_.breakpoints),u.responsive(u.options_.responsive),u}qe(s,r);var o=s.prototype;return o.dispose=function(){var e=this;this.trigger("dispose"),this.off("dispose"),de(t,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),de(t,"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),s.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),function(e){Hi[e.id()]=null}(this),li.names.forEach((function(t){var i=e[li[t].getterName]();i&&i.off&&i.off()})),r.prototype.dispose.call(this)},o.createEl=function(){var i,n=this.tag,a=this.playerElIngest_=n.parentNode&&n.parentNode.hasAttribute&&n.parentNode.hasAttribute("data-vjs-player"),s="video-js"===this.tag.tagName.toLowerCase();a?i=this.el_=n.parentNode:s||(i=this.el_=r.prototype.createEl.call(this,"div"));var o=R(n);if(s){for(i=this.el_=n,n=this.tag=t.createElement("video");i.children.length;)n.appendChild(i.firstChild);w(i,"video-js")||C(i,"video-js"),i.appendChild(n),a=this.playerElIngest_=i,Object.keys(i).forEach((function(e){try{n[e]=i[e]}catch(e){}}))}if(n.setAttribute("tabindex","-1"),o.tabindex="-1",(rt||tt&&at)&&(n.setAttribute("role","application"),o.role="application"),n.removeAttribute("width"),n.removeAttribute("height"),"width"in o&&delete o.width,"height"in o&&delete o.height,Object.getOwnPropertyNames(o).forEach((function(e){s&&"class"===e||i.setAttribute(e,o[e]),s&&n.setAttribute(e,o[e])})),n.playerId=n.id,n.id+="_html5_api",n.className="vjs-tech",n.player=i.player=this,this.addClass("vjs-paused"),!0!==e.VIDEOJS_NO_DYNAMIC_STYLE){this.styleEl_=Z("vjs-styles-dimensions");var u=W(".vjs-styles-defaults"),l=W("head");l.insertBefore(this.styleEl_,u?u.nextSibling:l.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);for(var c=n.getElementsByTagName("a"),d=0;d<c.length;d++){var h=c.item(d);C(h,"vjs-hidden"),h.setAttribute("hidden","hidden")}return n.initNetworkState_=n.networkState,n.parentNode&&!a&&n.parentNode.insertBefore(i,n),k(n,i),this.children_.unshift(n),this.el_.setAttribute("lang",this.language_),this.el_=i},o.crossOrigin=function(e){if(!e)return this.techGet_("crossOrigin");"anonymous"===e||"use-credentials"===e?this.techCall_("setCrossOrigin",e):n.warn('crossOrigin must be "anonymous" or "use-credentials", given "'+e+'"')},o.width=function(e){return this.dimension("width",e)},o.height=function(e){return this.dimension("height",e)},o.dimension=function(e,t){var i=e+"_";if(void 0===t)return this[i]||0;if(""===t||"auto"===t)return this[i]=void 0,void this.updateStyleEl_();var r=parseFloat(t);isNaN(r)?n.error('Improper value "'+t+'" supplied for for '+e):(this[i]=r,this.updateStyleEl_())},o.fluid=function(e){if(void 0===e)return!!this.fluid_;this.fluid_=!!e,Ce(this)&&this.off("playerreset",this.updateStyleEl_),e?(this.addClass("vjs-fluid"),this.fill(!1),function(e,t){Ce(e)?t():(e.eventedCallbacks||(e.eventedCallbacks=[]),e.eventedCallbacks.push(t))}((function(){this.on("playerreset",this.updateStyleEl_)}))):this.removeClass("vjs-fluid"),this.updateStyleEl_()},o.fill=function(e){if(void 0===e)return!!this.fill_;this.fill_=!!e,e?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")},o.aspectRatio=function(e){if(void 0===e)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(e))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=e,this.fluid(!0),this.updateStyleEl_()},o.updateStyleEl_=function(){if(!0!==e.VIDEOJS_NO_DYNAMIC_STYLE){var t,i,r,n=(void 0!==this.aspectRatio_&&"auto"!==this.aspectRatio_?this.aspectRatio_:0<this.videoWidth()?this.videoWidth()+":"+this.videoHeight():"16:9").split(":"),a=n[1]/n[0];t=void 0!==this.width_?this.width_:void 0!==this.height_?this.height_/a:this.videoWidth()||300,i=void 0!==this.height_?this.height_:t*a,r=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions",this.addClass(r),ee(this.styleEl_,"\n      ."+r+" {\n        width: "+t+"px;\n        height: "+i+"px;\n      }\n\n      ."+r+".vjs-fluid {\n        padding-top: "+100*a+"%;\n      }\n    ")}else{var s="number"==typeof this.width_?this.width_:this.options_.width,o="number"==typeof this.height_?this.height_:this.options_.height,u=this.tech_&&this.tech_.el();u&&(0<=s&&(u.width=s),0<=o&&(u.height=o))}},o.loadTech_=function(e,t){var i=this;this.tech_&&this.unloadTech_();var r=Oe(e),n=e.charAt(0).toLowerCase()+e.slice(1);"Html5"!==r&&this.tag&&(ji.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=r,this.isReady_=!1;var a={source:t,autoplay:"string"!=typeof this.autoplay()&&this.autoplay(),nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+n+"_api",playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,disablePictureInPicture:this.options_.disablePictureInPicture,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset,Promise:this.options_.Promise};li.names.forEach((function(e){var t=li[e];a[t.getterName]=i[t.privateName]})),h(a,this.options_[r]),h(a,this.options_[n]),h(a,this.options_[e.toLowerCase()]),this.tag&&(a.tag=this.tag),t&&t.src===this.cache_.src&&0<this.cache_.currentTime&&(a.startTime=this.cache_.currentTime);var s=ji.getTech(e);if(!s)throw new Error("No Tech named '"+r+"' exists! '"+r+"' should be registered using videojs.registerTech()'");this.tech_=new s(a),this.tech_.ready(ge(this,this.handleTechReady_),!0),function(e,t){e.forEach((function(e){var i=t.addRemoteTextTrack(e).track;!e.src&&e.cues&&e.cues.forEach((function(e){return i.addCue(e)}))})),t.textTracks()}(this.textTracksJson_||[],this.tech_),Pn.forEach((function(e){i.on(i.tech_,e,i["handleTech"+Oe(e)+"_"])})),Object.keys(Mn).forEach((function(e){i.on(i.tech_,e,(function(t){0===i.tech_.playbackRate()&&i.tech_.seeking()?i.queuedCallbacks_.push({callback:i["handleTech"+Mn[e]+"_"].bind(i),event:t}):i["handleTech"+Mn[e]+"_"](t)}))})),this.on(this.tech_,"loadstart",this.handleTechLoadStart_),this.on(this.tech_,"sourceset",this.handleTechSourceset_),this.on(this.tech_,"waiting",this.handleTechWaiting_),this.on(this.tech_,"ended",this.handleTechEnded_),this.on(this.tech_,"seeking",this.handleTechSeeking_),this.on(this.tech_,"play",this.handleTechPlay_),this.on(this.tech_,"firstplay",this.handleTechFirstPlay_),this.on(this.tech_,"pause",this.handleTechPause_),this.on(this.tech_,"durationchange",this.handleTechDurationChange_),this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_),this.on(this.tech_,"fullscreenerror",this.handleTechFullscreenError_),this.on(this.tech_,"enterpictureinpicture",this.handleTechEnterPictureInPicture_),this.on(this.tech_,"leavepictureinpicture",this.handleTechLeavePictureInPicture_),this.on(this.tech_,"error",this.handleTechError_),this.on(this.tech_,"loadedmetadata",this.updateStyleEl_),this.on(this.tech_,"posterchange",this.handleTechPosterChange_),this.on(this.tech_,"textdata",this.handleTechTextData_),this.on(this.tech_,"ratechange",this.handleTechRateChange_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode===this.el()||"Html5"===r&&this.tag||k(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)},o.unloadTech_=function(){var e=this;li.names.forEach((function(t){var i=li[t];e[i.privateName]=e[i.getterName]()})),this.textTracksJson_=function(e){var t=e.$$("track"),i=Array.prototype.map.call(t,(function(e){return e.track}));return Array.prototype.map.call(t,(function(e){var t=Ct(e.track);return e.src&&(t.src=e.src),t})).concat(Array.prototype.filter.call(e.textTracks(),(function(e){return-1===i.indexOf(e)})).map(Ct))}(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1},o.tech=function(e){return void 0===e&&n.warn("Using the tech directly can be dangerous. I hope you know what you're doing.\nSee https://github.com/videojs/video.js/issues/2617 for more info.\n"),this.tech_},o.addTechControlsListeners_=function(){this.removeTechControlsListeners_(),this.on(this.tech_,"mouseup",this.handleTechClick_),this.on(this.tech_,"dblclick",this.handleTechDoubleClick_),this.on(this.tech_,"touchstart",this.handleTechTouchStart_),this.on(this.tech_,"touchmove",this.handleTechTouchMove_),this.on(this.tech_,"touchend",this.handleTechTouchEnd_),this.on(this.tech_,"tap",this.handleTechTap_)},o.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.handleTechTap_),this.off(this.tech_,"touchstart",this.handleTechTouchStart_),this.off(this.tech_,"touchmove",this.handleTechTouchMove_),this.off(this.tech_,"touchend",this.handleTechTouchEnd_),this.off(this.tech_,"mouseup",this.handleTechClick_),this.off(this.tech_,"dblclick",this.handleTechDoubleClick_)},o.handleTechReady_=function(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()},o.handleTechLoadStart_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay")),this.manualAutoplay_(this.autoplay())},o.manualAutoplay_=function(e){var t=this;if(this.tech_&&"string"==typeof e){var i,r=function(){var e=t.muted();function i(){t.muted(e)}t.muted(!0),t.playTerminatedQueue_.push(i);var r=t.play();if(kt(r))return r.catch(i)};if("any"===e&&!0!==this.muted()?kt(i=this.play())&&(i=i.catch(r)):i="muted"===e&&!0!==this.muted()?r():this.play(),kt(i))return i.then((function(){t.trigger({type:"autoplay-success",autoplay:e})})).catch((function(i){t.trigger({type:"autoplay-failure",autoplay:e})}))}},o.updateSourceCaches_=function(e){void 0===e&&(e="");var t=e,i="";"string"!=typeof t&&(t=e.src,i=e.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],t&&!i&&(i=function(e,t){if(!t)return"";if(e.cache_.source.src===t&&e.cache_.source.type)return e.cache_.source.type;var i=e.cache_.sources.filter((function(e){return e.src===t}));if(i.length)return i[0].type;for(var r=e.$$("source"),n=0;n<r.length;n++){var a=r[n];if(a.type&&a.src&&a.src===t)return a.type}return Xi(t)}(this,t)),this.cache_.source=xe({},e,{src:t,type:i});for(var r=this.cache_.sources.filter((function(e){return e.src&&e.src===t})),n=[],a=this.$$("source"),s=[],o=0;o<a.length;o++){var u=R(a[o]);n.push(u),u.src&&u.src===t&&s.push(u.src)}s.length&&!r.length?this.cache_.sources=n:r.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=t},o.handleTechSourceset_=function(e){var t=this;if(!this.changingSrc_){var i=function(e){return t.updateSourceCaches_(e)},r=this.currentSource().src,n=e.src;r&&!/^blob:/.test(r)&&/^blob:/.test(n)&&(this.lastSource_&&(this.lastSource_.tech===n||this.lastSource_.player===r)||(i=function(){})),i(n),e.src||this.tech_.any(["sourceset","loadstart"],(function(e){if("sourceset"!==e.type){var i=t.techGet("currentSrc");t.lastSource_.tech=i,t.updateSourceCaches_(i)}}))}this.lastSource_={player:this.currentSource().src,tech:e.src},this.trigger({src:e.src,type:"sourceset"})},o.hasStarted=function(e){if(void 0===e)return this.hasStarted_;e!==this.hasStarted_&&(this.hasStarted_=e,this.hasStarted_?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started"))},o.handleTechPlay_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")},o.handleTechRateChange_=function(){0<this.tech_.playbackRate()&&0===this.cache_.lastPlaybackRate&&(this.queuedCallbacks_.forEach((function(e){return e.callback(e.event)})),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")},o.handleTechWaiting_=function(){var e=this;this.addClass("vjs-waiting"),this.trigger("waiting");var t=this.currentTime();this.on("timeupdate",(function i(){t!==e.currentTime()&&(e.removeClass("vjs-waiting"),e.off("timeupdate",i))}))},o.handleTechCanPlay_=function(){this.removeClass("vjs-waiting"),this.trigger("canplay")},o.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")},o.handleTechPlaying_=function(){this.removeClass("vjs-waiting"),this.trigger("playing")},o.handleTechSeeking_=function(){this.addClass("vjs-seeking"),this.trigger("seeking")},o.handleTechSeeked_=function(){this.removeClass("vjs-seeking"),this.removeClass("vjs-ended"),this.trigger("seeked")},o.handleTechFirstPlay_=function(){this.options_.starttime&&(n.warn("Passing the `starttime` option to the player will be deprecated in 6.0"),this.currentTime(this.options_.starttime)),this.addClass("vjs-has-started"),this.trigger("firstplay")},o.handleTechPause_=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")},o.handleTechEnded_=function(){this.addClass("vjs-ended"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")},o.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))},o.handleTechClick_=function(e){q(e)&&this.controls_&&(this.paused()?wt(this.play()):this.pause())},o.handleTechDoubleClick_=function(e){this.controls_&&(Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),(function(t){return t.contains(e.target)}))||void 0!==this.options_&&void 0!==this.options_.userActions&&void 0!==this.options_.userActions.doubleClick&&!1===this.options_.userActions.doubleClick||(void 0!==this.options_&&void 0!==this.options_.userActions&&"function"==typeof this.options_.userActions.doubleClick?this.options_.userActions.doubleClick.call(this,e):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen()))},o.handleTechTap_=function(){this.userActive(!this.userActive())},o.handleTechTouchStart_=function(){this.userWasActive=this.userActive()},o.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()},o.handleTechTouchEnd_=function(e){e.preventDefault()},o.handleStageClick_=function(){this.reportUserActivity()},o.toggleFullscreenClass_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},o.documentFullscreenChange_=function(e){var i=e.target.player;if(!i||i===this){var r=this.el(),n=t[this.fsApi_.fullscreenElement]===r;!n&&r.matches?n=r.matches(":"+this.fsApi_.fullscreen):!n&&r.msMatchesSelector&&(n=r.msMatchesSelector(":"+this.fsApi_.fullscreen)),this.isFullscreen(n)}},o.handleTechFullscreenChange_=function(e,t){t&&(t.nativeIOSFullscreen&&this.toggleClass("vjs-ios-native-fs"),this.isFullscreen(t.isFullscreen))},o.handleTechFullscreenError_=function(e,t){this.trigger("fullscreenerror",t)},o.togglePictureInPictureClass_=function(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")},o.handleTechEnterPictureInPicture_=function(e){this.isInPictureInPicture(!0)},o.handleTechLeavePictureInPicture_=function(e){this.isInPictureInPicture(!1)},o.handleTechError_=function(){var e=this.tech_.error();this.error(e)},o.handleTechTextData_=function(e,t){var i=null;1<arguments.length&&(i=t),this.trigger("textdata",i)},o.getCache=function(){return this.cache_},o.resetCache_=function(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],volume:1}},o.techCall_=function(e,t){this.ready((function(){if(e in Wi)return function(e,t,i,r){return t[i](e.reduce(Yi(i),r))}(this.middleware_,this.tech_,e,t);if(e in zi)return qi(this.middleware_,this.tech_,e,t);try{this.tech_&&this.tech_[e](t)}catch(e){throw n(e),e}}),!0)},o.techGet_=function(e){if(this.tech_&&this.tech_.isReady_){if(e in Ki)return function(e,t,i){return e.reduceRight(Yi(i),t[i]())}(this.middleware_,this.tech_,e);if(e in zi)return qi(this.middleware_,this.tech_,e);try{return this.tech_[e]()}catch(o){if(void 0===this.tech_[e])throw n("Video.js: "+e+" method not defined for "+this.techName_+" playback technology.",o),o;if("TypeError"===o.name)throw n("Video.js: "+e+" unavailable on "+this.techName_+" playback technology element.",o),this.tech_.isReady_=!1,o;throw n(o),o}}},o.play=function(){var t=this,i=this.options_.Promise||e.Promise;return i?new i((function(e){t.play_(e)})):this.play_()},o.play_=function(e){var t=this;void 0===e&&(e=wt),this.playCallbacks_.push(e);var i=Boolean(!this.changingSrc_&&(this.src()||this.currentSrc()));if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!i)return this.waitToPlay_=function(e){t.play_()},this.one(["ready","loadstart"],this.waitToPlay_),void(i||!ct&&!lt||this.load());var r=this.techGet_("play");null===r?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(r)},o.runPlayTerminatedQueue_=function(){var e=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],e.forEach((function(e){e()}))},o.runPlayCallbacks_=function(e){var t=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],t.forEach((function(t){t(e)}))},o.pause=function(){this.techCall_("pause")},o.paused=function(){return!1!==this.techGet_("paused")},o.played=function(){return this.techGet_("played")||pt(0,0)},o.scrubbing=function(e){if(void 0===e)return this.scrubbing_;this.scrubbing_=!!e,this.techCall_("setScrubbing",this.scrubbing_),e?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")},o.currentTime=function(e){return void 0!==e?(e<0&&(e=0),this.isReady_&&!this.changingSrc_&&this.tech_&&this.tech_.isReady_?(this.techCall_("setCurrentTime",e),void(this.cache_.initTime=0)):(this.cache_.initTime=e,this.off("canplay",this.applyInitTime_),void this.one("canplay",this.applyInitTime_))):(this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime)},o.applyInitTime_=function(){this.currentTime(this.cache_.initTime)},o.duration=function(e){if(void 0===e)return void 0!==this.cache_.duration?this.cache_.duration:NaN;(e=parseFloat(e))<0&&(e=1/0),e!==this.cache_.duration&&((this.cache_.duration=e)===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(e)||this.trigger("durationchange"))},o.remainingTime=function(){return this.duration()-this.currentTime()},o.remainingTimeDisplay=function(){return Math.floor(this.duration())-Math.floor(this.currentTime())},o.buffered=function(){var e=this.techGet_("buffered");return e&&e.length||(e=pt(0,0)),e},o.bufferedPercent=function(){return gt(this.buffered(),this.duration())},o.bufferedEnd=function(){var e=this.buffered(),t=this.duration(),i=e.end(e.length-1);return t<i&&(i=t),i},o.volume=function(e){var t;return void 0!==e?(t=Math.max(0,Math.min(1,parseFloat(e))),this.cache_.volume=t,this.techCall_("setVolume",t),void(0<t&&this.lastVolume_(t))):(t=parseFloat(this.techGet_("volume")),isNaN(t)?1:t)},o.muted=function(e){if(void 0===e)return this.techGet_("muted")||!1;this.techCall_("setMuted",e)},o.defaultMuted=function(e){return void 0!==e?this.techCall_("setDefaultMuted",e):this.techGet_("defaultMuted")||!1},o.lastVolume_=function(e){if(void 0===e||0===e)return this.cache_.lastVolume;this.cache_.lastVolume=e},o.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1},o.isFullscreen=function(e){if(void 0===e)return this.isFullscreen_;var t=this.isFullscreen_;return this.isFullscreen_=Boolean(e),this.isFullscreen_!==t&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),void this.toggleFullscreenClass_()},o.requestFullscreen=function(t){var i=this.options_.Promise||e.Promise;if(i){var r=this;return new i((function(e,i){function n(){r.off("fullscreenerror",s),r.off("fullscreenchange",a)}function a(){n(),e()}function s(e,t){n(),i(t)}r.one("fullscreenchange",a),r.one("fullscreenerror",s);var o=r.requestFullscreenHelper_(t);if(o)return o.then(n,n),o}))}return this.requestFullscreenHelper_()},o.requestFullscreenHelper_=function(e){var t,i=this;if(this.fsApi_.prefixed||(t=this.options_.fullscreen&&this.options_.fullscreen.options||{},void 0!==e&&(t=e)),this.fsApi_.requestFullscreen){var r=this.el_[this.fsApi_.requestFullscreen](t);return r&&r.then((function(){return i.isFullscreen(!0)}),(function(){return i.isFullscreen(!1)})),r}this.tech_.supportsFullScreen()?this.techCall_("enterFullScreen"):this.enterFullWindow()},o.exitFullscreen=function(){var t=this.options_.Promise||e.Promise;if(t){var i=this;return new t((function(e,t){function r(){i.off("fullscreenerror",a),i.off("fullscreenchange",n)}function n(){r(),e()}function a(e,i){r(),t(i)}i.one("fullscreenchange",n),i.one("fullscreenerror",a);var s=i.exitFullscreenHelper_();if(s)return s.then(r,r),s}))}return this.exitFullscreenHelper_()},o.exitFullscreenHelper_=function(){var e=this;if(this.fsApi_.requestFullscreen){var i=t[this.fsApi_.exitFullscreen]();return i&&i.then((function(){return e.isFullscreen(!1)})),i}this.tech_.supportsFullScreen()?this.techCall_("exitFullScreen"):this.exitFullWindow()},o.enterFullWindow=function(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=t.documentElement.style.overflow,ce(t,"keydown",this.boundFullWindowOnEscKey_),t.documentElement.style.overflow="hidden",C(t.body,"vjs-full-window"),this.trigger("enterFullWindow")},o.fullWindowOnEscKey=function(e){At.isEventKey(e,"Esc")&&(!0===this.isFullscreen()?this.exitFullscreen():this.exitFullWindow())},o.exitFullWindow=function(){this.isFullscreen(!1),this.isFullWindow=!1,de(t,"keydown",this.boundFullWindowOnEscKey_),t.documentElement.style.overflow=this.docOrigOverflow,A(t.body,"vjs-full-window"),this.trigger("exitFullWindow")},o.disablePictureInPicture=function(e){if(void 0===e)return this.techGet_("disablePictureInPicture");this.techCall_("setDisablePictureInPicture",e),this.options_.disablePictureInPicture=e,this.trigger("disablepictureinpicturechanged")},o.isInPictureInPicture=function(e){return void 0!==e?(this.isInPictureInPicture_=!!e,void this.togglePictureInPictureClass_()):!!this.isInPictureInPicture_},o.requestPictureInPicture=function(){if("pictureInPictureEnabled"in t&&!1===this.disablePictureInPicture())return this.techGet_("requestPictureInPicture")},o.exitPictureInPicture=function(){if("pictureInPictureEnabled"in t)return t.exitPictureInPicture()},o.handleKeyDown=function(e){var t=this.options_.userActions;t&&t.hotkeys&&!function(e){var t=e.tagName.toLowerCase();return!!e.isContentEditable||("input"===t?-1===["button","checkbox","hidden","radio","reset","submit"].indexOf(e.type):-1!==["textarea"].indexOf(t))}(this.el_.ownerDocument.activeElement)&&("function"==typeof t.hotkeys?t.hotkeys.call(this,e):this.handleHotkeys(e))},o.handleHotkeys=function(e){var i=this.options_.userActions?this.options_.userActions.hotkeys:{},r=i.fullscreenKey,n=i.muteKey,a=void 0===n?function(e){return At.isEventKey(e,"m")}:n,s=i.playPauseKey,o=void 0===s?function(e){return At.isEventKey(e,"k")||At.isEventKey(e,"Space")}:s;if((void 0===r?function(e){return At.isEventKey(e,"f")}:r).call(this,e)){e.preventDefault(),e.stopPropagation();var u=Fe.getComponent("FullscreenToggle");!1!==t[this.fsApi_.fullscreenEnabled]&&u.prototype.handleClick.call(this,e)}else a.call(this,e)?(e.preventDefault(),e.stopPropagation(),Fe.getComponent("MuteToggle").prototype.handleClick.call(this,e)):o.call(this,e)&&(e.preventDefault(),e.stopPropagation(),Fe.getComponent("PlayToggle").prototype.handleClick.call(this,e))},o.canPlayType=function(e){for(var t,i=0,r=this.options_.techOrder;i<r.length;i++){var a=r[i],s=ji.getTech(a);if(s=s||Fe.getComponent(a)){if(s.isSupported()&&(t=s.canPlayType(e)))return t}else n.error('The "'+a+'" tech is undefined. Skipped browser support check for that tech.')}return""},o.selectSource=function(e){function t(e,t,i){var r;return e.some((function(e){return t.some((function(t){if(r=i(e,t))return!0}))})),r}function i(e,t){var i=e[0];if(e[1].canPlaySource(t,a.options_[i.toLowerCase()]))return{source:t,tech:i}}var r,a=this,s=this.options_.techOrder.map((function(e){return[e,ji.getTech(e)]})).filter((function(e){var t=e[0],i=e[1];return i?i.isSupported():(n.error('The "'+t+'" tech is undefined. Skipped browser support check for that tech.'),!1)}));return(this.options_.sourceOrder?t(e,s,(r=i,function(e,t){return r(t,e)})):t(s,e,i))||!1},o.src=function(e){var t=this;if(void 0===e)return this.cache_.src||"";var i=function e(t){if(Array.isArray(t)){var i=[];t.forEach((function(t){t=e(t),Array.isArray(t)?i=i.concat(t):f(t)&&i.push(t)})),t=i}else t="string"==typeof t&&t.trim()?[$i({src:t})]:f(t)&&"string"==typeof t.src&&t.src&&t.src.trim()?[$i(t)]:[];return t}(e);i.length?(this.changingSrc_=!0,this.cache_.sources=i,this.updateSourceCaches_(i[0]),function(e,t,i){e.setTimeout((function(){return function e(t,i,r,n,a,s){void 0===t&&(t={}),void 0===i&&(i=[]),void 0===a&&(a=[]),void 0===s&&(s=!1);var o=i[0],u=i.slice(1);if("string"==typeof o)e(t,Vi[o],r,n,a,s);else if(o){var l=function(e,t){var i=Hi[e.id()],r=null;if(null==i)return r=t(e),Hi[e.id()]=[[t,r]],r;for(var n=0;n<i.length;n++){var a=i[n];a[0]===t&&(r=a[1])}return null===r&&(r=t(e),i.push([t,r])),r}(n,o);if(!l.setSource)return a.push(l),e(t,u,r,n,a,s);l.setSource(h({},t),(function(i,o){if(i)return e(t,u,r,n,a,s);a.push(l),e(o,t.type===o.type?u:Vi[o.type],r,n,a,s)}))}else u.length?e(t,u,r,n,a,s):s?r(t,a):e(t,Vi["*"],r,n,a,!0)}(t,Vi[t.type],i,e)}),1)}(this,i[0],(function(e,r){if(t.middleware_=r,t.cache_.sources=i,t.updateSourceCaches_(e),t.src_(e))return 1<i.length?t.src(i.slice(1)):(t.changingSrc_=!1,t.setTimeout((function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})}),0),void t.triggerReady());!function(e,t){e.forEach((function(e){return e.setTech&&e.setTech(t)}))}(r,t.tech_)}))):this.setTimeout((function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})}),0)},o.src_=function(e){var t=this,i=this.selectSource([e]);return!i||(function(e,t){return Oe(e)===Oe(t)}(i.tech,this.techName_)?this.ready((function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",e):this.techCall_("src",e.src),this.changingSrc_=!1}),!0):(this.changingSrc_=!0,this.loadTech_(i.tech,i.source),this.tech_.ready((function(){t.changingSrc_=!1}))),!1)},o.load=function(){this.techCall_("load")},o.reset=function(){var t=this,i=this.options_.Promise||e.Promise;this.paused()||!i?this.doReset_():wt(this.play().then((function(){return t.doReset_()})))},o.doReset_=function(){this.tech_&&this.tech_.clearTracks("text"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),Ce(this)&&this.trigger("playerreset")},o.resetControlBarUI_=function(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()},o.resetProgressBar_=function(){this.currentTime(0);var e=this.controlBar,t=e.durationDisplay,i=e.remainingTimeDisplay;t&&t.updateContent(),i&&i.updateContent()},o.resetPlaybackRate_=function(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()},o.resetVolumeBar_=function(){this.volume(1),this.trigger("volumechange")},o.currentSources=function(){var e=this.currentSource(),t=[];return 0!==Object.keys(e).length&&t.push(e),this.cache_.sources||t},o.currentSource=function(){return this.cache_.source||{}},o.currentSrc=function(){return this.currentSource()&&this.currentSource().src||""},o.currentType=function(){return this.currentSource()&&this.currentSource().type||""},o.preload=function(e){return void 0!==e?(this.techCall_("setPreload",e),void(this.options_.preload=e)):this.techGet_("preload")},o.autoplay=function(e){if(void 0===e)return this.options_.autoplay||!1;var t;"string"==typeof e&&/(any|play|muted)/.test(e)?(this.options_.autoplay=e,this.manualAutoplay_(e),t=!1):this.options_.autoplay=!!e,t=void 0===t?this.options_.autoplay:t,this.tech_&&this.techCall_("setAutoplay",t)},o.playsinline=function(e){return void 0!==e?(this.techCall_("setPlaysinline",e),this.options_.playsinline=e,this):this.techGet_("playsinline")},o.loop=function(e){return void 0!==e?(this.techCall_("setLoop",e),void(this.options_.loop=e)):this.techGet_("loop")},o.poster=function(e){if(void 0===e)return this.poster_;(e=e||"")!==this.poster_&&(this.poster_=e,this.techCall_("setPoster",e),this.isPosterFromTech_=!1,this.trigger("posterchange"))},o.handleTechPosterChange_=function(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var e=this.tech_.poster()||"";e!==this.poster_&&(this.poster_=e,this.isPosterFromTech_=!0,this.trigger("posterchange"))}},o.controls=function(e){if(void 0===e)return!!this.controls_;this.controls_!==(e=!!e)&&(this.controls_=e,this.usingNativeControls()&&this.techCall_("setControls",e),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))},o.usingNativeControls=function(e){if(void 0===e)return!!this.usingNativeControls_;this.usingNativeControls_!==(e=!!e)&&(this.usingNativeControls_=e,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))},o.error=function(e){if(void 0===e)return this.error_||null;if(this.options_.suppressNotSupportedError&&e&&4===e.code){var t=function(){this.error(e)};return this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],t),void this.one("loadstart",(function(){this.off(["click","touchstart"],t)}))}if(null===e)return this.error_=e,this.removeClass("vjs-error"),void(this.errorDisplay&&this.errorDisplay.close());this.error_=new St(e),this.addClass("vjs-error"),n.error("(CODE:"+this.error_.code+" "+St.errorTypes[this.error_.code]+")",this.error_.message,this.error_),this.trigger("error")},o.reportUserActivity=function(e){this.userActivity_=!0},o.userActive=function(e){if(void 0===e)return this.userActive_;if((e=!!e)!==this.userActive_){if(this.userActive_=e,this.userActive_)return this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),void this.trigger("useractive");this.tech_&&this.tech_.one("mousemove",(function(e){e.stopPropagation(),e.preventDefault()})),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}},o.listenForUserActivity_=function(){function e(e){n(),this.clearInterval(t)}var t,i,r,n=ge(this,this.reportUserActivity);this.on("mousedown",(function(){n(),this.clearInterval(t),t=this.setInterval(n,250)})),this.on("mousemove",(function(e){e.screenX===i&&e.screenY===r||(i=e.screenX,r=e.screenY,n())})),this.on("mouseup",e),this.on("mouseleave",e);var a,s=this.getChild("controlBar");!s||lt||Qe||(s.on("mouseenter",(function(e){this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout,this.player().options_.inactivityTimeout=0})),s.on("mouseleave",(function(e){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout}))),this.on("keydown",n),this.on("keyup",n),this.setInterval((function(){if(this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(a);var e=this.options_.inactivityTimeout;e<=0||(a=this.setTimeout((function(){this.userActivity_||this.userActive(!1)}),e))}}),250)},o.playbackRate=function(e){if(void 0===e)return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1;this.techCall_("setPlaybackRate",e)},o.defaultPlaybackRate=function(e){return void 0!==e?this.techCall_("setDefaultPlaybackRate",e):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1},o.isAudio=function(e){if(void 0===e)return!!this.isAudio_;this.isAudio_=!!e},o.addTextTrack=function(e,t,i){if(this.tech_)return this.tech_.addTextTrack(e,t,i)},o.addRemoteTextTrack=function(e,t){if(this.tech_)return this.tech_.addRemoteTextTrack(e,t)},o.removeRemoteTextTrack=function(e){void 0===e&&(e={});var t=e.track;if(t=t||e,this.tech_)return this.tech_.removeRemoteTextTrack(t)},o.getVideoPlaybackQuality=function(){return this.techGet_("getVideoPlaybackQuality")},o.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},o.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},o.language=function(e){if(void 0===e)return this.language_;this.language_=String(e).toLowerCase()},o.languages=function(){return xe(s.prototype.options_.languages,this.languages_)},o.toJSON=function(){var e=xe(this.options_),t=e.tracks;e.tracks=[];for(var i=0;i<t.length;i++){var r=t[i];(r=xe(r)).player=void 0,e.tracks[i]=r}return e},o.createModal=function(e,t){var i=this;(t=t||{}).content=e||"";var r=new It(this,t);return this.addChild(r),r.on("dispose",(function(){i.removeChild(r)})),r.open(),r},o.updateCurrentBreakpoint_=function(){if(this.responsive())for(var e=this.currentBreakpoint(),t=this.currentWidth(),i=0;i<Nn.length;i++){var r=Nn[i];if(t<=this.breakpoints_[r]){if(e===r)return;e&&this.removeClass(Un[e]),this.addClass(Un[r]),this.breakpoint_=r;break}}},o.removeCurrentBreakpoint_=function(){var e=this.currentBreakpointClass();this.breakpoint_="",e&&this.removeClass(e)},o.breakpoints=function(e){return void 0===e||(this.breakpoint_="",this.breakpoints_=h({},Fn,e),this.updateCurrentBreakpoint_()),h(this.breakpoints_)},o.responsive=function(e){return void 0===e?this.responsive_:(e=Boolean(e))!==this.responsive_?((this.responsive_=e)?(this.on("playerresize",this.updateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.updateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),e):void 0},o.currentBreakpoint=function(){return this.breakpoint_},o.currentBreakpointClass=function(){return Un[this.breakpoint_]||""},o.loadMedia=function(e,t){var i=this;if(e&&"object"==typeof e){this.reset(),this.cache_.media=xe(e);var r=this.cache_.media,n=r.poster,a=r.src,s=r.textTracks;!r.artwork&&n&&(this.cache_.media.artwork=[{src:n,type:Xi(n)}]),a&&this.src(a),n&&this.poster(n),Array.isArray(s)&&s.forEach((function(e){return i.addRemoteTextTrack(e,!1)})),this.ready(t)}},o.getMedia=function(){if(this.cache_.media)return xe(this.cache_.media);var e=this.poster(),t={src:this.currentSources(),textTracks:Array.prototype.map.call(this.remoteTextTracks(),(function(e){return{kind:e.kind,label:e.label,language:e.language,src:e.src}}))};return e&&(t.poster=e,t.artwork=[{src:t.poster,type:Xi(t.poster)}]),t},s.getTagSettings=function(e){var t={sources:[],tracks:[]},i=R(e),r=i["data-setup"];if(w(e,"vjs-fill")&&(i.fill=!0),w(e,"vjs-fluid")&&(i.fluid=!0),null!==r){var a=function(e,t){var i,r=null;try{i=JSON.parse(e,void 0)}catch(e){r=e}return[r,i]}(r||"{}"),s=a[0],o=a[1];s&&n.error(s),h(i,o)}if(h(t,i),e.hasChildNodes())for(var u=e.childNodes,l=0,c=u.length;l<c;l++){var d=u[l],f=d.nodeName.toLowerCase();"source"===f?t.sources.push(R(d)):"track"===f&&t.tracks.push(R(d))}return t},o.flexNotSupported_=function(){var e=t.createElement("i");return!("flexBasis"in e.style||"webkitFlexBasis"in e.style||"mozFlexBasis"in e.style||"msFlexBasis"in e.style||"msFlexOrder"in e.style)},o.debug=function(e){if(void 0===e)return this.debugEnabled_;e?(this.trigger("debugon"),this.previousLogLevel_=this.log.level,this.log.level("debug"),this.debugEnabled_=!0):(this.trigger("debugoff"),this.log.level(this.previousLogLevel_),this.previousLogLevel_=void 0,this.debugEnabled_=!1)},s}(Fe);li.names.forEach((function(e){var t=li[e];Bn.prototype[t.getterName]=function(){return this.tech_?this.tech_[t.getterName]():(this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName])}})),Bn.prototype.crossorigin=Bn.prototype.crossOrigin,Bn.players={};var jn=e.navigator;Bn.prototype.options_={techOrder:ji.defaultTechOrder_,html5:{},flash:{},inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:jn&&(jn.languages&&jn.languages[0]||jn.userLanguage||jn.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1},["ended","seeking","seekable","networkState","readyState"].forEach((function(e){Bn.prototype[e]=function(){return this.techGet_(e)}})),Pn.forEach((function(e){Bn.prototype["handleTech"+Oe(e)+"_"]=function(){return this.trigger(e)}})),Fe.registerComponent("Player",Bn);var Vn=o((function(e){function t(i,r){return e.exports=t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t(i,r)}e.exports=t}));function Hn(e){return $n.hasOwnProperty(e)}function Gn(e){return Hn(e)?$n[e]:void 0}function qn(e,t){e[Qn]=e[Qn]||{},e[Qn][t]=!0}function Kn(e,t,i){var r=(i?"before":"")+"pluginsetup";e.trigger(r,t),e.trigger(r+":"+t.name,t)}function Wn(e,t){return t.prototype.name=e,function(){Kn(this,{name:e,plugin:t,instance:null},!0);for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];var a=Yn(t,[this].concat(r));return this[e]=function(){return a},Kn(this,a.getEventHash()),a}}var zn=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(na){return!1}},Yn=o((function(e){function t(i,r,n){return e.exports=t=zn()?Reflect.construct:function(e,t,i){var r=[null];r.push.apply(r,t);var n=new(Function.bind.apply(e,r));return i&&Vn(n,i.prototype),n},t.apply(null,arguments)}e.exports=t})),Xn="plugin",Qn="activePlugins_",$n={},Jn=function(){function e(t){if(this.constructor===e)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=t,this.log||(this.log=this.player.log.createLogger(this.name)),Le(this),delete this.trigger,Re(this,this.constructor.defaultState),qn(t,this.name),this.dispose=ge(this,this.dispose),t.on("dispose",this.dispose)}var t=e.prototype;return t.version=function(){return this.constructor.VERSION},t.getEventHash=function(e){return void 0===e&&(e={}),e.name=this.name,e.plugin=this.constructor,e.instance=this,e},t.trigger=function(e,t){return void 0===t&&(t={}),he(this.eventBusEl_,e,this.getEventHash(t))},t.handleStateChanged=function(e){},t.dispose=function(){var e=this.name,t=this.player;this.trigger("dispose"),this.off(),t.off("dispose",this.dispose),t[Qn][e]=!1,this.player=this.state=null,t[e]=Wn(e,$n[e])},e.isBasic=function(t){var i="string"==typeof t?Gn(t):t;return"function"==typeof i&&!e.prototype.isPrototypeOf(i.prototype)},e.registerPlugin=function(t,i){if("string"!=typeof t)throw new Error('Illegal plugin name, "'+t+'", must be a string, was '+typeof t+".");if(Hn(t))n.warn('A plugin named "'+t+'" already exists. You may want to avoid re-registering plugins!');else if(Bn.prototype.hasOwnProperty(t))throw new Error('Illegal plugin name, "'+t+'", cannot share a name with an existing player method!');if("function"!=typeof i)throw new Error('Illegal plugin for "'+t+'", must be a function, was '+typeof i+".");return $n[t]=i,t!==Xn&&(Bn.prototype[t]=e.isBasic(i)?function(e,t){function i(){Kn(this,{name:e,plugin:t,instance:null},!0);var i=t.apply(this,arguments);return qn(this,e),Kn(this,{name:e,plugin:t,instance:i}),i}return Object.keys(t).forEach((function(e){i[e]=t[e]})),i}(t,i):Wn(t,i)),i},e.deregisterPlugin=function(e){if(e===Xn)throw new Error("Cannot de-register base plugin.");Hn(e)&&(delete $n[e],delete Bn.prototype[e])},e.getPlugins=function(e){var t;return void 0===e&&(e=Object.keys($n)),e.forEach((function(e){var i=Gn(e);i&&((t=t||{})[e]=i)})),t},e.getPluginVersion=function(e){var t=Gn(e);return t&&t.VERSION||""},e}();Jn.getPlugin=Gn,Jn.BASE_PLUGIN_NAME=Xn,Jn.registerPlugin(Xn,Jn),Bn.prototype.usingPlugin=function(e){return!!this[Qn]&&!0===this[Qn][e]},Bn.prototype.hasPlugin=function(e){return!!Hn(e)};var Zn=function(e){return 0===e.indexOf("#")?e.slice(1):e};function ea(e,t,i){var r=ea.getPlayer(e);if(r)return t&&n.warn('Player "'+e+'" is already initialised. Options will not be applied.'),i&&r.ready(i),r;var a="string"==typeof e?W("#"+Zn(e)):e;if(!_(a))throw new TypeError("The element or ID supplied is not valid. (videojs)");a.ownerDocument.defaultView&&a.ownerDocument.body.contains(a)||n.warn("The element supplied is not included in the DOM"),t=t||{},ea.hooks("beforesetup").forEach((function(e){var i=e(a,xe(t));f(i)&&!Array.isArray(i)?t=xe(t,i):n.error("please return an object in beforesetup hooks")}));var s=Fe.getComponent("Player");return r=new s(a,t,i),ea.hooks("setup").forEach((function(e){return e(r)})),r}if(ea.hooks_={},ea.hooks=function(e,t){return ea.hooks_[e]=ea.hooks_[e]||[],t&&(ea.hooks_[e]=ea.hooks_[e].concat(t)),ea.hooks_[e]},ea.hook=function(e,t){ea.hooks(e,t)},ea.hookOnce=function(e,t){ea.hooks(e,[].concat(t).map((function(t){return function i(){return ea.removeHook(e,i),t.apply(void 0,arguments)}})))},ea.removeHook=function(e,t){var i=ea.hooks(e).indexOf(t);return!(i<=-1||(ea.hooks_[e]=ea.hooks_[e].slice(),ea.hooks_[e].splice(i,1),0))},!0!==e.VIDEOJS_NO_DYNAMIC_STYLE&&y()){var ta=W(".vjs-styles-defaults");if(!ta){ta=Z("vjs-styles-defaults");var ia=W("head");ia&&ia.insertBefore(ta,ia.firstChild),ee(ta,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ")}}function ra(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}$(1,ea),ea.VERSION=i,ea.options=Bn.prototype.options_,ea.getPlayers=function(){return Bn.players},ea.getPlayer=function(e){var t,i=Bn.players;if("string"==typeof e){var r=Zn(e),n=i[r];if(n)return n;t=W("#"+r)}else t=e;if(_(t)){var a=t.player,s=t.playerId;if(a||i[s])return a||i[s]}},ea.getAllPlayers=function(){return Object.keys(Bn.players).map((function(e){return Bn.players[e]})).filter(Boolean)},ea.players=Bn.players,ea.getComponent=Fe.getComponent,ea.registerComponent=function(e,t){ji.isTech(t)&&n.warn("The "+e+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"),Fe.registerComponent.call(Fe,e,t)},ea.getTech=ji.getTech,ea.registerTech=ji.registerTech,ea.use=function(e,t){Vi[e]=Vi[e]||[],Vi[e].push(t)},Object.defineProperty(ea,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(ea.middleware,"TERMINATOR",{value:Gi,writeable:!1,enumerable:!0}),ea.browser=dt,ea.TOUCH_ENABLED=st,ea.extend=function(e,t){void 0===t&&(t={});var i=function(){e.apply(this,arguments)},r={};for(var n in"object"==typeof t?(t.constructor!==Object.prototype.constructor&&(i=t.constructor),r=t):"function"==typeof t&&(i=t),function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vn(e,t)}(i,e),e&&(i.super_=e),r)r.hasOwnProperty(n)&&(i.prototype[n]=r[n]);return i},ea.mergeOptions=xe,ea.bind=ge,ea.registerPlugin=Jn.registerPlugin,ea.deregisterPlugin=Jn.deregisterPlugin,ea.plugin=function(e,t){return n.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),Jn.registerPlugin(e,t)},ea.getPlugins=Jn.getPlugins,ea.getPlugin=Jn.getPlugin,ea.getPluginVersion=Jn.getPluginVersion,ea.addLanguage=function(e,t){var i;return e=(""+e).toLowerCase(),(ea.options.languages=xe(ea.options.languages,((i={})[e]=t,i)))[e]},ea.log=n,ea.createLogger=a,ea.createTimeRange=ea.createTimeRanges=pt,ea.formatTime=fr,ea.setFormatTime=function(e){hr=e},ea.resetFormatTime=function(){hr=dr},ea.parseUrl=Pt,ea.isCrossOrigin=Ut,ea.EventTarget=ve,ea.on=ce,ea.one=fe,ea.off=de,ea.trigger=he,ea.xhr=Qt,ea.TextTrack=ri,ea.AudioTrack=ni,ea.VideoTrack=ai,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach((function(e){ea[e]=function(){return n.warn("videojs."+e+"() is deprecated; use videojs.dom."+e+"() instead"),Y[e].apply(null,arguments)}})),ea.computedStyle=g,ea.dom=Y,ea.url=Yt,ea.defineLazyProperty=In;var na,aa=ra(o((function(e,t){var i,r,n,a,s;i=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,r=/^([^\/?#]*)(.*)$/,n=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,s={buildAbsoluteURL:function(e,t,i){if(i=i||{},e=e.trim(),!(t=t.trim())){if(!i.alwaysNormalize)return e;var n=s.parseURL(e);if(!n)throw new Error("Error trying to parse base URL.");return n.path=s.normalizePath(n.path),s.buildURLFromParts(n)}var a=s.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return i.alwaysNormalize?(a.path=s.normalizePath(a.path),s.buildURLFromParts(a)):t;var o=s.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var u=r.exec(o.path);o.netLoc=u[1],o.path=u[2]}o.netLoc&&!o.path&&(o.path="/");var l={scheme:o.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(l.netLoc=o.netLoc,"/"!==a.path[0]))if(a.path){var c=o.path,d=c.substring(0,c.lastIndexOf("/")+1)+a.path;l.path=s.normalizePath(d)}else l.path=o.path,a.params||(l.params=o.params,a.query||(l.query=o.query));return null===l.path&&(l.path=i.alwaysNormalize?s.normalizePath(a.path):a.path),s.buildURLFromParts(l)},parseURL:function(e){var t=i.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(n,"");e.length!==(e=e.replace(a,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=s}))),sa=ra(e),oa=function(e,t){return/^[a-z]+:/i.test(t)?t:(/\/\//i.test(e)||(e=aa.default.buildAbsoluteURL(sa.default.location&&sa.default.location.href||"",e)),aa.default.buildAbsoluteURL(e,t))},ua=function(){function e(){this.listeners={}}var t=e.prototype;return t.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},t.off=function(e,t){if(!this.listeners[e])return!1;var i=this.listeners[e].indexOf(t);return this.listeners[e]=this.listeners[e].slice(0),this.listeners[e].splice(i,1),-1<i},t.trigger=function(e,t){var i=this.listeners[e];if(i)if(2===arguments.length)for(var r=i.length,n=0;n<r;++n)i[n].call(this,t);else for(var a=Array.prototype.slice.call(arguments,1),s=i.length,o=0;o<s;++o)i[o].apply(this,a)},t.dispose=function(){this.listeners={}},t.pipe=function(e){this.on("data",(function(t){e.push(t)}))},e}(),la=(na=e)&&"object"==typeof na&&"default"in na?na:{default:na};function ca(e){for(var t,i=e.split(new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))')),r={},n=i.length;n--;)""!==i[n]&&((t=/([^=]*)=(.*)/.exec(i[n]).slice(1))[0]=t[0].replace(/^\s+|\s+$/g,""),t[1]=t[1].replace(/^\s+|\s+$/g,""),t[1]=t[1].replace(/^['"](.*)['"]$/g,"$1"),r[t[0]]=t[1]);return r}var da=function(e){for(var t=function(e){return la.default.atob?la.default.atob(e):Buffer.from(e,"base64").toString("binary")}(e),i=new Uint8Array(t.length),r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i},ha=function(e){function t(){var t;return(t=e.call(this)||this).buffer="",t}return qe(t,e),t.prototype.push=function(e){var t;for(this.buffer+=e,t=this.buffer.indexOf("\n");-1<t;t=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)},t}(ua),fa=function(e){function t(){var t;return(t=e.call(this)||this).customParsers=[],t.tagMappers=[],t}qe(t,e);var i=t.prototype;return i.push=function(e){var t,i,r=this;0!==(e=e.trim()).length&&("#"===e[0]?this.tagMappers.reduce((function(t,i){var r=i(e);return r===e?t:t.concat([r])}),[e]).forEach((function(e){for(var n=0;n<r.customParsers.length;n++)if(r.customParsers[n].call(r,e))return;if(0===e.indexOf("#EXT"))if(e=e.replace("\r",""),t=/^#EXTM3U/.exec(e))r.trigger("data",{type:"tag",tagType:"m3u"});else{if(t=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(e))return i={type:"tag",tagType:"inf"},t[1]&&(i.duration=parseFloat(t[1])),t[2]&&(i.title=t[2]),void r.trigger("data",i);if(t=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(e))return i={type:"tag",tagType:"targetduration"},t[1]&&(i.duration=parseInt(t[1],10)),void r.trigger("data",i);if(t=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(e))return i={type:"tag",tagType:"totalduration"},t[1]&&(i.duration=parseInt(t[1],10)),void r.trigger("data",i);if(t=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(e))return i={type:"tag",tagType:"version"},t[1]&&(i.version=parseInt(t[1],10)),void r.trigger("data",i);if(t=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))return i={type:"tag",tagType:"media-sequence"},t[1]&&(i.number=parseInt(t[1],10)),void r.trigger("data",i);if(t=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))return i={type:"tag",tagType:"discontinuity-sequence"},t[1]&&(i.number=parseInt(t[1],10)),void r.trigger("data",i);if(t=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(e))return i={type:"tag",tagType:"playlist-type"},t[1]&&(i.playlistType=t[1]),void r.trigger("data",i);if(t=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(e))return i={type:"tag",tagType:"byterange"},t[1]&&(i.length=parseInt(t[1],10)),t[2]&&(i.offset=parseInt(t[2],10)),void r.trigger("data",i);if(t=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(e))return i={type:"tag",tagType:"allow-cache"},t[1]&&(i.allowed=!/NO/.test(t[1])),void r.trigger("data",i);if(t=/^#EXT-X-MAP:?(.*)$/.exec(e)){if(i={type:"tag",tagType:"map"},t[1]){var a=ca(t[1]);if(a.URI&&(i.uri=a.URI),a.BYTERANGE){var s=a.BYTERANGE.split("@"),o=s[0],u=s[1];i.byterange={},o&&(i.byterange.length=parseInt(o,10)),u&&(i.byterange.offset=parseInt(u,10))}}r.trigger("data",i)}else if(t=/^#EXT-X-STREAM-INF:?(.*)$/.exec(e)){if(i={type:"tag",tagType:"stream-inf"},t[1]){if(i.attributes=ca(t[1]),i.attributes.RESOLUTION){var l=i.attributes.RESOLUTION.split("x"),c={};l[0]&&(c.width=parseInt(l[0],10)),l[1]&&(c.height=parseInt(l[1],10)),i.attributes.RESOLUTION=c}i.attributes.BANDWIDTH&&(i.attributes.BANDWIDTH=parseInt(i.attributes.BANDWIDTH,10)),i.attributes["PROGRAM-ID"]&&(i.attributes["PROGRAM-ID"]=parseInt(i.attributes["PROGRAM-ID"],10))}r.trigger("data",i)}else{if(t=/^#EXT-X-MEDIA:?(.*)$/.exec(e))return i={type:"tag",tagType:"media"},t[1]&&(i.attributes=ca(t[1])),void r.trigger("data",i);if(t=/^#EXT-X-ENDLIST/.exec(e))r.trigger("data",{type:"tag",tagType:"endlist"});else if(t=/^#EXT-X-DISCONTINUITY/.exec(e))r.trigger("data",{type:"tag",tagType:"discontinuity"});else{if(t=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(e))return i={type:"tag",tagType:"program-date-time"},t[1]&&(i.dateTimeString=t[1],i.dateTimeObject=new Date(t[1])),void r.trigger("data",i);if(t=/^#EXT-X-KEY:?(.*)$/.exec(e))return i={type:"tag",tagType:"key"},t[1]&&(i.attributes=ca(t[1]),i.attributes.IV&&("0x"===i.attributes.IV.substring(0,2).toLowerCase()&&(i.attributes.IV=i.attributes.IV.substring(2)),i.attributes.IV=i.attributes.IV.match(/.{8}/g),i.attributes.IV[0]=parseInt(i.attributes.IV[0],16),i.attributes.IV[1]=parseInt(i.attributes.IV[1],16),i.attributes.IV[2]=parseInt(i.attributes.IV[2],16),i.attributes.IV[3]=parseInt(i.attributes.IV[3],16),i.attributes.IV=new Uint32Array(i.attributes.IV))),void r.trigger("data",i);if(t=/^#EXT-X-START:?(.*)$/.exec(e))return i={type:"tag",tagType:"start"},t[1]&&(i.attributes=ca(t[1]),i.attributes["TIME-OFFSET"]=parseFloat(i.attributes["TIME-OFFSET"]),i.attributes.PRECISE=/YES/.test(i.attributes.PRECISE)),void r.trigger("data",i);if(t=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(e))return(i={type:"tag",tagType:"cue-out-cont"}).data=t[1]?t[1]:"",void r.trigger("data",i);if(t=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(e))return(i={type:"tag",tagType:"cue-out"}).data=t[1]?t[1]:"",void r.trigger("data",i);if(t=/^#EXT-X-CUE-IN:?(.*)?$/.exec(e))return(i={type:"tag",tagType:"cue-in"}).data=t[1]?t[1]:"",void r.trigger("data",i);r.trigger("data",{type:"tag",data:e.slice(4)})}}}else r.trigger("data",{type:"comment",text:e.slice(1)})})):this.trigger("data",{type:"uri",uri:e}))},i.addParser=function(e){var t=this,i=e.expression,r=e.customType,n=e.dataParser,a=e.segment;"function"!=typeof n&&(n=function(e){return e}),this.customParsers.push((function(e){if(i.exec(e))return t.trigger("data",{type:"custom",data:n(e),customType:r,segment:a}),!0}))},i.addTagMapper=function(e){var t=e.expression,i=e.map;this.tagMappers.push((function(e){return t.test(e)?i(e):e}))},t}(ua),pa=function(e){function t(){var t;(t=e.call(this)||this).lineStream=new ha,t.parseStream=new fa,t.lineStream.pipe(t.parseStream);var i,r,n=Be(t),a=[],s={},o={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},l=0;t.manifest={allowCache:!0,discontinuityStarts:[],segments:[]};var c=0;return t.parseStream.on("data",(function(e){var t,d;({tag:function(){({"allow-cache":function(){this.manifest.allowCache=e.allowed,"allowed"in e||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var t={};"length"in e&&((s.byterange=t).length=e.length,"offset"in e||(e.offset=c)),"offset"in e&&((s.byterange=t).offset=e.offset),c=t.offset+t.length},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),0<e.duration&&(s.duration=e.duration),0===e.duration&&(s.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=a},key:function(){if(e.attributes)if("NONE"!==e.attributes.METHOD)if(e.attributes.URI){if("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===e.attributes.KEYFORMAT)return-1===["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(e.attributes.METHOD)?void this.trigger("warn",{message:"invalid key method provided for Widevine"}):("SAMPLE-AES-CENC"===e.attributes.METHOD&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),"data:text/plain;base64,"!==e.attributes.URI.substring(0,23)?void this.trigger("warn",{message:"invalid key URI provided for Widevine"}):e.attributes.KEYID&&"0x"===e.attributes.KEYID.substring(0,2)?void(this.manifest.contentProtection={"com.widevine.alpha":{attributes:{schemeIdUri:e.attributes.KEYFORMAT,keyId:e.attributes.KEYID.substring(2)},pssh:da(e.attributes.URI.split(",")[1])}}):void this.trigger("warn",{message:"invalid key ID provided for Widevine"}));e.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),r={method:e.attributes.METHOD||"AES-128",uri:e.attributes.URI},void 0!==e.attributes.IV&&(r.iv=e.attributes.IV)}else this.trigger("warn",{message:"ignoring key declaration without URI"});else r=null;else this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){isFinite(e.number)?this.manifest.mediaSequence=e.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+e.number})},"discontinuity-sequence":function(){isFinite(e.number)?(this.manifest.discontinuitySequence=e.number,l=e.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+e.number})},"playlist-type":function(){/VOD|EVENT/.test(e.playlistType)?this.manifest.playlistType=e.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+e.playlist})},map:function(){i={},e.uri&&(i.uri=e.uri),e.byterange&&(i.byterange=e.byterange)},"stream-inf":function(){this.manifest.playlists=a,this.manifest.mediaGroups=this.manifest.mediaGroups||o,e.attributes?(s.attributes||(s.attributes={}),u(s.attributes,e.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||o,e.attributes&&e.attributes.TYPE&&e.attributes["GROUP-ID"]&&e.attributes.NAME){var i=this.manifest.mediaGroups[e.attributes.TYPE];i[e.attributes["GROUP-ID"]]=i[e.attributes["GROUP-ID"]]||{},t=i[e.attributes["GROUP-ID"]],d.autoselect=!!(d={default:/yes/i.test(e.attributes.DEFAULT)}).default||/yes/i.test(e.attributes.AUTOSELECT),e.attributes.LANGUAGE&&(d.language=e.attributes.LANGUAGE),e.attributes.URI&&(d.uri=e.attributes.URI),e.attributes["INSTREAM-ID"]&&(d.instreamId=e.attributes["INSTREAM-ID"]),e.attributes.CHARACTERISTICS&&(d.characteristics=e.attributes.CHARACTERISTICS),e.attributes.FORCED&&(d.forced=/yes/i.test(e.attributes.FORCED)),t[e.attributes.NAME]=d}else this.trigger("warn",{message:"ignoring incomplete or missing media group"})},discontinuity:function(){l+=1,s.discontinuity=!0,this.manifest.discontinuityStarts.push(a.length)},"program-date-time":function(){void 0===this.manifest.dateTimeString&&(this.manifest.dateTimeString=e.dateTimeString,this.manifest.dateTimeObject=e.dateTimeObject),s.dateTimeString=e.dateTimeString,s.dateTimeObject=e.dateTimeObject},targetduration:function(){!isFinite(e.duration)||e.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+e.duration}):this.manifest.targetDuration=e.duration},totalduration:function(){!isFinite(e.duration)||e.duration<0?this.trigger("warn",{message:"ignoring invalid total duration: "+e.duration}):this.manifest.totalDuration=e.duration},start:function(){e.attributes&&!isNaN(e.attributes["TIME-OFFSET"])?this.manifest.start={timeOffset:e.attributes["TIME-OFFSET"],precise:e.attributes.PRECISE}:this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"})},"cue-out":function(){s.cueOut=e.data},"cue-out-cont":function(){s.cueOutCont=e.data},"cue-in":function(){s.cueIn=e.data}}[e.tagType]||function(){}).call(n)},uri:function(){s.uri=e.uri,a.push(s),!this.manifest.targetDuration||"duration"in s||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),s.duration=this.manifest.targetDuration),r&&(s.key=r),s.timeline=l,i&&(s.map=i),s={}},comment:function(){},custom:function(){e.segment?(s.custom=s.custom||{},s.custom[e.customType]=e.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[e.customType]=e.data)}})[e.type].call(n)})),t}qe(t,e);var i=t.prototype;return i.push=function(e){this.lineStream.push(e)},i.end=function(){this.lineStream.push("\n")},i.addParser=function(e){this.parseStream.addParser(e)},i.addTagMapper=function(e){this.parseStream.addTagMapper(e)},t}(ua),ga=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i,r=/^application\/dash\+xml/i;t.simpleTypeFromSourceType=function(e){return i.test(e)?"hls":r.test(e)?"dash":"application/vnd.videojs.vhs+json"===e?"vhs-json":null}}));s(ga);var ma=ga.simpleTypeFromSourceType,va=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,ya=new RegExp("[\\-\\.0-9"+va.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),_a=new RegExp("^"+va.source+ya.source+"*(?::"+va.source+ya.source+"*)?$");function ba(){}function Ta(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function Sa(e,t,i,r,n,a){for(var s,o=++t,u=0;;){var l=e.charAt(o);switch(l){case"=":if(1===u)s=e.slice(t,o),u=3;else{if(2!==u)throw new Error("attribute equal must after attrName");u=3}break;case"'":case'"':if(3===u||1===u){if(1===u&&(a.warning('attribute value must after "="'),s=e.slice(t,o)),!(0<(o=e.indexOf(l,t=o+1))))throw new Error("attribute value no end '"+l+"' match");c=e.slice(t,o).replace(/&#?\w+;/g,n),i.add(s,c,t-1),u=5}else{if(4!=u)throw new Error('attribute value must after "="');c=e.slice(t,o).replace(/&#?\w+;/g,n),i.add(s,c,t),a.warning('attribute "'+s+'" missed start quot('+l+")!!"),t=o+1,u=5}break;case"/":switch(u){case 0:i.setTagName(e.slice(t,o));case 5:case 6:case 7:u=7,i.closed=!0;case 4:case 1:case 2:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return a.error("unexpected end of input"),0==u&&i.setTagName(e.slice(t,o)),o;case">":switch(u){case 0:i.setTagName(e.slice(t,o));case 5:case 6:case 7:break;case 4:case 1:"/"===(c=e.slice(t,o)).slice(-1)&&(i.closed=!0,c=c.slice(0,-1));case 2:2===u&&(c=s),4==u?(a.warning('attribute "'+c+'" missed quot(")!!'),i.add(s,c.replace(/&#?\w+;/g,n),t)):("http://www.w3.org/1999/xhtml"===r[""]&&c.match(/^(?:disabled|checked|selected)$/i)||a.warning('attribute "'+c+'" missed value!! "'+c+'" instead!!'),i.add(c,c,t));break;case 3:throw new Error("attribute value missed!!")}return o;case"":l=" ";default:if(l<=" ")switch(u){case 0:i.setTagName(e.slice(t,o)),u=6;break;case 1:s=e.slice(t,o),u=2;break;case 4:var c=e.slice(t,o).replace(/&#?\w+;/g,n);a.warning('attribute "'+c+'" missed quot(")!!'),i.add(s,c,t);case 5:u=6}else switch(u){case 2:"http://www.w3.org/1999/xhtml"===r[""]&&s.match(/^(?:disabled|checked|selected)$/i)||a.warning('attribute "'+s+'" missed value!! "'+s+'" instead2!!'),i.add(s,s,t),t=o,u=1;break;case 5:a.warning('attribute space is required"'+s+'"!!');case 6:u=1,t=o;break;case 3:u=4,t=o;break;case 7:throw new Error("elements closed character '/' and '>' must be connected to")}}o++}}function Ea(e,t,i){for(var r=e.tagName,n=null,a=e.length;a--;){var s=e[a],o=s.qName,u=s.value;if(0<(h=o.indexOf(":")))var l=s.prefix=o.slice(0,h),c=o.slice(h+1),d="xmlns"===l&&c;else l=null,d="xmlns"===(c=o)&&"";s.localName=c,!1!==d&&(null==n&&(n={},Ca(i,i={})),i[d]=n[d]=u,s.uri="http://www.w3.org/2000/xmlns/",t.startPrefixMapping(d,u))}for(a=e.length;a--;)(l=(s=e[a]).prefix)&&("xml"===l&&(s.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==l&&(s.uri=i[l||""]));var h;c=0<(h=r.indexOf(":"))?(l=e.prefix=r.slice(0,h),e.localName=r.slice(h+1)):(l=null,e.localName=r);var f=e.uri=i[l||""];if(t.startElement(f,c,r,e),!e.closed)return e.currentNSMap=i,e.localNSMap=n,!0;if(t.endElement(f,c,r),n)for(l in n)t.endPrefixMapping(l)}function ka(e,t,i,r,n){if(/^(?:script|textarea)$/i.test(i)){var a=e.indexOf("</"+i+">",t),s=e.substring(t+1,a);if(/[&<]/.test(s))return/^script$/i.test(i)||(s=s.replace(/&#?\w+;/g,r)),n.characters(s,0,s.length),a}return t+1}function wa(e,t,i,r){var n=r[i];return null==n&&((n=e.lastIndexOf("</"+i+">"))<t&&(n=e.lastIndexOf("</"+i)),r[i]=n),n<t}function Ca(e,t){for(var i in e)t[i]=e[i]}function Aa(e,t,i,r){switch(e.charAt(t+2)){case"-":return"-"!==e.charAt(t+3)?-1:t<(n=e.indexOf("--\x3e",t+4))?(i.comment(e,t+4,n-t-4),n+3):(r.error("Unclosed comment"),-1);default:if("CDATA["==e.substr(t+3,6)){var n=e.indexOf("]]>",t+9);return i.startCDATA(),i.characters(e,t+9,n-t-9),i.endCDATA(),n+3}var a=function(e,t){var i,r=[],n=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(n.lastIndex=t,n.exec(e);i=n.exec(e);)if(r.push(i),i[1])return r}(e,t),s=a.length;if(1<s&&/!doctype/i.test(a[0][0])){var o=a[1][0],u=3<s&&/^public$/i.test(a[2][0])&&a[3][0],l=4<s&&a[4][0],c=a[s-1];return i.startDTD(o,u&&u.replace(/^(['"])(.*?)\1$/,"$2"),l&&l.replace(/^(['"])(.*?)\1$/,"$2")),i.endDTD(),c.index+c[0].length}}return-1}function La(e,t,i){var r=e.indexOf("?>",t);if(r){var n=e.substring(t,r).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return n?(i.processingInstruction(n[1],n[2]),r+2):-1}return-1}function Ia(e){}function Ra(e,t){return e.__proto__=t,e}ba.prototype={parse:function(e,t,i){var r=this.domBuilder;r.startDocument(),Ca(t,t={}),function(e,t,i,r,n){function a(e){var t=e.slice(1,-1);return t in i?i[t]:"#"===t.charAt(0)?function(e){if(65535<e){var t=55296+((e-=65536)>>10);return String.fromCharCode(t,56320+(1023&e))}return String.fromCharCode(e)}(parseInt(t.substr(1).replace("x","0x"))):(n.error("entity not found:"+e),e)}function s(t){if(p<t){var i=e.substring(p,t).replace(/&#?\w+;/g,a);d&&o(p),r.characters(i,0,t-p),p=t}}function o(t,i){for(;l<=t&&(i=c.exec(e));)l=(u=i.index)+i[0].length,d.lineNumber++;d.columnNumber=t-u+1}for(var u=0,l=0,c=/.*(?:\r\n?|\n)|.*$/g,d=r.locator,h=[{currentNSMap:t}],f={},p=0;;){try{var g=e.indexOf("<",p);if(g<0){if(!e.substr(p).match(/^\s*$/)){var m=r.doc,v=m.createTextNode(e.substr(p));m.appendChild(v),r.currentElement=v}return}switch(p<g&&s(g),e.charAt(g+1)){case"/":var y=e.indexOf(">",g+3),_=e.substring(g+2,y),b=h.pop();y<0?(_=e.substring(g+2).replace(/[\s<].*/,""),n.error("end tag name: "+_+" is not complete:"+b.tagName),y=g+1+_.length):_.match(/\s</)&&(_=_.replace(/[\s<].*/,""),n.error("end tag name: "+_+" maybe not complete"),y=g+1+_.length);var T=b.localNSMap,S=b.tagName==_;if(S||b.tagName&&b.tagName.toLowerCase()==_.toLowerCase()){if(r.endElement(b.uri,b.localName,_),T)for(var E in T)r.endPrefixMapping(E);S||n.fatalError("end tag name: "+_+" is not match the current start tagName:"+b.tagName)}else h.push(b);y++;break;case"?":d&&o(g),y=La(e,g,r);break;case"!":d&&o(g),y=Aa(e,g,r,n);break;default:d&&o(g);var k=new Ia,w=h[h.length-1].currentNSMap,C=(y=Sa(e,g,k,w,a,n),k.length);if(!k.closed&&wa(e,y,k.tagName,f)&&(k.closed=!0,i.nbsp||n.warning("unclosed xml attribute")),d&&C){for(var A=Ta(d,{}),L=0;L<C;L++){var I=k[L];o(I.offset),I.locator=Ta(d,{})}r.locator=A,Ea(k,r,w)&&h.push(k),r.locator=d}else Ea(k,r,w)&&h.push(k);"http://www.w3.org/1999/xhtml"!==k.uri||k.closed?y++:y=ka(e,y,k.tagName,a,r)}}catch(t){n.error("element parse error: "+t),y=-1}p<y?p=y:s(Math.max(g,p)+1)}}(e,t,i,r,this.errorHandler),r.endDocument()}},Ia.prototype={setTagName:function(e){if(!_a.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},add:function(e,t,i){if(!_a.test(e))throw new Error("invalid attribute:"+e);this[this.length++]={qName:e,value:t,offset:i}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},Ra({},Ra.prototype)instanceof Ra||(Ra=function(e,t){function i(){}for(t in i.prototype=t,i=new i,e)i[t]=e[t];return i});var Da=ba;function Oa(e,t){for(var i in e)t[i]=e[i]}function xa(e,t){var i=e.prototype;if(Object.create){var r=Object.create(t.prototype);i.__proto__=r}if(!(i instanceof t)){var n=function(){};n.prototype=t.prototype,Oa(i,n=new n),e.prototype=i=n}i.constructor!=e&&(i.constructor=e)}var Pa={},Ma=Pa.ELEMENT_NODE=1,Na=Pa.ATTRIBUTE_NODE=2,Ua=Pa.TEXT_NODE=3,Fa=Pa.CDATA_SECTION_NODE=4,Ba=Pa.ENTITY_REFERENCE_NODE=5,ja=Pa.ENTITY_NODE=6,Va=Pa.PROCESSING_INSTRUCTION_NODE=7,Ha=Pa.COMMENT_NODE=8,Ga=Pa.DOCUMENT_NODE=9,qa=Pa.DOCUMENT_TYPE_NODE=10,Ka=Pa.DOCUMENT_FRAGMENT_NODE=11,Wa=Pa.NOTATION_NODE=12,za={},Ya={},Xa=(za.INDEX_SIZE_ERR=(Ya[1]="Index size error",1),za.DOMSTRING_SIZE_ERR=(Ya[2]="DOMString size error",2),za.HIERARCHY_REQUEST_ERR=(Ya[3]="Hierarchy request error",3)),Qa=(za.WRONG_DOCUMENT_ERR=(Ya[4]="Wrong document",4),za.INVALID_CHARACTER_ERR=(Ya[5]="Invalid character",5),za.NO_DATA_ALLOWED_ERR=(Ya[6]="No data allowed",6),za.NO_MODIFICATION_ALLOWED_ERR=(Ya[7]="No modification allowed",7),za.NOT_FOUND_ERR=(Ya[8]="Not found",8)),$a=(za.NOT_SUPPORTED_ERR=(Ya[9]="Not supported",9),za.INUSE_ATTRIBUTE_ERR=(Ya[10]="Attribute in use",10));function Ja(e,t){if(t instanceof Error)var i=t;else i=this,Error.call(this,Ya[e]),this.message=Ya[e],Error.captureStackTrace&&Error.captureStackTrace(this,Ja);return i.code=e,t&&(this.message=this.message+": "+t),i}function Za(){}function es(e,t){this._node=e,this._refresh=t,ts(this)}function ts(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!=t){var i=e._refresh(e._node);Ds(e,"length",i.length),Oa(i,e),e._inc=t}}function is(){}function rs(e,t){for(var i=e.length;i--;)if(e[i]===t)return i}function ns(e,t,i,r){if(r?t[rs(t,r)]=i:t[t.length++]=i,e){var n=(i.ownerElement=e).ownerDocument;n&&(r&&ds(n,e,r),function(e,t,i){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==i.namespaceURI&&(t._nsMap[i.prefix?i.localName:""]=i.value)}(n,e,i))}}function as(e,t,i){var r=rs(t,i);if(!(0<=r))throw Ja(Qa,new Error(e.tagName+"@"+i));for(var n=t.length-1;r<n;)t[r]=t[++r];if(t.length=n,e){var a=e.ownerDocument;a&&(ds(a,e,i),i.ownerElement=null)}}function ss(e){if(this._features={},e)for(var t in e)this._features=e[t]}function os(){}function us(e){return("<"==e?"&lt;":">"==e&&"&gt;")||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function ls(e,t){if(t(e))return!0;if(e=e.firstChild)do{if(ls(e,t))return!0}while(e=e.nextSibling)}function cs(){}function ds(e,t,i){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==i.namespaceURI&&delete t._nsMap[i.prefix?i.localName:""]}function hs(e,t,i){if(e&&e._inc){e._inc++;var r=t.childNodes;if(i)r[r.length++]=i;else{for(var n=t.firstChild,a=0;n;)n=(r[a++]=n).nextSibling;r.length=a}}}function fs(e,t){var i=t.previousSibling,r=t.nextSibling;return i?i.nextSibling=r:e.firstChild=r,r?r.previousSibling=i:e.lastChild=i,hs(e.ownerDocument,e),t}function ps(e,t,i){var r=t.parentNode;if(r&&r.removeChild(t),t.nodeType===Ka){var n=t.firstChild;if(null==n)return t;var a=t.lastChild}else n=a=t;var s=i?i.previousSibling:e.lastChild;for(n.previousSibling=s,a.nextSibling=i,s?s.nextSibling=n:e.firstChild=n,null==i?e.lastChild=a:i.previousSibling=a;n.parentNode=e,n!==a&&(n=n.nextSibling););return hs(e.ownerDocument||e,e),t.nodeType==Ka&&(t.firstChild=t.lastChild=null),t}function gs(){this._nsMap={}}function ms(){}function vs(){}function ys(){}function _s(){}function bs(){}function Ts(){}function Ss(){}function Es(){}function ks(){}function ws(){}function Cs(){}function As(){}function Ls(e,t){var i=[],r=9==this.nodeType?this.documentElement:this,n=r.prefix,a=r.namespaceURI;if(a&&null==n&&null==(n=r.lookupPrefix(a)))var s=[{namespace:a,prefix:null}];return Rs(this,i,e,t,s),i.join("")}function Is(e,t,i){var r=e.prefix||"",n=e.namespaceURI;if(!r&&!n)return!1;if("xml"===r&&"http://www.w3.org/XML/1998/namespace"===n||"http://www.w3.org/2000/xmlns/"==n)return!1;for(var a=i.length;a--;){var s=i[a];if(s.prefix==r)return s.namespace!=n}return!0}function Rs(e,t,i,r,n){if(r){if(!(e=r(e)))return;if("string"==typeof e)return void t.push(e)}switch(e.nodeType){case Ma:n=n||[];var a=e.attributes,s=a.length,o=e.firstChild,u=e.tagName;i="http://www.w3.org/1999/xhtml"===e.namespaceURI||i,t.push("<",u);for(var l=0;l<s;l++)"xmlns"==(c=a.item(l)).prefix?n.push({prefix:c.localName,namespace:c.value}):"xmlns"==c.nodeName&&n.push({prefix:"",namespace:c.value});for(l=0;l<s;l++){var c;if(Is(c=a.item(l),0,n)){var d=c.prefix||"",h=c.namespaceURI,f=d?" xmlns:"+d:" xmlns";t.push(f,'="',h,'"'),n.push({prefix:d,namespace:h})}Rs(c,t,i,r,n)}if(Is(e,0,n)&&(t.push(f=(d=e.prefix||"")?" xmlns:"+d:" xmlns",'="',h=e.namespaceURI,'"'),n.push({prefix:d,namespace:h})),o||i&&!/^(?:meta|link|img|br|hr|input)$/i.test(u)){if(t.push(">"),i&&/^script$/i.test(u))for(;o;)o.data?t.push(o.data):Rs(o,t,i,r,n),o=o.nextSibling;else for(;o;)Rs(o,t,i,r,n),o=o.nextSibling;t.push("</",u,">")}else t.push("/>");return;case Ga:case Ka:for(o=e.firstChild;o;)Rs(o,t,i,r,n),o=o.nextSibling;return;case Na:return t.push(" ",e.name,'="',e.value.replace(/[<&"]/g,us),'"');case Ua:return t.push(e.data.replace(/[<&]/g,us));case Fa:return t.push("<![CDATA[",e.data,"]]>");case Ha:return t.push("\x3c!--",e.data,"--\x3e");case qa:var p=e.publicId,g=e.systemId;if(t.push("<!DOCTYPE ",e.name),p)t.push(' PUBLIC "',p),g&&"."!=g&&t.push('" "',g),t.push('">');else if(g&&"."!=g)t.push(' SYSTEM "',g,'">');else{var m=e.internalSubset;m&&t.push(" [",m,"]"),t.push(">")}return;case Va:return t.push("<?",e.target," ",e.data,"?>");case Ba:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function Ds(e,t,i){e[t]=i}za.INVALID_STATE_ERR=(Ya[11]="Invalid state",11),za.SYNTAX_ERR=(Ya[12]="Syntax error",12),za.INVALID_MODIFICATION_ERR=(Ya[13]="Invalid modification",13),za.NAMESPACE_ERR=(Ya[14]="Invalid namespace",14),za.INVALID_ACCESS_ERR=(Ya[15]="Invalid access",15),Ja.prototype=Error.prototype,Oa(za,Ja),Za.prototype={length:0,item:function(e){return this[e]||null},toString:function(e,t){for(var i=[],r=0;r<this.length;r++)Rs(this[r],i,e,t);return i.join("")}},es.prototype.item=function(e){return ts(this),this[e]},xa(es,Za),is.prototype={length:0,item:Za.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var i=this[t];if(i.nodeName==e)return i}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new Ja($a);var i=this.getNamedItem(e.nodeName);return ns(this._ownerElement,this,e,i),i},setNamedItemNS:function(e){var t,i=e.ownerElement;if(i&&i!=this._ownerElement)throw new Ja($a);return t=this.getNamedItemNS(e.namespaceURI,e.localName),ns(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var t=this.getNamedItem(e);return as(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var i=this.getNamedItemNS(e,t);return as(this._ownerElement,this,i),i},getNamedItemNS:function(e,t){for(var i=this.length;i--;){var r=this[i];if(r.localName==t&&r.namespaceURI==e)return r}return null}},ss.prototype={hasFeature:function(e,t){var i=this._features[e.toLowerCase()];return!(!i||t&&!(t in i))},createDocument:function(e,t,i){var r=new cs;if(r.implementation=this,r.childNodes=new Za,(r.doctype=i)&&r.appendChild(i),t){var n=r.createElementNS(e,t);r.appendChild(n)}return r},createDocumentType:function(e,t,i){var r=new Ts;return r.name=e,r.nodeName=e,r.publicId=t,r.systemId=i,r}},os.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return ps(this,e,t)},replaceChild:function(e,t){this.insertBefore(e,t),t&&this.removeChild(t)},removeChild:function(e){return fs(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return function e(t,i,r){var n=new i.constructor;for(var a in i){var s=i[a];"object"!=typeof s&&s!=n[a]&&(n[a]=s)}switch(i.childNodes&&(n.childNodes=new Za),n.ownerDocument=t,n.nodeType){case Ma:var o=i.attributes,u=n.attributes=new is,l=o.length;u._ownerElement=n;for(var c=0;c<l;c++)n.setAttributeNode(e(t,o.item(c),!0));break;case Na:r=!0}if(r)for(var d=i.firstChild;d;)n.appendChild(e(t,d,r)),d=d.nextSibling;return n}(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==Ua&&e.nodeType==Ua?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return 0<this.attributes.length},lookupPrefix:function(e){for(var t=this;t;){var i=t._nsMap;if(i)for(var r in i)if(i[r]==e)return r;t=t.nodeType==Na?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var i=t._nsMap;if(i&&e in i)return i[e];t=t.nodeType==Na?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)}},Oa(Pa,os),Oa(Pa,os.prototype),cs.prototype={nodeName:"#document",nodeType:Ga,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType!=Ka)return null==this.documentElement&&e.nodeType==Ma&&(this.documentElement=e),ps(this,e,t),e.ownerDocument=this,e;for(var i=e.firstChild;i;){var r=i.nextSibling;this.insertBefore(i,t),i=r}return e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),fs(this,e)},importNode:function(e,t){return function e(t,i,r){var n;switch(i.nodeType){case Ma:(n=i.cloneNode(!1)).ownerDocument=t;case Ka:break;case Na:r=!0}if((n=n||i.cloneNode(!1)).ownerDocument=t,n.parentNode=null,r)for(var a=i.firstChild;a;)n.appendChild(e(t,a,r)),a=a.nextSibling;return n}(this,e,t)},getElementById:function(e){var t=null;return ls(this.documentElement,(function(i){if(i.nodeType==Ma&&i.getAttribute("id")==e)return t=i,!0})),t},createElement:function(e){var t=new gs;return t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.childNodes=new Za,(t.attributes=new is)._ownerElement=t},createDocumentFragment:function(){var e=new ws;return e.ownerDocument=this,e.childNodes=new Za,e},createTextNode:function(e){var t=new ys;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new _s;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new bs;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var i=new Cs;return i.ownerDocument=this,i.tagName=i.target=e,i.nodeValue=i.data=t,i},createAttribute:function(e){var t=new ms;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new ks;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var i=new gs,r=t.split(":"),n=i.attributes=new is;return i.childNodes=new Za,i.ownerDocument=this,i.nodeName=t,i.tagName=t,i.namespaceURI=e,2==r.length?(i.prefix=r[0],i.localName=r[1]):i.localName=t,n._ownerElement=i},createAttributeNS:function(e,t){var i=new ms,r=t.split(":");return i.ownerDocument=this,i.nodeName=t,i.name=t,i.namespaceURI=e,i.specified=!0,2==r.length?(i.prefix=r[0],i.localName=r[1]):i.localName=t,i}},xa(cs,os),cs.prototype.getElementsByTagName=(gs.prototype={nodeType:Ma,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var i=this.ownerDocument.createAttribute(e);i.value=i.nodeValue=""+t,this.setAttributeNode(i)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===Ka?this.insertBefore(e,null):function(e,t){var i=t.parentNode;if(i){var r=e.lastChild;i.removeChild(t),r=e.lastChild}return r=e.lastChild,t.parentNode=e,t.previousSibling=r,t.nextSibling=null,r?r.nextSibling=t:e.firstChild=t,e.lastChild=t,hs(e.ownerDocument,e,t),t}(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var i=this.getAttributeNodeNS(e,t);i&&this.removeAttributeNode(i)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var i=this.getAttributeNodeNS(e,t);return i&&i.value||""},setAttributeNS:function(e,t,i){var r=this.ownerDocument.createAttributeNS(e,t);r.value=r.nodeValue=""+i,this.setAttributeNode(r)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new es(this,(function(t){var i=[];return ls(t,(function(r){r===t||r.nodeType!=Ma||"*"!==e&&r.tagName!=e||i.push(r)})),i}))},getElementsByTagNameNS:function(e,t){return new es(this,(function(i){var r=[];return ls(i,(function(n){n===i||n.nodeType!==Ma||"*"!==e&&n.namespaceURI!==e||"*"!==t&&n.localName!=t||r.push(n)})),r}))}}).getElementsByTagName,cs.prototype.getElementsByTagNameNS=gs.prototype.getElementsByTagNameNS,xa(gs,os),ms.prototype.nodeType=Na,xa(ms,os),vs.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){this.nodeValue=this.data=e=this.data+e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(Ya[Xa])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,i){i=this.data.substring(0,e)+i+this.data.substring(e+t),this.nodeValue=this.data=i,this.length=i.length}},xa(vs,os),ys.prototype={nodeName:"#text",nodeType:Ua,splitText:function(e){var t=this.data,i=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var r=this.ownerDocument.createTextNode(i);return this.parentNode&&this.parentNode.insertBefore(r,this.nextSibling),r}},xa(ys,vs),_s.prototype={nodeName:"#comment",nodeType:Ha},xa(_s,vs),bs.prototype={nodeName:"#cdata-section",nodeType:Fa},xa(bs,vs),Ts.prototype.nodeType=qa,xa(Ts,os),Ss.prototype.nodeType=Wa,xa(Ss,os),Es.prototype.nodeType=ja,xa(Es,os),ks.prototype.nodeType=Ba,xa(ks,os),ws.prototype.nodeName="#document-fragment",ws.prototype.nodeType=Ka,xa(ws,os),Cs.prototype.nodeType=Va,xa(Cs,os),As.prototype.serializeToString=function(e,t,i){return Ls.call(e,t,i)},os.prototype.toString=Ls;try{Object.defineProperty&&(Object.defineProperty(es.prototype,"length",{get:function(){return ts(this),this.$$length}}),Object.defineProperty(os.prototype,"textContent",{get:function(){return function e(t){switch(t.nodeType){case Ma:case Ka:var i=[];for(t=t.firstChild;t;)7!==t.nodeType&&8!==t.nodeType&&i.push(e(t)),t=t.nextSibling;return i.join("");default:return t.nodeValue}}(this)},set:function(e){switch(this.nodeType){case Ma:case Ka:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),Ds=function(e,t,i){e["$$"+t]=i})}catch(na){}function Os(e){return!!e&&"object"==typeof e}function xs(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.reduce((function(e,t){return Object.keys(t).forEach((function(i){e[i]=Array.isArray(e[i])&&Array.isArray(t[i])?e[i].concat(t[i]):Os(e[i])&&Os(t[i])?xs(e[i],t[i]):t[i]})),e}),{})}function Ps(e){return e.reduce((function(e,t){return e.concat(t)}),[])}function Ms(e){if(!e.length)return[];for(var t=[],i=0;i<e.length;i++)t.push(e[i]);return t}function Ns(e){var t=e.baseUrl,i=e.source,r=void 0===i?"":i,n=e.range,a=void 0===n?"":n,s=e.indexRange,o=void 0===s?"":s,u={uri:r,resolvedUri:oa((void 0===t?"":t)||"",r)};if(a||o){var l=(a||o).split("-"),c=parseInt(l[0],10),d=parseInt(l[1],10);u.byterange={length:d-c+1,offset:c}}return u}function Us(e){var t=e.type,i=void 0===t?"static":t,r=e.duration,n=e.timescale,a=void 0===n?1:n,s=e.sourceDuration,o=co[i](e),u=function(e,t){for(var i=[],r=e;r<t;r++)i.push(r);return i}(o.start,o.end).map(function(e){return function(t,i){var r=e.duration,n=e.timescale,a=e.startNumber;return{number:(void 0===a?1:a)+t,duration:r/(void 0===n?1:n),timeline:e.periodIndex,time:i*r}}}(e));if("static"===i){var l=u.length-1;u[l].duration=s-r/a*l}return u}function Fs(e){var t=e.baseUrl,i=e.initialization,r=void 0===i?{}:i,n=e.sourceDuration,a=e.indexRange,s=void 0===a?"":a,o=e.duration;if(!t)throw new Error(uo);var u=Ns({baseUrl:t,source:r.sourceURL,range:r.range}),l=Ns({baseUrl:t,source:t,indexRange:s});if(l.map=u,o){var c=Us(e);c.length&&(l.duration=c[0].duration,l.timeline=c[0].timeline)}else n&&(l.duration=n,l.timeline=0);return l.number=0,[l]}function Bs(e,t,i){for(var r=e.sidx.map?e.sidx.map:null,n=e.sidx.duration,a=e.timeline||0,s=e.sidx.byterange,o=s.offset+s.length,u=t.timescale,l=t.references.filter((function(e){return 1!==e.referenceType})),c=[],d=o+t.firstOffset,h=0;h<l.length;h++){var f=t.references[h],p=f.referencedSize,g=Fs({baseUrl:i,timescale:u,timeline:a,periodIndex:a,duration:f.subsegmentDuration,sourceDuration:n,indexRange:d+"-"+(d+p-1)})[0];r&&(g.map=r),c.push(g),d+=p}return e.segments=c,e}function js(e){return function(e){return Object.keys(e).map((function(t){return e[t]}))}(e.reduce((function(e,t){var i,r=t.attributes.id+(t.attributes.lang||"");return e[r]?(t.segments[0]&&(t.segments[0].discontinuity=!0),(i=e[r].segments).push.apply(i,t.segments),t.attributes.contentProtection&&(e[r].attributes.contentProtection=t.attributes.contentProtection)):e[r]=t,e}),{})).map((function(e){return e.discontinuityStarts=function(e,t){return e.reduce((function(e,t,i){return t.discontinuity&&e.push(i),e}),[])}(e.segments),e}))}function Vs(e,t){if(void 0===t&&(t={}),!Object.keys(t).length)return e;for(var i in e){var r=e[i];if(r.sidx){var n=r.sidx.uri+"-"+(s=r.sidx.byterange).offset+"-"+(s.offset+s.length-1),a=t[n]&&t[n].sidx;r.sidx&&a&&Bs(r,a,r.sidx.resolvedUri)}}var s;return e}function Hs(e){var t,i=e.attributes,r=e.segments,n=e.sidx,a={attributes:(t={NAME:i.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:i.width,height:i.height},CODECS:i.codecs,BANDWIDTH:i.bandwidth},t["PROGRAM-ID"]=1,t),uri:"",endList:"static"===(i.type||"static"),timeline:i.periodIndex,resolvedUri:"",targetDuration:i.duration,segments:r,mediaSequence:r.length?r[0].number:1};return i.contentProtection&&(a.contentProtection=i.contentProtection),n&&(a.sidx=n),a}function Gs(e,t){for(var i,r,n,a,s,o=e.type,u=void 0===o?"static":o,l=e.minimumUpdatePeriod,c=void 0===l?0:l,d=e.media,h=void 0===d?"":d,f=e.sourceDuration,p=e.timescale,g=void 0===p?1:p,m=e.startNumber,v=void 0===m?1:m,y=e.periodIndex,_=[],b=-1,T=0;T<t.length;T++){var S=t[T],E=S.d,k=S.r||0,w=S.t||0;b<0&&(b=w),w&&b<w&&(b=w);var C=void 0;if(k<0){var A=T+1;C=A===t.length?"dynamic"===u&&0<c&&0<h.indexOf("$Number$")?(r=(i=e).NOW,n=i.timescale,a=i.start,s=i.minimumUpdatePeriod,Math.ceil((((r+i.clientOffset)/1e3+(void 0===s?0:s)-(i.availabilityStartTime+(void 0===a?0:a)))*(void 0===n?1:n)-b)/E)):(f*g-b)/E:(t[A].t-b)/E}else C=k+1;for(var L=v+_.length+C,I=v+_.length;I<L;)_.push({number:I,duration:E/g,time:b,timeline:y}),b+=E,I++}return _}function qs(e,t){return e.replace(ho,function(e){return function(t,i,r,n){if("$$"===t)return"$";if(void 0===e[i])return t;var a=""+e[i];return"RepresentationID"===i||(n=r?parseInt(n,10):1)<=a.length?a:new Array(n-a.length+1).join("0")+a}}(t))}function Ks(e,t){var i={RepresentationID:e.id,Bandwidth:e.bandwidth||0},r=e.initialization,n=void 0===r?{sourceURL:"",range:""}:r,a=Ns({baseUrl:e.baseUrl,source:qs(n.sourceURL,i),range:n.range});return function(e,t){return e.duration||t?e.duration?Us(e):Gs(e,t):[{number:e.startNumber||1,duration:e.sourceDuration,time:0,timeline:e.periodIndex}]}(e,t).map((function(t){i.Number=t.number,i.Time=t.time;var r=qs(e.media||"",i);return{uri:r,timeline:t.timeline,duration:t.duration,resolvedUri:oa(e.baseUrl||"",r),map:a,number:t.number}}))}function Ws(e,t){var i=e.duration,r=e.segmentUrls,n=void 0===r?[]:r;if(!i&&!t||i&&t)throw new Error(lo);var a,s=n.map((function(t){return function(e,t){var i=e.baseUrl,r=e.initialization,n=void 0===r?{}:r,a=Ns({baseUrl:i,source:n.sourceURL,range:n.range}),s=Ns({baseUrl:i,source:t.media,range:t.mediaRange});return s.map=a,s}(e,t)}));return i&&(a=Us(e)),t&&(a=Gs(e,t)),a.map((function(e,t){if(s[t]){var i=s[t];return i.timeline=e.timeline,i.duration=e.duration,i.number=e.number,i}})).filter((function(e){return e}))}function zs(e){var t,i,r=e.attributes,n=e.segmentInfo;n.template?(i=Ks,t=xs(r,n.template)):n.base?(i=Fs,t=xs(r,n.base)):n.list&&(i=Ws,t=xs(r,n.list));var a={attributes:r};if(!i)return a;var s=i(t,n.timeline);if(t.duration){var o=t.timescale;t.duration=t.duration/(void 0===o?1:o)}else t.duration=s.length?s.reduce((function(e,t){return Math.max(e,Math.ceil(t.duration))}),0):0;return a.attributes=t,a.segments=s,n.base&&t.indexRange&&(a.sidx=s[0],a.segments=[]),a}function Ys(e,t){return Ms(e.childNodes).filter((function(e){return e.tagName===t}))}function Xs(e){return e.textContent.trim()}function Qs(e){var t=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(e);if(!t)return 0;var i=t.slice(1),r=i[1],n=i[2],a=i[3],s=i[4],o=i[5];return 31536e3*parseFloat(i[0]||0)+2592e3*parseFloat(r||0)+86400*parseFloat(n||0)+3600*parseFloat(a||0)+60*parseFloat(s||0)+parseFloat(o||0)}function $s(e){return e&&e.attributes?Ms(e.attributes).reduce((function(e,t){return e[t.name]=(fo[t.name]||fo.DEFAULT)(t.value),e}),{}):{}}function Js(e,t){return t.length?Ps(e.map((function(e){return t.map((function(t){return oa(e,Xs(t))}))}))):e}function Zs(e){var t=Ys(e,"SegmentTemplate")[0],i=Ys(e,"SegmentList")[0],r=i&&Ys(i,"SegmentURL").map((function(e){return xs({tag:"SegmentURL"},$s(e))})),n=Ys(e,"SegmentBase")[0],a=i||t,s=a&&Ys(a,"SegmentTimeline")[0],o=i||n||t,u=o&&Ys(o,"Initialization")[0],l=t&&$s(t);l&&u?l.initialization=u&&$s(u):l&&l.initialization&&(l.initialization={sourceURL:l.initialization});var c={template:l,timeline:s&&Ys(s,"S").map((function(e){return $s(e)})),list:i&&xs($s(i),{segmentUrls:r,initialization:$s(u)}),base:n&&xs($s(n),{initialization:$s(u)})};return Object.keys(c).forEach((function(e){c[e]||delete c[e]})),c}function eo(e){if(""===e)throw new Error(so);var t=(new no).parseFromString(e,"application/xml"),i=t&&"MPD"===t.documentElement.tagName?t.documentElement:null;if(!i||i&&0<i.getElementsByTagName("parsererror").length)throw new Error(oo);return i}function to(t,i){void 0===i&&(i={});var r=function(t,i){void 0===i&&(i={});var r=i,n=r.manifestUri,a=void 0===n?"":n,s=r.NOW,o=void 0===s?Date.now():s,u=r.clientOffset,l=void 0===u?0:u,c=Ys(t,"Period");if(!c.length)throw new Error(ao);var d=Ys(t,"Location"),h=$s(t),f=Js([a],Ys(t,"BaseURL"));return h.sourceDuration=h.mediaPresentationDuration||0,h.NOW=o,h.clientOffset=l,d.length&&(h.locations=d.map(Xs)),{locations:h.locations,representationInfo:Ps(c.map(function(t,i){return function(r,n){var a=Js(i,Ys(r,"BaseURL")),s=$s(r),o=parseInt(s.id,10),u=e.isNaN(o)?n:o,l=xs(t,{periodIndex:u}),c=Ys(r,"AdaptationSet"),d=Zs(r);return Ps(c.map(function(e,t,i){return function(r){var n=$s(r),a=Js(t,Ys(r,"BaseURL")),s={role:$s(Ys(r,"Role")[0])},o=xs(e,n,s),u=function(e){return e.reduce((function(e,t){var i=$s(t),r=po[i.schemeIdUri];if(r){e[r]={attributes:i};var n=Ys(t,"cenc:pssh")[0];if(n){var a=Xs(n),s=a&&da(a);e[r].pssh=s}}return e}),{})}(Ys(r,"ContentProtection"));Object.keys(u).length&&(o=xs(o,{contentProtection:u}));var l=Zs(r),c=Ys(r,"Representation"),d=xs(i,l);return Ps(c.map(function(e,t,i){return function(r){var n=Ys(r,"BaseURL"),a=Js(t,n),s=xs(e,$s(r)),o=Zs(r);return a.map((function(e){return{segmentInfo:xs(i,o),attributes:xs(s,{baseUrl:e})}}))}}(o,a,d)))}}(l,a,d)))}}(h,f)))}}(eo(t),i);return function(e,t,i){var r;if(void 0===i&&(i={}),!e.length)return{};var n=e[0].attributes,a=n.sourceDuration,s=n.type,o=void 0===s?"static":s,u=n.suggestedPresentationDelay,l=n.minimumUpdatePeriod,c=js(e.filter((function(e){var t=e.attributes;return"video/mp4"===t.mimeType||"video"===t.contentType}))).map(Hs),d=js(e.filter((function(e){var t=e.attributes;return"audio/mp4"===t.mimeType||"audio"===t.contentType}))),h=e.filter((function(e){var t=e.attributes;return"text/vtt"===t.mimeType||"text"===t.contentType})),f={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:(r={AUDIO:{},VIDEO:{}},r["CLOSED-CAPTIONS"]={},r.SUBTITLES={},r),uri:"",duration:a,playlists:Vs(c,i)};return 0<=l&&(f.minimumUpdatePeriod=1e3*l),t&&(f.locations=t),"dynamic"===o&&(f.suggestedPresentationDelay=u),d.length&&(f.mediaGroups.AUDIO.audio=function(e,t){var i;void 0===t&&(t={});var r=e.reduce((function(e,r){var n=r.attributes.role&&r.attributes.role.value||"",a=r.attributes.lang||"",s="main";return a&&(s=r.attributes.lang+(n?" ("+n+")":"")),e[s]&&e[s].playlists[0].attributes.BANDWIDTH>r.attributes.bandwidth||(e[s]={language:a,autoselect:!0,default:"main"===n,playlists:Vs([function(e){var t,i=e.attributes,r=e.segments,n=e.sidx,a={attributes:(t={NAME:i.id,BANDWIDTH:i.bandwidth,CODECS:i.codecs},t["PROGRAM-ID"]=1,t),uri:"",endList:"static"===(i.type||"static"),timeline:i.periodIndex,resolvedUri:"",targetDuration:i.duration,segments:r,mediaSequence:r.length?r[0].number:1};return i.contentProtection&&(a.contentProtection=i.contentProtection),n&&(a.sidx=n),a}(r)],t),uri:""},void 0===i&&"main"===n&&((i=r).default=!0)),e}),{});return i||(r[Object.keys(r)[0]].default=!0),r}(d,i)),h.length&&(f.mediaGroups.SUBTITLES.subs=function(e,t){return void 0===t&&(t={}),e.reduce((function(e,i){var r=i.attributes.lang||"text";return e[r]||(e[r]={language:r,default:!1,autoselect:!1,playlists:Vs([function(e){var t,i=e.attributes,r=e.segments;void 0===r&&(r=[{uri:i.baseUrl,timeline:i.periodIndex,resolvedUri:i.baseUrl||"",duration:i.sourceDuration,number:0}],i.duration=i.sourceDuration);var n=((t={NAME:i.id,BANDWIDTH:i.bandwidth})["PROGRAM-ID"]=1,t);return i.codecs&&(n.CODECS=i.codecs),{attributes:n,uri:"",endList:"static"===(i.type||"static"),timeline:i.periodIndex,resolvedUri:i.baseUrl||"",targetDuration:i.duration,segments:r,mediaSequence:r.length?r[0].number:1}}(i)],t),uri:""}),e}),{})}(h,i)),f}(function(e){return e.map(zs)}(r.representationInfo),r.locations,i.sidxMapping)}var io=ss,ro=As,no=o((function(e,t){function i(e){this.options=e||{locator:{}}}function r(){this.cdata=!1}function n(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function a(e,t,i){return"string"==typeof e?e.substr(t,i):e.length>=t+i||t?new java.lang.String(e,t,i)+"":e}function s(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}i.prototype.parseFromString=function(e,t){var i=this.options,n=new o,a=i.domBuilder||new r,s=i.errorHandler,u=i.locator,l=i.xmlns||{},c={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return u&&a.setDocumentLocator(u),n.errorHandler=function(e,t,i){if(!e){if(t instanceof r)return t;e=t}var n={},a=e instanceof Function;function s(t){var r=e[t];!r&&a&&(r=2==e.length?function(i){e(t,i)}:e),n[t]=r&&function(e){r("[xmldom "+t+"]\t"+e+function(e){if(e)return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}(i))}||function(){}}return i=i||{},s("warning"),s("error"),s("fatalError"),n}(s,a,u),n.domBuilder=i.domBuilder||a,/\/x?html?$/.test(t)&&(c.nbsp="",c.copy="",l[""]="http://www.w3.org/1999/xhtml"),l.xml=l.xml||"http://www.w3.org/XML/1998/namespace",e?n.parse(e,l,c):n.errorHandler.error("invalid doc source"),a.doc},r.prototype={startDocument:function(){this.doc=(new u).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,i,r){var a=this.doc,o=a.createElementNS(e,i||t),u=r.length;s(this,o),this.currentElement=o,this.locator&&n(this.locator,o);for(var l=0;l<u;l++){e=r.getURI(l);var c=r.getValue(l),d=(i=r.getQName(l),a.createAttributeNS(e,i));this.locator&&n(r.getLocator(l),d),d.value=d.nodeValue=c,o.setAttributeNode(d)}},endElement:function(e,t,i){this.currentElement=this.currentElement.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var i=this.doc.createProcessingInstruction(e,t);this.locator&&n(this.locator,i),s(this,i)},ignorableWhitespace:function(e,t,i){},characters:function(e,t,i){if(e=a.apply(this,arguments)){if(this.cdata)var r=this.doc.createCDATASection(e);else r=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(r):/^\s*$/.test(e)&&this.doc.appendChild(r),this.locator&&n(this.locator,r)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,i){e=a.apply(this,arguments);var r=this.doc.createComment(e);this.locator&&n(this.locator,r),s(this,r)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,i){var r=this.doc.implementation;if(r&&r.createDocumentType){var a=r.createDocumentType(e,t,i);this.locator&&n(this.locator,a),s(this,a)}},warning:function(e){},error:function(e){},fatalError:function(e){throw e}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,(function(e){r.prototype[e]=function(){return null}}));var o=Da,u=t.DOMImplementation=io;t.XMLSerializer=ro,t.DOMParser=i})).DOMParser,ao="INVALID_NUMBER_OF_PERIOD",so="DASH_EMPTY_MANIFEST",oo="DASH_INVALID_XML",uo="NO_BASE_URL",lo="SEGMENT_TIME_UNSPECIFIED",co={static:function(e){var t=e.timescale;return{start:0,end:Math.ceil(e.sourceDuration/(e.duration/(void 0===t?1:t)))}},dynamic:function(e){var t=e.timescale,i=void 0===t?1:t,r=e.duration,n=e.start,a=e.minimumUpdatePeriod,s=e.timeShiftBufferDepth,o=void 0===s?1/0:s,u=(e.NOW+e.clientOffset)/1e3,l=e.availabilityStartTime+(void 0===n?0:n),c=Math.ceil((u+(void 0===a?0:a)-l)*i/r),d=Math.floor((u-l-o)*i/r),h=Math.floor((u-l)*i/r);return{start:Math.max(0,d),end:Math.min(c,h)}}},ho=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,fo={mediaPresentationDuration:function(e){return Qs(e)},availabilityStartTime:function(e){return function(e){return/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),Date.parse(e)}(e)/1e3},minimumUpdatePeriod:function(e){return Qs(e)},suggestedPresentationDelay:function(e){return Qs(e)},type:function(e){return e},timeShiftBufferDepth:function(e){return Qs(e)},start:function(e){return Qs(e)},width:function(e){return parseInt(e,10)},height:function(e){return parseInt(e,10)},bandwidth:function(e){return parseInt(e,10)},startNumber:function(e){return parseInt(e,10)},timescale:function(e){return parseInt(e,10)},duration:function(e){var t=parseInt(e,10);return isNaN(t)?Qs(e):t},d:function(e){return parseInt(e,10)},t:function(e){return parseInt(e,10)},r:function(e){return parseInt(e,10)},DEFAULT:function(e){return e}},po={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},go=o((function(e,t){function i(e){return e instanceof Uint8Array?e:new Uint8Array(e&&e.buffer||e,e&&e.byteOffset||0,e&&e.byteLength||0)}function r(e){if(!e)return"";e=Array.prototype.slice.call(e);var t=String.fromCharCode.apply(null,i(e));try{return decodeURIComponent(escape(t))}catch(e){}return t}function n(e,t){void 0===t&&(t=0);var r=(e=i(e))[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9];return(16&e[t+5])>>4?20+r:10+r}function a(e,t){return void 0===t&&(t=0),(e=i(e)).length-t<10||"ID3"!==r(e.subarray(t,t+3))?t:a(e,t+=n(e,t))}Object.defineProperty(t,"__esModule",{value:!0});var s={aac:function(e){var t=a(e);return e.length>=t+2&&255==(255&e[t])&&224==(224&e[t+1])&&16==(22&e[t+1])},mp3:function(e){var t=a(e);return e.length>=t+2&&255==(255&e[t])&&224==(224&e[t+1])&&2==(6&e[t+1])},webm:function(e){return 4<=e.length&&26==(255&e[0])&&69==(255&e[1])&&223==(255&e[2])&&163==(255&e[3])},mp4:function(e){return 8<=e.length&&/^(f|s)typ$/.test(r(e.subarray(4,8)))&&!/^ftyp3g$/.test(r(e.subarray(4,10)))},"3gp":function(e){return 10<=e.length&&/^ftyp3g$/.test(r(e.subarray(4,10)))},ts:function(e){if(e.length<189&&1<=e.length)return 71===e[0];for(var t=0;t+188<e.length&&t<188;){if(71===e[t]&&71===e[t+188])return!0;t+=1}return!1},flac:function(e){return 4<=e.length&&/^fLaC$/.test(r(e.subarray(0,4)))},ogg:function(e){return 4<=e.length&&/^OggS$/.test(r(e.subarray(0,4)))}},o=Object.keys(s).filter((function(e){return"ts"!==e})).concat("ts");o.forEach((function(e){var t=s[e];s[e]=function(e){return t(i(e))}})),t.detectContainerForBytes=function(e){e=i(e);for(var t=0;t<o.length;t++){var r=o[t];if(s[r](e))return r}return""},t.getId3Offset=a,t.id3Size=n,t.isLikely=s,t.isLikelyFmp4MediaSegment=function(e){e=i(e);for(var t=0;t<e.length;){var n=(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0;if("moof"===r(e.subarray(t+4,t+8)))return!0;0==n||n+t>e.length?t=e.length:t+=n}return!1}}));s(go);var mo=go.detectContainerForBytes,vo=go.getId3Offset,yo=go.isLikelyFmp4MediaSegment,_o=o((function(e,t){function i(e){return e instanceof Uint8Array?e:new Uint8Array(e&&e.buffer||e,e&&e.byteOffset||0,e&&e.byteLength||0)}Object.defineProperty(t,"__esModule",{value:!0}),t.bytesToString=function(e){if(!e)return"";e=Array.prototype.slice.call(e);var t=String.fromCharCode.apply(null,i(e));try{return decodeURIComponent(escape(t))}catch(e){}return t},t.concatTypedArrays=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t.reduce((function(e,t){return e+(t&&(t.byteLength||t.length)||0)}),0),a=new Uint8Array(n),s=0;return t.forEach((function(e){e=i(e),a.set(e,s),s+=e.byteLength})),a},t.isTypedArray=function(e){return ArrayBuffer.isView(e)},t.stringToBytes=function(e,t){return void 0===t&&(t=!1),"string"!=typeof e&&e&&"function"==typeof e.toString&&(e=e.toString()),"string"!=typeof e?[]:(t||(e=unescape(encodeURIComponent(e))),e.split("").map((function(e){return 255&e.charCodeAt(0)})))},t.toUint8=i}));function bo(){this.init=function(){var e={};this.on=function(t,i){e[t]||(e[t]=[]),e[t]=e[t].concat(i)},this.off=function(t,i){var r;return!!e[t]&&(r=e[t].indexOf(i),e[t]=e[t].slice(),e[t].splice(r,1),-1<r)},this.trigger=function(t){var i,r,n,a;if(i=e[t])if(2===arguments.length)for(n=i.length,r=0;r<n;++r)i[r].call(this,arguments[1]);else{for(a=[],r=arguments.length,r=1;r<arguments.length;++r)a.push(arguments[r]);for(n=i.length,r=0;r<n;++r)i[r].apply(this,a)}},this.dispose=function(){e={}}}}s(_o);var To=_o.concatTypedArrays,So=_o.stringToBytes,Eo=_o.toUint8;function ko(e){var t=31&e[1];return(t<<=8)|e[2]}function wo(e){return!!(64&e[1])}function Co(e){var t=0;return 1<(48&e[3])>>>4&&(t+=e[4]+1),t}function Ao(e){switch(e){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}}function Lo(e,t){var i=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9];return i=0<=i?i:0,(16&e[t+5])>>4?i+20:i+10}function Io(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]}bo.prototype.pipe=function(e){return this.on("data",(function(t){e.push(t)})),this.on("done",(function(t){e.flush(t)})),this.on("partialdone",(function(t){e.partialFlush(t)})),this.on("endedtimeline",(function(t){e.endTimeline(t)})),this.on("reset",(function(t){e.reset(t)})),e},bo.prototype.push=function(e){this.trigger("data",e)},bo.prototype.flush=function(e){this.trigger("done",e)},bo.prototype.partialFlush=function(e){this.trigger("partialdone",e)},bo.prototype.endTimeline=function(e){this.trigger("endedtimeline",e)},bo.prototype.reset=function(e){this.trigger("reset",e)},new bo;var Ro=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],Do={isLikelyAacData:function(e){var t=function e(t,i){return t.length-i<10||t[i]!=="I".charCodeAt(0)||t[i+1]!=="D".charCodeAt(0)||t[i+2]!=="3".charCodeAt(0)?i:e(t,i+=Lo(t,i))}(e,0);return e.length>=t+2&&255==(255&e[t])&&240==(240&e[t+1])&&16==(22&e[t+1])},parseId3TagSize:Lo,parseAdtsSize:function(e,t){return 6144&e[t+3]|e[t+4]<<3|(224&e[t+5])>>5},parseType:function(e,t){return e[t]==="I".charCodeAt(0)&&e[t+1]==="D".charCodeAt(0)&&e[t+2]==="3".charCodeAt(0)?"timed-metadata":!0&e[t]&&240==(240&e[t+1])?"audio":null},parseSampleRate:function(e){for(var t=0;t+5<e.length;){if(255===e[t]&&240==(246&e[t+1]))return Ro[(60&e[t+2])>>>2];t++}return null},parseAacTimestamp:function(e){var t,i,r;t=10,64&e[5]&&(t+=4,t+=Io(e.subarray(10,14)));do{if((i=Io(e.subarray(t+4,t+8)))<1)return null;if("PRIV"===String.fromCharCode(e[t],e[t+1],e[t+2],e[t+3])){r=e.subarray(t+10,t+i+10);for(var n=0;n<r.byteLength;n++)if(0===r[n]){if("com.apple.streaming.transportStreamTimestamp"!==unescape(function(e,t,i){var r,n="";for(r=0;r<i;r++)n+="%"+("00"+e[r].toString(16)).slice(-2);return n}(r,0,n)))break;var a=r.subarray(n+1),s=(1&a[3])<<30|a[4]<<22|a[5]<<14|a[6]<<6|a[7]>>>2;return(s*=4)+(3&a[7])}}t+=10,t+=i}while(t<e.byteLength);return null}},Oo=9e4,xo=function(e,t){var i=1;for(t<e&&(i=-1);4294967296<Math.abs(t-e);)e+=8589934592*i;return e},Po={};function Mo(e,t,i){for(var r,n,a,s,o=0,u=Bo,l=!1;u<=e.byteLength;)if(71!==e[o]||71!==e[u]&&u!==e.byteLength)o++,u++;else{switch(r=e.subarray(o,u),Po.ts.parseType(r,t.pid)){case"pes":n=Po.ts.parsePesType(r,t.table),a=Po.ts.parsePayloadUnitStartIndicator(r),"audio"===n&&a&&(s=Po.ts.parsePesTime(r))&&(s.type="audio",i.audio.push(s),l=!0)}if(l)break;o+=Bo,u+=Bo}for(o=(u=e.byteLength)-Bo,l=!1;0<=o;)if(71!==e[o]||71!==e[u]&&u!==e.byteLength)o--,u--;else{switch(r=e.subarray(o,u),Po.ts.parseType(r,t.pid)){case"pes":n=Po.ts.parsePesType(r,t.table),a=Po.ts.parsePayloadUnitStartIndicator(r),"audio"===n&&a&&(s=Po.ts.parsePesTime(r))&&(s.type="audio",i.audio.push(s),l=!0)}if(l)break;o-=Bo,u-=Bo}}function No(e,t,i){for(var r,n,a,s,o,u,l,c=0,d=Bo,h=!1,f={data:[],size:0};d<e.byteLength;)if(71!==e[c]||71!==e[d])c++,d++;else{switch(r=e.subarray(c,d),Po.ts.parseType(r,t.pid)){case"pes":if(n=Po.ts.parsePesType(r,t.table),a=Po.ts.parsePayloadUnitStartIndicator(r),"video"===n&&(a&&!h&&(s=Po.ts.parsePesTime(r))&&(s.type="video",i.video.push(s),h=!0),!i.firstKeyFrame)){if(a&&0!==f.size){for(o=new Uint8Array(f.size),u=0;f.data.length;)l=f.data.shift(),o.set(l,u),u+=l.byteLength;if(Po.ts.videoPacketContainsKeyFrame(o)){var p=Po.ts.parsePesTime(o);p&&(i.firstKeyFrame=p,i.firstKeyFrame.type="video")}f.size=0}f.data.push(r),f.size+=r.byteLength}}if(h&&i.firstKeyFrame)break;c+=Bo,d+=Bo}for(c=(d=e.byteLength)-Bo,h=!1;0<=c;)if(71!==e[c]||71!==e[d])c--,d--;else{switch(r=e.subarray(c,d),Po.ts.parseType(r,t.pid)){case"pes":n=Po.ts.parsePesType(r,t.table),a=Po.ts.parsePayloadUnitStartIndicator(r),"video"===n&&a&&(s=Po.ts.parsePesTime(r))&&(s.type="video",i.video.push(s),h=!0)}if(h)break;c-=Bo,d-=Bo}}Po.ts={parseType:function(e,t){var i=ko(e);return 0===i?"pat":i===t?"pmt":t?"pes":null},parsePat:function(e){var t=wo(e),i=4+Co(e);return t&&(i+=e[i]+1),(31&e[i+10])<<8|e[i+11]},parsePmt:function(e){var t={},i=wo(e),r=4+Co(e);if(i&&(r+=e[r]+1),1&e[r+5]){var n;n=3+((15&e[r+1])<<8|e[r+2])-4;for(var a=12+((15&e[r+10])<<8|e[r+11]);a<n;){var s=r+a;t[(31&e[s+1])<<8|e[s+2]]=e[s],a+=5+((15&e[s+3])<<8|e[s+4])}return t}},parsePayloadUnitStartIndicator:wo,parsePesType:function(e,t){switch(t[ko(e)]){case 27:return"video";case 15:return"audio";case 21:return"timed-metadata";default:return null}},parsePesTime:function(e){if(!wo(e))return null;var t=4+Co(e);if(t>=e.byteLength)return null;var i,r=null;return 192&(i=e[t+7])&&((r={}).pts=(14&e[t+9])<<27|(255&e[t+10])<<20|(254&e[t+11])<<12|(255&e[t+12])<<5|(254&e[t+13])>>>3,r.pts*=4,r.pts+=(6&e[t+13])>>>1,r.dts=r.pts,64&i&&(r.dts=(14&e[t+14])<<27|(255&e[t+15])<<20|(254&e[t+16])<<12|(255&e[t+17])<<5|(254&e[t+18])>>>3,r.dts*=4,r.dts+=(6&e[t+18])>>>1)),r},videoPacketContainsKeyFrame:function(e){for(var t=4+Co(e),i=e.subarray(t),r=0,n=0,a=!1;n<i.byteLength-3;n++)if(1===i[n+2]){r=n+5;break}for(;r<i.byteLength;)switch(i[r]){case 0:if(0!==i[r-1]){r+=2;break}if(0!==i[r-2]){r++;break}for(n+3!==r-2&&"slice_layer_without_partitioning_rbsp_idr"===Ao(31&i[n+3])&&(a=!0);1!==i[++r]&&r<i.length;);n=r-2,r+=3;break;case 1:if(0!==i[r-1]||0!==i[r-2]){r+=3;break}"slice_layer_without_partitioning_rbsp_idr"===Ao(31&i[n+3])&&(a=!0),n=r-2,r+=3;break;default:r+=3}return i=i.subarray(n),r-=n,n=0,i&&3<i.byteLength&&"slice_layer_without_partitioning_rbsp_idr"===Ao(31&i[n+3])&&(a=!0),a}},Po.aac=Do;var Uo,Fo=9e4,Bo=188,jo=function(e){return e>>>0},Vo=function(e){var t="";return t+=String.fromCharCode(e[0]),t+=String.fromCharCode(e[1]),(t+=String.fromCharCode(e[2]))+String.fromCharCode(e[3])},Ho=jo,Go=function e(t,i){var r,n,a,s,o,u=[];if(!i.length)return null;for(r=0;r<t.byteLength;)n=Ho(t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3]),a=Vo(t.subarray(r+4,r+8)),s=1<n?r+n:t.byteLength,a===i[0]&&(1===i.length?u.push(t.subarray(r+8,s)):(o=e(t.subarray(r+8,s),i.slice(1))).length&&(u=u.concat(o))),r=s;return u},qo=jo,Ko=function(e){return("00"+e.toString(16)).slice(-2)},Wo=(Uo=function(e){var t=0===e[0]?12:20;return qo(e[t]<<24|e[1+t]<<16|e[2+t]<<8|e[3+t])},o((function(t,i){function r(e){return e?e.replace(/avc1\.(\d+)\.(\d+)/i,(function(e,t,i){return"avc1."+("00"+Number(t).toString(16)).slice(-2)+"00"+("00"+Number(i).toString(16)).slice(-2)})):e}function n(e){return e.map(r)}function a(e){void 0===e&&(e="");var t=e.split(","),i={};return t.forEach((function(e){e=e.trim(),["video","audio"].forEach((function(t){var r=l[t].exec(e.toLowerCase());if(r&&!(r.length<=1)){var n=e.substring(0,r[1].length),a=e.replace(n,"");i[t]={type:n,details:a}}}))})),i}function s(e){return void 0===e&&(e=""),l.audio.test(e.trim().toLowerCase())}function o(e){if(e&&"string"==typeof e){var t=e.toLowerCase().split(",").map((function(e){return r(e.trim())})),i="video";1===t.length&&s(t[0])&&(i="audio");var n="mp4";return t.every((function(e){return l.mp4.test(e)}))?n="mp4":t.every((function(e){return l.webm.test(e)}))?n="webm":t.every((function(e){return l.ogg.test(e)}))&&(n="ogg"),i+"/"+n+';codecs="'+e+'"'}}Object.defineProperty(i,"__esModule",{value:!0});var u=function(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}(e),l={mp4:/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v)/,webm:/^(vp0?[89]|av0?1|opus|vorbis)/,ogg:/^(vp0?[89]|theora|flac|opus|vorbis)/,video:/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,audio:/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3)/,muxerVideo:/^(avc0?1)/,muxerAudio:/^(mp4a)/};i.DEFAULT_AUDIO_CODEC="mp4a.40.2",i.DEFAULT_VIDEO_CODEC="avc1.4d400d",i.browserSupportsCodec=function(e){return void 0===e&&(e=""),u.default.MediaSource&&u.default.MediaSource.isTypeSupported&&u.default.MediaSource.isTypeSupported(o(e))||!1},i.codecsFromDefault=function(e,t){if(!e.mediaGroups.AUDIO||!t)return null;var i=e.mediaGroups.AUDIO[t];if(!i)return null;for(var r in i){var n=i[r];if(n.default&&n.playlists)return a(n.playlists[0].attributes.CODECS)}return null},i.getMimeForCodec=o,i.isAudioCodec=s,i.isVideoCodec=function(e){return void 0===e&&(e=""),l.video.test(e.trim().toLowerCase())},i.mapLegacyAvcCodecs=function(e){return e.replace(/avc1\.(\d+)\.(\d+)/i,(function(e){return n([e])[0]}))},i.muxerSupportsCodec=function(e){return void 0===e&&(e=""),e.toLowerCase().split(",").every((function(e){return e=e.trim(),l.muxerVideo.test(e)||l.muxerAudio.test(e)}))},i.parseCodecs=a,i.translateLegacyCodec=r,i.translateLegacyCodecs=n})));function zo(e,t,i){return e&&i&&i.responseURL&&t!==i.responseURL?i.responseURL:t}function Yo(e,t){return e+"-"+t}function Xo(e){var t=e.manifestString,i=e.customTagParsers,r=void 0===i?[]:i,n=e.customTagMappers,a=void 0===n?[]:n,s=new pa;return r.forEach((function(e){return s.addParser(e)})),a.forEach((function(e){return s.addTagMapper(e)})),s.push(t),s.end(),s.manifest}function Qo(e,t){["AUDIO","SUBTITLES"].forEach((function(i){for(var r in e.mediaGroups[i])for(var n in e.mediaGroups[i][r])t(e.mediaGroups[i][r][n],i,r,n)}))}function $o(e){var t=e.playlist,i=e.uri;t.id=e.id,i&&(t.uri=i),t.attributes=t.attributes||{}}function Jo(e,t){e.uri=t;for(var i=0;i<e.playlists.length;i++)e.playlists[i].uri||(e.playlists[i].uri="placeholder-uri-"+i);Qo(e,(function(t,i,r,n){if(t.playlists&&t.playlists.length&&!t.playlists[0].uri){var a="placeholder-uri-"+i+"-"+r+"-"+n,s=Yo(0,a);t.playlists[0].uri=a,t.playlists[0].id=s,e.playlists[s]=t.playlists[0],e.playlists[a]=t.playlists[0]}})),function(e){for(var t=e.playlists.length;t--;){var i=e.playlists[t];$o({playlist:i,id:Yo(t,i.uri)}),i.resolvedUri=Qu(e.uri,i.uri),e.playlists[i.id]=i,(e.playlists[i.uri]=i).attributes.BANDWIDTH||$u.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}}(e),function(e){Qo(e,(function(t){t.uri&&(t.resolvedUri=Qu(e.uri,t.uri))}))}(e)}function Zo(e,t){e.resolvedUri||(e.resolvedUri=Qu(t,e.uri)),e.key&&!e.key.resolvedUri&&(e.key.resolvedUri=Qu(t,e.key.uri)),e.map&&!e.map.resolvedUri&&(e.map.resolvedUri=Qu(t,e.map.uri))}function eu(e,t){var i=Ju(e,{}),r=i.playlists[t.id];if(!r)return null;if(r.segments&&t.segments&&r.segments.length===t.segments.length&&r.endList===t.endList&&r.mediaSequence===t.mediaSequence)return null;var n=Ju(r,t);r.segments&&(n.segments=function(e,t,i){var r=t.slice();i=i||0;for(var n=Math.min(e.length,t.length+i),a=i;a<n;a++)r[a-i]=Ju(e[a],r[a-i]);return r}(r.segments,t.segments,t.mediaSequence-r.mediaSequence)),n.segments.forEach((function(e){Zo(e,n.resolvedUri)}));for(var a=0;a<i.playlists.length;a++)i.playlists[a].id===t.id&&(i.playlists[a]=n);return i.playlists[t.id]=n,i.playlists[t.uri]=n,i}function tu(e,t){var i=e.segments[e.segments.length-1];return t&&i&&i.duration?1e3*i.duration:500*(e.targetDuration||10)}function iu(e,t){var i,r=[];if(e&&e.length)for(i=0;i<e.length;i++)t(e.start(i),e.end(i))&&r.push([e.start(i),e.end(i)]);return ea.createTimeRanges(r)}function ru(e,t){return iu(e,(function(e,i){return e-.1<=t&&t<=i+.1}))}function nu(e,t){return iu(e,(function(e){return t<=e-el}))}function au(e){var t=[];if(!e||!e.length)return"";for(var i=0;i<e.length;i++)t.push(e.start(i)+" => "+e.end(i));return t.join(", ")}function su(e){for(var t=[],i=0;i<e.length;i++)t.push({start:e.start(i),end:e.end(i)});return t}function ou(e,t,i){if(void 0===t&&(t=e.mediaSequence+e.segments.length),t<e.mediaSequence)return 0;var r=function(e,t){var i=0,r=t-e.mediaSequence,n=e.segments[r];if(n){if(void 0!==n.start)return{result:n.start,precise:!0};if(void 0!==n.end)return{result:n.end-n.duration,precise:!0}}for(;r--;){if(void 0!==(n=e.segments[r]).end)return{result:i+n.end,precise:!0};if(i+=n.duration,void 0!==n.start)return{result:i+n.start,precise:!0}}return{result:i,precise:!1}}(e,t);if(r.precise)return r.result;var n=function(e,t){for(var i,r=0,n=t-e.mediaSequence;n<e.segments.length;n++){if(void 0!==(i=e.segments[n]).start)return{result:i.start-r,precise:!0};if(r+=i.duration,void 0!==i.end)return{result:i.end-r,precise:!0}}return{result:-1,precise:!1}}(e,t);return n.precise?n.result:r.result+i}function uu(t,i,r){if(!t)return 0;if("number"!=typeof r&&(r=0),void 0===i){if(t.totalDuration)return t.totalDuration;if(!t.endList)return e.Infinity}return ou(t,i,r)}function lu(e,t,i){var r=0;if(i<t){var n=[i,t];t=n[0],i=n[1]}if(t<0){for(var a=t;a<Math.min(0,i);a++)r+=e.targetDuration;t=0}for(var s=t;s<i;s++)r+=e.segments[s].duration;return r}function cu(e,t){if(!e.segments.length)return 0;var i=e.segments.length,r="number"==typeof t?t:(e.segments[i-1].duration||e.targetDuration)+2*e.targetDuration;if(0===r)return i;for(var n=0;i--&&!(r<=(n+=e.segments[i].duration)););return Math.max(0,i)}function du(e,t,i,r){if(!e||!e.segments)return null;if(e.endList)return uu(e);if(null===t)return null;t=t||0;var n=i?cu(e,r):e.segments.length;return ou(e,e.mediaSequence+n,t)}function hu(e){return e.excludeUntil&&e.excludeUntil>Date.now()}function fu(e){return e.excludeUntil&&e.excludeUntil===1/0}function pu(e){var t=hu(e);return!e.disabled&&!t}function gu(e,t){return t.attributes&&t.attributes[e]}function mu(e,t){if(1===e.playlists.length)return!0;var i=t.attributes.BANDWIDTH||Number.MAX_VALUE;return 0===e.playlists.filter((function(e){return!!pu(e)&&(e.attributes.BANDWIDTH||0)<i})).length}function vu(e,t,i,r){var n="arraybuffer"===e.responseType?e.response:e.responseText;!t&&n&&(e.responseTime=Date.now(),e.roundTripTime=e.responseTime-e.requestTime,e.bytesReceived=n.byteLength||n.length,e.bandwidth||(e.bandwidth=Math.floor(e.bytesReceived/e.roundTripTime*8*1e3))),i.headers&&(e.responseHeaders=i.headers),t&&"ETIMEDOUT"===t.code&&(e.timedout=!0),t||e.aborted||200===i.statusCode||206===i.statusCode||0===i.statusCode||(t=new Error("XHR Failed with a response of: "+(e&&(n||e.responseText)))),r(t,e)}function yu(){return function e(t,i){t=nl({timeout:45e3},t);var r=e.beforeRequest||ea.Vhs.xhr.beforeRequest;if(r&&"function"==typeof r){var n=r(t);n&&(t=n)}var a=rl(t,(function(e,t){return vu(a,e,t,i)})),s=a.abort;return a.abort=function(){return a.aborted=!0,s.apply(a,arguments)},a.uri=t.uri,a.requestTime=Date.now(),a}}function _u(e){var t={};return e.byterange&&(t.Range=function(e){return"bytes="+e.offset+"-"+(e.offset+e.length-1)}(e.byterange)),t}function bu(e,t){var i=e.toString(16);return"00".substring(0,2-i.length)+i+(t%2?" ":"")}function Tu(e){return 32<=e&&e<126?String.fromCharCode(e):"."}function Su(e){var t={};return Object.keys(e).forEach((function(i){var r=e[i];t[i]=ArrayBuffer.isView(r)?{bytes:r.buffer,byteOffset:r.byteOffset,byteLength:r.byteLength}:r})),t}function Eu(e){var t=e.byterange||{length:1/0,offset:0};return[t.length,t.offset,e.resolvedUri].join(",")}function ku(e){return e.resolvedUri}function wu(e){for(var t=Array.prototype.slice.call(e),i="",r=0;r<t.length/16;r++)i+=t.slice(16*r,16*r+16).map(bu).join("")+" "+t.slice(16*r,16*r+16).map(Tu).join("")+"\n";return i}function Cu(e,t){if(4===e.readyState)return t()}function Au(e){var t=e.srcUrl,i=to(e.masterXml,{manifestUri:t,clientOffset:e.clientOffset,sidxMapping:e.sidxMapping});return Jo(i,t),i}function Lu(e,t){for(var i=!0,r=sl(e,{duration:t.duration,minimumUpdatePeriod:t.minimumUpdatePeriod}),n=0;n<t.playlists.length;n++){var a=eu(r,t.playlists[n]);a&&(r=a,i=!1)}return Qo(t,(function(e,t,n,a){if(e.playlists&&e.playlists.length){var s=e.playlists[0].id,o=eu(r,e.playlists[0]);o&&((r=o).mediaGroups[t][n][a].playlists[0]=r.playlists[s],i=!1)}})),t.minimumUpdatePeriod!==e.minimumUpdatePeriod&&(i=!1),i?null:r}function Iu(e){return e.uri+"-"+e.byterange.offset+"-"+(e.byterange.offset+e.byterange.length-1)}function Ru(e,t){var i,r,n={};for(var a in e){var s=e[a].sidx;if(s){var o=Iu(s);if(!t[o])break;i=t[o].sidxInfo,r=s,(Boolean(!i.map&&!r.map)||Boolean(i.map&&r.map&&i.map.byterange.offset===r.map.byterange.offset&&i.map.byterange.length===r.map.byterange.length))&&i.uri===r.uri&&i.byterange.offset===r.byterange.offset&&i.byterange.length===r.byterange.length&&(n[o]=t[o])}}return n}function Du(e,t,i,r,n,a){var s={uri:zo(n.handleManifestRedirects,t.resolvedUri),byterange:t.byterange,playlist:i},o=ea.mergeOptions(s,{responseType:"arraybuffer",headers:_u(s)});return function(e,t,i){function r(e,t,r,n){return t.abort(),o=!0,i(e,t,r,n)}function n(e,t){if(!o){if(e)return r(e,t,"",s);var i=t.responseText.substring(s&&s.byteLength||0,t.responseText.length);if(s=To(s,So(i,!0)),a=a||vo(s),s.length<10||a&&s.length<a+2)return Cu(t,(function(){return r(e,t,"",s)}));var n=mo(s);return"ts"===n&&s.length<188||!n&&s.length<376?Cu(t,(function(){return r(e,t,"",s)})):r(null,t,n,s)}}var a,s=[],o=!1,u=t({uri:e,beforeSend:function(e){e.overrideMimeType("text/plain; charset=x-user-defined"),e.addEventListener("progress",(function(t){return vu(e,null,{statusCode:e.status},n)}))}},(function(e,t){return vu(u,e,t,n)}));return u}(s.uri,r,(function(t,n,u,l){if(t)return a(t,n);if(!u||"mp4"!==u)return a({status:n.status,message:"Unsupported "+(u||"unknown")+" container type for sidx segment at URL: "+s.uri,response:"",playlist:i,internal:!0,blacklistDuration:1/0,code:2},n);var c=s.byterange,d=c.offset,h=c.length;if(l.length>=h+d)return a(t,{response:l.subarray(d,d+h),status:n.status,uri:n.uri});e.request=r(o,a)}))}function Ou(e){for(var t=new Uint8Array(new ArrayBuffer(e.length)),i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t.buffer}function xu(e){var t=e.transmuxer,i=e.bytes,r=e.audioAppendStart,n=e.gopsToAlignWith,a=e.isPartial,s=e.remux,o=e.onData,u=e.onTrackInfo,l=e.onAudioTimingInfo,c=e.onVideoTimingInfo,d=e.onVideoSegmentTimingInfo,h=e.onId3,f=e.onCaptions,p=e.onDone,g={isPartial:a,buffer:[]};if(t.onmessage=function(e){Bu&&("data"===e.data.action&&function(e,t,i){var r=e.data.segment,n=r.type,a=r.initSegment,s=r.videoFrameDtsTime,o=r.videoFramePtsTime;t.buffer.push({captions:r.captions,captionStreams:r.captionStreams,metadata:r.metadata});var u=e.data.segment.boxes||{data:e.data.segment.data},l={type:n,data:new Uint8Array(u.data,u.data.byteOffset,u.data.byteLength),initSegment:new Uint8Array(a.data,a.byteOffset,a.byteLength)};void 0!==s&&(l.videoFrameDtsTime=s),void 0!==o&&(l.videoFramePtsTime=o),i(l)}(e,g,o),"trackinfo"===e.data.action&&u(e.data.trackInfo),"gopInfo"===e.data.action&&function(e,t){t.gopInfo=e.data.gopInfo}(e,g),"audioTimingInfo"===e.data.action&&l(e.data.audioTimingInfo),"videoTimingInfo"===e.data.action&&c(e.data.videoTimingInfo),"videoSegmentTimingInfo"===e.data.action&&d(e.data.videoSegmentTimingInfo),"id3Frame"===e.data.action&&h([e.data.id3Frame],e.data.id3Frame.dispatchType),"caption"===e.data.action&&f(e.data.caption),"transmuxed"===e.data.type&&(t.onmessage=null,function(e){var t=e.transmuxedData,i=e.callback;t.buffer=[],i(t)}({transmuxedData:g,callback:p}),cl()))},r&&t.postMessage({action:"setAudioAppendStart",appendStart:r}),Array.isArray(n)&&t.postMessage({action:"alignGopsWith",gopsToAlignWith:n}),void 0!==s&&t.postMessage({action:"setRemux",remux:s}),i.byteLength){var m=i instanceof ArrayBuffer?i:i.buffer,v=i instanceof ArrayBuffer?0:i.byteOffset;t.postMessage({action:"push",data:m,byteOffset:v,byteLength:i.byteLength},[m])}t.postMessage({action:a?"partialFlush":"flush"})}function Pu(e,t){e.postMessage({action:t}),cl()}function Mu(e,t){Bu?ll.push(Pu.bind(null,t,e)):Pu(t,Bu=e)}function Nu(e){e.forEach((function(e){e.abort()}))}function Uu(e,t){return t.timedout?{status:t.status,message:"HLS request timed-out at URL: "+t.uri,code:fl,xhr:t}:t.aborted?{status:t.status,message:"HLS request aborted at URL: "+t.uri,code:pl,xhr:t}:e?{status:t.status,message:"HLS request errored at URL: "+t.uri,code:hl,xhr:t}:null}function Fu(e){var t=e.segment,i=e.bytes,r=e.isPartial,n=e.trackInfoFn,a=e.timingInfoFn,s=e.videoSegmentTimingInfoFn,o=e.id3Fn,u=e.captionsFn,l=e.dataFn,c=e.doneFn,d=new Uint8Array(i);if(yo(d)){t.isFmp4=!0;var h=t.map.tracks,f={isFmp4:!0,hasVideo:!!h.video,hasAudio:!!h.audio};h.audio&&h.audio.codec&&"enca"!==h.audio.codec&&(f.audioCodec=h.audio.codec),h.video&&h.video.codec&&"encv"!==h.video.codec&&(f.videoCodec=h.video.codec),h.video&&h.audio&&(f.isMuxed=!0),n(t,f);var p=function(e,t){var i,r,n;return i=Go(t,["moof","traf"]),r=[].concat.apply([],i.map((function(t){return Go(t,["tfhd"]).map((function(i){var r,n;return r=qo(i[4]<<24|i[5]<<16|i[6]<<8|i[7]),n=e[r]||9e4,(Go(t,["tfdt"]).map((function(e){var t,i;return t=e[0],i=qo(e[4]<<24|e[5]<<16|e[6]<<8|e[7]),1===t&&(i*=Math.pow(2,32),i+=qo(e[8]<<24|e[9]<<16|e[10]<<8|e[11])),i}))[0]||1/0)/n}))}))),n=Math.min.apply(null,r),isFinite(n)?n:0}(t.map.timescales,d);f.hasAudio&&!f.isMuxed&&a(t,"audio","start",p),f.hasVideo&&a(t,"video","start",p);var g=function(e){l(t,{data:i,type:f.hasAudio&&!f.isMuxed?"audio":"video"}),e&&e.length&&u(t,e),c(null,t,{})};if(!h.video||!i.byteLength||!t.transmuxer)return void g();var m=i instanceof ArrayBuffer?i:i.buffer,v=i instanceof ArrayBuffer?0:i.byteOffset;return t.transmuxer.addEventListener("message",(function e(r){if("mp4Captions"===r.data.action){t.transmuxer.removeEventListener("message",e);var n=r.data.data;t.bytes=i=new Uint8Array(n,n.byteOffset||0,n.byteLength),g(r.data.captions)}})),void t.transmuxer.postMessage({action:"pushMp4Captions",timescales:t.map.timescales,trackIds:[h.video.id],data:m,byteOffset:v,byteLength:i.byteLength},[m])}if(t.transmuxer){if(void 0===t.container&&(t.container=mo(d)),"ts"!==t.container&&"aac"!==t.container)return n(t,{hasAudio:!1,hasVideo:!1}),void c(null,t,{});!function(e){var t=e.segment,i=e.bytes,r=e.isPartial,n=e.trackInfoFn,a=e.timingInfoFn,s=e.videoSegmentTimingInfoFn,o=e.id3Fn,u=e.captionsFn,l=e.dataFn,c=e.doneFn,d=t.map&&t.map.tracks||{},h=Boolean(d.audio&&d.video),f=a.bind(null,t,"audio","start"),p=a.bind(null,t,"audio","end"),g=a.bind(null,t,"video","start"),m=a.bind(null,t,"video","end");if(!r&&!t.lastReachedChar){var v=function(e,t){var i=function(e,t){var i;return(i=Po.aac.isLikelyAacData(e)?function(e){for(var t,i=!1,r=0,n=null,a=null,s=0,o=0;3<=e.length-o;){switch(Po.aac.parseType(e,o)){case"timed-metadata":if(e.length-o<10){i=!0;break}if((s=Po.aac.parseId3TagSize(e,o))>e.length){i=!0;break}null===a&&(t=e.subarray(o,o+s),a=Po.aac.parseAacTimestamp(t)),o+=s;break;case"audio":if(e.length-o<7){i=!0;break}if((s=Po.aac.parseAdtsSize(e,o))>e.length){i=!0;break}null===n&&(t=e.subarray(o,o+s),n=Po.aac.parseSampleRate(t)),r++,o+=s;break;default:o++}if(i)return null}if(null===n||null===a)return null;var u=Fo/n;return{audio:[{type:"audio",dts:a,pts:a},{type:"audio",dts:a+1024*r*u,pts:a+1024*r*u}]}}(e):function(e){var t={pid:null,table:null},i={};for(var r in function(e,t){for(var i,r=0,n=Bo;n<e.byteLength;)if(71!==e[r]||71!==e[n])r++,n++;else{switch(i=e.subarray(r,n),Po.ts.parseType(i,t.pid)){case"pat":t.pid||(t.pid=Po.ts.parsePat(i));break;case"pmt":t.table||(t.table=Po.ts.parsePmt(i))}if(t.pid&&t.table)return;r+=Bo,n+=Bo}}(e,t),t.table)if(t.table.hasOwnProperty(r))switch(t.table[r]){case 27:i.video=[],No(e,t,i),0===i.video.length&&delete i.video;break;case 15:i.audio=[],Mo(e,t,i),0===i.audio.length&&delete i.audio}return i}(e))&&(i.audio||i.video)?(function(e,t){if(e.audio&&e.audio.length){var i=t;void 0===i&&(i=e.audio[0].dts),e.audio.forEach((function(e){e.dts=xo(e.dts,i),e.pts=xo(e.pts,i),e.dtsTime=e.dts/Fo,e.ptsTime=e.pts/Fo}))}if(e.video&&e.video.length){var r=t;if(void 0===r&&(r=e.video[0].dts),e.video.forEach((function(e){e.dts=xo(e.dts,r),e.pts=xo(e.pts,r),e.dtsTime=e.dts/Fo,e.ptsTime=e.pts/Fo})),e.firstKeyFrame){var n=e.firstKeyFrame;n.dts=xo(n.dts,r),n.pts=xo(n.pts,r),n.dtsTime=n.dts/Fo,n.ptsTime=n.dts/Fo}}}(i,t),i):null}(e,t*Oo);if(!i)return null;var r={hasVideo:i.video&&2===i.video.length||!1,hasAudio:i.audio&&2===i.audio.length||!1};return r.hasVideo&&(r.videoStart=i.video[0].ptsTime),r.hasAudio&&(r.audioStart=i.audio[0].ptsTime),r}(i,t.baseStartTime);v&&(n(t,{hasAudio:v.hasAudio,hasVideo:v.hasVideo,isMuxed:h}),n=null,v.hasAudio&&!h&&f(v.audioStart),v.hasVideo&&g(v.videoStart),g=f=null)}!function(e){Bu?ll.push(e):xu(Bu=e)}({bytes:i,transmuxer:t.transmuxer,audioAppendStart:t.audioAppendStart,gopsToAlignWith:t.gopsToAlignWith,isPartial:r,remux:h,onData:function(e){e.type="combined"===e.type?"video":e.type,l(t,e)},onTrackInfo:function(e){n&&(h&&(e.isMuxed=!0),n(t,e))},onAudioTimingInfo:function(e){f&&void 0!==e.start&&(f(e.start),f=null),p&&void 0!==e.end&&p(e.end)},onVideoTimingInfo:function(e){g&&void 0!==e.start&&(g(e.start),g=null),m&&void 0!==e.end&&m(e.end)},onVideoSegmentTimingInfo:function(e){s(e)},onId3:function(e,i){o(t,e,i)},onCaptions:function(e){u(t,[e])},onDone:function(e){c&&!r&&(e.type="combined"===e.type?"video":e.type,c(null,t,e))}})}({segment:t,bytes:i,isPartial:r,trackInfoFn:n,timingInfoFn:a,videoSegmentTimingInfoFn:s,id3Fn:o,captionsFn:u,dataFn:l,doneFn:c})}else c(null,t,{})}s(Wo);var Bu,ju=Wo.DEFAULT_AUDIO_CODEC,Vu=Wo.DEFAULT_VIDEO_CODEC,Hu=Wo.browserSupportsCodec,Gu=Wo.codecsFromDefault,qu=Wo.getMimeForCodec,Ku=Wo.isAudioCodec,Wu=Wo.isVideoCodec,zu=Wo.muxerSupportsCodec,Yu=Wo.parseCodecs,Xu=Wo.translateLegacyCodec,Qu=oa,$u=ea.log,Ju=ea.mergeOptions,Zu=function(t){function i(e,i,r){var n;if(void 0===r&&(r={}),n=t.call(this)||this,!e)throw new Error("A non-empty playlist URL or object is required");var a=r.withCredentials,s=void 0!==a&&a,o=r.handleManifestRedirects,u=void 0!==o&&o;n.src=e,n.vhs_=i,n.withCredentials=s,n.handleManifestRedirects=u;var l=i.options_;return n.customTagParsers=l&&l.customTagParsers||[],n.customTagMappers=l&&l.customTagMappers||[],n.state="HAVE_NOTHING",n.on("mediaupdatetimeout",(function(){"HAVE_METADATA"===n.state&&(n.state="HAVE_CURRENT_METADATA",n.request=n.vhs_.xhr({uri:Qu(n.master.uri,n.media().uri),withCredentials:n.withCredentials},(function(e,t){if(n.request)return e?n.playlistRequestError(n.request,n.media(),"HAVE_METADATA"):void n.haveMetadata({playlistString:n.request.responseText,url:n.media().uri,id:n.media().id})})))})),n}qe(i,t);var r=i.prototype;return r.playlistRequestError=function(e,t,i){var r=t.uri,n=t.id;this.request=null,i&&(this.state=i),this.error={playlist:this.master.playlists[n],status:e.status,message:"HLS playlist request error at URL: "+r+".",responseText:e.responseText,code:500<=e.status?4:2},this.trigger("error")},r.haveMetadata=function(t){var i=this,r=t.playlistString,n=t.playlistObject,a=t.url,s=t.id;this.request=null,this.state="HAVE_METADATA";var o=n||Xo({manifestString:r,customTagParsers:this.customTagParsers,customTagMappers:this.customTagMappers});$o({playlist:o,uri:a,id:s});var u=eu(this.master,o);this.targetDuration=o.targetDuration,u?(this.master=u,this.media_=this.master.playlists[s]):this.trigger("playlistunchanged"),this.media().endList||(e.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=e.setTimeout((function(){i.trigger("mediaupdatetimeout")}),tu(this.media(),!!u))),this.trigger("loadedplaylist")},r.dispose=function(){this.trigger("dispose"),this.stopRequest(),e.clearTimeout(this.mediaUpdateTimeout),e.clearTimeout(this.finalRenditionTimeout),this.off()},r.stopRequest=function(){if(this.request){var e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}},r.media=function(t,i){var r=this;if(!t)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);if("string"==typeof t){if(!this.master.playlists[t])throw new Error("Unknown playlist URI: "+t);t=this.master.playlists[t]}if(e.clearTimeout(this.finalRenditionTimeout),i){var n=t.targetDuration/2*1e3||5e3;this.finalRenditionTimeout=e.setTimeout(this.media.bind(this,t,!1),n)}else{var a=this.state,s=!this.media_||t.id!==this.media_.id;if(this.master.playlists[t.id].endList||t.endList&&t.segments.length)return this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=t,void(s&&(this.trigger("mediachanging"),this.trigger("HAVE_MASTER"===a?"loadedmetadata":"mediachange")));if(s){if(this.state="SWITCHING_MEDIA",this.request){if(t.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.request=this.vhs_.xhr({uri:t.resolvedUri,withCredentials:this.withCredentials},(function(e,i){if(r.request){if(t.resolvedUri=zo(r.handleManifestRedirects,t.resolvedUri,i),e)return r.playlistRequestError(r.request,t,a);r.haveMetadata({playlistString:i.responseText,url:t.uri,id:t.id}),r.trigger("HAVE_MASTER"===a?"loadedmetadata":"mediachange")}}))}}},r.pause=function(){this.stopRequest(),e.clearTimeout(this.mediaUpdateTimeout),"HAVE_NOTHING"===this.state&&(this.started=!1),"SWITCHING_MEDIA"===this.state?this.state=this.media_?"HAVE_METADATA":"HAVE_MASTER":"HAVE_CURRENT_METADATA"===this.state&&(this.state="HAVE_METADATA")},r.load=function(t){var i=this;e.clearTimeout(this.mediaUpdateTimeout);var r=this.media();t?this.mediaUpdateTimeout=e.setTimeout((function(){return i.load()}),r?r.targetDuration/2*1e3:5e3):this.started?this.trigger(r&&!r.endList?"mediaupdatetimeout":"loadedplaylist"):this.start()},r.start=function(){var t=this;if(this.started=!0,"object"==typeof this.src)return this.src.uri||(this.src.uri=e.location.href),this.src.resolvedUri=this.src.uri,void setTimeout((function(){t.setupInitialPlaylist(t.src)}),0);this.request=this.vhs_.xhr({uri:this.src,withCredentials:this.withCredentials},(function(e,i){if(t.request){if(t.request=null,e)return t.error={status:i.status,message:"HLS playlist request error at URL: "+t.src+".",responseText:i.responseText,code:2},"HAVE_NOTHING"===t.state&&(t.started=!1),t.trigger("error");t.src=zo(t.handleManifestRedirects,t.src,i);var r=Xo({manifestString:i.responseText,customTagParsers:t.customTagParsers,customTagMappers:t.customTagMappers});t.setupInitialPlaylist(r)}}))},r.srcUri=function(){return"string"==typeof this.src?this.src:this.src.uri},r.setupInitialPlaylist=function(t){if(this.state="HAVE_MASTER",t.playlists)return this.master=t,Jo(this.master,this.srcUri()),t.playlists.forEach((function(e){e.segments&&e.segments.forEach((function(t){Zo(t,e.resolvedUri)}))})),this.trigger("loadedplaylist"),void(this.request||this.media(this.master.playlists[0]));var i=this.srcUri()||e.location.href;this.master=function(t,i){var r=Yo(0,i),n={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:e.location.href,resolvedUri:e.location.href,playlists:[{uri:i,id:r,resolvedUri:i,attributes:{}}]};return n.playlists[r]=n.playlists[0],n.playlists[i]=n.playlists[0],n}(0,i),this.haveMetadata({playlistObject:t,url:i,id:this.master.playlists[0].id}),this.trigger("loadedmetadata")},i}(ea.EventTarget),el=1/30,tl=ea.createTimeRange,il={duration:uu,seekable:function(e,t,i){var r=t||0,n=du(e,t,!0,i);return null===n?tl():tl(r,n)},safeLiveIndex:cu,getMediaInfoForTime:function(e,t,i,r){var n,a=e.segments.length,s=t-r;if(s<0){if(0<i)for(n=i-1;0<=n;n--)if(0<(s+=e.segments[n].duration+el))return{mediaIndex:n,startTime:r-lu(e,i,n)};return{mediaIndex:0,startTime:t}}if(i<0){for(n=i;n<0;n++)if((s-=e.targetDuration)<0)return{mediaIndex:0,startTime:t};i=0}for(n=i;n<a;n++)if((s-=e.segments[n].duration+el)<0)return{mediaIndex:n,startTime:r+lu(e,i,n)};return{mediaIndex:a-1,startTime:t}},isEnabled:pu,isDisabled:function(e){return e.disabled},isBlacklisted:hu,isIncompatible:fu,playlistEnd:du,isAes:function(e){for(var t=0;t<e.segments.length;t++)if(e.segments[t].key)return!0;return!1},hasAttribute:gu,estimateSegmentRequestTime:function(e,t,i,r){return void 0===r&&(r=0),gu("BANDWIDTH",i)?(e*i.attributes.BANDWIDTH-8*r)/t:NaN},isLowestEnabledRendition:mu},rl=ea.xhr,nl=ea.mergeOptions,al=Object.freeze({__proto__:null,createTransferableMessage:Su,initSegmentId:Eu,segmentKeyId:ku,hexDump:wu,tagDump:function(e){return wu(e.bytes)},textRanges:function(e){var t,i,r,n="";for(t=0;t<e.length;t++)n+=(i=e).start(r=t)+"-"+i.end(r)+" ";return n}}),sl=ea.mergeOptions,ol=function(t){function i(e,i,r,n){var a;void 0===r&&(r={}),a=t.call(this)||this;var s=r.withCredentials,o=void 0!==s&&s,u=r.handleManifestRedirects,l=void 0!==u&&u;if(a.vhs_=i,a.withCredentials=o,a.handleManifestRedirects=l,!e)throw new Error("A non-empty playlist URL or object is required");return a.on("minimumUpdatePeriod",(function(){a.refreshXml_()})),a.on("mediaupdatetimeout",(function(){a.refreshMedia_(a.media().id)})),a.state="HAVE_NOTHING",a.loadedPlaylists_={},"string"==typeof e?(a.srcUrl=e,a.sidxMapping_={},Be(a)):(a.setupChildLoader(n,e),a)}qe(i,t);var r=i.prototype;return r.setupChildLoader=function(e,t){this.masterPlaylistLoader_=e,this.childPlaylist_=t},r.dispose=function(){this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},e.clearTimeout(this.minimumUpdatePeriodTimeout_),e.clearTimeout(this.mediaRequest_),e.clearTimeout(this.mediaUpdateTimeout),this.off()},r.hasPendingRequest=function(){return this.request||this.mediaRequest_},r.stopRequest=function(){if(this.request){var e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}},r.sidxRequestFinished_=function(e,t,i,r){var n=this;return function(a,s){if(n.request){if(n.request=null,a)return n.error="object"==typeof a?a:{status:s.status,message:"DASH playlist request error at URL: "+e.uri,response:s.response,code:2},i&&(n.state=i),void n.trigger("error");var o=function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),references:[],referenceId:i.getUint32(4),timescale:i.getUint32(8),earliestPresentationTime:i.getUint32(12),firstOffset:i.getUint32(16)},n=i.getUint16(22);for(t=24;n;t+=12,n--)r.references.push({referenceType:(128&e[t])>>>7,referencedSize:2147483647&i.getUint32(t),subsegmentDuration:i.getUint32(t+4),startsWithSap:!!(128&e[t+8]),sapType:(112&e[t+8])>>>4,sapDeltaTime:268435455&i.getUint32(t+8)});return r}(Eo(s.response).subarray(8));return r(t,o)}}},r.media=function(t){var i=this;if(!t)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);var r=this.state;if("string"==typeof t){if(!this.master.playlists[t])throw new Error("Unknown playlist URI: "+t);t=this.master.playlists[t]}var n=!this.media_||t.id!==this.media_.id;if(n&&this.loadedPlaylists_[t.id]&&this.loadedPlaylists_[t.id].endList)return this.state="HAVE_METADATA",this.media_=t,void(n&&(this.trigger("mediachanging"),this.trigger("mediachange")));if(n)if(this.media_&&this.trigger("mediachanging"),t.sidx){var a,s;s=this.masterPlaylistLoader_?(a=this.masterPlaylistLoader_.master,this.masterPlaylistLoader_.sidxMapping_):(a=this.master,this.sidxMapping_);var o=Iu(t.sidx);s[o]={sidxInfo:t.sidx},this.request=Du(this,t.sidx,t,this.vhs_.xhr,{handleManifestRedirects:this.handleManifestRedirects},this.sidxRequestFinished_(t,a,r,(function(e,n){if(!e||!n)throw new Error("failed to request sidx");s[o].sidx=n,i.haveMetadata({startingState:r,playlist:e.playlists[t.id]})})))}else this.mediaRequest_=e.setTimeout(this.haveMetadata.bind(this,{startingState:r,playlist:t}),0)},r.haveMetadata=function(e){var t=e.startingState,i=e.playlist;this.state="HAVE_METADATA",this.loadedPlaylists_[i.id]=i,this.mediaRequest_=null,this.refreshMedia_(i.id),this.trigger("HAVE_MASTER"===t?"loadedmetadata":"mediachange")},r.pause=function(){this.stopRequest(),e.clearTimeout(this.mediaUpdateTimeout),e.clearTimeout(this.minimumUpdatePeriodTimeout_),"HAVE_NOTHING"===this.state&&(this.started=!1)},r.load=function(t){var i=this;e.clearTimeout(this.mediaUpdateTimeout),e.clearTimeout(this.minimumUpdatePeriodTimeout_);var r=this.media();t?this.mediaUpdateTimeout=e.setTimeout((function(){return i.load()}),r?r.targetDuration/2*1e3:5e3):this.started?this.trigger(r&&!r.endList?"mediaupdatetimeout":"loadedplaylist"):this.start()},r.start=function(){var t=this;this.started=!0,this.masterPlaylistLoader_?this.mediaRequest_=e.setTimeout(this.haveMaster_.bind(this),0):this.request=this.vhs_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},(function(e,i){if(t.request){if(t.request=null,e)return t.error={status:i.status,message:"DASH playlist request error at URL: "+t.srcUrl,responseText:i.responseText,code:2},"HAVE_NOTHING"===t.state&&(t.started=!1),t.trigger("error");t.masterXml_=i.responseText,t.masterLoaded_=i.responseHeaders&&i.responseHeaders.date?Date.parse(i.responseHeaders.date):Date.now(),t.srcUrl=zo(t.handleManifestRedirects,t.srcUrl,i),t.syncClientServerClock_(t.onClientServerClockSync_.bind(t))}}))},r.syncClientServerClock_=function(e){var t=this,i=function(e){return function(e){var t=Ys(e,"UTCTiming")[0];if(!t)return null;var i=$s(t);switch(i.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":i.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":i.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":i.method="DIRECT",i.value=Date.parse(i.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error("UNSUPPORTED_UTC_TIMING_SCHEME")}return i}(eo(e))}(this.masterXml_);return null===i?(this.clientOffset_=this.masterLoaded_-Date.now(),e()):"DIRECT"===i.method?(this.clientOffset_=i.value-Date.now(),e()):void(this.request=this.vhs_.xhr({uri:Qu(this.srcUrl,i.value),method:i.method,withCredentials:this.withCredentials},(function(r,n){if(t.request){if(r)return t.clientOffset_=t.masterLoaded_-Date.now(),e();var a;a="HEAD"===i.method?n.responseHeaders&&n.responseHeaders.date?Date.parse(n.responseHeaders.date):t.masterLoaded_:Date.parse(n.responseText),t.clientOffset_=a-Date.now(),e()}})))},r.haveMaster_=function(){this.state="HAVE_MASTER",this.mediaRequest_=null,this.masterPlaylistLoader_?this.media_||this.media(this.childPlaylist_):(this.updateMainManifest_(Au({masterXml:this.masterXml_,srcUrl:this.srcUrl,clientOffset:this.clientOffset_,sidxMapping:this.sidxMapping_})),this.trigger("loadedplaylist"))},r.updateMinimumUpdatePeriodTimeout_=function(){var t=this;function i(i){t.minimumUpdatePeriodTimeout_=e.setTimeout((function(){t.trigger("minimumUpdatePeriod")}),i)}e.clearTimeout(this.minimumUpdatePeriodTimeout_);var r=this.master&&this.master.minimumUpdatePeriod;0<r?i(r):0===r&&(this.media()?i(1e3*this.media().targetDuration):this.one("loadedplaylist",(function(){i(1e3*t.media().targetDuration)})))},r.onClientServerClockSync_=function(){this.haveMaster_(),this.hasPendingRequest()||this.media_||this.media(this.master.playlists[0]),this.updateMinimumUpdatePeriodTimeout_()},r.updateMainManifest_=function(e){if(this.master=e,this.master.locations&&this.master.locations.length){var t=this.master.locations[0];t!==this.srcUrl&&(this.srcUrl=t)}},r.refreshXml_=function(){var e=this;this.request=this.vhs_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},(function(t,i){if(e.request){if(e.request=null,t)return e.error={status:i.status,message:"DASH playlist request error at URL: "+e.srcUrl,responseText:i.responseText,code:2},"HAVE_NOTHING"===e.state&&(e.started=!1),e.trigger("error");e.masterXml_=i.responseText,e.sidxMapping_=function(e,t,i,r){var n=to(e,{manifestUri:t,clientOffset:i}),a=Ru(n.playlists,r);return Qo(n,(function(e,t,i,n){e.playlists&&e.playlists.length&&(a=sl(a,Ru(e.playlists,r)))})),a}(e.masterXml_,e.srcUrl,e.clientOffset_,e.sidxMapping_);var r=Au({masterXml:e.masterXml_,srcUrl:e.srcUrl,clientOffset:e.clientOffset_,sidxMapping:e.sidxMapping_}),n=Lu(e.master,r),a=e.media().sidx;if(n)if(a){var s=Iu(a);if(!e.sidxMapping_[s]){var o=e.media();e.request=Du(e,o.sidx,o,e.vhs_.xhr,{handleManifestRedirects:e.handleManifestRedirects},e.sidxRequestFinished_(o,r,e.state,(function(t,i){if(!t||!i)throw new Error("failed to request sidx on minimumUpdatePeriod");e.sidxMapping_[s].sidx=i,e.updateMinimumUpdatePeriodTimeout_(),e.refreshMedia_(e.media().id)})))}}else e.updateMainManifest_(n),e.media_&&(e.media_=e.master.playlists[e.media_.id]);e.updateMinimumUpdatePeriodTimeout_()}}))},r.refreshMedia_=function(t){var i,r,n=this;if(!t)throw new Error("refreshMedia_ must take a media id");r=this.masterPlaylistLoader_?(i=this.masterPlaylistLoader_.master,Au({masterXml:this.masterPlaylistLoader_.masterXml_,srcUrl:this.masterPlaylistLoader_.srcUrl,clientOffset:this.masterPlaylistLoader_.clientOffset_,sidxMapping:this.masterPlaylistLoader_.sidxMapping_})):(i=this.master,Au({masterXml:this.masterXml_,srcUrl:this.srcUrl,clientOffset:this.clientOffset_,sidxMapping:this.sidxMapping_}));var a=Lu(i,r);a?(this.masterPlaylistLoader_?this.masterPlaylistLoader_.master=a:this.master=a,this.media_=a.playlists[t]):(this.media_=i.playlists[t],this.trigger("playlistunchanged")),this.media().endList||(this.mediaUpdateTimeout=e.setTimeout((function(){n.trigger("mediaupdatetimeout")}),tu(this.media(),!!a))),this.trigger("loadedplaylist")},i}(ea.EventTarget),ul={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,BACK_BUFFER_LENGTH:30,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,BUFFER_LOW_WATER_LINE_RATE:1},ll=[],cl=function(){Bu=null,ll.length&&("function"==typeof(Bu=ll.shift())?Bu():xu(Bu))},dl=function(e){Mu("reset",e)},hl=2,fl=-101,pl=-102,gl="undefined"!=typeof window?window:{},ml="undefined"==typeof Symbol?"__target":Symbol(),vl=gl.BlobBuilder||gl.WebKitBlobBuilder||gl.MozBlobBuilder||gl.MSBlobBuilder,yl=gl.URL||gl.webkitURL||yl&&yl.msURL,_l=gl.Worker;function bl(e,t){return function(i){var r=this;if(!t)return new _l(e);if(_l&&!i){var n=kl(t.toString().replace(/^function.+?{/,"").slice(0,-1));return this[ml]=new _l(n),function(e,t){if(e&&t){var i=e.terminate;e.objURL=t,e.terminate=function(){e.objURL&&yl.revokeObjectURL(e.objURL),i.call(e)}}}(this[ml],n),this[ml]}var a={postMessage:function(e){r.onmessage&&setTimeout((function(){r.onmessage({data:e,target:a})}))}};t.call(a),this.postMessage=function(e){setTimeout((function(){a.onmessage({data:e,target:r})}))},this.isThisThread=!0}}if(_l){var Tl,Sl=kl("self.onmessage = function () {}"),El=new Uint8Array(1);try{(Tl=new _l(Sl)).postMessage(El,[El.buffer])}catch(na){_l=null}finally{yl.revokeObjectURL(Sl),Tl&&Tl.terminate()}}function kl(e){try{return yl.createObjectURL(new Blob([e],{type:"application/javascript"}))}catch(na){var t=new vl;return t.append(e),yl.createObjectURL(t.getBlob(type))}}function wl(e,t){var i=t.attributes||{};return e&&e.mediaGroups&&e.mediaGroups.AUDIO&&i.AUDIO&&e.mediaGroups.AUDIO[i.AUDIO]}function Cl(e,t){var i=t.attributes||{},r=function(e){var t=e.attributes||{};if(t.CODECS)return Yu(t.CODECS)}(t)||{};if(wl(e,t)&&!r.audio&&!function(e,t){if(!wl(e,t))return!0;var i=e.mediaGroups.AUDIO[(t.attributes||{}).AUDIO];for(var r in i)if(!i[r].uri&&!i[r].playlists)return!0;return!1}(e,t)){var n=Gu(e,i.AUDIO);n&&(r.audio=n.audio)}var a={};return r.video&&(a.video=Xu(""+r.video.type+r.video.details)),r.audio&&(a.audio=Xu(""+r.audio.type+r.audio.details)),a}function Al(e){return ea.log.debug?ea.log.debug.bind(ea,"VHS:",e+" >"):function(){}}function Ll(e){if(e&&e.playlist){var t=e.playlist;return JSON.stringify({id:t.id,bandwidth:e.bandwidth,width:e.width,height:e.height,codecs:t.attributes&&t.attributes.CODECS||""})}}function Il(t,i){if(!t)return"";var r=e.getComputedStyle(t);return r?r[i]:""}function Rl(e,t){var i=e.slice();e.sort((function(e,r){var n=t(e,r);return 0===n?i.indexOf(e)-i.indexOf(r):n}))}function Dl(t,i){var r,n;return t.attributes.BANDWIDTH&&(r=t.attributes.BANDWIDTH),i.attributes.BANDWIDTH&&(n=i.attributes.BANDWIDTH),(r=r||e.Number.MAX_VALUE)-(n||e.Number.MAX_VALUE)}function Ol(e,t,i){var r,n;if(i&&i.cues)for(r=i.cues.length;r--;)(n=i.cues[r]).startTime>=e&&n.endTime<=t&&i.removeCue(n)}function xl(e){return"number"==typeof e&&isFinite(e)}function Pl(e){return e+"TimingInfo"}function Ml(e){var t=e.startOfSegment,i=e.buffered;return e.overrideCheck||e.segmentTimeline!==e.currentTimeline?i.length?i.end(i.length-1):t:null}function Nl(e){var t=e.timelineChangeController,i=e.segmentTimeline,r=e.loaderType,n=e.audioDisabled;if(e.currentTimeline===i)return!1;if("audio"===r){var a=t.lastTimelineChange({type:"main"});return!a||a.to!==i}if("main"===r&&n){var s=t.pendingTimelineChange({type:"audio"});return!s||s.to!==i}return!1}var Ul=new bl("./transmuxer-worker.worker.js",(function(e,t){var i=this;!function(){function e(){this.init=function(){var e={};this.on=function(t,i){e[t]||(e[t]=[]),e[t]=e[t].concat(i)},this.off=function(t,i){var r;return!!e[t]&&(r=e[t].indexOf(i),e[t]=e[t].slice(),e[t].splice(r,1),-1<r)},this.trigger=function(t){var i,r,n,a;if(i=e[t])if(2===arguments.length)for(n=i.length,r=0;r<n;++r)i[r].call(this,arguments[1]);else{for(a=[],r=arguments.length,r=1;r<arguments.length;++r)a.push(arguments[r]);for(n=i.length,r=0;r<n;++r)i[r].apply(this,a)}},this.dispose=function(){e={}}}}e.prototype.pipe=function(e){return this.on("data",(function(t){e.push(t)})),this.on("done",(function(t){e.flush(t)})),this.on("partialdone",(function(t){e.partialFlush(t)})),this.on("endedtimeline",(function(t){e.endTimeline(t)})),this.on("reset",(function(t){e.reset(t)})),e},e.prototype.push=function(e){this.trigger("data",e)},e.prototype.flush=function(e){this.trigger("done",e)},e.prototype.partialFlush=function(e){this.trigger("partialdone",e)},e.prototype.endTimeline=function(e){this.trigger("endedtimeline",e)},e.prototype.reset=function(e){this.trigger("reset",e)};var t,r,n,a,s,o,u,l,c,d,h,f,p,g,m,v,y,_,b,T,S,E,k,w,C,A,L,I,R,D,O,x,P,M,N,U,F,B,j,V,H=e,G=Math.pow(2,32)-1;function q(e,t){var i={size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}};return i.dataOffset=t,i.compositionTimeOffset=e.pts-e.dts,i.duration=e.duration,i.size=4*e.length,i.size+=e.byteLength,e.keyFrame&&(i.flags.dependsOn=2,i.flags.isNonSyncSample=0),i}function K(e){for(var t=[];e--;)t.push(0);return t}function W(){W.prototype.init.call(this),this.captionPackets_=[],this.ccStreams_=[new ke(0,0),new ke(0,1),new ke(1,0),new ke(1,1)],this.reset(),this.ccStreams_.forEach((function(e){e.on("data",this.trigger.bind(this,"data")),e.on("partialdone",this.trigger.bind(this,"partialdone")),e.on("done",this.trigger.bind(this,"done"))}),this)}!function(){var e;if(E={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},"undefined"!=typeof Uint8Array){for(e in E)E.hasOwnProperty(e)&&(E[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);k=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),C=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),w=new Uint8Array([0,0,0,1]),A=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),L=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),I={video:A,audio:L},O=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),D=new Uint8Array([0,0,0,0,0,0,0,0]),x=new Uint8Array([0,0,0,0,0,0,0,0]),P=x,M=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),N=x,R=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}}(),t=function(e){var t,i,r=[],n=0;for(t=1;t<arguments.length;t++)r.push(arguments[t]);for(t=r.length;t--;)n+=r[t].byteLength;for(i=new Uint8Array(n+8),new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,i.byteLength),i.set(e,4),t=0,n=8;t<r.length;t++)i.set(r[t],n),n+=r[t].byteLength;return i},r=function(){return t(E.dinf,t(E.dref,O))},n=function(e){return t(E.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,e.audioobjecttype<<3|e.samplingfrequencyindex>>>1,e.samplingfrequencyindex<<7|e.channelcount<<3,6,1,2]))},m=function(e){return t(E.hdlr,I[e])},g=function(e){var i=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,e.duration>>>24&255,e.duration>>>16&255,e.duration>>>8&255,255&e.duration,85,196,0,0]);return e.samplerate&&(i[12]=e.samplerate>>>24&255,i[13]=e.samplerate>>>16&255,i[14]=e.samplerate>>>8&255,i[15]=255&e.samplerate),t(E.mdhd,i)},p=function(e){return t(E.mdia,g(e),m(e.type),o(e))},s=function(e){return t(E.mfhd,new Uint8Array([0,0,0,0,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e]))},o=function(e){return t(E.minf,"video"===e.type?t(E.vmhd,R):t(E.smhd,D),r(),y(e))},u=function(e,i){for(var r=[],n=i.length;n--;)r[n]=b(i[n]);return t.apply(null,[E.moof,s(e)].concat(r))},l=function(e){for(var i=e.length,r=[];i--;)r[i]=h(e[i]);return t.apply(null,[E.moov,d(4294967295)].concat(r).concat(c(e)))},c=function(e){for(var i=e.length,r=[];i--;)r[i]=T(e[i]);return t.apply(null,[E.mvex].concat(r))},d=function(e){var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return t(E.mvhd,i)},v=function(e){var i,r,n=e.samples||[],a=new Uint8Array(4+n.length);for(r=0;r<n.length;r++)a[r+4]=(i=n[r].flags).dependsOn<<4|i.isDependedOn<<2|i.hasRedundancy;return t(E.sdtp,a)},y=function(e){return t(E.stbl,_(e),t(E.stts,N),t(E.stsc,P),t(E.stsz,M),t(E.stco,x))},_=function(e){return t(E.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===e.type?U(e):F(e))},U=function(e){var i,r,n=e.sps||[],a=e.pps||[],s=[],o=[];for(i=0;i<n.length;i++)s.push((65280&n[i].byteLength)>>>8),s.push(255&n[i].byteLength),s=s.concat(Array.prototype.slice.call(n[i]));for(i=0;i<a.length;i++)o.push((65280&a[i].byteLength)>>>8),o.push(255&a[i].byteLength),o=o.concat(Array.prototype.slice.call(a[i]));if(r=[E.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&e.width)>>8,255&e.width,(65280&e.height)>>8,255&e.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),t(E.avcC,new Uint8Array([1,e.profileIdc,e.profileCompatibility,e.levelIdc,255].concat([n.length],s,[a.length],o))),t(E.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],e.sarRatio){var u=e.sarRatio[0],l=e.sarRatio[1];r.push(t(E.pasp,new Uint8Array([(4278190080&u)>>24,(16711680&u)>>16,(65280&u)>>8,255&u,(4278190080&l)>>24,(16711680&l)>>16,(65280&l)>>8,255&l])))}return t.apply(null,r)},F=function(e){return t(E.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&e.channelcount)>>8,255&e.channelcount,(65280&e.samplesize)>>8,255&e.samplesize,0,0,0,0,(65280&e.samplerate)>>8,255&e.samplerate,0,0]),n(e))},f=function(e){var i=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,0,(4278190080&e.duration)>>24,(16711680&e.duration)>>16,(65280&e.duration)>>8,255&e.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&e.width)>>8,255&e.width,0,0,(65280&e.height)>>8,255&e.height,0,0]);return t(E.tkhd,i)},b=function(e){var i,r,n,a,s,o;return i=t(E.tfhd,new Uint8Array([0,0,0,58,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),s=Math.floor(e.baseMediaDecodeTime/(1+G)),o=Math.floor(e.baseMediaDecodeTime%(1+G)),r=t(E.tfdt,new Uint8Array([1,0,0,0,s>>>24&255,s>>>16&255,s>>>8&255,255&s,o>>>24&255,o>>>16&255,o>>>8&255,255&o])),"audio"===e.type?(n=S(e,92),t(E.traf,i,r,n)):(a=v(e),n=S(e,a.length+92),t(E.traf,i,r,n,a))},h=function(e){return e.duration=e.duration||4294967295,t(E.trak,f(e),p(e))},T=function(e){var i=new Uint8Array([0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==e.type&&(i[i.length-1]=0),t(E.trex,i)},V=function(e,t){var i=0,r=0,n=0,a=0;return e.length&&(void 0!==e[0].duration&&(i=1),void 0!==e[0].size&&(r=2),void 0!==e[0].flags&&(n=4),void 0!==e[0].compositionTimeOffset&&(a=8)),[0,0,i|r|n|a,1,(4278190080&e.length)>>>24,(16711680&e.length)>>>16,(65280&e.length)>>>8,255&e.length,(4278190080&t)>>>24,(16711680&t)>>>16,(65280&t)>>>8,255&t]},j=function(e,i){var r,n,a,s,o,u;for(i+=20+16*(s=e.samples||[]).length,a=V(s,i),(n=new Uint8Array(a.length+16*s.length)).set(a),r=a.length,u=0;u<s.length;u++)n[r++]=(4278190080&(o=s[u]).duration)>>>24,n[r++]=(16711680&o.duration)>>>16,n[r++]=(65280&o.duration)>>>8,n[r++]=255&o.duration,n[r++]=(4278190080&o.size)>>>24,n[r++]=(16711680&o.size)>>>16,n[r++]=(65280&o.size)>>>8,n[r++]=255&o.size,n[r++]=o.flags.isLeading<<2|o.flags.dependsOn,n[r++]=o.flags.isDependedOn<<6|o.flags.hasRedundancy<<4|o.flags.paddingValue<<1|o.flags.isNonSyncSample,n[r++]=61440&o.flags.degradationPriority,n[r++]=15&o.flags.degradationPriority,n[r++]=(4278190080&o.compositionTimeOffset)>>>24,n[r++]=(16711680&o.compositionTimeOffset)>>>16,n[r++]=(65280&o.compositionTimeOffset)>>>8,n[r++]=255&o.compositionTimeOffset;return t(E.trun,n)},B=function(e,i){var r,n,a,s,o,u;for(i+=20+8*(s=e.samples||[]).length,a=V(s,i),(r=new Uint8Array(a.length+8*s.length)).set(a),n=a.length,u=0;u<s.length;u++)r[n++]=(4278190080&(o=s[u]).duration)>>>24,r[n++]=(16711680&o.duration)>>>16,r[n++]=(65280&o.duration)>>>8,r[n++]=255&o.duration,r[n++]=(4278190080&o.size)>>>24,r[n++]=(16711680&o.size)>>>16,r[n++]=(65280&o.size)>>>8,r[n++]=255&o.size;return t(E.trun,r)},S=function(e,t){return"audio"===e.type?B(e,t):j(e,t)},a=function(){return t(E.ftyp,k,w,k,C)};var z,Y,X,Q,$,J=function(e){return t(E.mdat,e)},Z=u,ee=function(e){var t,i=a(),r=l(e);return(t=new Uint8Array(i.byteLength+r.byteLength)).set(i),t.set(r,i.byteLength),t},te=function(e){var t,i,r=[],n=[];for(n.byteLength=0,n.nalCount=0,n.duration=0,t=r.byteLength=0;t<e.length;t++)"access_unit_delimiter_rbsp"===(i=e[t]).nalUnitType?(r.length&&(r.duration=i.dts-r.dts,n.byteLength+=r.byteLength,n.nalCount+=r.length,n.duration+=r.duration,n.push(r)),(r=[i]).byteLength=i.data.byteLength,r.pts=i.pts,r.dts=i.dts):("slice_layer_without_partitioning_rbsp_idr"===i.nalUnitType&&(r.keyFrame=!0),r.duration=i.dts-r.dts,r.byteLength+=i.data.byteLength,r.push(i));return n.length&&(!r.duration||r.duration<=0)&&(r.duration=n[n.length-1].duration),n.byteLength+=r.byteLength,n.nalCount+=r.length,n.duration+=r.duration,n.push(r),n},ie=function(e){var t,i,r=[],n=[];for(r.byteLength=0,r.nalCount=0,r.duration=0,r.pts=e[0].pts,r.dts=e[0].dts,n.byteLength=0,n.nalCount=0,n.duration=0,n.pts=e[0].pts,n.dts=e[0].dts,t=0;t<e.length;t++)(i=e[t]).keyFrame?(r.length&&(n.push(r),n.byteLength+=r.byteLength,n.nalCount+=r.nalCount,n.duration+=r.duration),(r=[i]).nalCount=i.length,r.byteLength=i.byteLength,r.pts=i.pts,r.dts=i.dts,r.duration=i.duration):(r.duration+=i.duration,r.nalCount+=i.length,r.byteLength+=i.byteLength,r.push(i));return n.length&&r.duration<=0&&(r.duration=n[n.length-1].duration),n.byteLength+=r.byteLength,n.nalCount+=r.nalCount,n.duration+=r.duration,n.push(r),n},re=function(e){var t;return!e[0][0].keyFrame&&1<e.length&&(t=e.shift(),e.byteLength-=t.byteLength,e.nalCount-=t.nalCount,e[0][0].dts=t.dts,e[0][0].pts=t.pts,e[0][0].duration+=t.duration),e},ne=function(e,t){var i,r=[];return i=q(e,t||0),r.push(i),r},ae=function(e){var t,i,r=0,n=new Uint8Array(e.byteLength+4*e.length),a=new DataView(n.buffer);for(t=0;t<e.length;t++)a.setUint32(r,(i=e[t]).data.byteLength),n.set(i.data,r+=4),r+=i.data.byteLength;return n},se=[33,16,5,32,164,27],oe=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],ue=(X=function(e,t){return e*t},Q=function(e){return e/9e4}),le=($=function(e,t){return e/t},function(e,t){return Y($(e,t))}),ce=function(e,t,i){return Q(i?e:e-t)},de=Y=function(e){return 9e4*e},he=ue,fe=function(e,t,i,r){var n,a,s,o,u,l=0,c=0,d=0;if(t.length&&(n=le(e.baseMediaDecodeTime,e.samplerate),a=Math.ceil(9e4/(e.samplerate/1024)),i&&r&&(l=n-Math.max(i,r),d=(c=Math.floor(l/a))*a),!(c<1||45e3<d))){for(s=(s=function(){if(!z){var e={96e3:[se,[227,64],K(154),[56]],88200:[se,[231],K(170),[56]],64e3:[se,[248,192],K(240),[56]],48e3:[se,[255,192],K(268),[55,148,128],K(54),[112]],44100:[se,[255,192],K(268),[55,163,128],K(84),[112]],32e3:[se,[255,192],K(268),[55,234],K(226),[112]],24e3:[se,[255,192],K(268),[55,255,128],K(268),[111,112],K(126),[224]],16e3:[se,[255,192],K(268),[55,255,128],K(268),[111,255],K(269),[223,108],K(195),[1,192]],12e3:[oe,K(268),[3,127,248],K(268),[6,255,240],K(268),[13,255,224],K(268),[27,253,128],K(259),[56]],11025:[oe,K(268),[3,127,248],K(268),[6,255,240],K(268),[13,255,224],K(268),[27,255,192],K(268),[55,175,128],K(108),[112]],8e3:[oe,K(268),[3,121,16],K(47),[7]]};z=function(e){return Object.keys(e).reduce((function(t,i){return t[i]=new Uint8Array(e[i].reduce((function(e,t){return e.concat(t)}),[])),t}),{})}(e)}return z}()[e.samplerate])||t[0].data,o=0;o<c;o++)t.splice(0,0,{data:s,dts:(u=t[0]).dts-a,pts:u.pts-a});e.baseMediaDecodeTime-=Math.floor(function(e,t){return X(Q(e),t)}(d,e.samplerate))}},pe=function(e,t,i){return t.minSegmentDts>=i?e:(t.minSegmentDts=1/0,e.filter((function(e){return e.dts>=i&&(t.minSegmentDts=Math.min(t.minSegmentDts,e.dts),t.minSegmentPts=t.minSegmentDts,!0)})))},ge=function(e){var t,i=[];for(t=0;t<e.length;t++)i.push({size:e[t].data.byteLength,duration:1024});return i},me=function(e){var t,i,r=0,n=new Uint8Array(function(e){var t,i=0;for(t=0;t<e.length;t++)i+=e[t].data.byteLength;return i}(e));for(t=0;t<e.length;t++)n.set((i=e[t]).data,r),r+=i.data.byteLength;return n},ve=function(e){delete e.minSegmentDts,delete e.maxSegmentDts,delete e.minSegmentPts,delete e.maxSegmentPts},ye=function(e,t){var i,r=e.minSegmentDts;return t||(r-=e.timelineStartInfo.dts),i=e.timelineStartInfo.baseMediaDecodeTime,i+=r,i=Math.max(0,i),"audio"===e.type&&(i*=e.samplerate/9e4,i=Math.floor(i)),i},_e=function(e,t){"number"==typeof t.pts&&(void 0===e.timelineStartInfo.pts&&(e.timelineStartInfo.pts=t.pts),e.minSegmentPts=void 0===e.minSegmentPts?t.pts:Math.min(e.minSegmentPts,t.pts),e.maxSegmentPts=void 0===e.maxSegmentPts?t.pts:Math.max(e.maxSegmentPts,t.pts)),"number"==typeof t.dts&&(void 0===e.timelineStartInfo.dts&&(e.timelineStartInfo.dts=t.dts),e.minSegmentDts=void 0===e.minSegmentDts?t.dts:Math.min(e.minSegmentDts,t.dts),e.maxSegmentDts=void 0===e.maxSegmentDts?t.dts:Math.max(e.maxSegmentDts,t.dts))};function be(e){return null===e?"":(e=Se[e]||e,String.fromCharCode(e))}function Te(){for(var e=[],t=15;t--;)e.push("");return e}(W.prototype=new H).push=function(e){var t,i,r;if("sei_rbsp"===e.nalUnitType&&4===(t=function(e){for(var t=0,i={payloadType:-1,payloadSize:0},r=0,n=0;t<e.byteLength&&128!==e[t];){for(;255===e[t];)r+=255,t++;for(r+=e[t++];255===e[t];)n+=255,t++;if(n+=e[t++],!i.payload&&4===r){if("GA94"===String.fromCharCode(e[t+3],e[t+4],e[t+5],e[t+6])){i.payloadType=r,i.payloadSize=n,i.payload=e.subarray(t,t+n);break}i.payload=void 0}t+=n,n=r=0}return i}(e.escapedRBSP)).payloadType&&(i=function(e){return 181!==e.payload[0]||49!=(e.payload[1]<<8|e.payload[2])||"GA94"!==String.fromCharCode(e.payload[3],e.payload[4],e.payload[5],e.payload[6])||3!==e.payload[7]?null:e.payload.subarray(8,e.payload.length-1)}(t)))if(e.dts<this.latestDts_)this.ignoreNextEqualDts_=!0;else{if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));r=function(e,t){var i,r,n,a,s=[];if(!(64&t[0]))return s;for(r=31&t[0],i=0;i<r;i++)a={type:3&t[2+(n=3*i)],pts:e},4&t[2+n]&&(a.ccData=t[3+n]<<8|t[4+n],s.push(a));return s}(e.pts,i),this.captionPackets_=this.captionPackets_.concat(r),this.latestDts_!==e.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=e.dts}},W.prototype.flushCCStreams=function(e){this.ccStreams_.forEach((function(t){return"flush"===e?t.flush():t.partialFlush()}),this)},W.prototype.flushStream=function(e){this.captionPackets_.length&&(this.captionPackets_.forEach((function(e,t){e.presortIndex=t})),this.captionPackets_.sort((function(e,t){return e.pts===t.pts?e.presortIndex-t.presortIndex:e.pts-t.pts})),this.captionPackets_.forEach((function(e){e.type<2&&this.dispatchCea608Packet(e)}),this),this.captionPackets_.length=0),this.flushCCStreams(e)},W.prototype.flush=function(){return this.flushStream("flush")},W.prototype.partialFlush=function(){return this.flushStream("partialFlush")},W.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach((function(e){e.reset()}))},W.prototype.dispatchCea608Packet=function(e){this.setsTextOrXDSActive(e)?this.activeCea608Channel_[e.type]=null:this.setsChannel1Active(e)?this.activeCea608Channel_[e.type]=0:this.setsChannel2Active(e)&&(this.activeCea608Channel_[e.type]=1),null!==this.activeCea608Channel_[e.type]&&this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)},W.prototype.setsChannel1Active=function(e){return 4096==(30720&e.ccData)},W.prototype.setsChannel2Active=function(e){return 6144==(30720&e.ccData)},W.prototype.setsTextOrXDSActive=function(e){return 256==(28928&e.ccData)||4138==(30974&e.ccData)||6186==(30974&e.ccData)};var Se={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},Ee=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],ke=function e(t,i){e.prototype.init.call(this),this.field_=t||0,this.dataChannel_=i||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(e){var t,i,r,n,a;if((t=32639&e.ccData)!==this.lastControlCode_){if(4096==(61440&t)?this.lastControlCode_=t:t!==this.PADDING_&&(this.lastControlCode_=null),r=t>>>8,n=255&t,t!==this.PADDING_)if(t===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(t===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(e.pts),this.flushDisplayed(e.pts),i=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=i,this.startPts_=e.pts;else if(t===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(e.pts);else if(t===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(e.pts);else if(t===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(e.pts);else if(t===this.CARRIAGE_RETURN_)this.clearFormatting(e.pts),this.flushDisplayed(e.pts),this.shiftRowsUp_(),this.startPts_=e.pts;else if(t===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(t===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(e.pts),this.displayed_=Te();else if(t===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=Te();else if(t===this.RESUME_DIRECT_CAPTIONING_)"paintOn"!==this.mode_&&(this.flushDisplayed(e.pts),this.displayed_=Te()),this.mode_="paintOn",this.startPts_=e.pts;else if(this.isSpecialCharacter(r,n))a=be((r=(3&r)<<8)|n),this[this.mode_](e.pts,a),this.column_++;else if(this.isExtCharacter(r,n))"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),a=be((r=(3&r)<<8)|n),this[this.mode_](e.pts,a),this.column_++;else if(this.isMidRowCode(r,n))this.clearFormatting(e.pts),this[this.mode_](e.pts," "),this.column_++,14==(14&n)&&this.addFormatting(e.pts,["i"]),1==(1&n)&&this.addFormatting(e.pts,["u"]);else if(this.isOffsetControlCode(r,n))this.column_+=3&n;else if(this.isPAC(r,n)){var s=Ee.indexOf(7968&t);"rollUp"===this.mode_&&(s-this.rollUpRows_+1<0&&(s=this.rollUpRows_-1),this.setRollUp(e.pts,s)),s!==this.row_&&(this.clearFormatting(e.pts),this.row_=s),1&n&&-1===this.formatting_.indexOf("u")&&this.addFormatting(e.pts,["u"]),16==(16&t)&&(this.column_=4*((14&t)>>1)),this.isColorPAC(n)&&14==(14&n)&&this.addFormatting(e.pts,["i"])}else this.isNormalChar(r)&&(0===n&&(n=null),a=be(r),a+=be(n),this[this.mode_](e.pts,a),this.column_+=a.length)}else this.lastControlCode_=null}};function we(e,t){var i=1;for(t<e&&(i=-1);4294967296<Math.abs(t-e);)e+=8589934592*i;return e}function Ce(e){var t,i;Ce.prototype.init.call(this),this.type_=e||"shared",this.push=function(e){"shared"!==this.type_&&e.type!==this.type_||(void 0===i&&(i=e.dts),e.dts=we(e.dts,i),e.pts=we(e.pts,i),t=e.dts,this.trigger("data",e))},this.flush=function(){i=t,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){t=i=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}}ke.prototype=new H,ke.prototype.flushDisplayed=function(e){var t=this.displayed_.map((function(e){try{return e.trim()}catch(e){return""}})).join("\n").replace(/^\n+|\n+$/g,"");t.length&&this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})},ke.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=Te(),this.nonDisplayed_=Te(),this.lastControlCode_=null,this.column_=0,this.row_=14,this.rollUpRows_=2,this.formatting_=[]},ke.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},ke.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&48<=t&&t<=63},ke.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&32<=t&&t<=63},ke.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&32<=t&&t<=47},ke.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&33<=t&&t<=35},ke.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&64<=t&&t<=127},ke.prototype.isColorPAC=function(e){return 64<=e&&e<=79||96<=e&&e<=127},ke.prototype.isNormalChar=function(e){return 32<=e&&e<=127},ke.prototype.setRollUp=function(e,t){if("rollUp"!==this.mode_&&(this.row_=14,this.mode_="rollUp",this.flushDisplayed(e),this.nonDisplayed_=Te(),this.displayed_=Te()),void 0!==t&&t!==this.row_)for(var i=0;i<this.rollUpRows_;i++)this.displayed_[t-i]=this.displayed_[this.row_-i],this.displayed_[this.row_-i]="";void 0===t&&(t=this.row_),this.topRow_=t-this.rollUpRows_+1},ke.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var i=t.reduce((function(e,t){return e+"<"+t+">"}),"");this[this.mode_](e,i)},ke.prototype.clearFormatting=function(e){if(this.formatting_.length){var t=this.formatting_.reverse().reduce((function(e,t){return e+"</"+t+">"}),"");this.formatting_=[],this[this.mode_](e,t)}},ke.prototype.popOn=function(e,t){var i=this.nonDisplayed_[this.row_];this.nonDisplayed_[this.row_]=i+=t},ke.prototype.rollUp=function(e,t){var i=this.displayed_[this.row_];this.displayed_[this.row_]=i+=t},ke.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++)this.displayed_[e]="";for(e=this.row_+1;e<15;e++)this.displayed_[e]="";for(e=this.topRow_;e<this.row_;e++)this.displayed_[e]=this.displayed_[e+1];this.displayed_[this.row_]=""},ke.prototype.paintOn=function(e,t){var i=this.displayed_[this.row_];this.displayed_[this.row_]=i+=t};var Ae={CaptionStream:W,Cea608Stream:ke},Le={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21};function Ie(e,t,i){var r,n="";for(r=t;r<i;r++)n+="%"+("00"+e[r].toString(16)).slice(-2);return n}function Re(e,t,i){return decodeURIComponent(Ie(e,t,i))}function De(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]}Ce.prototype=new H;var Oe,xe=Ce,Pe={TXXX:function(e){var t;if(3===e.data[0]){for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=Re(e.data,1,t),e.value=Re(e.data,t+1,e.data.length).replace(/\0*$/,"");break}e.data=e.value}},WXXX:function(e){var t;if(3===e.data[0])for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=Re(e.data,1,t),e.url=Re(e.data,t+1,e.data.length);break}},PRIV:function(e){var t;for(t=0;t<e.data.length;t++)if(0===e.data[t]){e.owner=unescape(Ie(e.data,0,t));break}e.privateData=e.data.subarray(t+1),e.data=e.privateData}};(Oe=function(e){var t,i={debug:!(!e||!e.debug),descriptor:e&&e.descriptor},r=0,n=[],a=0;if(Oe.prototype.init.call(this),this.dispatchType=Le.METADATA_STREAM_TYPE.toString(16),i.descriptor)for(t=0;t<i.descriptor.length;t++)this.dispatchType+=("00"+i.descriptor[t].toString(16)).slice(-2);this.push=function(e){var t,i,s,o,u;if("timed-metadata"===e.type)if(e.dataAlignmentIndicator&&(a=0,n.length=0),0===n.length&&(e.data.length<10||e.data[0]!=="I".charCodeAt(0)||e.data[1]!=="D".charCodeAt(0)||e.data[2]!=="3".charCodeAt(0)));else if(n.push(e),a+=e.data.byteLength,1===n.length&&(r=De(e.data.subarray(6,10)),r+=10),!(a<r)){for(t={data:new Uint8Array(r),frames:[],pts:n[0].pts,dts:n[0].dts},u=0;u<r;)t.data.set(n[0].data.subarray(0,r-u),u),u+=n[0].data.byteLength,a-=n[0].data.byteLength,n.shift();i=10,64&t.data[5]&&(i+=4,i+=De(t.data.subarray(10,14)),r-=De(t.data.subarray(16,20)));do{if((s=De(t.data.subarray(i+4,i+8)))<1)return;if((o={id:String.fromCharCode(t.data[i],t.data[i+1],t.data[i+2],t.data[i+3]),data:t.data.subarray(i+10,i+s+10)}).key=o.id,Pe[o.id]&&(Pe[o.id](o),"com.apple.streaming.transportStreamTimestamp"===o.owner)){var l=o.data,c=(1&l[3])<<30|l[4]<<22|l[5]<<14|l[6]<<6|l[7]>>>2;c*=4,o.timeStamp=c+=3&l[7],void 0===t.pts&&void 0===t.dts&&(t.pts=o.timeStamp,t.dts=o.timeStamp),this.trigger("timestamp",o)}t.frames.push(o),i+=10,i+=s}while(i<r);this.trigger("data",t)}}}).prototype=new H;var Me,Ne,Ue,Fe=Oe,Be=xe;(Me=function(){var e=new Uint8Array(188),t=0;Me.prototype.init.call(this),this.push=function(i){var r,n=0,a=188;for(t?((r=new Uint8Array(i.byteLength+t)).set(e.subarray(0,t)),r.set(i,t),t=0):r=i;a<r.byteLength;)71!==r[n]||71!==r[a]?(n++,a++):(this.trigger("data",r.subarray(n,a)),n+=188,a+=188);n<r.byteLength&&(e.set(r.subarray(n),0),t=r.byteLength-n)},this.flush=function(){188===t&&71===e[0]&&(this.trigger("data",e),t=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){t=0,this.trigger("reset")}}).prototype=new H,(Ne=function(){var e,t,i,r;Ne.prototype.init.call(this),(r=this).packetsWaitingForPmt=[],this.programMapTable=void 0,e=function(e,r){var n=0;r.payloadUnitStartIndicator&&(n+=e[n]+1),"pat"===r.type?t(e.subarray(n),r):i(e.subarray(n),r)},t=function(e,t){t.section_number=e[7],t.last_section_number=e[8],r.pmtPid=(31&e[10])<<8|e[11],t.pmtPid=r.pmtPid},i=function(e,t){var i,n;if(1&e[5]){for(r.programMapTable={video:null,audio:null,"timed-metadata":{}},i=3+((15&e[1])<<8|e[2])-4,n=12+((15&e[10])<<8|e[11]);n<i;){var a=e[n],s=(31&e[n+1])<<8|e[n+2];a===Le.H264_STREAM_TYPE&&null===r.programMapTable.video?r.programMapTable.video=s:a===Le.ADTS_STREAM_TYPE&&null===r.programMapTable.audio?r.programMapTable.audio=s:a===Le.METADATA_STREAM_TYPE&&(r.programMapTable["timed-metadata"][s]=a),n+=5+((15&e[n+3])<<8|e[n+4])}t.programMapTable=r.programMapTable}},this.push=function(t){var i={},r=4;if(i.payloadUnitStartIndicator=!!(64&t[1]),i.pid=31&t[1],i.pid<<=8,i.pid|=t[2],1<(48&t[3])>>>4&&(r+=t[r]+1),0===i.pid)i.type="pat",e(t.subarray(r),i),this.trigger("data",i);else if(i.pid===this.pmtPid)for(i.type="pmt",e(t.subarray(r),i),this.trigger("data",i);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else void 0===this.programMapTable?this.packetsWaitingForPmt.push([t,r,i]):this.processPes_(t,r,i)},this.processPes_=function(e,t,i){i.streamType=i.pid===this.programMapTable.video?Le.H264_STREAM_TYPE:i.pid===this.programMapTable.audio?Le.ADTS_STREAM_TYPE:this.programMapTable["timed-metadata"][i.pid],i.type="pes",i.data=e.subarray(t),this.trigger("data",i)}}).prototype=new H,Ne.STREAM_TYPES={h264:27,adts:15},(Ue=function(){function e(e,t,r){var n,a,s=new Uint8Array(e.size),o={type:t},u=0,l=0;if(e.data.length&&!(e.size<9)){for(o.trackId=e.data[0].pid,u=0;u<e.data.length;u++)s.set((a=e.data[u]).data,l),l+=a.data.byteLength;!function(e,t){var i;t.packetLength=6+(e[4]<<8|e[5]),t.dataAlignmentIndicator=0!=(4&e[6]),192&(i=e[7])&&(t.pts=(14&e[9])<<27|(255&e[10])<<20|(254&e[11])<<12|(255&e[12])<<5|(254&e[13])>>>3,t.pts*=4,t.pts+=(6&e[13])>>>1,t.dts=t.pts,64&i&&(t.dts=(14&e[14])<<27|(255&e[15])<<20|(254&e[16])<<12|(255&e[17])<<5|(254&e[18])>>>3,t.dts*=4,t.dts+=(6&e[18])>>>1)),t.data=e.subarray(9+e[8])}(s,o),n="video"===t||o.packetLength<=e.size,(r||n)&&(e.size=0,e.data.length=0),n&&i.trigger("data",o)}}var t,i=this,r={data:[],size:0},n={data:[],size:0},a={data:[],size:0};Ue.prototype.init.call(this),this.push=function(s){({pat:function(){},pes:function(){var t,i;switch(s.streamType){case Le.H264_STREAM_TYPE:t=r,i="video";break;case Le.ADTS_STREAM_TYPE:t=n,i="audio";break;case Le.METADATA_STREAM_TYPE:t=a,i="timed-metadata";break;default:return}s.payloadUnitStartIndicator&&e(t,i,!0),t.data.push(s),t.size+=s.data.byteLength},pmt:function(){var e={type:"metadata",tracks:[]};null!==(t=s.programMapTable).video&&e.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+t.video,codec:"avc",type:"video"}),null!==t.audio&&e.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+t.audio,codec:"adts",type:"audio"}),i.trigger("data",e)}})[s.type]()},this.reset=function(){r.size=0,r.data.length=0,n.size=0,n.data.length=0,this.trigger("reset")},this.flushStreams_=function(){e(r,"video"),e(n,"audio"),e(a,"timed-metadata")},this.flush=function(){this.flushStreams_(),this.trigger("done")}}).prototype=new H;var je={PAT_PID:0,MP2T_PACKET_LENGTH:188,TransportPacketStream:Me,TransportParseStream:Ne,ElementaryStream:Ue,TimestampRolloverStream:Be,CaptionStream:Ae.CaptionStream,Cea608Stream:Ae.Cea608Stream,MetadataStream:Fe};for(var Ve in Le)Le.hasOwnProperty(Ve)&&(je[Ve]=Le[Ve]);var He,Ge=je,qe=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];(He=function(e){var t,i=0;He.prototype.init.call(this),this.push=function(r){var n,a,s,o,u=0;if(e||(i=0),"audio"===r.type)for(t?(a=t,(t=new Uint8Array(a.byteLength+r.data.byteLength)).set(a),t.set(r.data,a.byteLength)):t=r.data;u+5<t.length;)if(255===t[u]&&240==(246&t[u+1])){if(o=9e4*(s=1024*(1+(3&t[u+6])))/qe[(60&t[u+2])>>>2],t.byteLength<(n=u+((3&t[u+3])<<11|t[u+4]<<3|(224&t[u+5])>>5)))return;if(this.trigger("data",{pts:r.pts+i*o,dts:r.dts+i*o,sampleCount:s,audioobjecttype:1+(t[u+2]>>>6&3),channelcount:(1&t[u+2])<<2|(192&t[u+3])>>>6,samplerate:qe[(60&t[u+2])>>>2],samplingfrequencyindex:(60&t[u+2])>>>2,samplesize:16,data:t.subarray(u+7+2*(1&~t[u+1]),n)}),i++,t.byteLength===n)return void(t=void 0);t=t.subarray(n)}else u++},this.flush=function(){i=0,this.trigger("done")},this.reset=function(){t=void 0,this.trigger("reset")},this.endTimeline=function(){t=void 0,this.trigger("endedtimeline")}}).prototype=new H;var Ke,We,ze,Ye=He,Xe=function(e){var t=e.byteLength,i=0,r=0;this.length=function(){return 8*t},this.bitsAvailable=function(){return 8*t+r},this.loadWord=function(){var n=e.byteLength-t,a=new Uint8Array(4),s=Math.min(4,t);if(0===s)throw new Error("no bytes available");a.set(e.subarray(n,n+s)),i=new DataView(a.buffer).getUint32(0),r=8*s,t-=s},this.skipBits=function(e){var n;e<r||(e-=r,e-=8*(n=Math.floor(e/8)),t-=n,this.loadWord()),i<<=e,r-=e},this.readBits=function(e){var n=Math.min(r,e),a=i>>>32-n;return 0<(r-=n)?i<<=n:0<t&&this.loadWord(),0<(n=e-n)?a<<n|this.readBits(n):a},this.skipLeadingZeros=function(){var e;for(e=0;e<r;++e)if(0!=(i&2147483648>>>e))return i<<=e,r-=e,e;return this.loadWord(),e+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros();return this.readBits(e+1)-1},this.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();return 1&e?1+e>>>1:-1*(e>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};function Qe(e,t){var i=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9];return i=0<=i?i:0,(16&e[t+5])>>4?i+20:i+10}(We=function(){var e,t,i=0;We.prototype.init.call(this),this.push=function(r){for(var n,a=(t=t?((n=new Uint8Array(t.byteLength+r.data.byteLength)).set(t),n.set(r.data,t.byteLength),n):r.data).byteLength;i<a-3;i++)if(1===t[i+2]){e=i+5;break}for(;e<a;)switch(t[e]){case 0:if(0!==t[e-1]){e+=2;break}if(0!==t[e-2]){e++;break}for(i+3!==e-2&&this.trigger("data",t.subarray(i+3,e-2));1!==t[++e]&&e<a;);i=e-2,e+=3;break;case 1:if(0!==t[e-1]||0!==t[e-2]){e+=3;break}this.trigger("data",t.subarray(i+3,e-2)),i=e-2,e+=3;break;default:e+=3}t=t.subarray(i),e-=i,i=0},this.reset=function(){t=null,i=0,this.trigger("reset")},this.flush=function(){t&&3<t.byteLength&&this.trigger("data",t.subarray(i+3)),t=null,i=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}}).prototype=new H,ze={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},(Ke=function(){var e,t,i,r,n,a,s,o=new We;Ke.prototype.init.call(this),(e=this).push=function(e){"video"===e.type&&(t=e.trackId,i=e.pts,r=e.dts,o.push(e))},o.on("data",(function(s){var o={trackId:t,pts:i,dts:r,data:s};switch(31&s[0]){case 5:o.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:o.nalUnitType="sei_rbsp",o.escapedRBSP=n(s.subarray(1));break;case 7:o.nalUnitType="seq_parameter_set_rbsp",o.escapedRBSP=n(s.subarray(1)),o.config=a(o.escapedRBSP);break;case 8:o.nalUnitType="pic_parameter_set_rbsp";break;case 9:o.nalUnitType="access_unit_delimiter_rbsp"}e.trigger("data",o)})),o.on("done",(function(){e.trigger("done")})),o.on("partialdone",(function(){e.trigger("partialdone")})),o.on("reset",(function(){e.trigger("reset")})),o.on("endedtimeline",(function(){e.trigger("endedtimeline")})),this.flush=function(){o.flush()},this.partialFlush=function(){o.partialFlush()},this.reset=function(){o.reset()},this.endTimeline=function(){o.endTimeline()},s=function(e,t){var i,r=8,n=8;for(i=0;i<e;i++)0!==n&&(n=(r+t.readExpGolomb()+256)%256),r=0===n?r:n},n=function(e){for(var t,i,r=e.byteLength,n=[],a=1;a<r-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(n.push(a+2),a+=2):a++;if(0===n.length)return e;t=r-n.length,i=new Uint8Array(t);var s=0;for(a=0;a<t;s++,a++)s===n[0]&&(s++,n.shift()),i[a]=e[s];return i},a=function(e){var t,i,r,n,a,o,u,l,c,d,h,f,p,g=0,m=0,v=0,y=0,_=1;if(i=(t=new Xe(e)).readUnsignedByte(),n=t.readUnsignedByte(),r=t.readUnsignedByte(),t.skipUnsignedExpGolomb(),ze[i]&&(3===(a=t.readUnsignedExpGolomb())&&t.skipBits(1),t.skipUnsignedExpGolomb(),t.skipUnsignedExpGolomb(),t.skipBits(1),t.readBoolean()))for(h=3!==a?8:12,p=0;p<h;p++)t.readBoolean()&&s(p<6?16:64,t);if(t.skipUnsignedExpGolomb(),0===(o=t.readUnsignedExpGolomb()))t.readUnsignedExpGolomb();else if(1===o)for(t.skipBits(1),t.skipExpGolomb(),t.skipExpGolomb(),u=t.readUnsignedExpGolomb(),p=0;p<u;p++)t.skipExpGolomb();if(t.skipUnsignedExpGolomb(),t.skipBits(1),l=t.readUnsignedExpGolomb(),c=t.readUnsignedExpGolomb(),0===(d=t.readBits(1))&&t.skipBits(1),t.skipBits(1),t.readBoolean()&&(g=t.readUnsignedExpGolomb(),m=t.readUnsignedExpGolomb(),v=t.readUnsignedExpGolomb(),y=t.readUnsignedExpGolomb()),t.readBoolean()&&t.readBoolean()){switch(t.readUnsignedByte()){case 1:f=[1,1];break;case 2:f=[12,11];break;case 3:f=[10,11];break;case 4:f=[16,11];break;case 5:f=[40,33];break;case 6:f=[24,11];break;case 7:f=[20,11];break;case 8:f=[32,11];break;case 9:f=[80,33];break;case 10:f=[18,11];break;case 11:f=[15,11];break;case 12:f=[64,33];break;case 13:f=[160,99];break;case 14:f=[4,3];break;case 15:f=[3,2];break;case 16:f=[2,1];break;case 255:f=[t.readUnsignedByte()<<8|t.readUnsignedByte(),t.readUnsignedByte()<<8|t.readUnsignedByte()]}f&&(_=f[0]/f[1])}return{profileIdc:i,levelIdc:r,profileCompatibility:n,width:Math.ceil((16*(l+1)-2*g-2*m)*_),height:(2-d)*(c+1)*16-2*v-2*y,sarRatio:f}}}).prototype=new H;var $e,Je={H264Stream:Ke,NalByteStream:We},Ze=function(e){var t=function e(t,i){return t.length-i<10||t[i]!=="I".charCodeAt(0)||t[i+1]!=="D".charCodeAt(0)||t[i+2]!=="3".charCodeAt(0)?i:e(t,i+=Qe(t,i))}(e,0);return e.length>=t+2&&255==(255&e[t])&&240==(240&e[t+1])&&16==(22&e[t+1])},et=Qe,tt=function(e,t){return 6144&e[t+3]|e[t+4]<<3|(224&e[t+5])>>5};function it(e,t){var i;if(e.length!==t.length)return!1;for(i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}function rt(e,t,i,r,n,a){return{start:{dts:e,pts:e+(i-t)},end:{dts:e+(r-t),pts:e+(n-i)},prependedContentDuration:a,baseMediaDecodeTime:e}}($e=function(){var e=new Uint8Array,t=0;$e.prototype.init.call(this),this.setTimestamp=function(e){t=e},this.push=function(i){var r,n,a,s=0,o=0;for(e.length?(a=e.length,(e=new Uint8Array(i.byteLength+a)).set(e.subarray(0,a)),e.set(i,a)):e=i;3<=e.length-o;)if(e[o]!=="I".charCodeAt(0)||e[o+1]!=="D".charCodeAt(0)||e[o+2]!=="3".charCodeAt(0))if(255!=(255&e[o])||240!=(240&e[o+1]))o++;else{if(e.length-o<7)break;if(o+(s=tt(e,o))>e.length)break;n={type:"audio",data:e.subarray(o,o+s),pts:t,dts:t},this.trigger("data",n),o+=s}else{if(e.length-o<10)break;if(o+(s=et(e,o))>e.length)break;r={type:"timed-metadata",data:e.subarray(o,o+s)},this.trigger("data",r),o+=s}e=0<e.length-o?e.subarray(o):new Uint8Array},this.reset=function(){e=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){e=new Uint8Array,this.trigger("endedtimeline")}}).prototype=new H;var nt,at,st,ot,ut=$e,lt=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],ct=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],dt=Je.H264Stream,ht=Ze;function ft(e,t){var i=[],r=0,n=0,a=0,s=1/0,o=null,u=null;t=t||{},ft.prototype.init.call(this),this.push=function(t){_e(e,t),e&&lt.forEach((function(i){e[i]=t[i]})),i.push(t)},this.setEarliestDts=function(e){n=e},this.setVideoBaseMediaDecodeTime=function(e){s=e},this.setAudioAppendStart=function(e){a=e},this.processFrames_=function(){var l,c,d,h;0!==i.length&&0!==(l=pe(i,e,n)).length&&(e.baseMediaDecodeTime=ye(e,t.keepOriginalTimestamps),fe(e,l,a,s),e.samples=ge(l),d=J(me(l)),i=[],c=Z(r,[e]),r++,e.initSegment=ee([e]),(h=new Uint8Array(c.byteLength+d.byteLength)).set(c),h.set(d,c.byteLength),ve(e),null===o&&(u=o=l[0].pts),u+=l.length*(1024*mt/e.samplerate),this.trigger("timingInfo",{start:o}),this.trigger("data",{track:e,boxes:h}))},this.flush=function(){this.processFrames_(),this.trigger("timingInfo",{start:o,end:u}),this.resetTiming_(),this.trigger("done","AudioSegmentStream")},this.partialFlush=function(){this.processFrames_(),this.trigger("partialdone","AudioSegmentStream")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline","AudioSegmentStream")},this.resetTiming_=function(){ve(e),u=o=null},this.reset=function(){this.resetTiming_(),i=[],this.trigger("reset")}}(at=function(e,t){var i=[],r=0,n=0,a=0,s=1/0;t=t||{},at.prototype.init.call(this),this.push=function(t){_e(e,t),e&&lt.forEach((function(i){e[i]=t[i]})),i.push(t)},this.setEarliestDts=function(e){n=e},this.setVideoBaseMediaDecodeTime=function(e){s=e},this.setAudioAppendStart=function(e){a=e},this.flush=function(){var o,u,l,c,d;0!==i.length&&(o=pe(i,e,n),e.baseMediaDecodeTime=ye(e,t.keepOriginalTimestamps),fe(e,o,a,s),e.samples=ge(o),l=J(me(o)),i=[],u=Z(r,[e]),c=new Uint8Array(u.byteLength+l.byteLength),r++,c.set(u),c.set(l,u.byteLength),ve(e),d=Math.ceil(9216e4/e.samplerate),o.length&&this.trigger("timingInfo",{start:o[0].pts,end:o[0].pts+o.length*d}),this.trigger("data",{track:e,boxes:c})),this.trigger("done","AudioSegmentStream")},this.reset=function(){ve(e),i=[],this.trigger("reset")}}).prototype=new H,(nt=function(e,t){var i,r,n=0,a=[],s=[];t=t||{},nt.prototype.init.call(this),delete e.minPTS,this.gopCache_=[],this.push=function(t){_e(e,t),"seq_parameter_set_rbsp"!==t.nalUnitType||i||(i=t.config,e.sps=[t.data],ct.forEach((function(t){e[t]=i[t]}),this)),"pic_parameter_set_rbsp"!==t.nalUnitType||r||(r=t.data,e.pps=[t.data]),a.push(t)},this.flush=function(){for(var i,r,o,u,l,c,d,h,f=0;a.length&&"access_unit_delimiter_rbsp"!==a[0].nalUnitType;)a.shift();if(0===a.length)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");if(i=te(a),(o=ie(i))[0][0].keyFrame||((r=this.getGopForFusion_(a[0],e))?(f=r.duration,o.unshift(r),o.byteLength+=r.byteLength,o.nalCount+=r.nalCount,o.pts=r.pts,o.dts=r.dts,o.duration+=r.duration):o=re(o)),s.length){var p;if(!(p=t.alignGopsAtEnd?this.alignGopsAtEnd_(o):this.alignGopsAtStart_(o)))return this.gopCache_.unshift({gop:o.pop(),pps:e.pps,sps:e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),a=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");ve(e),o=p}_e(e,o),e.samples=function(e,t){var i,r,n,a,s=0,o=[];for(i=0;i<e.length;i++)for(a=e[i],r=0;r<a.length;r++)s+=(n=q(a[r],s)).size,o.push(n);return o}(o),l=J(function(e){var t,i,r,n,a,s,o=0,u=new Uint8Array(e.byteLength+4*e.nalCount),l=new DataView(u.buffer);for(t=0;t<e.length;t++)for(n=e[t],i=0;i<n.length;i++)for(a=n[i],r=0;r<a.length;r++)l.setUint32(o,(s=a[r]).data.byteLength),u.set(s.data,o+=4),o+=s.data.byteLength;return u}(o)),e.baseMediaDecodeTime=ye(e,t.keepOriginalTimestamps),this.trigger("processedGopsInfo",o.map((function(e){return{pts:e.pts,dts:e.dts,byteLength:e.byteLength}}))),this.trigger("segmentTimingInfo",rt(e.baseMediaDecodeTime,(d=o[0]).dts,d.pts,(h=o[o.length-1]).dts+h.duration,h.pts+h.duration,f)),this.trigger("timingInfo",{start:o[0].pts,end:o[o.length-1].pts+o[o.length-1].duration}),this.gopCache_.unshift({gop:o.pop(),pps:e.pps,sps:e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),a=[],this.trigger("baseMediaDecodeTime",e.baseMediaDecodeTime),this.trigger("timelineStartInfo",e.timelineStartInfo),u=Z(n,[e]),c=new Uint8Array(u.byteLength+l.byteLength),n++,c.set(u),c.set(l,u.byteLength),this.trigger("data",{track:e,boxes:c}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),a=[],this.gopCache_.length=0,s.length=0,this.trigger("reset")},this.resetStream_=function(){ve(e),r=i=void 0},this.getGopForFusion_=function(t){var i,r,n,a,s,o=1/0;for(s=0;s<this.gopCache_.length;s++)n=(a=this.gopCache_[s]).gop,e.pps&&it(e.pps[0],a.pps[0])&&e.sps&&it(e.sps[0],a.sps[0])&&(n.dts<e.timelineStartInfo.dts||-1e4<=(i=t.dts-n.dts-n.duration)&&i<=45e3&&(!r||i<o)&&(r=a,o=i));return r?r.gop:null},this.alignGopsAtStart_=function(e){var t,i,r,n,a,o,u,l;for(a=e.byteLength,o=e.nalCount,u=e.duration,t=i=0;t<s.length&&i<e.length&&(r=s[t]).pts!==(n=e[i]).pts;)n.pts>r.pts?t++:(i++,a-=n.byteLength,o-=n.nalCount,u-=n.duration);return 0===i?e:i===e.length?null:((l=e.slice(i)).byteLength=a,l.duration=u,l.nalCount=o,l.pts=l[0].pts,l.dts=l[0].dts,l)},this.alignGopsAtEnd_=function(e){var t,i,r,n,a,o,u;for(t=s.length-1,i=e.length-1,a=null,o=!1;0<=t&&0<=i;){if((r=s[t]).pts===(n=e[i]).pts){o=!0;break}r.pts>n.pts?t--:(t===s.length-1&&(a=i),i--)}if(!o&&null===a)return null;if(0===(u=o?i:a))return e;var l=e.slice(u),c=l.reduce((function(e,t){return e.byteLength+=t.byteLength,e.duration+=t.duration,e.nalCount+=t.nalCount,e}),{byteLength:0,duration:0,nalCount:0});return l.byteLength=c.byteLength,l.duration=c.duration,l.nalCount=c.nalCount,l.pts=l[0].pts,l.dts=l[0].dts,l},this.alignGopsWith=function(e){s=e}}).prototype=new H,(ot=function(e,t){this.numberOfTracks=0,this.metadataStream=t,this.remuxTracks=void 0===(e=e||{}).remux||!!e.remux,this.keepOriginalTimestamps="boolean"==typeof e.keepOriginalTimestamps&&e.keepOriginalTimestamps,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,ot.prototype.init.call(this),this.push=function(e){return e.text?this.pendingCaptions.push(e):e.frames?this.pendingMetadata.push(e):(this.pendingTracks.push(e.track),this.pendingBytes+=e.boxes.byteLength,"video"===e.track.type&&(this.videoTrack=e.track,this.pendingBoxes.push(e.boxes)),void("audio"===e.track.type&&(this.audioTrack=e.track,this.pendingBoxes.unshift(e.boxes))))}}).prototype=new H,ot.prototype.flush=function(e){var t,i,r,n,a=0,s={captions:[],captionStreams:{},metadata:[],info:{}},o=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==e&&"AudioSegmentStream"!==e)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}if(this.videoTrack?(o=this.videoTrack.timelineStartInfo.pts,ct.forEach((function(e){s.info[e]=this.videoTrack[e]}),this)):this.audioTrack&&(o=this.audioTrack.timelineStartInfo.pts,lt.forEach((function(e){s.info[e]=this.audioTrack[e]}),this)),this.videoTrack||this.audioTrack){for(s.type=1===this.pendingTracks.length?this.pendingTracks[0].type:"combined",this.emittedTracks+=this.pendingTracks.length,r=ee(this.pendingTracks),s.initSegment=new Uint8Array(r.byteLength),s.initSegment.set(r),s.data=new Uint8Array(this.pendingBytes),n=0;n<this.pendingBoxes.length;n++)s.data.set(this.pendingBoxes[n],a),a+=this.pendingBoxes[n].byteLength;for(n=0;n<this.pendingCaptions.length;n++)(t=this.pendingCaptions[n]).startTime=ce(t.startPts,o,this.keepOriginalTimestamps),t.endTime=ce(t.endPts,o,this.keepOriginalTimestamps),s.captionStreams[t.stream]=!0,s.captions.push(t);for(n=0;n<this.pendingMetadata.length;n++)(i=this.pendingMetadata[n]).cueTime=ce(i.pts,o,this.keepOriginalTimestamps),s.metadata.push(i);for(s.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",s),n=0;n<s.captions.length;n++)this.trigger("caption",t=s.captions[n]);for(n=0;n<s.metadata.length;n++)this.trigger("id3Frame",i=s.metadata[n])}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},ot.prototype.setRemux=function(e){this.remuxTracks=e},(st=function(e){var t,i,r=this,n=!0;st.prototype.init.call(this),this.baseMediaDecodeTime=(e=e||{}).baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var n={};(this.transmuxPipeline_=n).type="aac",n.metadataStream=new Ge.MetadataStream,n.aacStream=new ut,n.audioTimestampRolloverStream=new Ge.TimestampRolloverStream("audio"),n.timedMetadataTimestampRolloverStream=new Ge.TimestampRolloverStream("timed-metadata"),n.adtsStream=new Ye,n.coalesceStream=new ot(e,n.metadataStream),n.headOfPipeline=n.aacStream,n.aacStream.pipe(n.audioTimestampRolloverStream).pipe(n.adtsStream),n.aacStream.pipe(n.timedMetadataTimestampRolloverStream).pipe(n.metadataStream).pipe(n.coalesceStream),n.metadataStream.on("timestamp",(function(e){n.aacStream.setTimestamp(e.timeStamp)})),n.aacStream.on("data",(function(a){"timed-metadata"!==a.type&&"audio"!==a.type||n.audioSegmentStream||(i=i||{timelineStartInfo:{baseMediaDecodeTime:r.baseMediaDecodeTime},codec:"adts",type:"audio"},n.coalesceStream.numberOfTracks++,n.audioSegmentStream=new at(i,e),n.audioSegmentStream.on("timingInfo",r.trigger.bind(r,"audioTimingInfo")),n.adtsStream.pipe(n.audioSegmentStream).pipe(n.coalesceStream),r.trigger("trackinfo",{hasAudio:!!i,hasVideo:!!t}))})),n.coalesceStream.on("data",this.trigger.bind(this,"data")),n.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setupTsPipeline=function(){var n={};(this.transmuxPipeline_=n).type="ts",n.metadataStream=new Ge.MetadataStream,n.packetStream=new Ge.TransportPacketStream,n.parseStream=new Ge.TransportParseStream,n.elementaryStream=new Ge.ElementaryStream,n.timestampRolloverStream=new Ge.TimestampRolloverStream,n.adtsStream=new Ye,n.h264Stream=new dt,n.captionStream=new Ge.CaptionStream,n.coalesceStream=new ot(e,n.metadataStream),n.headOfPipeline=n.packetStream,n.packetStream.pipe(n.parseStream).pipe(n.elementaryStream).pipe(n.timestampRolloverStream),n.timestampRolloverStream.pipe(n.h264Stream),n.timestampRolloverStream.pipe(n.adtsStream),n.timestampRolloverStream.pipe(n.metadataStream).pipe(n.coalesceStream),n.h264Stream.pipe(n.captionStream).pipe(n.coalesceStream),n.elementaryStream.on("data",(function(a){var s;if("metadata"===a.type){for(s=a.tracks.length;s--;)t||"video"!==a.tracks[s].type?i||"audio"!==a.tracks[s].type||((i=a.tracks[s]).timelineStartInfo.baseMediaDecodeTime=r.baseMediaDecodeTime):(t=a.tracks[s]).timelineStartInfo.baseMediaDecodeTime=r.baseMediaDecodeTime;t&&!n.videoSegmentStream&&(n.coalesceStream.numberOfTracks++,n.videoSegmentStream=new nt(t,e),n.videoSegmentStream.on("timelineStartInfo",(function(t){i&&!e.keepOriginalTimestamps&&(i.timelineStartInfo=t,n.audioSegmentStream.setEarliestDts(t.dts-r.baseMediaDecodeTime))})),n.videoSegmentStream.on("processedGopsInfo",r.trigger.bind(r,"gopInfo")),n.videoSegmentStream.on("segmentTimingInfo",r.trigger.bind(r,"videoSegmentTimingInfo")),n.videoSegmentStream.on("baseMediaDecodeTime",(function(e){i&&n.audioSegmentStream.setVideoBaseMediaDecodeTime(e)})),n.videoSegmentStream.on("timingInfo",r.trigger.bind(r,"videoTimingInfo")),n.h264Stream.pipe(n.videoSegmentStream).pipe(n.coalesceStream)),i&&!n.audioSegmentStream&&(n.coalesceStream.numberOfTracks++,n.audioSegmentStream=new at(i,e),n.audioSegmentStream.on("timingInfo",r.trigger.bind(r,"audioTimingInfo")),n.adtsStream.pipe(n.audioSegmentStream).pipe(n.coalesceStream)),r.trigger("trackinfo",{hasAudio:!!i,hasVideo:!!t})}})),n.coalesceStream.on("data",this.trigger.bind(this,"data")),n.coalesceStream.on("id3Frame",(function(e){e.dispatchType=n.metadataStream.dispatchType,r.trigger("id3Frame",e)})),n.coalesceStream.on("caption",this.trigger.bind(this,"caption")),n.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setBaseMediaDecodeTime=function(r){var n=this.transmuxPipeline_;e.keepOriginalTimestamps||(this.baseMediaDecodeTime=r),i&&(i.timelineStartInfo.dts=void 0,i.timelineStartInfo.pts=void 0,ve(i),n.audioTimestampRolloverStream&&n.audioTimestampRolloverStream.discontinuity()),t&&(n.videoSegmentStream&&(n.videoSegmentStream.gopCache_=[]),t.timelineStartInfo.dts=void 0,t.timelineStartInfo.pts=void 0,ve(t),n.captionStream.reset()),n.timestampRolloverStream&&n.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(e){i&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e)},this.setRemux=function(t){var i=this.transmuxPipeline_;e.remux=t,i&&i.coalesceStream&&i.coalesceStream.setRemux(t)},this.alignGopsWith=function(e){t&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e)},this.push=function(e){if(n){var t=ht(e);t&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():t||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline(),n=!1}this.transmuxPipeline_.headOfPipeline.push(e)},this.flush=function(){n=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}}).prototype=new H;var pt={Transmuxer:st,VideoSegmentStream:nt,AudioSegmentStream:at,AUDIO_PROPERTIES:lt,VIDEO_PROPERTIES:ct,generateVideoSegmentTimingInfo:rt}.Transmuxer,gt={Adts:Ye,h264:Je},mt=9e4;function vt(e,t){var i,r,n,a=0,s=[],o=[],u=null,l=null,c=!0;t=t||{},vt.prototype.init.call(this),this.push=function(t){_e(e,t),void 0===e.timelineStartInfo.dts&&(e.timelineStartInfo.dts=t.dts),"seq_parameter_set_rbsp"!==t.nalUnitType||i||(i=t.config,e.sps=[t.data],ct.forEach((function(t){e[t]=i[t]}),this)),"pic_parameter_set_rbsp"!==t.nalUnitType||r||(r=t.data,e.pps=[t.data]),s.push(t)},this.processNals_=function(i){var r;for(s=o.concat(s);s.length&&"access_unit_delimiter_rbsp"!==s[0].nalUnitType;)s.shift();if(0!==s.length){var d=te(s);if(d.length)if(o=d[d.length-1],i&&(d.pop(),d.duration-=o.duration,d.nalCount-=o.length,d.byteLength-=o.byteLength),d.length){if(this.trigger("timelineStartInfo",e.timelineStartInfo),c){if(!(n=ie(d))[0][0].keyFrame){if(!(n=re(n))[0][0].keyFrame)return s=[].concat.apply([],d).concat(o),void(o=[]);(d=[].concat.apply([],n)).duration=n.duration}c=!1}for(null===u&&(l=u=d[0].pts),this.trigger("timingInfo",{start:u,end:l+=d.duration}),r=0;r<d.length;r++){var h=d[r];e.samples=ne(h);var f=J(ae(h));ve(e),_e(e,h),e.baseMediaDecodeTime=ye(e,t.keepOriginalTimestamps);var p=Z(a,[e]);a++,e.initSegment=ee([e]);var g=new Uint8Array(p.byteLength+f.byteLength);g.set(p),g.set(f,p.byteLength),this.trigger("data",{track:e,boxes:g,sequence:a,videoFrameDts:h.dts,videoFramePts:h.pts})}s=[]}else s=[]}},this.resetTimingAndConfig_=function(){r=i=void 0,l=u=null},this.partialFlush=function(){this.processNals_(!0),this.trigger("partialdone","VideoSegmentStream")},this.flush=function(){this.processNals_(!1),this.resetTimingAndConfig_(),this.trigger("done","VideoSegmentStream")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline","VideoSegmentStream")},this.reset=function(){this.resetTimingAndConfig_(),o=[],s=[],c=!0,this.trigger("reset")}}ft.prototype=new H;var yt=ft;function _t(e){return e.prototype=new H,e.prototype.init.call(e),e}function bt(e,t){e.on("data",t.trigger.bind(t,"data")),e.on("done",t.trigger.bind(t,"done")),e.on("partialdone",t.trigger.bind(t,"partialdone")),e.on("endedtimeline",t.trigger.bind(t,"endedtimeline")),e.on("audioTimingInfo",t.trigger.bind(t,"audioTimingInfo")),e.on("videoTimingInfo",t.trigger.bind(t,"videoTimingInfo")),e.on("trackinfo",t.trigger.bind(t,"trackinfo")),e.on("id3Frame",(function(i){i.dispatchType=e.metadataStream.dispatchType,i.cueTime=ue(i.pts),t.trigger("id3Frame",i)})),e.on("caption",(function(e){t.trigger("caption",e)}))}function Tt(e){var t=null,i=!0;e=e||{},Tt.prototype.init.call(this),e.baseMediaDecodeTime=e.baseMediaDecodeTime||0,this.push=function(r){if(i){var n=Et(r);!n||t&&"aac"===t.type?n||t&&"ts"===t.type||bt(t=function(e){var t={type:"ts",tracks:{audio:null,video:null},packet:new Ge.TransportPacketStream,parse:new Ge.TransportParseStream,elementary:new Ge.ElementaryStream,timestampRollover:new Ge.TimestampRolloverStream,adts:new gt.Adts,h264:new gt.h264.H264Stream,captionStream:new Ge.CaptionStream,metadataStream:new Ge.MetadataStream};return t.headOfPipeline=t.packet,t.packet.pipe(t.parse).pipe(t.elementary).pipe(t.timestampRollover),t.timestampRollover.pipe(t.h264),t.h264.pipe(t.captionStream),t.timestampRollover.pipe(t.metadataStream),t.timestampRollover.pipe(t.adts),t.elementary.on("data",(function(i){if("metadata"===i.type){for(var r=0;r<i.tracks.length;r++)t.tracks[i.tracks[r].type]||(t.tracks[i.tracks[r].type]=i.tracks[r],t.tracks[i.tracks[r].type].timelineStartInfo.baseMediaDecodeTime=e.baseMediaDecodeTime);t.tracks.video&&!t.videoSegmentStream&&(t.videoSegmentStream=new St(t.tracks.video,e),t.videoSegmentStream.on("timelineStartInfo",(function(i){t.tracks.audio&&!e.keepOriginalTimestamps&&t.audioSegmentStream.setEarliestDts(i.dts-e.baseMediaDecodeTime)})),t.videoSegmentStream.on("timingInfo",t.trigger.bind(t,"videoTimingInfo")),t.videoSegmentStream.on("data",(function(e){t.trigger("data",{type:"video",data:e})})),t.videoSegmentStream.on("done",t.trigger.bind(t,"done")),t.videoSegmentStream.on("partialdone",t.trigger.bind(t,"partialdone")),t.videoSegmentStream.on("endedtimeline",t.trigger.bind(t,"endedtimeline")),t.h264.pipe(t.videoSegmentStream)),t.tracks.audio&&!t.audioSegmentStream&&(t.audioSegmentStream=new yt(t.tracks.audio,e),t.audioSegmentStream.on("data",(function(e){t.trigger("data",{type:"audio",data:e})})),t.audioSegmentStream.on("done",t.trigger.bind(t,"done")),t.audioSegmentStream.on("partialdone",t.trigger.bind(t,"partialdone")),t.audioSegmentStream.on("endedtimeline",t.trigger.bind(t,"endedtimeline")),t.audioSegmentStream.on("timingInfo",t.trigger.bind(t,"audioTimingInfo")),t.adts.pipe(t.audioSegmentStream)),t.trigger("trackinfo",{hasAudio:!!t.tracks.audio,hasVideo:!!t.tracks.video})}})),t.captionStream.on("data",(function(i){var r;i.startTime=ce(i.startPts,r=t.tracks.video&&t.tracks.video.timelineStartInfo.pts||0,e.keepOriginalTimestamps),i.endTime=ce(i.endPts,r,e.keepOriginalTimestamps),t.trigger("caption",i)})),(t=_t(t)).metadataStream.on("data",t.trigger.bind(t,"id3Frame")),t}(e),this):bt(t=function(e){var t={type:"aac",tracks:{audio:null},metadataStream:new Ge.MetadataStream,aacStream:new ut,audioRollover:new Ge.TimestampRolloverStream("audio"),timedMetadataRollover:new Ge.TimestampRolloverStream("timed-metadata"),adtsStream:new Ye(!0)};return t.headOfPipeline=t.aacStream,t.aacStream.pipe(t.audioRollover).pipe(t.adtsStream),t.aacStream.pipe(t.timedMetadataRollover).pipe(t.metadataStream),t.metadataStream.on("timestamp",(function(e){t.aacStream.setTimestamp(e.timeStamp)})),t.aacStream.on("data",(function(i){"timed-metadata"!==i.type&&"audio"!==i.type||t.audioSegmentStream||(t.tracks.audio=t.tracks.audio||{timelineStartInfo:{baseMediaDecodeTime:e.baseMediaDecodeTime},codec:"adts",type:"audio"},t.audioSegmentStream=new yt(t.tracks.audio,e),t.audioSegmentStream.on("data",(function(e){t.trigger("data",{type:"audio",data:e})})),t.audioSegmentStream.on("partialdone",t.trigger.bind(t,"partialdone")),t.audioSegmentStream.on("done",t.trigger.bind(t,"done")),t.audioSegmentStream.on("endedtimeline",t.trigger.bind(t,"endedtimeline")),t.audioSegmentStream.on("timingInfo",t.trigger.bind(t,"audioTimingInfo")),t.adtsStream.pipe(t.audioSegmentStream),t.trigger("trackinfo",{hasAudio:!!t.tracks.audio,hasVideo:!!t.tracks.video}))})),(t=_t(t)).metadataStream.on("data",t.trigger.bind(t,"id3Frame")),t}(e),this),i=!1}t.headOfPipeline.push(r)},this.flush=function(){t&&(i=!0,t.headOfPipeline.flush())},this.partialFlush=function(){t&&t.headOfPipeline.partialFlush()},this.endTimeline=function(){t&&t.headOfPipeline.endTimeline()},this.reset=function(){t&&t.headOfPipeline.reset()},this.setBaseMediaDecodeTime=function(i){e.keepOriginalTimestamps||(e.baseMediaDecodeTime=i),t&&(t.tracks.audio&&(t.tracks.audio.timelineStartInfo.dts=void 0,t.tracks.audio.timelineStartInfo.pts=void 0,ve(t.tracks.audio),t.audioRollover&&t.audioRollover.discontinuity()),t.tracks.video&&(t.videoSegmentStream&&(t.videoSegmentStream.gopCache_=[]),t.tracks.video.timelineStartInfo.dts=void 0,t.tracks.video.timelineStartInfo.pts=void 0,ve(t.tracks.video)),t.timestampRollover&&t.timestampRollover.discontinuity())},this.setRemux=function(i){e.remux=i,t&&t.coalesceStream&&t.coalesceStream.setRemux(i)},this.setAudioAppendStart=function(e){t&&t.tracks.audio&&t.audioSegmentStream&&t.audioSegmentStream.setAudioAppendStart(e)},this.alignGopsWith=function(e){}}vt.prototype=new H;var St=vt,Et=Ze;function kt(e,t){for(var i=e,r=0;r<t.length;r++){var n=t[r];if(i<n.size)return n;i-=n.size}return null}function wt(e,t){var i=Dt(e,["moof","traf"]),r=Dt(e,["mdat"]),n={},a=[];return r.forEach((function(e,t){a.push({mdat:e,traf:i[t]})})),a.forEach((function(e){var i,r=e.mdat,a=e.traf,s=Dt(a,["tfhd"]),o=Nt(s[0]),u=o.trackId,l=Dt(a,["tfdt"]),c=0<l.length?xt(l[0]).baseMediaDecodeTime:0,d=Dt(a,["trun"]);t===u&&0<d.length&&(i=function(e,t,i){var r,n,a,s,o=new DataView(e.buffer,e.byteOffset,e.byteLength),u=[];for(n=0;n+4<e.length;n+=a)if(a=o.getUint32(n),n+=4,!(a<=0))switch(31&e[n]){case 6:var l=e.subarray(n+1,n+1+a),c=kt(n,t);if(r={nalUnitType:"sei_rbsp",size:a,data:l,escapedRBSP:Ut(l),trackId:i},c)r.pts=c.pts,r.dts=c.dts,s=c;else{if(!s)break;r.pts=s.pts,r.dts=s.dts}u.push(r)}return u}(r,function(e,t,i){var r=t,n=i.defaultSampleDuration||0,a=i.defaultSampleSize||0,s=i.trackId,o=[];return e.forEach((function(e){var t=Mt(e).samples;t.forEach((function(e){void 0===e.duration&&(e.duration=n),void 0===e.size&&(e.size=a),e.trackId=s,e.dts=r,void 0===e.compositionTimeOffset&&(e.compositionTimeOffset=0),e.pts=r+e.compositionTimeOffset,r+=e.duration})),o=o.concat(t)})),o}(d,c,o),u),n[u]||(n[u]=[]),n[u]=n[u].concat(i))})),n}function Ct(e){return"AudioSegmentStream"===e?"audio":"VideoSegmentStream"===e?"video":""}Tt.prototype=new H;var At=Tt,Lt=function(e){return e>>>0},It=function(e){var t="";return t+=String.fromCharCode(e[0]),t+=String.fromCharCode(e[1]),(t+=String.fromCharCode(e[2]))+String.fromCharCode(e[3])},Rt=Lt,Dt=function e(t,i){var r,n,a,s,o,u=[];if(!i.length)return null;for(r=0;r<t.byteLength;)n=Rt(t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3]),a=It(t.subarray(r+4,r+8)),s=1<n?r+n:t.byteLength,a===i[0]&&(1===i.length?u.push(t.subarray(r+8,s)):(o=e(t.subarray(r+8,s),i.slice(1))).length&&(u=u.concat(o))),r=s;return u},Ot=Lt,xt=function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4)),baseMediaDecodeTime:Ot(e[4]<<24|e[5]<<16|e[6]<<8|e[7])};return 1===t.version&&(t.baseMediaDecodeTime*=Math.pow(2,32),t.baseMediaDecodeTime+=Ot(e[8]<<24|e[9]<<16|e[10]<<8|e[11])),t},Pt=function(e){return{isLeading:(12&e[0])>>>2,dependsOn:3&e[0],isDependedOn:(192&e[1])>>>6,hasRedundancy:(48&e[1])>>>4,paddingValue:(14&e[1])>>>1,isNonSyncSample:1&e[1],degradationPriority:e[2]<<8|e[3]}},Mt=function(e){var t,i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]},r=new DataView(e.buffer,e.byteOffset,e.byteLength),n=1&i.flags[2],a=4&i.flags[2],s=1&i.flags[1],o=2&i.flags[1],u=4&i.flags[1],l=8&i.flags[1],c=r.getUint32(4),d=8;for(n&&(i.dataOffset=r.getInt32(d),d+=4),a&&c&&(t={flags:Pt(e.subarray(d,d+4))},d+=4,s&&(t.duration=r.getUint32(d),d+=4),o&&(t.size=r.getUint32(d),d+=4),l&&(t.compositionTimeOffset=1===i.version?r.getInt32(d):r.getUint32(d),d+=4),i.samples.push(t),c--);c--;)t={},s&&(t.duration=r.getUint32(d),d+=4),o&&(t.size=r.getUint32(d),d+=4),u&&(t.flags=Pt(e.subarray(d,d+4)),d+=4),l&&(t.compositionTimeOffset=1===i.version?r.getInt32(d):r.getUint32(d),d+=4),i.samples.push(t);return i},Nt=function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:i.getUint32(4)},n=1&r.flags[2],a=2&r.flags[2],s=8&r.flags[2],o=16&r.flags[2],u=32&r.flags[2],l=65536&r.flags[0],c=131072&r.flags[0];return t=8,n&&(t+=4,r.baseDataOffset=i.getUint32(12),t+=4),a&&(r.sampleDescriptionIndex=i.getUint32(t),t+=4),s&&(r.defaultSampleDuration=i.getUint32(t),t+=4),o&&(r.defaultSampleSize=i.getUint32(t),t+=4),u&&(r.defaultSampleFlags=i.getUint32(t)),l&&(r.durationIsEmpty=!0),!n&&c&&(r.baseDataOffsetIsMoof=!0),r},Ut=function(e){for(var t,i,r=e.byteLength,n=[],a=1;a<r-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(n.push(a+2),a+=2):a++;if(0===n.length)return e;t=r-n.length,i=new Uint8Array(t);var s=0;for(a=0;a<t;s++,a++)s===n[0]&&(s++,n.shift()),i[a]=e[s];return i},Ft=Ae.CaptionStream,Bt=function(){var e,t,i,r,n,a,s=!1;this.isInitialized=function(){return s},this.init=function(t){e=new Ft,s=!0,a=!!t&&t.isPartial,e.on("data",(function(e){e.startTime=e.startPts/r,e.endTime=e.endPts/r,n.captions.push(e),n.captionStreams[e.stream]=!0}))},this.isNewInit=function(e,t){return!(e&&0===e.length||t&&"object"==typeof t&&0===Object.keys(t).length||i===e[0]&&r===t[i])},this.parse=function(e,a,s){var o;if(!this.isInitialized())return null;if(!a||!s)return null;if(this.isNewInit(a,s))r=s[i=a[0]];else if(null===i||!r)return t.push(e),null;for(;0<t.length;){var u=t.shift();this.parse(u,a,s)}return null!==(o=function(e,t,i){return null===t?null:{seiNals:wt(e,t)[t],timescale:i}}(e,i,r))&&o.seiNals?(this.pushNals(o.seiNals),this.flushStream(),n):null},this.pushNals=function(t){if(!this.isInitialized()||!t||0===t.length)return null;t.forEach((function(t){e.push(t)}))},this.flushStream=function(){if(!this.isInitialized())return null;a?e.partialFlush():e.flush()},this.clearParsedCaptions=function(){n.captions=[],n.captionStreams={}},this.resetCaptionStream=function(){if(!this.isInitialized())return null;e.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){t=[],r=i=null,n?this.clearParsedCaptions():n={captions:[],captionStreams:{}},this.resetCaptionStream()},this.reset()},jt=function(){function e(e,t){this.options=t||{},this.self=e,this.init()}var t=e.prototype;return t.init=function(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=this.options.handlePartialData?new At(this.options):new pt(this.options),this.options.handlePartialData?function(e,t){t.on("data",(function(t){var i={boxes:{data:t.data.boxes.buffer,byteOffset:t.data.boxes.byteOffset,byteLength:t.data.boxes.byteLength},initSegment:{data:t.data.track.initSegment.buffer,byteOffset:t.data.track.initSegment.byteOffset,byteLength:t.data.track.initSegment.byteLength},type:t.type,sequence:t.data.sequence};void 0!==t.data.videoFrameDts&&(i.videoFrameDtsTime=he(t.data.videoFrameDts)),void 0!==t.data.videoFramePts&&(i.videoFramePtsTime=he(t.data.videoFramePts)),e.postMessage({action:"data",segment:i},[i.boxes.data,i.initSegment.data])})),t.on("id3Frame",(function(t){e.postMessage({action:"id3Frame",id3Frame:t})})),t.on("caption",(function(t){e.postMessage({action:"caption",caption:t})})),t.on("done",(function(t){e.postMessage({action:"done",type:Ct(t)})})),t.on("partialdone",(function(t){e.postMessage({action:"partialdone",type:Ct(t)})})),t.on("endedsegment",(function(t){e.postMessage({action:"endedSegment",type:Ct(t)})})),t.on("trackinfo",(function(t){e.postMessage({action:"trackinfo",trackInfo:t})})),t.on("audioTimingInfo",(function(t){if(null!==t.start){var i={start:he(t.start)};t.end&&(i.end=he(t.end)),e.postMessage({action:"audioTimingInfo",audioTimingInfo:i})}else e.postMessage({action:"audioTimingInfo",audioTimingInfo:t})})),t.on("videoTimingInfo",(function(t){var i={start:he(t.start)};t.end&&(i.end=he(t.end)),e.postMessage({action:"videoTimingInfo",videoTimingInfo:i})}))}(this.self,this.transmuxer):function(e,t){t.on("data",(function(t){var i=t.initSegment;t.initSegment={data:i.buffer,byteOffset:i.byteOffset,byteLength:i.byteLength};var r=t.data;t.data=r.buffer,e.postMessage({action:"data",segment:t,byteOffset:r.byteOffset,byteLength:r.byteLength},[t.data])})),t.on("done",(function(t){e.postMessage({action:"done"})})),t.on("gopInfo",(function(t){e.postMessage({action:"gopInfo",gopInfo:t})})),t.on("videoSegmentTimingInfo",(function(t){var i={start:{decode:he(t.start.dts),presentation:he(t.start.pts)},end:{decode:he(t.end.dts),presentation:he(t.end.pts)},baseMediaDecodeTime:he(t.baseMediaDecodeTime)};t.prependedContentDuration&&(i.prependedContentDuration=he(t.prependedContentDuration)),e.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:i})})),t.on("id3Frame",(function(t){e.postMessage({action:"id3Frame",id3Frame:t})})),t.on("caption",(function(t){e.postMessage({action:"caption",caption:t})})),t.on("trackinfo",(function(t){e.postMessage({action:"trackinfo",trackInfo:t})})),t.on("audioTimingInfo",(function(t){e.postMessage({action:"audioTimingInfo",audioTimingInfo:{start:he(t.start),end:he(t.end)}})})),t.on("videoTimingInfo",(function(t){e.postMessage({action:"videoTimingInfo",videoTimingInfo:{start:he(t.start),end:he(t.end)}})}))}(this.self,this.transmuxer)},t.pushMp4Captions=function(e){this.captionParser||(this.captionParser=new Bt,this.captionParser.init());var t=new Uint8Array(e.data,e.byteOffset,e.byteLength),i=this.captionParser.parse(t,e.trackIds,e.timescales);this.self.postMessage({action:"mp4Captions",captions:i&&i.captions||[],data:t.buffer},[t.buffer])},t.clearAllMp4Captions=function(){this.captionParser&&this.captionParser.clearAllCaptions()},t.clearParsedMp4Captions=function(){this.captionParser&&this.captionParser.clearParsedCaptions()},t.push=function(e){var t=new Uint8Array(e.data,e.byteOffset,e.byteLength);this.transmuxer.push(t)},t.reset=function(){this.transmuxer.reset()},t.setTimestampOffset=function(e){this.transmuxer.setBaseMediaDecodeTime(Math.round(de(e.timestampOffset||0)))},t.setAudioAppendStart=function(e){this.transmuxer.setAudioAppendStart(Math.ceil(de(e.appendStart)))},t.setRemux=function(e){this.transmuxer.setRemux(e.remux)},t.flush=function(e){this.transmuxer.flush(),i.postMessage({action:"done",type:"transmuxed"})},t.partialFlush=function(e){this.transmuxer.partialFlush(),i.postMessage({action:"partialdone",type:"transmuxed"})},t.endTimeline=function(){this.transmuxer.endTimeline(),i.postMessage({action:"endedtimeline",type:"transmuxed"})},t.alignGopsWith=function(e){this.transmuxer.alignGopsWith(e.gopsToAlignWith.slice())},e}();new function(e){e.onmessage=function(t){"init"===t.data.action&&t.data.options?this.messageHandlers=new jt(e,t.data.options):(this.messageHandlers||(this.messageHandlers=new jt(e)),t.data&&t.data.action&&"init"!==t.data.action&&this.messageHandlers[t.data.action]&&this.messageHandlers[t.data.action](t.data))}}(i)}()})),Fl=Al("PlaylistSelector"),Bl=function(t){function i(e,i){var r;if(r=t.call(this)||this,!e)throw new TypeError("Initialization settings are required");if("function"!=typeof e.currentTime)throw new TypeError("No currentTime getter specified");if(!e.mediaSource)throw new TypeError("No MediaSource specified");return r.bandwidth=e.bandwidth,r.throughput={rate:0,count:0},r.roundTrip=NaN,r.resetStats_(),r.mediaIndex=null,r.hasPlayed_=e.hasPlayed,r.currentTime_=e.currentTime,r.seekable_=e.seekable,r.seeking_=e.seeking,r.duration_=e.duration,r.mediaSource_=e.mediaSource,r.vhs_=e.vhs,r.loaderType_=e.loaderType,r.currentMediaInfo_=void 0,r.startingMediaInfo_=void 0,r.segmentMetadataTrack_=e.segmentMetadataTrack,r.goalBufferLength_=e.goalBufferLength,r.sourceType_=e.sourceType,r.sourceUpdater_=e.sourceUpdater,r.inbandTextTracks_=e.inbandTextTracks,r.state_="INIT",r.handlePartialData_=e.handlePartialData,r.timelineChangeController_=e.timelineChangeController,r.shouldSaveSegmentTimingInfo_=!0,r.checkBufferTimeout_=null,r.error_=void 0,r.currentTimeline_=-1,r.pendingSegment_=null,r.xhrOptions_=null,r.pendingSegments_=[],r.audioDisabled_=!1,r.isPendingTimestampOffset_=!1,r.gopBuffer_=[],r.timeMapping_=0,r.safeAppend_=11<=ea.browser.IE_VERSION,r.appendInitSegment_={audio:!0,video:!0},r.playlistOfLastInitSegment_={audio:null,video:null},r.callQueue_=[],r.loadQueue_=[],r.metadataQueue_={id3:[],caption:[]},r.activeInitSegmentId_=null,r.initSegments_={},r.cacheEncryptionKeys_=e.cacheEncryptionKeys,r.keyCache_={},r.decrypter_=e.decrypter,r.syncController_=e.syncController,r.syncPoint_={segmentIndex:0,time:0},r.transmuxer_=r.createTransmuxer_(),r.triggerSyncInfoUpdate_=function(){return r.trigger("syncinfoupdate")},r.syncController_.on("syncinfoupdate",r.triggerSyncInfoUpdate_),r.mediaSource_.addEventListener("sourceopen",(function(){r.isEndOfStream_()||(r.ended_=!1)})),r.fetchAtBuffer_=!1,r.logger_=Al("SegmentLoader["+r.loaderType_+"]"),Object.defineProperty(Be(r),"state",{get:function(){return this.state_},set:function(e){e!==this.state_&&(this.logger_(this.state_+" -> "+e),this.state_=e,this.trigger("statechange"))}}),r.sourceUpdater_.on("ready",(function(){r.hasEnoughInfoToAppend_()&&r.processCallQueue_()})),"main"===r.loaderType_&&r.timelineChangeController_.on("pendingtimelinechange",(function(){r.hasEnoughInfoToAppend_()&&r.processCallQueue_()})),"audio"===r.loaderType_&&r.timelineChangeController_.on("timelinechange",(function(){r.hasEnoughInfoToLoad_()&&r.processLoadQueue_(),r.hasEnoughInfoToAppend_()&&r.processCallQueue_()})),r}qe(i,t);var r=i.prototype;return r.createTransmuxer_=function(){var e=new Ul;return e.postMessage({action:"init",options:{remux:!1,alignGopsAtEnd:this.safeAppend_,keepOriginalTimestamps:!0,handlePartialData:this.handlePartialData_}}),e},r.resetStats_=function(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0},r.dispose=function(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.transmuxer_&&(this.transmuxer_.terminate(),Bu=null,ll.length=0),this.resetStats_(),this.checkBufferTimeout_&&e.clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()},r.setAudio=function(e){this.audioDisabled_=!e,e?this.appendInitSegment_.audio=!0:this.sourceUpdater_.removeAudio(0,this.duration_())},r.abort=function(){"WAITING"===this.state?(this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()):this.pendingSegment_&&(this.pendingSegment_=null)},r.abort_=function(){this.pendingSegment_&&this.pendingSegment_.abortRequests&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_)},r.checkForAbort_=function(e){return"APPENDING"!==this.state||this.pendingSegment_?!this.pendingSegment_||this.pendingSegment_.requestId!==e:(this.state="READY",!0)},r.error=function(e){return void 0!==e&&(this.logger_("error occurred:",e),this.error_=e),this.pendingSegment_=null,this.error_},r.endOfStream=function(){this.ended_=!0,this.transmuxer_&&dl(this.transmuxer_),this.gopBuffer_.length=0,this.pause(),this.trigger("ended")},r.buffered_=function(){if(!this.sourceUpdater_||!this.startingMediaInfo_)return ea.createTimeRanges();if("main"===this.loaderType_){var e=this.startingMediaInfo_,t=e.hasVideo;if(t&&e.hasAudio&&!this.audioDisabled_&&!e.isMuxed)return this.sourceUpdater_.buffered();if(t)return this.sourceUpdater_.videoBuffered()}return this.sourceUpdater_.audioBuffered()},r.initSegmentForMap=function(e,t){if(void 0===t&&(t=!1),!e)return null;var i=Eu(e),r=this.initSegments_[i];return t&&!r&&e.bytes&&(this.initSegments_[i]=r={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:e.bytes,tracks:e.tracks,timescales:e.timescales}),r||e},r.segmentKey=function(e,t){if(void 0===t&&(t=!1),!e)return null;var i=ku(e),r=this.keyCache_[i];this.cacheEncryptionKeys_&&t&&!r&&e.bytes&&(this.keyCache_[i]=r={resolvedUri:e.resolvedUri,bytes:e.bytes});var n={resolvedUri:(r||e).resolvedUri};return r&&(n.bytes=r.bytes),n},r.couldBeginLoading_=function(){return this.playlist_&&!this.paused()},r.load=function(){if(this.monitorBuffer_(),this.playlist_){if(this.syncController_.setDateTimeMapping(this.playlist_),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||"READY"!==this.state&&"INIT"!==this.state||(this.state="READY")}},r.init_=function(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()},r.playlist=function(e,t){if(void 0===t&&(t={}),e){var i=this.playlist_,r=this.pendingSegment_;this.playlist_=e,this.xhrOptions_=t,"INIT"===this.state&&(e.syncInfo={mediaSequence:e.mediaSequence,time:0});var n=null;if(i&&(i.id?n=i.id:i.uri&&(n=i.uri)),this.logger_("playlist update ["+n+" => "+(e.id||e.uri)+"]"),this.trigger("syncinfoupdate"),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();if(!i||i.uri!==e.uri)return null===this.mediaIndex&&!this.handlePartialData_||this.resyncLoader(),this.currentMediaInfo_=void 0,void this.trigger("playlistupdate");var a=e.mediaSequence-i.mediaSequence;this.logger_("live window shift ["+a+"]"),null!==this.mediaIndex&&(this.mediaIndex-=a),r&&(r.mediaIndex-=a,0<=r.mediaIndex&&(r.segment=e.segments[r.mediaIndex])),this.syncController_.saveExpiredSegmentInfo(i,e)}},r.pause=function(){this.checkBufferTimeout_&&(e.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)},r.paused=function(){return null===this.checkBufferTimeout_},r.resetEverything=function(e){this.ended_=!1,this.appendInitSegment_={audio:!0,video:!0},this.resetLoader(),this.remove(0,1/0,e),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"})},r.resetLoader=function(){this.fetchAtBuffer_=!1,this.resyncLoader()},r.resyncLoader=function(){this.transmuxer_&&dl(this.transmuxer_),this.mediaIndex=null,this.syncPoint_=null,this.isPendingTimestampOffset_=!1,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})},r.remove=function(e,t,i){if(void 0===i&&(i=function(){}),t===1/0&&(t=this.duration_()),this.sourceUpdater_&&this.currentMediaInfo_){var r=1,n=function(){0==--r&&i()};for(var a in this.audioDisabled_||(r++,this.sourceUpdater_.removeAudio(e,t,n)),"main"===this.loaderType_&&this.currentMediaInfo_&&this.currentMediaInfo_.hasVideo&&(this.gopBuffer_=function(e,t,i,r){for(var n=Math.ceil((t-r)*Oo),a=Math.ceil((i-r)*Oo),s=e.slice(),o=e.length;o--&&!(e[o].pts<=a););if(-1===o)return s;for(var u=o+1;u--&&!(e[u].pts<=n););return u=Math.max(u,0),s.splice(u,o-u+1),s}(this.gopBuffer_,e,t,this.timeMapping_),r++,this.sourceUpdater_.removeVideo(e,t,n)),this.inbandTextTracks_)Ol(e,t,this.inbandTextTracks_[a]);Ol(e,t,this.segmentMetadataTrack_),n()}},r.monitorBuffer_=function(){this.checkBufferTimeout_&&e.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=e.setTimeout(this.monitorBufferTick_.bind(this),1)},r.monitorBufferTick_=function(){"READY"===this.state&&this.fillBuffer_(),this.checkBufferTimeout_&&e.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=e.setTimeout(this.monitorBufferTick_.bind(this),500)},r.fillBuffer_=function(){if(!this.sourceUpdater_.updating()){this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_()));var e=this.buffered_(),t=this.checkBuffer_(e,this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);t&&(t.timestampOffset=Ml({segmentTimeline:t.timeline,currentTimeline:this.currentTimeline_,startOfSegment:t.startOfSegment,buffered:e,overrideCheck:this.isPendingTimestampOffset_}),this.isPendingTimestampOffset_=!1,"number"==typeof t.timestampOffset&&this.timelineChangeController_.pendingTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:t.timeline}),this.loadSegment_(t))}},r.isEndOfStream_=function(e,t){return void 0===e&&(e=this.mediaIndex),void 0===t&&(t=this.playlist_),!(!t||!this.mediaSource_)&&t.endList&&"open"===this.mediaSource_.readyState&&e+1===t.segments.length},r.checkBuffer_=function(e,t,i,r,n,a){var s=0;e.length&&(s=e.end(e.length-1));var o=Math.max(0,s-n);if(!t.segments.length)return null;if(o>=this.goalBufferLength_())return null;if(!r&&1<=o)return null;var u,l=null,c=!1;if(null===a)l=this.getSyncSegmentCandidate_(t),c=!0;else if(null!==i){var d=t.segments[i];u=d&&d.end?d.end:s,l=i+1}else if(this.fetchAtBuffer_){var h=il.getMediaInfoForTime(t,s,a.segmentIndex,a.time);l=h.mediaIndex,u=h.startTime}else{var f=il.getMediaInfoForTime(t,n,a.segmentIndex,a.time);l=f.mediaIndex,u=f.startTime}var p=this.generateSegmentInfo_(t,l,u,c);return!p||this.mediaSource_&&this.playlist_&&p.mediaIndex===this.playlist_.segments.length-1&&"ended"===this.mediaSource_.readyState&&!this.seeking_()?void 0:(this.logger_("checkBuffer_ returning "+p.uri,{segmentInfo:p,playlist:t,currentMediaIndex:i,nextMediaIndex:l,startOfSegment:u,isSyncRequest:c}),p)},r.getSyncSegmentCandidate_=function(e){var t=this;if(-1===this.currentTimeline_)return 0;var i=e.segments.map((function(e,t){return{timeline:e.timeline,segmentIndex:t}})).filter((function(e){return e.timeline===t.currentTimeline_}));return i.length?i[Math.min(i.length-1,1)].segmentIndex:Math.max(e.segments.length-1,0)},r.generateSegmentInfo_=function(e,t,i,r){if(t<0||t>=e.segments.length)return null;var n,a,s=e.segments[t],o=this.sourceUpdater_.audioBuffered(),u=this.sourceUpdater_.videoBuffered();return o.length&&(n=o.end(o.length-1)-this.sourceUpdater_.audioTimestampOffset()),u.length&&(a=function(e,t,i){if(null==t||!e.length)return[];var r,n=Math.ceil((t-i+3)*Oo);for(r=0;r<e.length&&!(e[r].pts>n);r++);return e.slice(r)}(this.gopBuffer_,this.currentTime_()-this.sourceUpdater_.videoTimestampOffset(),this.timeMapping_)),{requestId:"segment-loader-"+Math.random(),uri:s.resolvedUri,mediaIndex:t,isSyncRequest:r,startOfSegment:i,playlist:e,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:s.timeline,duration:s.duration,segment:s,byteLength:0,transmuxer:this.transmuxer_,audioAppendStart:n,gopsToAlignWith:a}},r.abortRequestEarly_=function(e){if(this.vhs_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH)return!1;if(Date.now()-(e.firstBytesReceivedAt||Date.now())<1e3)return!1;var t=this.currentTime_(),i=e.bandwidth,r=this.pendingSegment_.duration,n=il.estimateSegmentRequestTime(r,i,this.playlist_,e.bytesReceived),a=function(e,t,i){return void 0===i&&(i=1),((e.length?e.end(e.length-1):0)-t)/i}(this.buffered_(),t,this.vhs_.tech_.playbackRate())-1;if(n<=a)return!1;var s=function(e){var t=e.currentTime,i=e.bandwidth,r=e.duration,n=e.segmentDuration,a=e.timeUntilRebuffer,s=e.currentTimeline,o=e.syncController,u=e.master.playlists.filter((function(e){return!il.isIncompatible(e)})),l=u.filter(il.isEnabled);l.length||(l=u.filter((function(e){return!il.isDisabled(e)})));var c=l.filter(il.hasAttribute.bind(null,"BANDWIDTH")).map((function(e){var u=o.getSyncPoint(e,r,s,t)?1:2;return{playlist:e,rebufferingImpact:il.estimateSegmentRequestTime(n,i,e)*u-a}})),d=c.filter((function(e){return e.rebufferingImpact<=0}));return Rl(d,(function(e,t){return Dl(t.playlist,e.playlist)})),d.length?d[0]:(Rl(c,(function(e,t){return e.rebufferingImpact-t.rebufferingImpact})),c[0]||null)}({master:this.vhs_.playlists.master,currentTime:t,bandwidth:i,duration:this.duration_(),segmentDuration:r,timeUntilRebuffer:a,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(s){var o=.5;return a<=el&&(o=1),!(!s.playlist||s.playlist.uri===this.playlist_.uri||n-a-s.rebufferingImpact<o||(this.bandwidth=s.playlist.attributes.BANDWIDTH*ul.BANDWIDTH_VARIANCE+1,this.abort(),this.trigger("earlyabort"),0))}},r.handleAbort_=function(){this.mediaRequestsAborted+=1},r.handleProgress_=function(e,t){this.checkForAbort_(t.requestId)||this.abortRequestEarly_(t.stats)||this.trigger("progress")},r.handleTrackInfo_=function(e,t){this.checkForAbort_(e.requestId)||this.abortRequestEarly_(e.stats)||this.checkForIllegalMediaSwitch(t)||(function(e,t){if(!e&&!t||!e&&t||e&&!t)return!1;if(e===t)return!0;var i=Object.keys(e).sort(),r=Object.keys(t).sort();if(i.length!==r.length)return!1;for(var n=0;n<i.length;n++){var a=i[n];if(a!==r[n])return!1;if(e[a]!==t[a])return!1}return!0}(this.currentMediaInfo_,t=t||{})||(this.appendInitSegment_={audio:!0,video:!0},this.startingMediaInfo_=t,this.currentMediaInfo_=t,this.logger_("trackinfo update",t),this.trigger("trackinfo")),this.checkForAbort_(e.requestId)||this.abortRequestEarly_(e.stats)||(this.pendingSegment_.trackInfo=t,this.hasEnoughInfoToAppend_()&&this.processCallQueue_()))},r.handleTimingInfo_=function(e,t,i,r){if(!this.checkForAbort_(e.requestId)&&!this.abortRequestEarly_(e.stats)){var n=this.pendingSegment_,a=Pl(t);n[a]=n[a]||{},n[a][i]=r,this.logger_("timinginfo: "+t+" - "+i+" - "+r),this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}},r.handleCaptions_=function(t,i){var r=this;if(!this.checkForAbort_(t.requestId)&&!this.abortRequestEarly_(t.stats))if(0!==i.length)if(this.pendingSegment_.hasAppendedData_){var n=null===this.sourceUpdater_.videoTimestampOffset()?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset(),a={};i.forEach((function(e){a[e.stream]=a[e.stream]||{startTime:1/0,captions:[],endTime:0};var t=a[e.stream];t.startTime=Math.min(t.startTime,e.startTime+n),t.endTime=Math.max(t.endTime,e.endTime+n),t.captions.push(e)})),Object.keys(a).forEach((function(t){var i=a[t],s=i.startTime,o=i.endTime,u=i.captions,l=r.inbandTextTracks_;r.logger_("adding cues from "+s+" -> "+o+" for "+t),function(e,t,i){if(!e[i]){t.trigger({type:"usage",name:"vhs-608"}),t.trigger({type:"usage",name:"hls-608"});var r=t.textTracks().getTrackById(i);e[i]=r||t.addRemoteTextTrack({kind:"captions",id:i,label:i},!1).track}}(l,r.vhs_.tech_,t),Ol(s,o,l[t]),function(t){var i=t.inbandTextTracks,r=t.captionArray,n=t.timestampOffset;if(r){var a=e.WebKitDataCue||e.VTTCue;r.forEach((function(e){i[e.stream].addCue(new a(e.startTime+n,e.endTime+n,e.text))}))}}({captionArray:u,inbandTextTracks:l,timestampOffset:n})})),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}else this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,t,i));else this.logger_("SegmentLoader received no captions from a caption event")},r.handleId3_=function(t,i,r){if(!this.checkForAbort_(t.requestId)&&!this.abortRequestEarly_(t.stats))if(this.pendingSegment_.hasAppendedData_){var n=null===this.sourceUpdater_.videoTimestampOffset()?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset();!function(e,t,i){e.metadataTrack_||(e.metadataTrack_=i.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,e.metadataTrack_.inBandMetadataTrackDispatchType=t)}(this.inbandTextTracks_,r,this.vhs_.tech_),function(t){var i=t.metadataArray,r=t.timestampOffset,n=t.videoDuration;if(i){var a=e.WebKitDataCue||e.VTTCue,s=t.inbandTextTracks.metadataTrack_;if(s&&(i.forEach((function(t){var i=t.cueTime+r;!("number"!=typeof i||e.isNaN(i)||i<0)&&i<1/0&&t.frames.forEach((function(e){var t=new a(i,i,e.value||e.url||e.data||"");t.frame=e,t.value=e,function(e){Object.defineProperties(e.frame,{id:{get:function(){return ea.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),e.value.key}},value:{get:function(){return ea.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),e.value.data}},privateData:{get:function(){return ea.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),e.value.data}}})}(t),s.addCue(t)}))})),s.cues&&s.cues.length)){for(var o=s.cues,u=[],l=0;l<o.length;l++)o[l]&&u.push(o[l]);var c=u.reduce((function(e,t){var i=e[t.startTime]||[];return i.push(t),e[t.startTime]=i,e}),{}),d=Object.keys(c).sort((function(e,t){return Number(e)-Number(t)}));d.forEach((function(e,t){var i=c[e],r=Number(d[t+1])||n;i.forEach((function(e){e.endTime=r}))}))}}}({inbandTextTracks:this.inbandTextTracks_,metadataArray:i,timestampOffset:n,videoDuration:this.duration_()})}else this.metadataQueue_.id3.push(this.handleId3_.bind(this,t,i,r))},r.processMetadataQueue_=function(){this.metadataQueue_.id3.forEach((function(e){return e()})),this.metadataQueue_.caption.forEach((function(e){return e()})),this.metadataQueue_.id3=[],this.metadataQueue_.caption=[]},r.processCallQueue_=function(){var e=this.callQueue_;this.callQueue_=[],e.forEach((function(e){return e()}))},r.processLoadQueue_=function(){var e=this.loadQueue_;this.loadQueue_=[],e.forEach((function(e){return e()}))},r.hasEnoughInfoToLoad_=function(){if("audio"!==this.loaderType_)return!0;var e=this.pendingSegment_;return!(!e||this.currentMediaInfo_&&Nl({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))},r.hasEnoughInfoToAppend_=function(){if(!this.sourceUpdater_.ready())return!1;var e=this.pendingSegment_;if(!e||!e.trackInfo)return!1;if(!this.handlePartialData_){var t=this.currentMediaInfo_;if(t.hasVideo&&!e.videoTimingInfo)return!1;if(t.hasAudio&&!this.audioDisabled_&&!t.isMuxed&&!e.audioTimingInfo)return!1}return!Nl({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_})},r.handleData_=function(e,t){if(!this.checkForAbort_(e.requestId)&&!this.abortRequestEarly_(e.stats))if(!this.callQueue_.length&&this.hasEnoughInfoToAppend_()){var i=this.pendingSegment_;if(this.setTimeMapping_(i.timeline),this.updateMediaSecondsLoaded_(i.segment),"closed"!==this.mediaSource_.readyState){if(e.map&&(e.map=this.initSegmentForMap(e.map,!0),i.segment.map=e.map),e.key&&this.segmentKey(e.key,!0),i.isFmp4=e.isFmp4,i.timingInfo=i.timingInfo||{},i.isFmp4)this.trigger("fmp4"),i.timingInfo.start=i[Pl(t.type)].start;else{var r,n="main"===this.loaderType_&&this.currentMediaInfo_.hasVideo;n&&(r=this.handlePartialData_?t.videoFramePtsTime:i.videoTimingInfo.start),i.timingInfo.start=this.trueSegmentStart_({currentStart:i.timingInfo.start,playlist:i.playlist,mediaIndex:i.mediaIndex,currentVideoTimestampOffset:this.sourceUpdater_.videoTimestampOffset(),useVideoTimingInfo:n,firstVideoFrameTimeForData:r,videoTimingInfo:i.videoTimingInfo,audioTimingInfo:i.audioTimingInfo})}this.updateAppendInitSegmentStatus(i,t.type),this.updateSourceBufferTimestampOffset_(i),i.hasAppendedData_=!0,this.processMetadataQueue_(),this.appendData_(i,t)}}else this.callQueue_.push(this.handleData_.bind(this,e,t))},r.updateAppendInitSegmentStatus=function(e,t){"main"!==this.loaderType_||"number"!=typeof e.timestampOffset||e.changedTimestampOffset||(this.appendInitSegment_={audio:!0,video:!0}),this.playlistOfLastInitSegment_[t]!==e.playlist&&(this.appendInitSegment_[t]=!0)},r.getInitSegmentAndUpdateState_=function(e){var t=e.type,i=e.initSegment,r=e.map,n=e.playlist;if(r){var a=Eu(r);if(this.activeInitSegmentId_===a)return null;i=this.initSegmentForMap(r,!0).bytes,this.activeInitSegmentId_=a}return i&&this.appendInitSegment_[t]?(this.playlistOfLastInitSegment_[t]=n,this.appendInitSegment_[t]=!!r,this.activeInitSegmentId_=null,i):null},r.appendToSourceBuffer_=function(e){var t=this,i=e.segmentInfo,r=e.type,n=e.initSegment,a=e.data,s=[a],o=a.byteLength;n&&(s.unshift(n),o+=n.byteLength);var u=function(e){var t,i=0;return e.bytes&&(t=new Uint8Array(e.bytes),e.segments.forEach((function(e){t.set(e,i),i+=e.byteLength}))),t}({bytes:o,segments:s});this.sourceUpdater_.appendBuffer({segmentInfo:i,type:r,bytes:u},(function(e){e&&(t.error(r+" append of "+u.length+"b failed for segment #"+i.mediaIndex+" in playlist "+i.playlist.id),t.trigger("appenderror"))}))},r.handleVideoSegmentTimingInfo_=function(e,t){if(this.pendingSegment_&&e===this.pendingSegment_.requestId){var i=this.pendingSegment_.segment;i.videoTimingInfo||(i.videoTimingInfo={}),i.videoTimingInfo.transmuxerPrependedSeconds=t.prependedContentDuration||0,i.videoTimingInfo.transmuxedPresentationStart=t.start.presentation,i.videoTimingInfo.transmuxedPresentationEnd=t.end.presentation,i.videoTimingInfo.baseMediaDecodeTime=t.baseMediaDecodeTime}},r.appendData_=function(e,t){var i=t.type,r=t.data;if(r&&r.byteLength&&("audio"!==i||!this.audioDisabled_)){var n=this.getInitSegmentAndUpdateState_({type:i,initSegment:t.initSegment,playlist:e.playlist,map:e.isFmp4?e.segment.map:null});this.appendToSourceBuffer_({segmentInfo:e,type:i,initSegment:n,data:r})}},r.loadSegment_=function(e){var t=this;this.state="WAITING",this.pendingSegment_=e,this.trimBackBuffer_(e),"number"==typeof e.timestampOffset&&this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.hasEnoughInfoToLoad_()?this.updateTransmuxerAndRequestSegment_(e):this.loadQueue_.push((function(){var i=t.buffered_();"number"==typeof e.timestampOffset&&(e.timestampOffset=Ml({segmentTimeline:e.timeline,currentTimeline:t.currentTimeline_,startOfSegment:e.startOfSegment,buffered:i,overrideCheck:!0})),delete e.audioAppendStart;var r=t.sourceUpdater_.audioBuffered();r.length&&(e.audioAppendStart=r.end(r.length-1)-t.sourceUpdater_.audioTimestampOffset()),t.updateTransmuxerAndRequestSegment_(e)}))},r.updateTransmuxerAndRequestSegment_=function(e){this.shouldUpdateTransmuxerTimestampOffset_(e.timestampOffset)&&(this.gopBuffer_.length=0,e.gopsToAlignWith=[],this.timeMapping_=0,this.transmuxer_.postMessage({action:"reset"}),this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:e.timestampOffset}));var t=this.createSimplifiedSegmentObj_(e);e.abortRequests=function(e){var t=e.xhr,i=e.xhrOptions,r=e.segment,n=e.abortFn,a=e.progressFn,s=e.trackInfoFn,o=e.timingInfoFn,u=e.videoSegmentTimingInfoFn,l=e.id3Fn,c=e.captionsFn,d=e.dataFn,h=e.handlePartialData,f=[],p=function(e){var t=e.activeXhrs,i=e.decryptionWorker,r=e.trackInfoFn,n=e.timingInfoFn,a=e.videoSegmentTimingInfoFn,s=e.id3Fn,o=e.captionsFn,u=e.dataFn,l=e.doneFn,c=0,d=!1;return function(e,h){if(!d){if(e)return d=!0,Nu(t),l(e,h);if((c+=1)===t.length){if(h.endOfAllRequests=Date.now(),h.encryptedBytes)return function(e){var t,i=e.decryptionWorker,r=e.segment,n=e.trackInfoFn,a=e.timingInfoFn,s=e.videoSegmentTimingInfoFn,o=e.id3Fn,u=e.captionsFn,l=e.dataFn,c=e.doneFn;i.addEventListener("message",(function e(t){if(t.data.source===r.requestId){i.removeEventListener("message",e);var d=t.data.decrypted;r.bytes=new Uint8Array(d.bytes,d.byteOffset,d.byteLength),Fu({segment:r,bytes:r.bytes,isPartial:!1,trackInfoFn:n,timingInfoFn:a,videoSegmentTimingInfoFn:s,id3Fn:o,captionsFn:u,dataFn:l,doneFn:c})}})),t=r.key.bytes.slice?r.key.bytes.slice():new Uint32Array(Array.prototype.slice.call(r.key.bytes)),i.postMessage(Su({source:r.requestId,encrypted:r.encryptedBytes,key:t,iv:r.key.iv}),[r.encryptedBytes.buffer,t.buffer])}({decryptionWorker:i,segment:h,trackInfoFn:r,timingInfoFn:n,videoSegmentTimingInfoFn:a,id3Fn:s,captionsFn:o,dataFn:u,doneFn:l});Fu({segment:h,bytes:h.bytes,isPartial:!1,trackInfoFn:r,timingInfoFn:n,videoSegmentTimingInfoFn:a,id3Fn:s,captionsFn:o,dataFn:u,doneFn:l})}}}}({activeXhrs:f,decryptionWorker:e.decryptionWorker,trackInfoFn:s,timingInfoFn:o,videoSegmentTimingInfoFn:u,id3Fn:l,captionsFn:c,dataFn:d,doneFn:e.doneFn});if(r.key&&!r.key.bytes){var g=t(ea.mergeOptions(i,{uri:r.key.resolvedUri,responseType:"arraybuffer"}),function(e,t){return function(i,r){var n=r.response,a=Uu(i,r);if(a)return t(a,e);if(16!==n.byteLength)return t({status:r.status,message:"Invalid HLS key at URL: "+r.uri,code:hl,xhr:r},e);var s=new DataView(n);return e.key.bytes=new Uint32Array([s.getUint32(0),s.getUint32(4),s.getUint32(8),s.getUint32(12)]),t(null,e)}}(r,p));f.push(g)}if(r.map&&!r.map.bytes){var m=t(ea.mergeOptions(i,{uri:r.map.resolvedUri,responseType:"arraybuffer",headers:_u(r.map)}),function(e){var t=e.segment,i=e.finishProcessingFn;return function(e,r){var n=r.response,a=Uu(e,r);if(a)return i(a,t);if(0===n.byteLength)return i({status:r.status,message:"Empty HLS segment content at URL: "+r.uri,code:hl,xhr:r},t);t.map.bytes=new Uint8Array(r.response);var s=mo(t.map.bytes);return"mp4"!==s?i({status:r.status,message:"Found unsupported "+(s||"unknown")+" container for initialization segment at URL: "+r.uri,code:hl,internal:!0,xhr:r},t):(function(e){var t=Go(e,["moov","trak"]),i=[];return t.forEach((function(e){var t,r,n={},a=Go(e,["tkhd"])[0];a&&(r=(t=new DataView(a.buffer,a.byteOffset,a.byteLength)).getUint8(0),n.id=t.getUint32(0===r?12:20));var s=Go(e,["mdia","hdlr"])[0];if(s){var o=Vo(s.subarray(8,12));n.type="vide"===o?"video":"soun"===o?"audio":o}var u=Go(e,["mdia","minf","stbl","stsd"])[0];if(u){var l=u.subarray(8);n.codec=Vo(l.subarray(4,8));var c,d=Go(l,[n.codec])[0];d&&(/^[a-z]vc[1-9]$/i.test(n.codec)?(c=d.subarray(78),"avcC"===Vo(c.subarray(4,8))&&11<c.length?(n.codec+=".",n.codec+=Ko(c[9]),n.codec+=Ko(c[10]),n.codec+=Ko(c[11])):n.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(n.codec)&&(c=d.subarray(28),"esds"===Vo(c.subarray(4,8))&&20<c.length&&0!==c[19]?(n.codec+="."+Ko(c[19]),n.codec+="."+Ko(c[20]>>>2&63).replace(/^0/,"")):n.codec="mp4a.40.2"))}var h=Go(e,["mdia","mdhd"])[0];h&&(n.timescale=Uo(h)),i.push(n)})),i}(t.map.bytes).forEach((function(e){t.map.tracks=t.map.tracks||{},t.map.tracks[e.type]||(t.map.tracks[e.type]=e).id&&e.timescale&&(t.map.timescales=t.map.timescales||{},t.map.timescales[e.id]=e.timescale)})),i(null,t))}}({segment:r,finishProcessingFn:p}));f.push(m)}var v=ea.mergeOptions(i,{uri:r.resolvedUri,responseType:"arraybuffer",headers:_u(r)});h&&(v.responseType="text",v.beforeSend=function(e){e.overrideMimeType("text/plain; charset=x-user-defined")});var y=t(v,function(e){var t=e.segment,i=e.finishProcessingFn,r=e.responseType;return function(e,n){var a=n.response,s=Uu(e,n);if(s)return i(s,t);var o="arraybuffer"!==r&&n.responseText?Ou(n.responseText.substring(t.lastReachedChar||0)):n.response;return 0===a.byteLength?i({status:n.status,message:"Empty HLS segment content at URL: "+n.uri,code:hl,xhr:n},t):(t.stats=function(e){return{bandwidth:e.bandwidth,bytesReceived:e.bytesReceived||0,roundTripTime:e.roundTripTime||0}}(n),t.key?t.encryptedBytes=new Uint8Array(o):t.bytes=new Uint8Array(o),i(null,t))}}({segment:r,finishProcessingFn:p,responseType:v.responseType}));y.addEventListener("progress",function(e){var t=e.segment,i=e.progressFn,r=e.trackInfoFn,n=e.timingInfoFn,a=e.videoSegmentTimingInfoFn,s=e.id3Fn,o=e.captionsFn,u=e.dataFn,l=e.handlePartialData;return function(e){var c=e.target;if(!c.aborted){if(l&&!t.key&&c.responseText&&8<=c.responseText.length){var d=Ou(c.responseText.substring(t.lastReachedChar||0));!t.lastReachedChar&&yo(new Uint8Array(d))||(t.lastReachedChar=c.responseText.length,Fu({segment:t,bytes:d,isPartial:!0,trackInfoFn:r,timingInfoFn:n,videoSegmentTimingInfoFn:a,id3Fn:s,captionsFn:o,dataFn:u}))}return t.stats=ea.mergeOptions(t.stats,function(e){var t=e.target,i={bandwidth:1/0,bytesReceived:0,roundTripTime:Date.now()-t.requestTime||0};return i.bytesReceived=e.loaded,i.bandwidth=Math.floor(i.bytesReceived/i.roundTripTime*8*1e3),i}(e)),!t.stats.firstBytesReceivedAt&&t.stats.bytesReceived&&(t.stats.firstBytesReceivedAt=Date.now()),i(e,t)}}}({segment:r,progressFn:a,trackInfoFn:s,timingInfoFn:o,videoSegmentTimingInfoFn:u,id3Fn:l,captionsFn:c,dataFn:d,handlePartialData:h})),f.push(y);var _={};return f.forEach((function(e){e.addEventListener("loadend",function(e){var t=e.loadendState,i=e.abortFn;return function(e){e.target.aborted&&i&&!t.calledAbortFn&&(i(),t.calledAbortFn=!0)}}({loadendState:_,abortFn:n}))})),function(){return Nu(f)}}({xhr:this.vhs_.xhr,xhrOptions:this.xhrOptions_,decryptionWorker:this.decrypter_,segment:t,handlePartialData:this.handlePartialData_,abortFn:this.handleAbort_.bind(this),progressFn:this.handleProgress_.bind(this),trackInfoFn:this.handleTrackInfo_.bind(this),timingInfoFn:this.handleTimingInfo_.bind(this),videoSegmentTimingInfoFn:this.handleVideoSegmentTimingInfo_.bind(this,e.requestId),captionsFn:this.handleCaptions_.bind(this),id3Fn:this.handleId3_.bind(this),dataFn:this.handleData_.bind(this),doneFn:this.segmentRequestFinished_.bind(this)})},r.trimBackBuffer_=function(e){var t=function(e,t,i){var r=t-ul.BACK_BUFFER_LENGTH;return e.length&&(r=Math.max(r,e.start(0))),Math.min(t-i,r)}(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);0<t&&this.remove(0,t)},r.createSimplifiedSegmentObj_=function(e){var t=e.segment,i={resolvedUri:t.resolvedUri,byterange:t.byterange,requestId:e.requestId,transmuxer:e.transmuxer,audioAppendStart:e.audioAppendStart,gopsToAlignWith:e.gopsToAlignWith},r=e.playlist.segments[e.mediaIndex];if(r&&r.end&&r.timeline===t.timeline&&(i.baseStartTime=r.end+e.timestampOffset),t.key){var n=t.key.iv||new Uint32Array([0,0,0,e.mediaIndex+e.playlist.mediaSequence]);i.key=this.segmentKey(t.key),i.key.iv=n}return t.map&&(i.map=this.initSegmentForMap(t.map)),i},r.saveTransferStats_=function(e){this.mediaRequests+=1,e&&(this.mediaBytesTransferred+=e.bytesReceived,this.mediaTransferDuration+=e.roundTripTime)},r.saveBandwidthRelatedStats_=function(e){this.bandwidth=e.bandwidth,this.roundTrip=e.roundTripTime,this.pendingSegment_.byteLength=e.bytesReceived},r.handleTimeout_=function(){this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,this.trigger("bandwidthupdate")},r.segmentRequestFinished_=function(e,t,i){if(this.callQueue_.length)this.callQueue_.push(this.segmentRequestFinished_.bind(this,e,t,i));else if(this.saveTransferStats_(t.stats),this.pendingSegment_&&t.requestId===this.pendingSegment_.requestId){if(e){if(this.pendingSegment_=null,this.state="READY",e.code===pl)return;return this.pause(),e.code===fl?void this.handleTimeout_():(this.mediaRequestsErrored+=1,this.error(e),void this.trigger("error"))}this.saveBandwidthRelatedStats_(t.stats);var r=this.pendingSegment_;r.endOfAllRequests=t.endOfAllRequests,i.gopInfo&&(this.gopBuffer_=function(e,t,i){if(!t.length)return e;if(i)return t.slice();for(var r=t[0].pts,n=0;n<e.length&&!(e[n].pts>=r);n++);return e.slice(0,n).concat(t)}(this.gopBuffer_,i.gopInfo,this.safeAppend_)),this.state="APPENDING";var n=this.isEndOfStream_(r.mediaIndex,r.playlist);!r.isFmp4&&(n||null!==this.mediaIndex&&r.timeline!==this.currentTimeline_&&0<r.timeline)&&function(e){Mu("endTimeline",e)}(this.transmuxer_),this.trigger("appending"),this.waitForAppendsToComplete_(r)}},r.setTimeMapping_=function(e){var t=this.syncController_.mappingForTimeline(e);null!==t&&(this.timeMapping_=t)},r.updateMediaSecondsLoaded_=function(e){this.mediaSecondsLoaded+="number"==typeof e.start&&"number"==typeof e.end?e.end-e.start:e.duration},r.shouldUpdateTransmuxerTimestampOffset_=function(e){return null!==e&&("main"===this.loaderType_&&e!==this.sourceUpdater_.videoTimestampOffset()||!this.audioDisabled_&&e!==this.sourceUpdater_.audioTimestampOffset())},r.trueSegmentStart_=function(e){var t=e.currentStart,i=e.mediaIndex,r=e.firstVideoFrameTimeForData;if(void 0!==t)return t;if(!e.useVideoTimingInfo)return e.audioTimingInfo.start;var n=e.playlist.segments[i-1];return 0!==i&&n&&void 0!==n.start&&n.end===r+e.currentVideoTimestampOffset?e.videoTimingInfo.start:r},r.waitForAppendsToComplete_=function(e){if(!this.currentMediaInfo_)return this.error({message:"No starting media returned, likely due to an unsupported media format.",blacklistDuration:1/0}),void this.trigger("error");var t=this.currentMediaInfo_,i="main"===this.loaderType_&&t.hasVideo,r=!this.audioDisabled_&&t.hasAudio&&!t.isMuxed;if(e.waitingOnAppends=0,!e.hasAppendedData_)return e.timingInfo||"number"!=typeof e.timestampOffset||(this.isPendingTimestampOffset_=!0),e.timingInfo={start:0},e.waitingOnAppends++,this.isPendingTimestampOffset_||(this.updateSourceBufferTimestampOffset_(e),this.processMetadataQueue_()),void this.checkAppendsDone_(e);i&&e.waitingOnAppends++,r&&e.waitingOnAppends++,i&&this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,e)),r&&this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,e))},r.checkAppendsDone_=function(e){this.checkForAbort_(e.requestId)||(e.waitingOnAppends--,0===e.waitingOnAppends&&this.handleAppendsDone_())},r.checkForIllegalMediaSwitch=function(e){var t=function(e,t,i){return"main"===e&&t&&i?i.hasAudio||i.hasVideo?t.hasVideo&&!i.hasVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!t.hasVideo&&i.hasVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null:"Neither audio nor video found in segment.":null}(this.loaderType_,this.currentMediaInfo_,e);return!!t&&(this.error({message:t,blacklistDuration:1/0}),this.trigger("error"),!0)},r.updateSourceBufferTimestampOffset_=function(e){if(null!==e.timestampOffset&&"number"==typeof e.timingInfo.start&&!e.changedTimestampOffset&&"main"===this.loaderType_){var t=!1;e.timestampOffset-=e.timingInfo.start,e.changedTimestampOffset=!0,e.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()&&(this.sourceUpdater_.videoTimestampOffset(e.timestampOffset),t=!0),e.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()&&(this.sourceUpdater_.audioTimestampOffset(e.timestampOffset),t=!0),t&&this.trigger("timestampoffset")}},r.updateTimingInfoEnd_=function(e){e.timingInfo=e.timingInfo||{};var t="main"===this.loaderType_&&this.currentMediaInfo_.hasVideo&&e.videoTimingInfo?e.videoTimingInfo:e.audioTimingInfo;t&&(e.timingInfo.end="number"==typeof t.end?t.end:t.start+e.duration)},r.handleAppendsDone_=function(){if(this.pendingSegment_&&this.trigger("appendsdone"),!this.pendingSegment_)return this.state="READY",void(this.paused()||this.monitorBuffer_());var e=this.pendingSegment_;if(this.updateTimingInfoEnd_(e),this.shouldSaveSegmentTimingInfo_&&this.syncController_.saveSegmentTimingInfo({segmentInfo:e,shouldSaveTimelineMapping:"main"===this.loaderType_}),this.logger_(function(e){var t=e.segment,i=e.playlist,r=i.mediaSequence,n=i.segments;return["appending ["+e.mediaIndex+"] of ["+r+", "+(r+(void 0===n?[]:n).length)+"] from playlist ["+i.id+"]","["+t.start+" => "+t.end+"] in timeline ["+e.timeline+"]"].join(" ")}(e)),this.recordThroughput_(e),this.pendingSegment_=null,this.state="READY",e.isSyncRequest)this.trigger("syncinfoupdate");else{this.addSegmentMetadataCue_(e),this.fetchAtBuffer_=!0,this.currentTimeline_!==e.timeline&&(this.timelineChangeController_.lastTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline}),"main"!==this.loaderType_||this.audioDisabled_||this.timelineChangeController_.lastTimelineChange({type:"audio",from:this.currentTimeline_,to:e.timeline})),this.currentTimeline_=e.timeline,this.trigger("syncinfoupdate");var t=e.segment;t.end&&this.currentTime_()-t.end>3*e.playlist.targetDuration?this.resetEverything():(null!==this.mediaIndex&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.mediaIndex=e.mediaIndex,this.isEndOfStream_(e.mediaIndex,e.playlist)&&this.endOfStream(),this.trigger("appended"),this.paused()||this.monitorBuffer_())}},r.recordThroughput_=function(e){var t=this.throughput.rate,i=Date.now()-e.endOfAllRequests+1,r=Math.floor(e.byteLength/i*8*1e3);this.throughput.rate+=(r-t)/++this.throughput.count},r.addSegmentMetadataCue_=function(t){if(this.segmentMetadataTrack_){var i=t.segment,r=i.start,n=i.end;if(xl(r)&&xl(n)){Ol(r,n,this.segmentMetadataTrack_);var a={custom:i.custom,dateTimeObject:i.dateTimeObject,dateTimeString:i.dateTimeString,bandwidth:t.playlist.attributes.BANDWIDTH,resolution:t.playlist.attributes.RESOLUTION,codecs:t.playlist.attributes.CODECS,byteLength:t.byteLength,uri:t.uri,timeline:t.timeline,playlist:t.playlist.id,start:r,end:n},s=new(e.WebKitDataCue||e.VTTCue)(r,n,JSON.stringify(a));s.value=a,this.segmentMetadataTrack_.addCue(s)}}},i}(ea.EventTarget);function jl(){}function Vl(e){return"string"!=typeof e?e:e.replace(/./,(function(e){return e.toUpperCase()}))}function Hl(e,t){var i=t[e+"Buffer"];return i&&i.updating||t.queuePending[e]}function Gl(e,t){if(0!==t.queue.length){var i=0,r=t.queue[i];if("mediaSource"!==r.type){if("mediaSource"!==e&&t.started_&&"closed"!==t.mediaSource.readyState&&!Hl(e,t)){if(r.type!==e){if(null===(i=function(e,t){for(var i=0;i<t.length;i++){var r=t[i];if("mediaSource"===r.type)return null;if(r.type===e)return i}return null}(e,t.queue)))return;r=t.queue[i]}t.queue.splice(i,1),r.action(e,t),r.doneFn?t.queuePending[e]=r:Gl(e,t)}}else t.updating()||"closed"===t.mediaSource.readyState||(t.queue.shift(),r.action(t),r.doneFn&&r.doneFn(),Gl("audio",t),Gl("video",t))}}function ql(e,t){var i=t[e+"Buffer"],r=Vl(e);i&&(i.removeEventListener("updateend",t["on"+r+"UpdateEnd_"]),i.removeEventListener("error",t["on"+r+"Error_"]),t.codecs[e]=null,t[e+"Buffer"]=null)}function Kl(e,t){return e&&t&&-1!==Array.prototype.indexOf.call(e.sourceBuffers,t)}function Wl(e){var t=e.type,i=e.sourceUpdater;i.queue.push({type:t,action:e.action,doneFn:e.doneFn,name:e.name}),Gl(t,i)}function zl(e,t){return function(i){if(t.queuePending[e]){var r=t.queuePending[e].doneFn;t.queuePending[e]=null,r&&r(t[e+"Error_"])}Gl(e,t)}}function Yl(e){return decodeURIComponent(escape(String.fromCharCode.apply(null,e)))}function Xl(e,t){for(var i=e.cues,r=0;r<i.length;r++){var n=i[r];if(t>=n.adStartTime&&t<=n.adEndTime)return n}return null}function Ql(e,t){e.abort(),e.pause(),t&&t.activePlaylistLoader&&(t.activePlaylistLoader.pause(),t.activePlaylistLoader=null)}function $l(e,t){(t.activePlaylistLoader=e).load()}function Jl(e,t,i){var r=e.masterPlaylistController_,n=r[(e.options_.smoothQualityChange?"smooth":"fast")+"QualityChange_"].bind(r);if(t.attributes.RESOLUTION){var a=t.attributes.RESOLUTION;this.width=a.width,this.height=a.height}this.bandwidth=t.attributes.BANDWIDTH,this.codecs=Cl(r.master(),t),this.playlist=t,this.id=i,this.enabled=function(e,t,i){return function(r){var n=e.master.playlists[t],a=fu(n),s=pu(n);return void 0===r?s:(r?delete n.disabled:n.disabled=!0,r===s||a||(i(),e.trigger(r?"renditionenabled":"renditiondisabled")),r)}}(e.playlists,t.id,n)}function Zl(e){!function e(t,i){var r=0,n=0,a=ea.mergeOptions(Cc,i);function s(){n&&t.currentTime(n)}function o(e){null!=e&&(n=t.duration()!==1/0&&t.currentTime()||0,t.one("loadedmetadata",s),t.src(e),t.trigger({type:"usage",name:"vhs-error-reload"}),t.trigger({type:"usage",name:"hls-error-reload"}),t.play())}function u(){return Date.now()-r<1e3*a.errorInterval?(t.trigger({type:"usage",name:"vhs-error-reload-canceled"}),void t.trigger({type:"usage",name:"hls-error-reload-canceled"})):a.getSource&&"function"==typeof a.getSource?(r=Date.now(),a.getSource.call(t,o)):void ea.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!")}function l(){t.off("loadedmetadata",s),t.off("error",u),t.off("dispose",l)}t.ready((function(){t.trigger({type:"usage",name:"vhs-error-reload-initialized"}),t.trigger({type:"usage",name:"hls-error-reload-initialized"})})),t.on("error",u),t.on("dispose",l),t.reloadSourceOnError=function(i){l(),e(t,i)}}(this,e)}var ec,tc=["video","audio"],ic=function(e,t){return function(i,r){var n=r[i+"Buffer"];Kl(r.mediaSource,n)&&(r.logger_("Appending segment "+t.mediaIndex+"'s "+e.length+" bytes to "+i+"Buffer"),n.appendBuffer(e))}},rc=function(e,t){return function(i,r){var n=r[i+"Buffer"];Kl(r.mediaSource,n)&&(r.logger_("Removing "+e+" to "+t+" from "+i+"Buffer"),n.remove(e,t))}},nc=function(e){return function(t,i){var r=i[t+"Buffer"];Kl(i.mediaSource,r)&&(i.logger_("Setting "+t+"timestampOffset to "+e),r.timestampOffset=e)}},ac=function(e){return function(t,i){e()}},sc=function(e){return function(t){if("open"===t.mediaSource.readyState){t.logger_("Calling mediaSource endOfStream("+(e||"")+")");try{t.mediaSource.endOfStream(e)}catch(t){ea.log.warn("Failed to call media source endOfStream",t)}}}},oc=function(e){return function(t){t.logger_("Setting mediaSource duration to "+e);try{t.mediaSource.duration=e}catch(t){ea.log.warn("Failed to set media source duration",t)}}},uc=function(e,t){return function(i){var r=Vl(e),n=qu(t);i.logger_("Adding "+e+"Buffer with codec "+t+" to mediaSource");var a=i.mediaSource.addSourceBuffer(n);a.addEventListener("updateend",i["on"+r+"UpdateEnd_"]),a.addEventListener("error",i["on"+r+"Error_"]),i.codecs[e]=t,i[e+"Buffer"]=a}},lc=function(e){return function(t){var i=t[e+"Buffer"];if(ql(e,t),Kl(t.mediaSource,i)){t.logger_("Removing "+e+"Buffer with codec "+t.codecs[e]+" from mediaSource");try{t.mediaSource.removeSourceBuffer(i)}catch(t){ea.log.warn("Failed to removeSourceBuffer "+e+"Buffer",t)}}}},cc=function(e){return function(t,i){var r=i[t+"Buffer"],n=qu(e);Kl(i.mediaSource,r)&&i.codecs[t]!==e&&(i.logger_("changing "+t+"Buffer codec from "+i.codecs[t]+" to "+e),r.changeType(n),i.codecs[t]=e)}},dc=function(t){function i(e){var i;return(i=t.call(this)||this).mediaSource=e,i.sourceopenListener_=function(){return Gl("mediaSource",Be(i))},i.mediaSource.addEventListener("sourceopen",i.sourceopenListener_),i.logger_=Al("SourceUpdater"),i.audioTimestampOffset_=0,i.videoTimestampOffset_=0,i.queue=[],i.queuePending={audio:null,video:null},i.delayedAudioAppendQueue_=[],i.videoAppendQueued_=!1,i.codecs={},i.onVideoUpdateEnd_=zl("video",Be(i)),i.onAudioUpdateEnd_=zl("audio",Be(i)),i.onVideoError_=function(e){i.videoError_=e},i.onAudioError_=function(e){i.audioError_=e},i.started_=!1,i}qe(i,t);var r=i.prototype;return r.ready=function(){return this.started_},r.createSourceBuffers=function(e){this.ready()||(this.addOrChangeSourceBuffers(e),this.started_=!0,this.trigger("ready"))},r.addSourceBuffer=function(e,t){Wl({type:"mediaSource",sourceUpdater:this,action:uc(e,t),name:"addSourceBuffer"})},r.abort=function(e){Wl({type:e,sourceUpdater:this,action:function(e,t){if("open"===t.mediaSource.readyState){var i=t[e+"Buffer"];if(Kl(t.mediaSource,i)){t.logger_("calling abort on "+e+"Buffer");try{i.abort()}catch(t){ea.log.warn("Failed to abort on "+e+"Buffer",t)}}}},name:"abort"})},r.removeSourceBuffer=function(e){this.canRemoveSourceBuffer()?Wl({type:"mediaSource",sourceUpdater:this,action:lc(e),name:"removeSourceBuffer"}):ea.log.error("removeSourceBuffer is not supported!")},r.canRemoveSourceBuffer=function(){return!ea.browser.IE_VERSION&&e.MediaSource&&e.MediaSource.prototype&&"function"==typeof e.MediaSource.prototype.removeSourceBuffer},i.canChangeType=function(){return e.SourceBuffer&&e.SourceBuffer.prototype&&"function"==typeof e.SourceBuffer.prototype.changeType},r.canChangeType=function(){return this.constructor.canChangeType()},r.changeType=function(e,t){this.canChangeType()?Wl({type:e,sourceUpdater:this,action:cc(t),name:"changeType"}):ea.log.error("changeType is not supported!")},r.addOrChangeSourceBuffers=function(e){var t=this;if(!e||"object"!=typeof e||0===Object.keys(e).length)throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs");Object.keys(e).forEach((function(i){var r=e[i];if(!t.ready())return t.addSourceBuffer(i,r);t.canChangeType()&&t.changeType(i,r)}))},r.appendBuffer=function(e,t){var i=this,r=e.segmentInfo,n=e.type,a=e.bytes;if(this.processedAppend_=!0,"audio"===n&&this.videoBuffer&&!this.videoAppendQueued_)return this.delayedAudioAppendQueue_.push([e,t]),void this.logger_("delayed audio append of "+a.length+" until video append");if(Wl({type:n,sourceUpdater:this,action:ic(a,r||{mediaIndex:-1}),doneFn:t,name:"appendBuffer"}),"video"===n){if(this.videoAppendQueued_=!0,!this.delayedAudioAppendQueue_.length)return;var s=this.delayedAudioAppendQueue_.slice();this.logger_("queuing delayed audio "+s.length+" appendBuffers"),this.delayedAudioAppendQueue_.length=0,s.forEach((function(e){i.appendBuffer.apply(i,e)}))}},r.audioBuffered=function(){return Kl(this.mediaSource,this.audioBuffer)&&this.audioBuffer.buffered?this.audioBuffer.buffered:ea.createTimeRange()},r.videoBuffered=function(){return Kl(this.mediaSource,this.videoBuffer)&&this.videoBuffer.buffered?this.videoBuffer.buffered:ea.createTimeRange()},r.buffered=function(){var e=Kl(this.mediaSource,this.videoBuffer)?this.videoBuffer:null,t=Kl(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;return t&&!e?this.audioBuffered():e&&!t?this.videoBuffered():function(e,t){var i=null,r=null,n=0,a=[],s=[];if(!(e&&e.length&&t&&t.length))return ea.createTimeRange();for(var o=e.length;o--;)a.push({time:e.start(o),type:"start"}),a.push({time:e.end(o),type:"end"});for(o=t.length;o--;)a.push({time:t.start(o),type:"start"}),a.push({time:t.end(o),type:"end"});for(a.sort((function(e,t){return e.time-t.time})),o=0;o<a.length;o++)"start"===a[o].type?2==++n&&(i=a[o].time):"end"===a[o].type&&1==--n&&(r=a[o].time),null!==i&&null!==r&&(s.push([i,r]),r=i=null);return ea.createTimeRanges(s)}(this.audioBuffered(),this.videoBuffered())},r.setDuration=function(e,t){void 0===t&&(t=jl),Wl({type:"mediaSource",sourceUpdater:this,action:oc(e),name:"duration",doneFn:t})},r.endOfStream=function(e,t){void 0===e&&(e=null),void 0===t&&(t=jl),"string"!=typeof e&&(e=void 0),Wl({type:"mediaSource",sourceUpdater:this,action:sc(e),name:"endOfStream",doneFn:t})},r.removeAudio=function(e,t,i){void 0===i&&(i=jl),this.audioBuffered().length&&0!==this.audioBuffered().end(0)?Wl({type:"audio",sourceUpdater:this,action:rc(e,t),doneFn:i,name:"remove"}):i()},r.removeVideo=function(e,t,i){void 0===i&&(i=jl),this.videoBuffered().length&&0!==this.videoBuffered().end(0)?Wl({type:"video",sourceUpdater:this,action:rc(e,t),doneFn:i,name:"remove"}):i()},r.updating=function(){return!(!Hl("audio",this)&&!Hl("video",this))},r.audioTimestampOffset=function(e){return void 0!==e&&this.audioBuffer&&this.audioTimestampOffset_!==e&&(Wl({type:"audio",sourceUpdater:this,action:nc(e),name:"timestampOffset"}),this.audioTimestampOffset_=e),this.audioTimestampOffset_},r.videoTimestampOffset=function(e){return void 0!==e&&this.videoBuffer&&this.videoTimestampOffset!==e&&(Wl({type:"video",sourceUpdater:this,action:nc(e),name:"timestampOffset"}),this.videoTimestampOffset_=e),this.videoTimestampOffset_},r.audioQueueCallback=function(e){this.audioBuffer&&Wl({type:"audio",sourceUpdater:this,action:ac(e),name:"callback"})},r.videoQueueCallback=function(e){this.videoBuffer&&Wl({type:"video",sourceUpdater:this,action:ac(e),name:"callback"})},r.dispose=function(){var e=this;this.trigger("dispose"),tc.forEach((function(t){e.abort(t),e.canRemoveSourceBuffer()?e.removeSourceBuffer(t):e[t+"QueueCallback"]((function(){return ql(t,e)}))})),this.videoAppendQueued_=!1,this.delayedAudioAppendQueue_.length=0,this.sourceopenListener_&&this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_),this.off()},i}(ea.EventTarget),hc=new Uint8Array("\n\n".split("").map((function(e){return e.charCodeAt(0)}))),fc=function(t){function i(e,i){var r;return void 0===i&&(i={}),(r=t.call(this,e,i)||this).handlePartialData_=!1,r.mediaSource_=null,r.subtitlesTrack_=null,r.loaderType_="subtitle",r.featuresNativeTextTracks_=e.featuresNativeTextTracks,r.shouldSaveSegmentTimingInfo_=!1,r}qe(i,t);var r=i.prototype;return r.createTransmuxer_=function(){return null},r.buffered_=function(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues.length)return ea.createTimeRanges();var e=this.subtitlesTrack_.cues;return ea.createTimeRanges([[e[0].startTime,e[e.length-1].startTime]])},r.initSegmentForMap=function(e,t){if(void 0===t&&(t=!1),!e)return null;var i=Eu(e),r=this.initSegments_[i];if(t&&!r&&e.bytes){var n=new Uint8Array(hc.byteLength+e.bytes.byteLength);n.set(e.bytes),n.set(hc,e.bytes.byteLength),this.initSegments_[i]=r={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:n}}return r||e},r.couldBeginLoading_=function(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()},r.init_=function(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()},r.track=function(e){return void 0===e||(this.subtitlesTrack_=e,"INIT"===this.state&&this.couldBeginLoading_()&&this.init_()),this.subtitlesTrack_},r.remove=function(e,t){Ol(e,t,this.subtitlesTrack_)},r.fillBuffer_=function(){var e=this;this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_()));var t=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);if(t=this.skipEmptySegments_(t)){if(null===this.syncController_.timestampOffsetForTimeline(t.timeline))return this.syncController_.one("timestampoffset",(function(){e.state="READY",e.paused()||e.monitorBuffer_()})),void(this.state="WAITING_ON_TIMELINE");this.loadSegment_(t)}},r.skipEmptySegments_=function(e){for(;e&&e.segment.empty;)e=this.generateSegmentInfo_(e.playlist,e.mediaIndex+1,e.startOfSegment+e.duration,e.isSyncRequest);return e},r.stopForError=function(e){this.error(e),this.state="READY",this.pause(),this.trigger("error")},r.segmentRequestFinished_=function(t,i,r){var n=this;if(this.subtitlesTrack_){if(this.saveTransferStats_(i.stats),!this.pendingSegment_)return this.state="READY",void(this.mediaRequestsAborted+=1);if(t)return t.code===fl&&this.handleTimeout_(),t.code===pl?this.mediaRequestsAborted+=1:this.mediaRequestsErrored+=1,void this.stopForError(t);this.saveBandwidthRelatedStats_(i.stats),this.state="APPENDING",this.trigger("appending");var a=this.pendingSegment_,s=a.segment;if(s.map&&(s.map.bytes=i.map.bytes),a.bytes=i.bytes,"function"!=typeof e.WebVTT&&this.subtitlesTrack_&&this.subtitlesTrack_.tech_){var o,u=function(){n.subtitlesTrack_.tech_.off("vttjsloaded",o),n.stopForError({message:"Error loading vtt.js"})};return o=function(){n.subtitlesTrack_.tech_.off("vttjserror",u),n.segmentRequestFinished_(t,i,r)},this.state="WAITING_ON_VTTJS",this.subtitlesTrack_.tech_.one("vttjsloaded",o),void this.subtitlesTrack_.tech_.one("vttjserror",u)}s.requested=!0;try{this.parseVTTCues_(a)}catch(t){return void this.stopForError({message:t.message})}if(this.updateTimeMapping_(a,this.syncController_.timelines[a.timeline],this.playlist_),a.timingInfo=a.cues.length?{start:a.cues[0].startTime,end:a.cues[a.cues.length-1].endTime}:{start:a.startOfSegment,end:a.startOfSegment+a.duration},a.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");a.byteLength=a.bytes.byteLength,this.mediaSecondsLoaded+=s.duration,a.cues.forEach((function(t){n.remove(t.startTime,t.endTime),n.subtitlesTrack_.addCue(n.featuresNativeTextTracks_?new e.VTTCue(t.startTime,t.endTime,t.text):t)})),this.handleAppendsDone_()}else this.state="READY"},r.handleData_=function(){},r.updateTimingInfoEnd_=function(){},r.parseVTTCues_=function(t){var i,r=!1;"function"==typeof e.TextDecoder?i=new e.TextDecoder("utf8"):(i=e.WebVTT.StringDecoder(),r=!0);var n=new e.WebVTT.Parser(e,e.vttjs,i);if(t.cues=[],t.timestampmap={MPEGTS:0,LOCAL:0},n.oncue=t.cues.push.bind(t.cues),n.ontimestampmap=function(e){t.timestampmap=e},n.onparsingerror=function(e){ea.log.warn("Error encountered when parsing cues: "+e.message)},t.segment.map){var a=t.segment.map.bytes;r&&(a=Yl(a)),n.parse(a)}var s=t.bytes;r&&(s=Yl(s)),n.parse(s),n.flush()},r.updateTimeMapping_=function(e,t,i){var r=e.segment;if(t)if(e.cues.length){var n=e.timestampmap,a=n.MPEGTS/Oo-n.LOCAL+t.mapping;e.cues.forEach((function(e){e.startTime+=a,e.endTime+=a})),i.syncInfo||(i.syncInfo={mediaSequence:i.mediaSequence+e.mediaIndex,time:Math.min(e.cues[0].startTime,e.cues[e.cues.length-1].startTime-r.duration)})}else r.empty=!0},i}(Bl),pc=[{name:"VOD",run:function(e,t,i,r,n){return i===1/0?null:{time:0,segmentIndex:0}}},{name:"ProgramDateTime",run:function(e,t,i,r,n){if(!e.datetimeToDisplayTime)return null;var a=t.segments||[],s=null,o=null;n=n||0;for(var u=0;u<a.length;u++){var l=a[u];if(l.dateTimeObject){var c=l.dateTimeObject.getTime()/1e3+e.datetimeToDisplayTime,d=Math.abs(n-c);if(null!==o&&(0===d||o<d))break;o=d,s={time:c,segmentIndex:u}}}return s}},{name:"Segment",run:function(e,t,i,r,n){var a=t.segments||[],s=null,o=null;n=n||0;for(var u=0;u<a.length;u++){var l=a[u];if(l.timeline===r&&void 0!==l.start){var c=Math.abs(n-l.start);if(null!==o&&o<c)break;(!s||null===o||c<=o)&&(o=c,s={time:l.start,segmentIndex:u})}}return s}},{name:"Discontinuity",run:function(e,t,i,r,n){var a=null;if(n=n||0,t.discontinuityStarts&&t.discontinuityStarts.length)for(var s=null,o=0;o<t.discontinuityStarts.length;o++){var u=t.discontinuityStarts[o],l=e.discontinuities[t.discontinuitySequence+o+1];if(l){var c=Math.abs(n-l.time);if(null!==s&&s<c)break;(!a||null===s||c<=s)&&(s=c,a={time:l.time,segmentIndex:u})}}return a}},{name:"Playlist",run:function(e,t,i,r,n){return t.syncInfo?{time:t.syncInfo.time,segmentIndex:t.syncInfo.mediaSequence-t.mediaSequence}:null}}],gc=function(e){function t(t){var i;return(i=e.call(this)||this).timelines=[],i.discontinuities=[],i.datetimeToDisplayTime=null,i.logger_=Al("SyncController"),i}qe(t,e);var i=t.prototype;return i.getSyncPoint=function(e,t,i,r){var n=this.runStrategies_(e,t,i,r);return n.length?this.selectSyncPoint_(n,{key:"time",value:r}):null},i.getExpiredTime=function(e,t){if(!e||!e.segments)return null;var i=this.runStrategies_(e,t,e.discontinuitySequence,0);if(!i.length)return null;var r=this.selectSyncPoint_(i,{key:"segmentIndex",value:0});return 0<r.segmentIndex&&(r.time*=-1),Math.abs(r.time+lu(e,r.segmentIndex,0))},i.runStrategies_=function(e,t,i,r){for(var n=[],a=0;a<pc.length;a++){var s=pc[a],o=s.run(this,e,t,i,r);o&&(o.strategy=s.name,n.push({strategy:s.name,syncPoint:o}))}return n},i.selectSyncPoint_=function(e,t){for(var i=e[0].syncPoint,r=Math.abs(e[0].syncPoint[t.key]-t.value),n=e[0].strategy,a=1;a<e.length;a++){var s=Math.abs(e[a].syncPoint[t.key]-t.value);s<r&&(r=s,i=e[a].syncPoint,n=e[a].strategy)}return this.logger_("syncPoint for ["+t.key+": "+t.value+"] chosen with strategy ["+n+"]: [time:"+i.time+", segmentIndex:"+i.segmentIndex+"]"),i},i.saveExpiredSegmentInfo=function(e,t){for(var i=t.mediaSequence-e.mediaSequence-1;0<=i;i--){var r=e.segments[i];if(r&&void 0!==r.start){t.syncInfo={mediaSequence:e.mediaSequence+i,time:r.start},this.logger_("playlist refresh sync: [time:"+t.syncInfo.time+", mediaSequence: "+t.syncInfo.mediaSequence+"]"),this.trigger("syncinfoupdate");break}}},i.setDateTimeMapping=function(e){if(!this.datetimeToDisplayTime&&e.segments&&e.segments.length&&e.segments[0].dateTimeObject){var t=e.segments[0].dateTimeObject.getTime()/1e3;this.datetimeToDisplayTime=-t}},i.saveSegmentTimingInfo=function(e){var t=e.segmentInfo;this.calculateSegmentTimeMapping_(t,t.timingInfo,e.shouldSaveTimelineMapping)&&(this.saveDiscontinuitySyncInfo_(t),t.playlist.syncInfo||(t.playlist.syncInfo={mediaSequence:t.playlist.mediaSequence+t.mediaIndex,time:t.segment.start}))},i.timestampOffsetForTimeline=function(e){return void 0===this.timelines[e]?null:this.timelines[e].time},i.mappingForTimeline=function(e){return void 0===this.timelines[e]?null:this.timelines[e].mapping},i.calculateSegmentTimeMapping_=function(e,t,i){var r=e.segment,n=this.timelines[e.timeline];if(null!==e.timestampOffset)n={time:e.startOfSegment,mapping:e.startOfSegment-t.start},i&&(this.timelines[e.timeline]=n,this.trigger("timestampoffset"),this.logger_("time mapping for timeline "+e.timeline+": [time: "+n.time+"] [mapping: "+n.mapping+"]")),r.start=e.startOfSegment,r.end=t.end+n.mapping;else{if(!n)return!1;r.start=t.start+n.mapping,r.end=t.end+n.mapping}return!0},i.saveDiscontinuitySyncInfo_=function(e){var t=e.playlist,i=e.segment;if(i.discontinuity)this.discontinuities[i.timeline]={time:i.start,accuracy:0};else if(t.discontinuityStarts&&t.discontinuityStarts.length)for(var r=0;r<t.discontinuityStarts.length;r++){var n,a=t.discontinuityStarts[r],s=t.discontinuitySequence+r+1,o=a-e.mediaIndex,u=Math.abs(o);(!this.discontinuities[s]||this.discontinuities[s].accuracy>u)&&(n=o<0?i.start-lu(t,e.mediaIndex,a):i.end+lu(t,e.mediaIndex+1,a),this.discontinuities[s]={time:n,accuracy:u})}},i.dispose=function(){this.trigger("dispose"),this.off()},t}(ea.EventTarget),mc=function(e){function t(){var t;return(t=e.call(this)||this).pendingTimelineChanges_={},t.lastTimelineChanges_={},t}qe(t,e);var i=t.prototype;return i.clearPendingTimelineChange=function(e){this.pendingTimelineChanges_[e]=null,this.trigger("pendingtimelinechange")},i.pendingTimelineChange=function(e){var t=e.type,i=e.from,r=e.to;return"number"==typeof i&&"number"==typeof r&&(this.pendingTimelineChanges_[t]={type:t,from:i,to:r},this.trigger("pendingtimelinechange")),this.pendingTimelineChanges_[t]},i.lastTimelineChange=function(e){var t=e.type,i=e.from,r=e.to;return"number"==typeof i&&"number"==typeof r&&(this.lastTimelineChanges_[t]={type:t,from:i,to:r},delete this.pendingTimelineChanges_[t],this.trigger("timelinechange")),this.lastTimelineChanges_[t]},i.dispose=function(){this.trigger("dispose"),this.pendingTimelineChanges_={},this.lastTimelineChanges_={},this.off()},t}(ea.EventTarget),vc=new bl("./decrypter-worker.worker.js",(function(e,t){var i,r,n,a,s,o,u;function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}i=function(e,t,i){return t&&l(e.prototype,t),i&&l(e,i),e},r=function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t},n=function(){function e(){this.listeners={}}var t=e.prototype;return t.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},t.off=function(e,t){if(!this.listeners[e])return!1;var i=this.listeners[e].indexOf(t);return this.listeners[e]=this.listeners[e].slice(0),this.listeners[e].splice(i,1),-1<i},t.trigger=function(e,t){var i=this.listeners[e];if(i)if(2===arguments.length)for(var r=i.length,n=0;n<r;++n)i[n].call(this,t);else for(var a=Array.prototype.slice.call(arguments,1),s=i.length,o=0;o<s;++o)i[o].apply(this,a)},t.dispose=function(){this.listeners={}},t.pipe=function(e){this.on("data",(function(t){e.push(t)}))},e}(),a=null,s=function(){function e(e){var t,i,r;a=a||function(){var e,t,i,r,n,a,s,o,u=[[[],[],[],[],[]],[[],[],[],[],[]]],l=u[0],c=u[1],d=l[4],h=c[4],f=[],p=[];for(e=0;e<256;e++)p[(f[e]=e<<1^283*(e>>7))^e]=e;for(t=i=0;!d[t];t^=r||1,i=p[i]||1)for(a=(a=i^i<<1^i<<2^i<<3^i<<4)>>8^255&a^99,o=16843009*f[n=f[r=f[h[d[t]=a]=t]]]^65537*n^257*r^16843008*t,s=257*f[a]^16843008*a,e=0;e<4;e++)l[e][t]=s=s<<24^s>>>8,c[e][a]=o=o<<24^o>>>8;for(e=0;e<5;e++)l[e]=l[e].slice(0),c[e]=c[e].slice(0);return u}(),this._tables=[[a[0][0].slice(),a[0][1].slice(),a[0][2].slice(),a[0][3].slice(),a[0][4].slice()],[a[1][0].slice(),a[1][1].slice(),a[1][2].slice(),a[1][3].slice(),a[1][4].slice()]];var n=this._tables[0][4],s=this._tables[1],o=e.length,u=1;if(4!==o&&6!==o&&8!==o)throw new Error("Invalid aes key size");var l=e.slice(0),c=[];for(this._key=[l,c],t=o;t<4*o+28;t++)r=l[t-1],(t%o==0||8===o&&t%o==4)&&(r=n[r>>>24]<<24^n[r>>16&255]<<16^n[r>>8&255]<<8^n[255&r],t%o==0&&(r=r<<8^r>>>24^u<<24,u=u<<1^283*(u>>7))),l[t]=l[t-o]^r;for(i=0;t;i++,t--)r=l[3&i?t:t-4],c[i]=t<=4||i<4?r:s[0][n[r>>>24]]^s[1][n[r>>16&255]]^s[2][n[r>>8&255]]^s[3][n[255&r]]}return e.prototype.decrypt=function(e,t,i,r,n,a){var s,o,u,l,c=this._key[1],d=e^c[0],h=r^c[1],f=i^c[2],p=t^c[3],g=c.length/4-2,m=4,v=this._tables[1],y=v[0],_=v[1],b=v[2],T=v[3],S=v[4];for(l=0;l<g;l++)s=y[d>>>24]^_[h>>16&255]^b[f>>8&255]^T[255&p]^c[m],o=y[h>>>24]^_[f>>16&255]^b[p>>8&255]^T[255&d]^c[m+1],u=y[f>>>24]^_[p>>16&255]^b[d>>8&255]^T[255&h]^c[m+2],p=y[p>>>24]^_[d>>16&255]^b[h>>8&255]^T[255&f]^c[m+3],m+=4,d=s,h=o,f=u;for(l=0;l<4;l++)n[(3&-l)+a]=S[d>>>24]<<24^S[h>>16&255]<<16^S[f>>8&255]<<8^S[255&p]^c[m++],s=d,d=h,h=f,f=p,p=s},e}(),o=function(e){function t(){var t;return(t=e.call(this,n)||this).jobs=[],t.delay=1,t.timeout_=null,t}r(t,e);var i=t.prototype;return i.processJob_=function(){this.jobs.shift()(),this.timeout_=this.jobs.length?setTimeout(this.processJob_.bind(this),this.delay):null},i.push=function(e){this.jobs.push(e),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},t}(n),u=function(){function e(t,i,r,n){var a=e.STEP,s=new Int32Array(t.buffer),u=new Uint8Array(t.byteLength),l=0;for(this.asyncStream_=new o,this.asyncStream_.push(this.decryptChunk_(s.subarray(l,l+a),i,r,u)),l=a;l<s.length;l+=a)r=new Uint32Array([c(s[l-4]),c(s[l-3]),c(s[l-2]),c(s[l-1])]),this.asyncStream_.push(this.decryptChunk_(s.subarray(l,l+a),i,r,u));this.asyncStream_.push((function(){n(null,function(e){return e.subarray(0,e.byteLength-e[e.byteLength-1])}(u))}))}return e.prototype.decryptChunk_=function(e,t,i,r){return function(){var n=function(e,t,i){var r,n,a,o,u,l,d,h,f,p=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),g=new s(Array.prototype.slice.call(t)),m=new Uint8Array(e.byteLength),v=new Int32Array(m.buffer);for(r=i[0],n=i[1],a=i[2],o=i[3],f=0;f<p.length;f+=4)u=c(p[f]),l=c(p[f+1]),d=c(p[f+2]),h=c(p[f+3]),g.decrypt(u,l,d,h,v,f),v[f]=c(v[f]^r),v[f+1]=c(v[f+1]^n),v[f+2]=c(v[f+2]^a),v[f+3]=c(v[f+3]^o),r=u,n=l,a=d,o=h;return m}(e,t,i);r.set(n,e.byteOffset)}},i(e,null,[{key:"STEP",get:function(){return 32e3}}]),e}(),new function(e){e.onmessage=function(t){var i=t.data,r=new Uint8Array(i.encrypted.bytes,i.encrypted.byteOffset,i.encrypted.byteLength),n=new Uint32Array(i.key.bytes,i.key.byteOffset,i.key.byteLength/4),a=new Uint32Array(i.iv.bytes,i.iv.byteOffset,i.iv.byteLength/4);new u(r,n,a,(function(t,r){e.postMessage(function(e){var t={};return Object.keys(e).forEach((function(i){var r=e[i];t[i]=ArrayBuffer.isView(r)?{bytes:r.buffer,byteOffset:r.byteOffset,byteLength:r.byteLength}:r})),t}({source:i.source,decrypted:r}),[r.buffer])}))}}(this)})),yc={AUDIO:function(e,t){return function(){var i=t.mediaTypes[e],r=t.blacklistCurrentPlaylist;Ql(t.segmentLoaders[e],i);var n=i.activeTrack(),a=i.activeGroup(),s=(a.filter((function(e){return e.default}))[0]||a[0]).id,o=i.tracks[s];if(n!==o){for(var u in ea.log.warn("Problem encountered loading the alternate audio track.Switching back to default."),i.tracks)i.tracks[u].enabled=i.tracks[u]===o;i.onTrackChanged()}else r({message:"Problem encountered loading the default audio track."})}},SUBTITLES:function(e,t){return function(){var i=t.segmentLoaders[e],r=t.mediaTypes[e];ea.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."),Ql(i,r);var n=r.activeTrack();n&&(n.mode="disabled"),r.onTrackChanged()}}},_c={AUDIO:function(e,t,i){if(t){var r=i.tech,n=i.requestOptions,a=i.segmentLoaders[e];t.on("loadedmetadata",(function(){var e=t.media();a.playlist(e,n),(!r.paused()||e.endList&&"none"!==r.preload())&&a.load()})),t.on("loadedplaylist",(function(){a.playlist(t.media(),n),r.paused()||a.load()})),t.on("error",yc[e](e,i))}},SUBTITLES:function(e,t,i){var r=i.tech,n=i.requestOptions,a=i.segmentLoaders[e],s=i.mediaTypes[e];t.on("loadedmetadata",(function(){var e=t.media();a.playlist(e,n),a.track(s.activeTrack()),(!r.paused()||e.endList&&"none"!==r.preload())&&a.load()})),t.on("loadedplaylist",(function(){a.playlist(t.media(),n),r.paused()||a.load()})),t.on("error",yc[e](e,i))}},bc={AUDIO:function(e,t){var i=t.vhs,r=t.sourceType,n=t.segmentLoaders[e],a=t.requestOptions,s=t.master,o=s.mediaGroups,u=s.playlists,l=t.mediaTypes[e],c=l.groups,d=l.tracks,h=t.masterPlaylistLoader;function f(n){function s(s){var u,f=o[e][n][s];if(l.filter((function(e){return e.resolvedUri===f.resolvedUri})).length&&delete f.resolvedUri,u="vhs-json"===r&&f.playlists?new Zu(f.playlists[0],i,a):f.resolvedUri?new Zu(f.resolvedUri,i,a):f.playlists&&"dash"===r?new ol(f.playlists[0],i,a,h):null,f=ea.mergeOptions({id:s,playlistLoader:u},f),_c[e](e,f.playlistLoader,t),c[n].push(f),void 0===d[s]){var p=new ea.AudioTrack({id:s,kind:function(e){var t=e.default?"main":"alternative";return e.characteristics&&0<=e.characteristics.indexOf("public.accessibility.describes-video")&&(t="main-desc"),t}(f),enabled:!1,language:f.language,default:f.default,label:s});d[s]=p}}c[n]||(c[n]=[]);var l=u.filter((function(t){return t.attributes[e]===n}));for(var f in o[e][n])s(f)}for(var p in o[e]&&0!==Object.keys(o[e]).length||(o[e]={main:{default:{default:!0}}}),o[e])f(p);n.on("error",yc[e](e,t))},SUBTITLES:function(e,t){var i=t.tech,r=t.vhs,n=t.sourceType,a=t.segmentLoaders[e],s=t.requestOptions,o=t.master.mediaGroups,u=t.mediaTypes[e],l=u.groups,c=u.tracks,d=t.masterPlaylistLoader;for(var h in o[e])for(var f in l[h]||(l[h]=[]),o[e][h])if(!o[e][h][f].forced){var p=o[e][h][f],g=void 0;if("hls"===n?g=new Zu(p.resolvedUri,r,s):"dash"===n?g=new ol(p.playlists[0],r,s,d):"vhs-json"===n&&(g=new Zu(p.playlists?p.playlists[0]:p.resolvedUri,r,s)),p=ea.mergeOptions({id:f,playlistLoader:g},p),_c[e](e,p.playlistLoader,t),l[h].push(p),void 0===c[f]){var m=i.addRemoteTextTrack({id:f,kind:"subtitles",default:p.default&&p.autoselect,language:p.language,label:f},!1).track;c[f]=m}}a.on("error",yc[e](e,t))},"CLOSED-CAPTIONS":function(e,t){var i=t.tech,r=t.master.mediaGroups,n=t.mediaTypes[e],a=n.groups,s=n.tracks;for(var o in r[e])for(var u in a[o]||(a[o]=[]),r[e][o]){var l=r[e][o][u];if(l.instreamId.match(/CC\d/)&&(a[o].push(ea.mergeOptions({id:u},l)),void 0===s[u])){var c=i.addRemoteTextTrack({id:l.instreamId,kind:"captions",default:l.default&&l.autoselect,language:l.language,label:u},!1).track;s[u]=c}}}},Tc={AUDIO:function(e,t){return function(){var i=t.mediaTypes[e].tracks;for(var r in i)if(i[r].enabled)return i[r];return null}},SUBTITLES:function(e,t){return function(){var i=t.mediaTypes[e].tracks;for(var r in i)if("showing"===i[r].mode||"hidden"===i[r].mode)return i[r];return null}}},Sc=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred"],Ec=function(t){function i(i){var r;r=t.call(this)||this;var n=i.src,a=i.handleManifestRedirects,s=i.withCredentials,o=i.tech,u=i.bandwidth,l=i.externVhs,c=i.useCueTags,d=i.blacklistDuration,h=i.enableLowInitialPlaylist,f=i.sourceType,p=i.cacheEncryptionKeys,g=i.handlePartialData;if(!n)throw new Error("A non-empty playlist URL or JSON manifest string is required");ec=l,r.withCredentials=s,r.tech_=o,r.vhs_=o.vhs,r.sourceType_=f,r.useCueTags_=c,r.blacklistDuration=d,r.enableLowInitialPlaylist=h,r.useCueTags_&&(r.cueTagsTrack_=r.tech_.addTextTrack("metadata","ad-cues"),r.cueTagsTrack_.inBandMetadataTrackDispatchType=""),r.requestOptions_={withCredentials:s,handleManifestRedirects:a,timeout:null},r.on("error",r.pauseLoading),r.mediaTypes_=function(){var e={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((function(t){e[t]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:jl,activeTrack:jl,onGroupChanged:jl,onTrackChanged:jl}})),e}(),r.mediaSource=new e.MediaSource,r.handleDurationChange_=r.handleDurationChange_.bind(Be(r)),r.handleSourceOpen_=r.handleSourceOpen_.bind(Be(r)),r.handleSourceEnded_=r.handleSourceEnded_.bind(Be(r)),r.mediaSource.addEventListener("durationchange",r.handleDurationChange_),r.mediaSource.addEventListener("sourceopen",r.handleSourceOpen_),r.mediaSource.addEventListener("sourceended",r.handleSourceEnded_),r.seekable_=ea.createTimeRanges(),r.hasPlayed_=!1,r.syncController_=new gc(i),r.segmentMetadataTrack_=o.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,r.decrypter_=new vc,r.sourceUpdater_=new dc(r.mediaSource),r.inbandTextTracks_={},r.timelineChangeController_=new mc;var m={vhs:r.vhs_,mediaSource:r.mediaSource,currentTime:r.tech_.currentTime.bind(r.tech_),seekable:function(){return r.seekable()},seeking:function(){return r.tech_.seeking()},duration:function(){return r.duration()},hasPlayed:function(){return r.hasPlayed_},goalBufferLength:function(){return r.goalBufferLength()},bandwidth:u,syncController:r.syncController_,decrypter:r.decrypter_,sourceType:r.sourceType_,inbandTextTracks:r.inbandTextTracks_,cacheEncryptionKeys:p,handlePartialData:g,sourceUpdater:r.sourceUpdater_,timelineChangeController:r.timelineChangeController_};return r.masterPlaylistLoader_="dash"===r.sourceType_?new ol(n,r.vhs_,r.requestOptions_):new Zu(n,r.vhs_,r.requestOptions_),r.setupMasterPlaylistLoaderListeners_(),r.mainSegmentLoader_=new Bl(ea.mergeOptions(m,{segmentMetadataTrack:r.segmentMetadataTrack_,loaderType:"main"}),i),r.audioSegmentLoader_=new Bl(ea.mergeOptions(m,{loaderType:"audio"}),i),r.subtitleSegmentLoader_=new fc(ea.mergeOptions(m,{loaderType:"vtt",featuresNativeTextTracks:r.tech_.featuresNativeTextTracks}),i),r.setupSegmentLoaderListeners_(),Sc.forEach((function(e){r[e+"_"]=(function(e){return this.audioSegmentLoader_[e]+this.mainSegmentLoader_[e]}).bind(Be(r),e)})),r.logger_=Al("MPC"),r.triggeredFmp4Usage=!1,r.masterPlaylistLoader_.load(),r}qe(i,t);var r=i.prototype;return r.setupMasterPlaylistLoaderListeners_=function(){var e=this;this.masterPlaylistLoader_.on("loadedmetadata",(function(){var t=e.masterPlaylistLoader_.media(),i=1.5*t.targetDuration*1e3;e.requestOptions_.timeout=mu(e.masterPlaylistLoader_.master,e.masterPlaylistLoader_.media())?0:i,t.endList&&"none"!==e.tech_.preload()&&(e.mainSegmentLoader_.playlist(t,e.requestOptions_),e.mainSegmentLoader_.load()),function(e){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((function(t){bc[t](t,e)}));var t=e.mediaTypes,i=e.masterPlaylistLoader,r=e.tech,n=e.vhs;["AUDIO","SUBTITLES"].forEach((function(i){t[i].activeGroup=function(e,t){return function(i){var r=t.mediaTypes[e].groups,n=t.masterPlaylistLoader.media();if(!n)return null;var a=null;return n.attributes[e]&&(a=r[n.attributes[e]]),a=a||r.main,void 0===i?a:null===i?null:a.filter((function(e){return e.id===i.id}))[0]||null}}(i,e),t[i].activeTrack=Tc[i](i,e),t[i].onGroupChanged=function(e,t){return function(){var i=t.segmentLoaders,r=i[e],n=i.main,a=t.mediaTypes[e],s=a.activeTrack(),o=a.activeGroup(s),u=a.activePlaylistLoader;Ql(r,a),o&&(o.playlistLoader?(r.resyncLoader(),$l(o.playlistLoader,a)):u&&n.resetEverything())}}(i,e),t[i].onGroupChanging=function(e,t){return function(){var i=t.segmentLoaders[e];i.abort(),i.pause()}}(i,e),t[i].onTrackChanged=function(e,t){return function(){var i=t.segmentLoaders,r=i[e],n=i.main,a=t.mediaTypes[e],s=a.activeTrack(),o=a.activeGroup(s),u=a.activePlaylistLoader;if(Ql(r,a),o){if("AUDIO"===e){if(!o.playlistLoader)return n.setAudio(!0),void n.resetEverything();r.setAudio(!0),n.setAudio(!1)}u!==o.playlistLoader&&(r.track&&r.track(s),r.resetEverything()),$l(o.playlistLoader,a)}}}(i,e)}));var a=t.AUDIO.activeGroup();if(a){var s=(a.filter((function(e){return e.default}))[0]||a[0]).id;t.AUDIO.tracks[s].enabled=!0,t.AUDIO.onTrackChanged()}function o(){t.AUDIO.onTrackChanged(),r.trigger({type:"usage",name:"vhs-audio-change"}),r.trigger({type:"usage",name:"hls-audio-change"})}for(var u in i.on("mediachange",(function(){["AUDIO","SUBTITLES"].forEach((function(e){return t[e].onGroupChanged()}))})),i.on("mediachanging",(function(){["AUDIO","SUBTITLES"].forEach((function(e){return t[e].onGroupChanging()}))})),r.audioTracks().addEventListener("change",o),r.remoteTextTracks().addEventListener("change",t.SUBTITLES.onTrackChanged),n.on("dispose",(function(){r.audioTracks().removeEventListener("change",o),r.remoteTextTracks().removeEventListener("change",t.SUBTITLES.onTrackChanged)})),r.clearTracks("audio"),t.AUDIO.tracks)r.audioTracks().addTrack(t.AUDIO.tracks[u])}({sourceType:e.sourceType_,segmentLoaders:{AUDIO:e.audioSegmentLoader_,SUBTITLES:e.subtitleSegmentLoader_,main:e.mainSegmentLoader_},tech:e.tech_,requestOptions:e.requestOptions_,masterPlaylistLoader:e.masterPlaylistLoader_,vhs:e.vhs_,master:e.master(),mediaTypes:e.mediaTypes_,blacklistCurrentPlaylist:e.blacklistCurrentPlaylist.bind(e)}),e.triggerPresenceUsage_(e.master(),t),e.setupFirstPlay(),!e.mediaTypes_.AUDIO.activePlaylistLoader||e.mediaTypes_.AUDIO.activePlaylistLoader.media()?e.trigger("selectedinitialmedia"):e.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",(function(){e.trigger("selectedinitialmedia")}))})),this.masterPlaylistLoader_.on("loadedplaylist",(function(){var t=e.masterPlaylistLoader_.media();if(!t){var i;if(e.excludeUnsupportedVariants_(),e.enableLowInitialPlaylist&&(i=e.selectInitialPlaylist()),i=i||e.selectPlaylist(),e.initialMedia_=i,e.masterPlaylistLoader_.media(e.initialMedia_),"vhs-json"!==e.sourceType_||!e.initialMedia_.segments)return;t=e.initialMedia_}e.handleUpdatedMediaPlaylist(t)})),this.masterPlaylistLoader_.on("error",(function(){e.blacklistCurrentPlaylist(e.masterPlaylistLoader_.error)})),this.masterPlaylistLoader_.on("mediachanging",(function(){e.mainSegmentLoader_.abort(),e.mainSegmentLoader_.pause()})),this.masterPlaylistLoader_.on("mediachange",(function(){var t=e.masterPlaylistLoader_.media(),i=1.5*t.targetDuration*1e3;e.requestOptions_.timeout=mu(e.masterPlaylistLoader_.master,e.masterPlaylistLoader_.media())?0:i,e.mainSegmentLoader_.playlist(t,e.requestOptions_),e.mainSegmentLoader_.load(),e.tech_.trigger({type:"mediachange",bubbles:!0})})),this.masterPlaylistLoader_.on("playlistunchanged",(function(){var t=e.masterPlaylistLoader_.media();e.stuckAtPlaylistEnd_(t)&&(e.blacklistCurrentPlaylist({message:"Playlist no longer updating."}),e.tech_.trigger("playliststuck"))})),this.masterPlaylistLoader_.on("renditiondisabled",(function(){e.tech_.trigger({type:"usage",name:"vhs-rendition-disabled"}),e.tech_.trigger({type:"usage",name:"hls-rendition-disabled"})})),this.masterPlaylistLoader_.on("renditionenabled",(function(){e.tech_.trigger({type:"usage",name:"vhs-rendition-enabled"}),e.tech_.trigger({type:"usage",name:"hls-rendition-enabled"})}))},r.handleUpdatedMediaPlaylist=function(e){this.useCueTags_&&this.updateAdCues_(e),this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.updateDuration(!e.endList),this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioSegmentLoader_&&this.audioSegmentLoader_.load())},r.triggerPresenceUsage_=function(e,t){var i=e.mediaGroups||{},r=!0,n=Object.keys(i.AUDIO);for(var a in i.AUDIO)for(var s in i.AUDIO[a])i.AUDIO[a][s].uri||(r=!1);r&&(this.tech_.trigger({type:"usage",name:"vhs-demuxed"}),this.tech_.trigger({type:"usage",name:"hls-demuxed"})),Object.keys(i.SUBTITLES).length&&(this.tech_.trigger({type:"usage",name:"vhs-webvtt"}),this.tech_.trigger({type:"usage",name:"hls-webvtt"})),ec.Playlist.isAes(t)&&(this.tech_.trigger({type:"usage",name:"vhs-aes"}),this.tech_.trigger({type:"usage",name:"hls-aes"})),n.length&&1<Object.keys(i.AUDIO[n[0]]).length&&(this.tech_.trigger({type:"usage",name:"vhs-alternate-audio"}),this.tech_.trigger({type:"usage",name:"hls-alternate-audio"})),this.useCueTags_&&(this.tech_.trigger({type:"usage",name:"vhs-playlist-cue-tags"}),this.tech_.trigger({type:"usage",name:"hls-playlist-cue-tags"}))},r.setupSegmentLoaderListeners_=function(){var e=this;function t(){if(!e.sourceUpdater_.ready())return e.tryToCreateSourceBuffers_();var t=e.getCodecsOrExclude_();t&&e.sourceUpdater_.addOrChangeSourceBuffers(t)}this.mainSegmentLoader_.on("bandwidthupdate",(function(){var t=e.selectPlaylist(),i=e.masterPlaylistLoader_.media(),r=e.tech_.buffered();!function(e){var t=e.currentPlaylist,i=e.nextPlaylist;return i?!t.endList||e.duration<ul.MAX_BUFFER_LOW_WATER_LINE||i.attributes.BANDWIDTH<t.attributes.BANDWIDTH||e.bufferLowWaterLine<=e.forwardBuffer:(ea.log.warn("We received no playlist to switch to. Please check your stream."),!1)}({currentPlaylist:i,nextPlaylist:t,forwardBuffer:r.length?r.end(r.length-1)-e.tech_.currentTime():0,bufferLowWaterLine:e.bufferLowWaterLine(),duration:e.duration(),log:e.logger_})||e.masterPlaylistLoader_.media(t),e.tech_.trigger("bandwidthupdate")})),this.mainSegmentLoader_.on("progress",(function(){e.trigger("progress")})),this.mainSegmentLoader_.on("error",(function(){e.blacklistCurrentPlaylist(e.mainSegmentLoader_.error())})),this.mainSegmentLoader_.on("appenderror",(function(){e.error=e.mainSegmentLoader_.error_,e.trigger("error")})),this.mainSegmentLoader_.on("syncinfoupdate",(function(){e.onSyncInfoUpdate_()})),this.mainSegmentLoader_.on("timestampoffset",(function(){e.tech_.trigger({type:"usage",name:"vhs-timestamp-offset"}),e.tech_.trigger({type:"usage",name:"hls-timestamp-offset"})})),this.audioSegmentLoader_.on("syncinfoupdate",(function(){e.onSyncInfoUpdate_()})),this.audioSegmentLoader_.on("appenderror",(function(){e.error=e.audioSegmentLoader_.error_,e.trigger("error")})),this.mainSegmentLoader_.on("ended",(function(){e.logger_("main segment loader ended"),e.onEndOfStream()})),this.mainSegmentLoader_.on("earlyabort",(function(){e.blacklistCurrentPlaylist({message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},120)})),this.mainSegmentLoader_.on("trackinfo",t),this.audioSegmentLoader_.on("trackinfo",t),this.mainSegmentLoader_.on("fmp4",(function(){e.triggeredFmp4Usage||(e.tech_.trigger({type:"usage",name:"vhs-fmp4"}),e.tech_.trigger({type:"usage",name:"hls-fmp4"}),e.triggeredFmp4Usage=!0)})),this.audioSegmentLoader_.on("fmp4",(function(){e.triggeredFmp4Usage||(e.tech_.trigger({type:"usage",name:"vhs-fmp4"}),e.tech_.trigger({type:"usage",name:"hls-fmp4"}),e.triggeredFmp4Usage=!0)})),this.audioSegmentLoader_.on("ended",(function(){e.logger_("audioSegmentLoader ended"),e.onEndOfStream()}))},r.mediaSecondsLoaded_=function(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)},r.load=function(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()},r.smoothQualityChange_=function(e){void 0===e&&(e=this.selectPlaylist()),e!==this.masterPlaylistLoader_.media()&&(this.masterPlaylistLoader_.media(e),this.mainSegmentLoader_.resetLoader())},r.fastQualityChange_=function(e){var t=this;void 0===e&&(e=this.selectPlaylist()),e!==this.masterPlaylistLoader_.media()&&(this.masterPlaylistLoader_.media(e),this.mainSegmentLoader_.resetEverything((function(){t.tech_.setCurrentTime(ea.browser.IE_VERSION||ea.browser.IS_EDGE?t.tech_.currentTime()+.04:t.tech_.currentTime())})))},r.play=function(){if(!this.setupFirstPlay()){this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load();var e=this.tech_.seekable();return this.tech_.duration()===1/0&&this.tech_.currentTime()<e.start(0)?this.tech_.setCurrentTime(e.end(e.length-1)):void 0}},r.setupFirstPlay=function(){var e=this,t=this.masterPlaylistLoader_.media();if(!t||this.tech_.paused()||this.hasPlayed_)return!1;if(!t.endList){var i=this.seekable();if(!i.length)return!1;if(ea.browser.IE_VERSION&&0===this.tech_.readyState())return this.tech_.one("loadedmetadata",(function(){e.trigger("firstplay"),e.tech_.setCurrentTime(i.end(0)),e.hasPlayed_=!0})),!1;this.trigger("firstplay"),this.tech_.setCurrentTime(i.end(0))}return this.hasPlayed_=!0,this.load(),!0},r.handleSourceOpen_=function(){if(this.tryToCreateSourceBuffers_(),this.tech_.autoplay()){var e=this.tech_.play();void 0!==e&&"function"==typeof e.then&&e.then(null,(function(e){}))}this.trigger("sourceopen")},r.handleSourceEnded_=function(){if(this.inbandTextTracks_.metadataTrack_){var e=this.inbandTextTracks_.metadataTrack_.cues;if(e&&e.length){var t=this.duration();e[e.length-1].endTime=isNaN(t)||Math.abs(t)===1/0?Number.MAX_VALUE:t}}},r.handleDurationChange_=function(){this.tech_.trigger("durationchange")},r.onEndOfStream=function(){var e=this.mainSegmentLoader_.ended_;this.mediaTypes_.AUDIO.activePlaylistLoader&&(e=!this.mainSegmentLoader_.currentMediaInfo_||this.mainSegmentLoader_.currentMediaInfo_.hasVideo?e&&this.audioSegmentLoader_.ended_:this.audioSegmentLoader_.ended_),e&&this.sourceUpdater_.endOfStream()},r.stuckAtPlaylistEnd_=function(e){if(!this.seekable().length)return!1;var t=this.syncController_.getExpiredTime(e,this.duration());if(null===t)return!1;var i=ec.Playlist.playlistEnd(e,t),r=this.tech_.currentTime(),n=this.tech_.buffered();if(!n.length)return i-r<=.1;var a=n.end(n.length-1);return a-r<=.1&&i-a<=.1},r.blacklistCurrentPlaylist=function(e,t){void 0===e&&(e={});var i=e.playlist||this.masterPlaylistLoader_.media();if(t=t||e.blacklistDuration||this.blacklistDuration,!i)return this.error=e,void("open"!==this.mediaSource.readyState?this.trigger("error"):this.sourceUpdater_.endOfStream("network"));var r=this.masterPlaylistLoader_.master.playlists,n=r.filter(pu),a=1===n.length&&n[0]===i;if(1===r.length&&t!==1/0)return ea.log.warn("Problem encountered with playlist "+i.id+". Trying again since it is the only playlist."),this.tech_.trigger("retryplaylist"),this.masterPlaylistLoader_.load(a);if(a){var s=!1;r.forEach((function(e){if(e!==i){var t=e.excludeUntil;void 0!==t&&t!==1/0&&(s=!0,delete e.excludeUntil)}})),s&&(ea.log.warn("Removing other playlists from the exclusion list because the last rendition is about to be excluded."),this.tech_.trigger("retryplaylist"))}i.excludeUntil=Date.now()+1e3*t,this.tech_.trigger("blacklistplaylist"),this.tech_.trigger({type:"usage",name:"vhs-rendition-blacklisted"}),this.tech_.trigger({type:"usage",name:"hls-rendition-blacklisted"});var o=this.selectPlaylist();return o?((e.internal?this.logger_:ea.log.warn)((e.internal?"Internal problem":"Problem")+" encountered with playlist "+i.id+"."+(e.message?" "+e.message:"")+" Switching to playlist "+o.id+"."),o.attributes.AUDIO!==i.attributes.AUDIO&&this.delegateLoaders_("audio",["abort","pause"]),o.attributes.SUBTITLES!==i.attributes.SUBTITLES&&this.delegateLoaders_("subtitle",["abort","pause"]),this.delegateLoaders_("main",["abort","pause"]),this.masterPlaylistLoader_.media(o,a)):(this.error="Playback cannot continue. No available working or supported playlists.",void this.trigger("error"))},r.pauseLoading=function(){this.delegateLoaders_("all",["abort","pause"])},r.delegateLoaders_=function(e,t){var i=this,r=[],n="all"===e;!n&&"main"!==e||r.push(this.masterPlaylistLoader_);var a=[];!n&&"audio"!==e||a.push("AUDIO"),!n&&"subtitle"!==e||(a.push("CLOSED-CAPTIONS"),a.push("SUBTITLES")),a.forEach((function(e){var t=i.mediaTypes_[e]&&i.mediaTypes_[e].activePlaylistLoader;t&&r.push(t)})),["main","audio","subtitle"].forEach((function(t){var n=i[t+"SegmentLoader_"];!n||e!==t&&"all"!==e||r.push(n)})),r.forEach((function(e){return t.forEach((function(t){"function"==typeof e[t]&&e[t]()}))}))},r.setCurrentTime=function(e){var t=ru(this.tech_.buffered(),e);return this.masterPlaylistLoader_&&this.masterPlaylistLoader_.media()&&this.masterPlaylistLoader_.media().segments?t&&t.length?e:(this.mainSegmentLoader_.resetEverything(),this.mainSegmentLoader_.abort(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.resetEverything(),this.audioSegmentLoader_.abort()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.resetEverything(),this.subtitleSegmentLoader_.abort()),void this.load()):0},r.duration=function(){if(!this.masterPlaylistLoader_)return 0;var e=this.masterPlaylistLoader_.media();return e?e.endList?this.mediaSource?this.mediaSource.duration:ec.Playlist.duration(e):1/0:0},r.seekable=function(){return this.seekable_},r.onSyncInfoUpdate_=function(){var e;if(this.masterPlaylistLoader_){var t=this.masterPlaylistLoader_.media();if(t){var i=this.syncController_.getExpiredTime(t,this.duration());if(null!==i){var r=this.masterPlaylistLoader_.master.suggestedPresentationDelay,n=ec.Playlist.seekable(t,i,r);if(0!==n.length){if(this.mediaTypes_.AUDIO.activePlaylistLoader){if(t=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),null===(i=this.syncController_.getExpiredTime(t,this.duration())))return;if(0===(e=ec.Playlist.seekable(t,i,r)).length)return}var a,s;this.seekable_&&this.seekable_.length&&(a=this.seekable_.end(0),s=this.seekable_.start(0)),this.seekable_=e?e.start(0)>n.end(0)||n.start(0)>e.end(0)?n:ea.createTimeRanges([[e.start(0)>n.start(0)?e.start(0):n.start(0),e.end(0)<n.end(0)?e.end(0):n.end(0)]]):n,this.seekable_&&this.seekable_.length&&this.seekable_.end(0)===a&&this.seekable_.start(0)===s||(this.logger_("seekable updated ["+au(this.seekable_)+"]"),this.tech_.trigger("seekablechanged"))}}}}},r.updateDuration=function(e){if(this.updateDuration_&&(this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.updateDuration_=null),"open"!==this.mediaSource.readyState)return this.updateDuration_=this.updateDuration.bind(this,e),void this.mediaSource.addEventListener("sourceopen",this.updateDuration_);if(e){var t=this.seekable();if(!t.length)return;(isNaN(this.mediaSource.duration)||this.mediaSource.duration<t.end(t.length-1))&&this.sourceUpdater_.setDuration(t.end(t.length-1))}else{var i=this.tech_.buffered(),r=ec.Playlist.duration(this.masterPlaylistLoader_.media());0<i.length&&(r=Math.max(r,i.end(i.length-1))),this.mediaSource.duration!==r&&this.sourceUpdater_.setDuration(r)}},r.dispose=function(){var e=this;this.trigger("dispose"),this.decrypter_.terminate(),this.masterPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),["AUDIO","SUBTITLES"].forEach((function(t){var i=e.mediaTypes_[t].groups;for(var r in i)i[r].forEach((function(e){e.playlistLoader&&e.playlistLoader.dispose()}))})),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.sourceUpdater_.dispose(),this.timelineChangeController_.dispose(),this.updateDuration_&&this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_),this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_),this.off()},r.master=function(){return this.masterPlaylistLoader_.master},r.media=function(){return this.masterPlaylistLoader_.media()||this.initialMedia_},r.areMediaTypesKnown_=function(){return!(!this.mainSegmentLoader_.currentMediaInfo_||this.mediaTypes_.AUDIO.activePlaylistLoader&&!this.audioSegmentLoader_.currentMediaInfo_)},r.getCodecsOrExclude_=function(){var e=this,t={main:this.mainSegmentLoader_.currentMediaInfo_||{},audio:this.audioSegmentLoader_.currentMediaInfo_||{}};t.video=t.main;var i=Cl(this.master(),this.media()),r={},n=!!this.mediaTypes_.AUDIO.activePlaylistLoader;if(t.main.hasVideo&&(r.video=i.video||t.main.videoCodec||Vu),t.main.isMuxed&&(r.video+=","+(i.audio||t.main.audioCodec||ju)),(t.main.hasAudio&&!t.main.isMuxed||t.audio.hasAudio||n)&&(r.audio=i.audio||t.main.audioCodec||t.audio.audioCodec||ju,t.audio.isFmp4=t.main.hasAudio&&!t.main.isMuxed?t.main.isFmp4:t.audio.isFmp4),r.audio||r.video){var a,s={};if(["video","audio"].forEach((function(e){if(r.hasOwnProperty(e)&&!function(e,t){return e?Hu(t):zu(t)}(t[e].isFmp4,r[e])){var i=t[e].isFmp4?"browser":"muxer";s[i]=s[i]||[],s[i].push(r[e]),"audio"===e&&(a=i)}})),n&&a&&this.media().attributes.AUDIO){var o=this.media().attributes.AUDIO;this.master().playlists.forEach((function(t){(t.attributes&&t.attributes.AUDIO)===o&&t!==e.media()&&(t.excludeUntil=1/0)})),this.logger_("excluding audio group "+o+" as "+a+' does not support codec(s): "'+r.audio+'"')}if(!Object.keys(s).length){if(this.sourceUpdater_.ready()&&!this.sourceUpdater_.canChangeType()){var u=[];if(["video","audio"].forEach((function(t){var i=(Yu(e.sourceUpdater_.codecs[t]||"")[t]||{}).type,n=(Yu(r[t]||"")[t]||{}).type;i&&n&&i.toLowerCase()!==n.toLowerCase()&&u.push('"'+e.sourceUpdater_.codecs[t]+'" -> "'+r[t]+'"')})),u.length)return void this.blacklistCurrentPlaylist({playlist:this.media(),message:"Codec switching not supported: "+u.join(", ")+".",blacklistDuration:1/0,internal:!0})}return r}var l=Object.keys(s).reduce((function(e,t){return e&&(e+=", "),e+(t+' does not support codec(s): "')+s[t].join(",")+'"'}),"")+".";this.blacklistCurrentPlaylist({playlist:this.media(),internal:!0,message:l,blacklistDuration:1/0})}else this.blacklistCurrentPlaylist({playlist:this.media(),message:"Could not determine codecs for playlist.",blacklistDuration:1/0})},r.tryToCreateSourceBuffers_=function(){if("open"===this.mediaSource.readyState&&!this.sourceUpdater_.ready()&&this.areMediaTypesKnown_()){var e=this.getCodecsOrExclude_();if(e){this.sourceUpdater_.createSourceBuffers(e);var t=[e.video,e.audio].filter(Boolean).join(",");this.excludeIncompatibleVariants_(t)}}},r.excludeUnsupportedVariants_=function(){var e=this;this.master().playlists.forEach((function(t){var i=Cl(e.master,t);!i.audio||zu(i.audio)||Hu(i.audio)||(t.excludeUntil=1/0),!i.video||zu(i.video)||Hu(i.video)||(t.excludeUntil=1/0)}))},r.excludeIncompatibleVariants_=function(e){var t=this,i=Yu(e),r=Object.keys(i).length;this.master().playlists.forEach((function(e){if(e.excludeUntil!==1/0){var n={},a=2,s=[],o=Cl(t.masterPlaylistLoader_.master,e);if(o.audio||o.video){var u=[o.video,o.audio].filter(Boolean).join(",");n=Yu(u),a=Object.keys(n).length}a!==r&&(s.push('codec count "'+a+'" !== "'+r+'"'),e.excludeUntil=1/0),t.sourceUpdater_.canChangeType()||(n.video&&i.video&&n.video.type.toLowerCase()!==i.video.type.toLowerCase()&&(s.push('video codec "'+n.video.type+'" !== "'+i.video.type+'"'),e.excludeUntil=1/0),n.audio&&i.audio&&n.audio.type.toLowerCase()!==i.audio.type.toLowerCase()&&(e.excludeUntil=1/0,s.push('audio codec "'+n.audio.type+'" !== "'+i.audio.type+'"'))),s.length&&t.logger_("blacklisting "+e.id+": "+s.join(" && "))}}))},r.updateAdCues_=function(t){var i=0,r=this.seekable();r.length&&(i=r.start(0)),function(t,i,r){if(void 0===r&&(r=0),t.segments)for(var n,a=r,s=0;s<t.segments.length;s++){var o=t.segments[s];if(n=n||Xl(i,a+o.duration/2)){if("cueIn"in o){n.endTime=a,n.adEndTime=a,a+=o.duration,n=null;continue}if(a<n.endTime){a+=o.duration;continue}n.endTime+=o.duration}else if("cueOut"in o&&((n=new e.VTTCue(a,a+o.duration,o.cueOut)).adStartTime=a,n.adEndTime=a+parseFloat(o.cueOut),i.addCue(n)),"cueOutCont"in o){var u=o.cueOutCont.split("/").map(parseFloat),l=u[0],c=u[1];(n=new e.VTTCue(a,a+o.duration,"")).adStartTime=a-l,n.adEndTime=n.adStartTime+c,i.addCue(n)}a+=o.duration}}(t,this.cueTagsTrack_,i)},r.goalBufferLength=function(){var e=this.tech_.currentTime(),t=ul.GOAL_BUFFER_LENGTH,i=ul.GOAL_BUFFER_LENGTH_RATE,r=Math.max(t,ul.MAX_GOAL_BUFFER_LENGTH);return Math.min(t+e*i,r)},r.bufferLowWaterLine=function(){var e=this.tech_.currentTime(),t=ul.BUFFER_LOW_WATER_LINE,i=ul.BUFFER_LOW_WATER_LINE_RATE,r=Math.max(t,ul.MAX_BUFFER_LOW_WATER_LINE);return Math.min(t+e*i,r)},i}(ea.EventTarget),kc=["seeking","seeked","pause","playing","error"],wc=function(){function t(t){var i=this;function r(){return i.monitorCurrentTime_()}function n(){return i.techWaiting_()}function a(){return i.cancelTimer_()}function s(){return i.fixesBadSeeks_()}this.masterPlaylistController_=t.masterPlaylistController,this.tech_=t.tech,this.seekable=t.seekable,this.allowSeeksWithinUnsafeLiveWindow=t.allowSeeksWithinUnsafeLiveWindow,this.media=t.media,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.timer_=null,this.checkCurrentTimeTimeout_=null,this.logger_=Al("PlaybackWatcher"),this.logger_("initialize");var o=this.masterPlaylistController_,u=["main","subtitle","audio"],l={};u.forEach((function(e){l[e]={reset:function(){return i.resetSegmentDownloads_(e)},updateend:function(){return i.checkSegmentDownloads_(e)}},o[e+"SegmentLoader_"].on("appendsdone",l[e].updateend),o[e+"SegmentLoader_"].on("playlistupdate",l[e].reset),i.tech_.on(["seeked","seeking"],l[e].reset)})),this.tech_.on("seekablechanged",s),this.tech_.on("waiting",n),this.tech_.on(kc,a),this.tech_.on("canplay",r),this.dispose=function(){i.logger_("dispose"),i.tech_.off("seekablechanged",s),i.tech_.off("waiting",n),i.tech_.off(kc,a),i.tech_.off("canplay",r),u.forEach((function(e){o[e+"SegmentLoader_"].off("appendsdone",l[e].updateend),o[e+"SegmentLoader_"].off("playlistupdate",l[e].reset),i.tech_.off(["seeked","seeking"],l[e].reset)})),i.checkCurrentTimeTimeout_&&e.clearTimeout(i.checkCurrentTimeTimeout_),i.cancelTimer_()}}var i=t.prototype;return i.monitorCurrentTime_=function(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&e.clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=e.setTimeout(this.monitorCurrentTime_.bind(this),250)},i.resetSegmentDownloads_=function(e){var t=this.masterPlaylistController_[e+"SegmentLoader_"];0<this[e+"StalledDownloads_"]&&this.logger_("resetting possible stalled download count for "+e+" loader"),this[e+"StalledDownloads_"]=0,this[e+"Buffered_"]=t.buffered_()},i.checkSegmentDownloads_=function(e){var t=this.masterPlaylistController_,i=t[e+"SegmentLoader_"],r=i.buffered_(),n=function(e,t){if(e===t)return!1;if(!e&&t||!t&&e)return!0;if(e.length!==t.length)return!0;for(var i=0;i<e.length;i++)if(e.start(i)!==t.start(i)||e.end(i)!==t.end(i))return!0;return!1}(this[e+"Buffered_"],r);this[e+"Buffered_"]=r,n?this.resetSegmentDownloads_(e):(this[e+"StalledDownloads_"]++,this.logger_("found #"+this[e+"StalledDownloads_"]+" "+e+" appends that did not increase buffer (possible stalled download)",{playlistId:i.playlist_&&i.playlist_.id,buffered:su(r)}),this[e+"StalledDownloads_"]<10||(this.logger_(e+" loader stalled download exclusion"),this.resetSegmentDownloads_(e),this.tech_.trigger({type:"usage",name:"vhs-"+e+"-download-exclusion"}),"subtitle"!==e&&t.blacklistCurrentPlaylist({message:"Excessive "+e+" segment downloading detected."},1/0)))},i.checkCurrentTime_=function(){if(this.tech_.seeking()&&this.fixesBadSeeks_())return this.consecutiveUpdates=0,void(this.lastRecordedTime=this.tech_.currentTime());if(!this.tech_.paused()&&!this.tech_.seeking()){var e=this.tech_.currentTime(),t=this.tech_.buffered();if(this.lastRecordedTime===e&&(!t.length||e+.1>=t.end(t.length-1)))return this.techWaiting_();5<=this.consecutiveUpdates&&e===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):e===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=e)}},i.cancelTimer_=function(){this.consecutiveUpdates=0,this.timer_&&(this.logger_("cancelTimer_"),clearTimeout(this.timer_)),this.timer_=null},i.fixesBadSeeks_=function(){if(!this.tech_.seeking())return!1;var e,t=this.seekable(),i=this.tech_.currentTime();if(this.afterSeekableWindow_(t,i,this.media(),this.allowSeeksWithinUnsafeLiveWindow)&&(e=t.end(t.length-1)),this.beforeSeekableWindow_(t,i)){var r=t.start(0);e=r+(r===t.end(0)?0:.1)}if(void 0!==e)return this.logger_("Trying to seek outside of seekable at time "+i+" with seekable range "+au(t)+". Seeking to "+e+"."),this.tech_.setCurrentTime(e),!0;var n=this.tech_.buffered();return!!function(e){var t=e.buffered,i=e.targetDuration,r=e.currentTime;return!(!t.length||t.end(0)-t.start(0)<2*i||r>t.start(0)||!(t.start(0)-r<i))}({buffered:n,targetDuration:this.media().targetDuration,currentTime:i})&&(e=n.start(0)+.1,this.logger_("Buffered region starts ("+n.start(0)+")  just beyond seek point ("+i+"). Seeking to "+e+"."),this.tech_.setCurrentTime(e),!0)},i.waiting_=function(){if(!this.techWaiting_()){var e=this.tech_.currentTime(),t=ru(this.tech_.buffered(),e);return t.length&&e+3<=t.end(0)?(this.cancelTimer_(),this.tech_.setCurrentTime(e),this.logger_("Stopped at "+e+" while inside a buffered region ["+t.start(0)+" -> "+t.end(0)+"]. Attempting to resume playback by seeking to the current time."),this.tech_.trigger({type:"usage",name:"vhs-unknown-waiting"}),void this.tech_.trigger({type:"usage",name:"hls-unknown-waiting"})):void 0}},i.techWaiting_=function(){var e=this.seekable(),t=this.tech_.currentTime();if(this.tech_.seeking()&&this.fixesBadSeeks_())return!0;if(this.tech_.seeking()||null!==this.timer_)return!0;if(this.beforeSeekableWindow_(e,t)){var i=e.end(e.length-1);return this.logger_("Fell out of live window at time "+t+". Seeking to live point (seekable end) "+i),this.cancelTimer_(),this.tech_.setCurrentTime(i),this.tech_.trigger({type:"usage",name:"vhs-live-resync"}),this.tech_.trigger({type:"usage",name:"hls-live-resync"}),!0}var r=this.tech_.vhs.masterPlaylistController_.sourceUpdater_,n=this.tech_.buffered();if(this.videoUnderflow_({audioBuffered:r.audioBuffered(),videoBuffered:r.videoBuffered(),currentTime:t}))return this.cancelTimer_(),this.tech_.setCurrentTime(t),this.tech_.trigger({type:"usage",name:"vhs-video-underflow"}),this.tech_.trigger({type:"usage",name:"hls-video-underflow"}),!0;var a=nu(n,t);if(0<a.length){var s=a.start(0)-t;return this.logger_("Stopped at "+t+", setting timer for "+s+", seeking to "+a.start(0)),this.cancelTimer_(),this.timer_=setTimeout(this.skipTheGap_.bind(this),1e3*s,t),!0}return!1},i.afterSeekableWindow_=function(e,t,i,r){if(void 0===r&&(r=!1),!e.length)return!1;var n=e.end(e.length-1)+.1;return!i.endList&&r&&(n=e.end(e.length-1)+3*i.targetDuration),n<t},i.beforeSeekableWindow_=function(e,t){return!!(e.length&&0<e.start(0)&&t<e.start(0)-.1)},i.videoUnderflow_=function(e){var t=e.videoBuffered,i=e.audioBuffered,r=e.currentTime;if(t){var n;if(t.length&&i.length){var a=ru(t,r-3),s=ru(t,r),o=ru(i,r);o.length&&!s.length&&a.length&&(n={start:a.end(0),end:o.end(0)})}else nu(t,r).length||(n=this.gapFromVideoUnderflow_(t,r));return!!n&&(this.logger_("Encountered a gap in video from "+n.start+" to "+n.end+". Seeking to current time "+r),!0)}},i.skipTheGap_=function(e){var t=this.tech_.buffered(),i=this.tech_.currentTime(),r=nu(t,i);this.cancelTimer_(),0!==r.length&&i===e&&(this.logger_("skipTheGap_:","currentTime:",i,"scheduled currentTime:",e,"nextRange start:",r.start(0)),this.tech_.setCurrentTime(r.start(0)+el),this.tech_.trigger({type:"usage",name:"vhs-gap-skip"}),this.tech_.trigger({type:"usage",name:"hls-gap-skip"}))},i.gapFromVideoUnderflow_=function(e,t){for(var i=function(e){if(e.length<2)return ea.createTimeRanges();for(var t=[],i=1;i<e.length;i++){var r=e.end(i-1),n=e.start(i);t.push([r,n])}return ea.createTimeRanges(t)}(e),r=0;r<i.length;r++){var n=i.start(r),a=i.end(r);if(t-n<4&&2<t-n)return{start:n,end:a}}return null},t}(),Cc={errorInterval:30,getSource:function(e){return e(this.tech({IWillNotUseThisInPlugins:!0}).currentSource_||this.currentSource())}},Ac={PlaylistLoader:Zu,Playlist:il,utils:al,STANDARD_PLAYLIST_SELECTOR:function(){var t=this.useDevicePixelRatio&&e.devicePixelRatio||1;return function(t,i,r,n,a){var s={bandwidth:i,width:r,height:n,limitRenditionByPlayerDimensions:a},o=t.playlists.map((function(t){return{bandwidth:t.attributes.BANDWIDTH||e.Number.MAX_VALUE,width:t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width,height:t.attributes.RESOLUTION&&t.attributes.RESOLUTION.height,playlist:t}}));Rl(o,(function(e,t){return e.bandwidth-t.bandwidth}));var u=(o=o.filter((function(e){return!il.isIncompatible(e.playlist)}))).filter((function(e){return il.isEnabled(e.playlist)}));u.length||(u=o.filter((function(e){return!il.isDisabled(e.playlist)})));var l=u.filter((function(e){return e.bandwidth*ul.BANDWIDTH_VARIANCE<i})),c=l[l.length-1],d=l.filter((function(e){return e.bandwidth===c.bandwidth}))[0];if(!1===a){var h=d||u[0]||o[0];if(h&&h.playlist){var f="sortedPlaylistReps";return d&&(f="bandwidthBestRep"),u[0]&&(f="enabledPlaylistReps"),Fl("choosing "+Ll(h)+" using "+f+" with options",s),h.playlist}return Fl("could not choose a playlist with options",s),null}var p=l.filter((function(e){return e.width&&e.height}));Rl(p,(function(e,t){return e.width-t.width}));var g=p.filter((function(e){return e.width===r&&e.height===n}));c=g[g.length-1];var m,v,y,_=g.filter((function(e){return e.bandwidth===c.bandwidth}))[0];_||(v=(m=p.filter((function(e){return e.width>r||e.height>n}))).filter((function(e){return e.width===m[0].width&&e.height===m[0].height})),c=v[v.length-1],y=v.filter((function(e){return e.bandwidth===c.bandwidth}))[0]);var b=y||_||d||u[0]||o[0];if(b&&b.playlist){var T="sortedPlaylistReps";return y?T="resolutionPlusOneRep":_?T="resolutionBestRep":d?T="bandwidthBestRep":u[0]&&(T="enabledPlaylistReps"),Fl("choosing "+Ll(b)+" using "+T+" with options",s),b.playlist}return Fl("could not choose a playlist with options",s),null}(this.playlists.master,this.systemBandwidth,parseInt(Il(this.tech_.el(),"width"),10)*t,parseInt(Il(this.tech_.el(),"height"),10)*t,this.limitRenditionByPlayerDimensions)},INITIAL_PLAYLIST_SELECTOR:function(){var e=this,t=this.playlists.master.playlists.filter(il.isEnabled);return Rl(t,(function(e,t){return Dl(e,t)})),t.filter((function(t){return!!Cl(e.playlists.master,t).video}))[0]||null},comparePlaylistBandwidth:Dl,comparePlaylistResolution:function(t,i){var r,n;return t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width&&(r=t.attributes.RESOLUTION.width),i.attributes.RESOLUTION&&i.attributes.RESOLUTION.width&&(n=i.attributes.RESOLUTION.width),(r=r||e.Number.MAX_VALUE)===(n=n||e.Number.MAX_VALUE)&&t.attributes.BANDWIDTH&&i.attributes.BANDWIDTH?t.attributes.BANDWIDTH-i.attributes.BANDWIDTH:r-n},xhr:yu()};function Lc(e,t){for(var i=t.media(),r=-1,n=0;n<e.length;n++)if(e[n].id===i.id){r=n;break}e.selectedIndex_=r,e.trigger({selectedIndex:r,type:"change"})}["GOAL_BUFFER_LENGTH","MAX_GOAL_BUFFER_LENGTH","BACK_BUFFER_LENGTH","GOAL_BUFFER_LENGTH_RATE","BUFFER_LOW_WATER_LINE","MAX_BUFFER_LOW_WATER_LINE","BUFFER_LOW_WATER_LINE_RATE","BANDWIDTH_VARIANCE"].forEach((function(e){Object.defineProperty(Ac,e,{get:function(){return ea.log.warn("using Vhs."+e+" is UNSAFE be sure you know what you are doing"),ul[e]},set:function(t){ea.log.warn("using Vhs."+e+" is UNSAFE be sure you know what you are doing"),"number"!=typeof t||t<0?ea.log.warn("value of Vhs."+e+" must be greater than or equal to 0"):ul[e]=t}})}));var Ic="videojs-vhs";function Rc(){if(!e.localStorage)return null;var t=e.localStorage.getItem(Ic);if(!t)return null;try{return JSON.parse(t)}catch(t){return null}}Ac.canPlaySource=function(){return ea.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")},Ac.supportsNativeHls=function(){if(!t||!t.createElement)return!1;var e=t.createElement("video");return!!ea.getTech("Html5").isSupported()&&["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some((function(t){return/maybe|probably/i.test(e.canPlayType(t))}))}(),Ac.supportsNativeDash=!!(t&&t.createElement&&ea.getTech("Html5").isSupported())&&/maybe|probably/i.test(t.createElement("video").canPlayType("application/dash+xml")),Ac.supportsTypeNatively=function(e){return"hls"===e?Ac.supportsNativeHls:"dash"===e&&Ac.supportsNativeDash},Ac.isSupported=function(){return ea.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var Dc=function(i){function r(e,r,n){var a;if(a=i.call(this,r,ea.mergeOptions(n.hls,n.vhs))||this,n.hls&&Object.keys(n.hls).length&&ea.log.warn("Using hls options is deprecated. Use vhs instead."),r.options_&&r.options_.playerId){var s=ea(r.options_.playerId);s.hasOwnProperty("hls")||Object.defineProperty(s,"hls",{get:function(){return ea.log.warn("player.hls is deprecated. Use player.tech().vhs instead."),r.trigger({type:"usage",name:"hls-player-access"}),Be(a)},configurable:!0}),s.hasOwnProperty("vhs")||Object.defineProperty(s,"vhs",{get:function(){return ea.log.warn("player.vhs is deprecated. Use player.tech().vhs instead."),r.trigger({type:"usage",name:"vhs-player-access"}),Be(a)},configurable:!0}),s.hasOwnProperty("dash")||Object.defineProperty(s,"dash",{get:function(){return ea.log.warn("player.dash is deprecated. Use player.tech().vhs instead."),Be(a)},configurable:!0}),a.player_=s}if(a.tech_=r,a.source_=e,a.stats={},a.ignoreNextSeekingEvent_=!1,a.setOptions_(),a.options_.overrideNative&&r.overrideNativeAudioTracks&&r.overrideNativeVideoTracks)r.overrideNativeAudioTracks(!0),r.overrideNativeVideoTracks(!0);else if(a.options_.overrideNative&&(r.featuresNativeVideoTracks||r.featuresNativeAudioTracks))throw new Error("Overriding native HLS requires emulated tracks. See https://git.io/vMpjB");return a.on(t,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],(function(e){var i=t.fullscreenElement||t.webkitFullscreenElement||t.mozFullScreenElement||t.msFullscreenElement;i&&i.contains(a.tech_.el())&&a.masterPlaylistController_.smoothQualityChange_()})),a.on(a.tech_,"seeking",(function(){this.ignoreNextSeekingEvent_?this.ignoreNextSeekingEvent_=!1:this.setCurrentTime(this.tech_.currentTime())})),a.on(a.tech_,"error",(function(){this.tech_.error()&&this.masterPlaylistController_&&this.masterPlaylistController_.pauseLoading()})),a.on(a.tech_,"play",a.play),a}qe(r,i);var n=r.prototype;return n.setOptions_=function(){var e=this;if(this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.handleManifestRedirects=!1!==this.options_.handleManifestRedirects,this.options_.limitRenditionByPlayerDimensions=!1!==this.options_.limitRenditionByPlayerDimensions,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.smoothQualityChange=this.options_.smoothQualityChange||!1,this.options_.useBandwidthFromLocalStorage=void 0!==this.source_.useBandwidthFromLocalStorage?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,this.options_.handlePartialData=this.options_.handlePartialData||!1,"number"!=typeof this.options_.blacklistDuration&&(this.options_.blacklistDuration=300),"number"!=typeof this.options_.bandwidth&&this.options_.useBandwidthFromLocalStorage){var t=Rc();t&&t.bandwidth&&(this.options_.bandwidth=t.bandwidth,this.tech_.trigger({type:"usage",name:"vhs-bandwidth-from-local-storage"}),this.tech_.trigger({type:"usage",name:"hls-bandwidth-from-local-storage"})),t&&t.throughput&&(this.options_.throughput=t.throughput,this.tech_.trigger({type:"usage",name:"vhs-throughput-from-local-storage"}),this.tech_.trigger({type:"usage",name:"hls-throughput-from-local-storage"}))}"number"!=typeof this.options_.bandwidth&&(this.options_.bandwidth=ul.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===ul.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","limitRenditionByPlayerDimensions","bandwidth","smoothQualityChange","customTagParsers","customTagMappers","handleManifestRedirects","cacheEncryptionKeys","handlePartialData"].forEach((function(t){void 0!==e.source_[t]&&(e.options_[t]=e.source_[t])})),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio},n.src=function(t,i){var r=this;t&&(this.setOptions_(),this.options_.src=function(e){return 0===e.toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,")?JSON.parse(e.substring(e.indexOf(",")+1)):e}(this.source_.src),this.options_.tech=this.tech_,this.options_.externVhs=Ac,this.options_.sourceType=ma(i),this.options_.seekTo=function(e){r.tech_.setCurrentTime(e)},this.masterPlaylistController_=new Ec(this.options_),this.playbackWatcher_=new wc(ea.mergeOptions(this.options_,{seekable:function(){return r.seekable()},media:function(){return r.masterPlaylistController_.media()},masterPlaylistController:this.masterPlaylistController_})),this.masterPlaylistController_.on("error",(function(){var e=ea.players[r.tech_.options_.playerId],t=r.masterPlaylistController_.error;"object"!=typeof t||t.code?"string"==typeof t&&(t={message:t,code:3}):t.code=3,e.error(t)})),this.masterPlaylistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):Ac.STANDARD_PLAYLIST_SELECTOR.bind(this),this.masterPlaylistController_.selectInitialPlaylist=Ac.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.masterPlaylistController_.masterPlaylistLoader_,this.mediaSource=this.masterPlaylistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get:function(){return this.masterPlaylistController_.selectPlaylist},set:function(e){this.masterPlaylistController_.selectPlaylist=e.bind(this)}},throughput:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.throughput.rate=e,this.masterPlaylistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.bandwidth},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=e,this.masterPlaylistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get:function(){return Math.floor(1/(1/(this.bandwidth||1)+(0<this.throughput?1/this.throughput:0)))},set:function(){ea.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:function(){return r.bandwidth||0},enumerable:!0},mediaRequests:{get:function(){return r.masterPlaylistController_.mediaRequests_()||0},enumerable:!0},mediaRequestsAborted:{get:function(){return r.masterPlaylistController_.mediaRequestsAborted_()||0},enumerable:!0},mediaRequestsTimedout:{get:function(){return r.masterPlaylistController_.mediaRequestsTimedout_()||0},enumerable:!0},mediaRequestsErrored:{get:function(){return r.masterPlaylistController_.mediaRequestsErrored_()||0},enumerable:!0},mediaTransferDuration:{get:function(){return r.masterPlaylistController_.mediaTransferDuration_()||0},enumerable:!0},mediaBytesTransferred:{get:function(){return r.masterPlaylistController_.mediaBytesTransferred_()||0},enumerable:!0},mediaSecondsLoaded:{get:function(){return r.masterPlaylistController_.mediaSecondsLoaded_()||0},enumerable:!0},buffered:{get:function(){return su(r.tech_.buffered())},enumerable:!0},currentTime:{get:function(){return r.tech_.currentTime()},enumerable:!0},currentSource:{get:function(){return r.tech_.currentSource_},enumerable:!0},currentTech:{get:function(){return r.tech_.name_},enumerable:!0},duration:{get:function(){return r.tech_.duration()},enumerable:!0},master:{get:function(){return r.playlists.master},enumerable:!0},playerDimensions:{get:function(){return r.tech_.currentDimensions()},enumerable:!0},seekable:{get:function(){return su(r.tech_.seekable())},enumerable:!0},timestamp:{get:function(){return Date.now()},enumerable:!0},videoPlaybackQuality:{get:function(){return r.tech_.getVideoPlaybackQuality()},enumerable:!0}}),this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_)),this.tech_.on("bandwidthupdate",(function(){r.options_.useBandwidthFromLocalStorage&&function(t){if(e.localStorage){var i=Rc();i=i?ea.mergeOptions(i,t):t;try{e.localStorage.setItem(Ic,JSON.stringify(i))}catch(t){return}}}({bandwidth:r.bandwidth,throughput:Math.round(r.throughput)})})),this.masterPlaylistController_.on("selectedinitialmedia",(function(){!function(e){var t=e.playlists;e.representations=function(){return t&&t.master&&t.master.playlists?t.master.playlists.filter((function(e){return!fu(e)})).map((function(t,i){return new Jl(e,t,t.id)})):[]}}(r)})),this.masterPlaylistController_.sourceUpdater_.on("ready",(function(){var e=r.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader;!function(e){var t=e.player,i=e.sourceKeySystems,r=e.audioMedia,n=e.mainPlaylists,a=function(e,t,i){if(!e)return e;var r={video:t&&t.attributes&&t.attributes.CODECS,audio:i&&i.attributes&&i.attributes.CODECS};!r.audio&&r.video&&1<r.video.split(",").length&&r.video.split(",").forEach((function(e){e=e.trim(),Ku(e)?r.audio=e:Wu(e)&&(r.video=e)}));var n=r.video?'video/mp4;codecs="'+r.video+'"':null,a=r.audio?'audio/mp4;codecs="'+r.audio+'"':null,s={};for(var o in e)s[o]={audioContentType:a,videoContentType:n},t.contentProtection&&t.contentProtection[o]&&t.contentProtection[o].pssh&&(s[o].pssh=t.contentProtection[o].pssh),"string"==typeof e[o]&&(s[o].url=e[o]);return ea.mergeOptions(e,s)}(i,e.media,r);a&&(!(t.currentSource().keySystems=a)||t.eme?11!==ea.browser.IE_VERSION&&t.eme.initializeMediaKeys&&function(e,t){return e.reduce((function(e,i){if(!i.contentProtection)return e;var r=t.reduce((function(e,t){var r=i.contentProtection[t];return r&&r.pssh&&(e[t]={pssh:r.pssh}),e}),{});return Object.keys(r).length&&e.push(r),e}),[])}(r?n.concat([r]):n,Object.keys(i)).forEach((function(e){t.eme.initializeMediaKeys({keySystems:e})})):ea.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin"))}({player:r.player_,sourceKeySystems:r.source_.keySystems,media:r.playlists.media(),audioMedia:e&&e.media(),mainPlaylists:r.playlists.master.playlists})})),this.on(this.masterPlaylistController_,"progress",(function(){this.tech_.trigger("progress")})),this.on(this.masterPlaylistController_,"firstplay",(function(){this.ignoreNextSeekingEvent_=!0})),this.setupQualityLevels_(),this.tech_.el()&&(this.mediaSourceUrl_=e.URL.createObjectURL(this.masterPlaylistController_.mediaSource),this.tech_.src(this.mediaSourceUrl_)))},n.setupQualityLevels_=function(){var e=this,t=ea.players[this.tech_.options_.playerId];t&&t.qualityLevels&&!this.qualityLevels_&&(this.qualityLevels_=t.qualityLevels(),this.masterPlaylistController_.on("selectedinitialmedia",(function(){!function(e,t){t.representations().forEach((function(t){e.addQualityLevel(t)})),Lc(e,t.playlists)}(e.qualityLevels_,e)})),this.playlists.on("mediachange",(function(){Lc(e.qualityLevels_,e.playlists)})))},r.version=function(){return{"@videojs/http-streaming":"2.2.4","mux.js":"5.6.7","mpd-parser":"0.14.0","m3u8-parser":"4.5.0","aes-decrypter":"3.1.0"}},n.version=function(){return this.constructor.version()},n.canChangeType=function(){return dc.canChangeType()},n.play=function(){this.masterPlaylistController_.play()},n.setCurrentTime=function(e){this.masterPlaylistController_.setCurrentTime(e)},n.duration=function(){return this.masterPlaylistController_.duration()},n.seekable=function(){return this.masterPlaylistController_.seekable()},n.dispose=function(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.masterPlaylistController_&&this.masterPlaylistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.player_&&(delete this.player_.vhs,delete this.player_.dash,delete this.player_.hls),this.tech_&&this.tech_.vhs&&delete this.tech_.vhs,this.tech_&&delete this.tech_.hls,this.mediaSourceUrl_&&e.URL.revokeObjectURL&&(e.URL.revokeObjectURL(this.mediaSourceUrl_),this.mediaSourceUrl_=null),i.prototype.dispose.call(this)},n.convertToProgramTime=function(e,t){return function(e){var t=e.playlist,i=e.time,r=void 0===i?void 0:i,n=e.callback;if(!n)throw new Error("getProgramTime: callback must be provided");if(!t||void 0===r)return n({message:"getProgramTime: playlist and time must be provided"});var a=function(e,t){if(!t||!t.segments||0===t.segments.length)return null;for(var i,r=0,n=0;n<t.segments.length&&!(e<=(r=(i=t.segments[n]).videoTimingInfo?i.videoTimingInfo.transmuxedPresentationEnd:r+i.duration));n++);var a=t.segments[t.segments.length-1];if(a.videoTimingInfo&&a.videoTimingInfo.transmuxedPresentationEnd<e)return null;if(r<e){if(e>r+.25*a.duration)return null;i=a}return{segment:i,estimatedStart:i.videoTimingInfo?i.videoTimingInfo.transmuxedPresentationStart:r-i.duration,type:i.videoTimingInfo?"accurate":"estimate"}}(r,t);if(!a)return n({message:"valid programTime was not found"});if("estimate"===a.type)return n({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:a.estimatedStart});var s={mediaSeconds:r},o=function(e,t){if(!t.dateTimeObject)return null;var i=e-(t.videoTimingInfo.transmuxedPresentationStart+t.videoTimingInfo.transmuxerPrependedSeconds);return new Date(t.dateTimeObject.getTime()+1e3*i)}(r,a.segment);return o&&(s.programDateTime=o.toISOString()),n(null,s)}({playlist:this.masterPlaylistController_.media(),time:e,callback:t})},n.seekToProgramTime=function(e,t,i,r){return void 0===i&&(i=!0),void 0===r&&(r=2),function e(t){var i=t.programTime,r=t.playlist,n=t.retryCount,a=void 0===n?2:n,s=t.seekTo,o=t.pauseAfterSeek,u=void 0===o||o,l=t.tech,c=t.callback;if(!c)throw new Error("seekToProgramTime: callback must be provided");if(void 0===i||!r||!s)return c({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!r.endList&&!l.hasStarted_)return c({message:"player must be playing a live stream to start buffering"});if(!function(e){if(!e.segments||0===e.segments.length)return!1;for(var t=0;t<e.segments.length;t++)if(!e.segments[t].dateTimeObject)return!1;return!0}(r))return c({message:"programDateTime tags must be provided in the manifest "+r.resolvedUri});var d=function(e,t){var i;try{i=new Date(e)}catch(e){return null}if(!t||!t.segments||0===t.segments.length)return null;var r=t.segments[0];if(i<r.dateTimeObject)return null;for(var n=0;n<t.segments.length-1&&(r=t.segments[n],!(i<t.segments[n+1].dateTimeObject));n++);var a=t.segments[t.segments.length-1],s=a.dateTimeObject,o=a.videoTimingInfo?function(e){return e.transmuxedPresentationEnd-e.transmuxedPresentationStart-e.transmuxerPrependedSeconds}(a.videoTimingInfo):a.duration+.25*a.duration;return new Date(s.getTime()+1e3*o)<i?null:(s<i&&(r=a),{segment:r,estimatedStart:r.videoTimingInfo?r.videoTimingInfo.transmuxedPresentationStart:il.duration(t,t.mediaSequence+t.segments.indexOf(r)),type:r.videoTimingInfo?"accurate":"estimate"})}(i,r);if(!d)return c({message:i+" was not found in the stream"});var h=d.segment,f=function(e,t){var i,r;try{i=new Date(e),r=new Date(t)}catch(e){}var n=i.getTime();return(r.getTime()-n)/1e3}(h.dateTimeObject,i);if("estimate"===d.type)return 0===a?c({message:i+" is not buffered yet. Try again"}):(s(d.estimatedStart+f),void l.one("seeked",(function(){e({programTime:i,playlist:r,retryCount:a-1,seekTo:s,pauseAfterSeek:u,tech:l,callback:c})})));var p=h.start+f;l.one("seeked",(function(){return c(null,l.currentTime())})),u&&l.pause(),s(p)}({programTime:e,playlist:this.masterPlaylistController_.media(),retryCount:r,pauseAfterSeek:i,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:t})},r}(ea.getComponent("Component")),Oc={name:"videojs-http-streaming",VERSION:"2.2.4",canHandleSource:function(e,t){void 0===t&&(t={});var i=ea.mergeOptions(ea.options,t);return Oc.canPlayType(e.type,i)},handleSource:function(e,t,i){void 0===i&&(i={});var r=ea.mergeOptions(ea.options,i);return t.vhs=new Dc(e,t,r),ea.hasOwnProperty("hls")||Object.defineProperty(t,"hls",{get:function(){return ea.log.warn("player.tech().hls is deprecated. Use player.tech().vhs instead."),t.vhs},configurable:!0}),t.vhs.xhr=yu(),t.vhs.src(e.src,e.type),t.vhs},canPlayType:function(e,t){void 0===t&&(t={});var i=ea.mergeOptions(ea.options,t).vhs.overrideNative,r=void 0===i?!ea.browser.IS_ANY_SAFARI:i,n=ma(e);return!n||Ac.supportsTypeNatively(n)&&!r?"":"maybe"}};return Hu("avc1.4d400d,mp4a.40.2")&&ea.getTech("Html5").registerSourceHandler(Oc,0),ea.VhsHandler=Dc,Object.defineProperty(ea,"HlsHandler",{get:function(){return ea.log.warn("videojs.HlsHandler is deprecated. Use videojs.VhsHandler instead."),Dc},configurable:!0}),ea.VhsSourceHandler=Oc,Object.defineProperty(ea,"HlsSourceHandler",{get:function(){return ea.log.warn("videojs.HlsSourceHandler is deprecated. Use videojs.VhsSourceHandler instead."),Oc},configurable:!0}),ea.Vhs=Ac,Object.defineProperty(ea,"Hls",{get:function(){return ea.log.warn("videojs.Hls is deprecated. Use videojs.Vhs instead."),Ac},configurable:!0}),ea.use||(ea.registerComponent("Hls",Ac),ea.registerComponent("Vhs",Ac)),ea.options.vhs=ea.options.vhs||{},ea.options.hls=ea.options.hls||{},ea.registerPlugin?ea.registerPlugin("reloadSourceOnError",Zl):ea.plugin("reloadSourceOnError",Zl),ea}));